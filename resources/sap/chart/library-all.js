jQuery.sap.declare('sap.chart.library-all');if(!jQuery.sap.isDeclared('sap.chart.ChartLog')){
/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
jQuery.sap.declare('sap.chart.ChartLog');sap.ui.define("sap/chart/ChartLog",[],function(){"use strict";function C(t,n,m){this._type=t;this._name=n;this._message=m;}C.prototype.display=function(){if(this._type==="error"){jQuery.sap.log.error("[Error in user input] "+this._name,this._message,'sap.chart');}};return C;});};if(!jQuery.sap.isDeclared('sap.chart.ChartType')){jQuery.sap.declare('sap.chart.ChartType');sap.ui.define("sap/chart/ChartType",function(){"use strict";var C={Bar:"bar",Column:"column",Line:"line",Combination:"combination",Pie:"pie",Donut:"donut",Scatter:"scatter",Bubble:"bubble",Heatmap:"heatmap",Bullet:"bullet",VerticalBullet:"vertical_bullet",StackedBar:"stacked_bar",StackedColumn:"stacked_column",StackedCombination:"stacked_combination",HorizontalStackedCombination:"horizontal_stacked_combination",DualBar:"dual_bar",DualColumn:"dual_column",DualLine:"dual_line",DualStackedBar:"dual_stacked_bar",DualStackedColumn:"dual_stacked_column",DualCombination:"dual_combination",DualHorizontalCombination:"dual_horizontal_combination",DualStackedCombination:"dual_stacked_combination",DualHorizontalStackedCombination:"dual_horizontal_stacked_combination",PercentageStackedBar:"100_stacked_bar",PercentageStackedColumn:"100_stacked_column",PercentageDualStackedBar:"100_dual_stacked_bar",PercentageDualStackedColumn:"100_dual_stacked_column",Waterfall:"waterfall",HorizontalWaterfall:"horizontal_waterfall"};return C;},true);};if(!jQuery.sap.isDeclared('sap.chart.TimeUnitType')){jQuery.sap.declare('sap.chart.TimeUnitType');sap.ui.define("sap/chart/TimeUnitType",function(){"use strict";var T={Date:"Date",yearmonthday:"yearmonthday",yearquarter:"yearquarter",yearmonth:"yearmonth",fiscalyear:"fiscalyear",fiscalyearperiod:"fiscalyearperiod"};return T;},true);};if(!jQuery.sap.isDeclared('sap.chart.coloring.ColorPalette')){jQuery.sap.declare('sap.chart.coloring.ColorPalette');sap.ui.define("sap/chart/coloring/ColorPalette",[],function(){"use strict";var P={};P.CRITICALITY={Positive:['sapUiChartPaletteSemanticGoodLight3','sapUiChartPaletteSemanticGoodLight2','sapUiChartPaletteSemanticGoodLight1','sapUiChartPaletteSemanticGood','sapUiChartPaletteSemanticGoodDark1','sapUiChartPaletteSemanticGoodDark2'],Critical:['sapUiChartPaletteSemanticCriticalLight3','sapUiChartPaletteSemanticCriticalLight2','sapUiChartPaletteSemanticCriticalLight1','sapUiChartPaletteSemanticCritical','sapUiChartPaletteSemanticCriticalDark1','sapUiChartPaletteSemanticCriticalDark2'],Negative:['sapUiChartPaletteSemanticBadLight3','sapUiChartPaletteSemanticBadLight2','sapUiChartPaletteSemanticBadLight1','sapUiChartPaletteSemanticBad','sapUiChartPaletteSemanticBadDark1','sapUiChartPaletteSemanticBadDark2'],Neutral:['sapUiChartPaletteSemanticNeutralLight3','sapUiChartPaletteSemanticNeutralLight2','sapUiChartPaletteSemanticNeutralLight1','sapUiChartPaletteSemanticNeutral','sapUiChartPaletteSemanticNeutralDark1','sapUiChartPaletteSemanticNeutralDark2']};P.EMPHASIS={Highlight:"sapUiChartPaletteQualitativeHue2",Others:"sapUiChartPaletteQualitativeHue1"};return P;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.ColoringUtils')){jQuery.sap.declare('sap.chart.coloring.ColoringUtils');sap.ui.define("sap/chart/coloring/ColoringUtils",[],function(){"use strict";var t=jQuery.type;var U={};U.find=function(m,l){for(var i=0;i<l.length;i++){if(m===l[i].getName()){return l[i];}}return null;};U.isNumber=function(){for(var i=0;i<arguments.length;i++){if(t(arguments[i])!=='number'){return false;}}return true;};U.assertLevel=function(b,l){var L=b[l];if(L===null||L===undefined){return 1;}else if([1,2,3,4,5,6].indexOf(L)!==-1){return L;}else{throw new Error("Colorings.Criticality.<MeasureName>.Breakdown."+l+" must be an integer from 1 to 6, received "+L);}};U.thresholdValue=function(T){if(t(T)==='string'){return function(c){return c[T];};}else{return function(c){return T;};}};U.isInRange=function(v,l,h,a,b){if(!U.isNumber(v,l,h)){return false;}var c=a?(l<=v):(l<v);var d=b?(v<=h):(v<h);return c&&d;};U.genLevels=function(n,l){var L=[];for(var i=0;i<n;i++){L.push(i+1);}return L.map(function(a){return function(c){return l(c)===a;};});};U.assignColor=function(c,l){switch(l){case 1:return[c[3]];case 2:return[c[1],c[3]];case 3:return[c[1],c[3],c[5]];case 4:return c.slice(1,5);case 5:return c.slice(1,6);case 6:return c.slice(0,6);default:return null;}};U.assignUnmentionedColor=function(c,l){switch(l){case 1:return[c[1]];case 2:return[c[1],c[5]];case 3:return[c[1],c[2],c[4]];case 4:return[c[1],c[2],c[4],c[5]];case 5:return c.filter(function(i){return i!==3;});default:return null;}};return U;});};if(!jQuery.sap.isDeclared('sap.chart.pagination.SeriesColorTracker')){jQuery.sap.declare('sap.chart.pagination.SeriesColorTracker');sap.ui.define("sap/chart/pagination/SeriesColorTracker",[],function(){"use strict";var _={color:true,color2:true};function S(){this._mSeriesColor={};}function s(c){var t=jQuery.type(c);switch(t){case"string":return'"'+c+'"';case"null":case"undefined":return t;case"array":return"["+c.map(s).join(",")+"]";case"object":return"{"+Object.keys(c).map(function(p){return'"'+p+'":'+s(c[p]);}).join(",")+"}";case"number":case"boolean":return String(c);default:return t+"<"+String(c)+">";}}S.prototype.add=function(r){var a=this._mSeriesColor,m;r.forEach(function(R){var f=R.feed;if(!_[f]){return;}m=a[f];if(!m){m={};a[f]=m;}R.results.forEach(function(o){var k=s(o.dataContext);if(!m[k]){m[k]=o;}});});};S.prototype.get=function(){var f=Object.keys(this._mSeriesColor);var m=this._mSeriesColor;return f.map(function(F){var k=Object.keys(m[F]);return k.length===0?null:{results:k.map(function(K){return m[F][K];}),feed:F};});};S.prototype.clear=function(){this._mSeriesColor={};};return S;});};if(!jQuery.sap.isDeclared('sap.chart.utils.ChartUtils')){jQuery.sap.declare('sap.chart.utils.ChartUtils');sap.ui.define("sap/chart/utils/ChartUtils",['sap/chart/ChartType'],function(C){"use strict";var _={chartTypes:[C.Bar,C.Column,C.Line,C.Combination,C.Pie,C.Donut,C.Scatter,C.Bubble,C.Heatmap,C.Bullet,C.VerticalBullet,C.StackedBar,C.StackedColumn,C.StackedCombination,C.HorizontalStackedCombination,C.DualBar,C.DualColumn,C.DualLine,C.DualStackedBar,C.DualStackedColumn,C.DualCombination,C.DualHorizontalCombination,C.DualStackedCombination,C.DualHorizontalStackedCombination,C.PercentageStackedBar,C.PercentageStackedColumn,C.PercentageDualStackedBar,C.PercentageDualStackedColumn,C.Waterfall,C.HorizontalWaterfall],pagingChartTypes:[C.Bar,C.Column,C.Line,C.Combination,C.Bullet,C.VerticalBullet,C.StackedBar,C.StackedColumn,C.StackedCombination,C.HorizontalStackedCombination,C.DualBar,C.DualColumn,C.DualLine,C.DualStackedBar,C.DualStackedColumn,C.DualCombination,C.DualHorizontalCombination,C.DualStackedCombination,C.DualHorizontalStackedCombination,C.PercentageStackedBar,C.PercentageStackedColumn,C.PercentageDualStackedBar,C.PercentageDualStackedColumn],timeChartTypes:["timeseries_line","timeseries_column","timeseries_bubble","timeseries_scatter","timeseries_combination","dual_timeseries_combination","timeseries_bullet","timeseries_stacked_column","timeseries_100_stacked_column","timeseries_waterfall"],oAdapteredChartTypes:{"line":"timeseries_line","column":"timeseries_column","scatter":"timeseries_scatter","bubble":"timeseries_bubble","combination":"timeseries_combination","dual_combination":"dual_timeseries_combination","vertical_bullet":"timeseries_bullet","stacked_column":"timeseries_stacked_column","100_stacked_column":"timeseries_100_stacked_column","waterfall":"timeseries_waterfall"},nonSemanticPatternChartType:[C.Combination,C.Pie,C.Donut,C.Scatter,C.Bubble,C.Heatmap,C.StackedBar,C.StackedColumn,C.StackedCombination,C.HorizontalStackedCombination,C.DualStackedBar,C.DualStackedColumn,C.DualCombination,C.DualHorizontalCombination,C.DualStackedCombination,C.DualHorizontalStackedCombination,C.PercentageStackedBar,C.PercentageStackedColumn,C.PercentageDualStackedBar,C.PercentageDualStackedColumn,C.Waterfall,C.HorizontalWaterfall,"timeseries_bubble","timeseries_scatter","timeseries_combination","dual_timeseries_combination","timeseries_stacked_column","timeseries_100_stacked_column","timeseries_waterfall"]};return{CONFIG:_,makeNotifyParentProperty:function(p){return function(v,s){var o=this.mProperties[p];v=this.validateProperty(p,v);if(jQuery.sap.equal(o,v)){return this;}this.setProperty(p,v,s);if(s){return this;}var P=this.getParent();if(P&&typeof P._invalidateBy==="function"){P._invalidateBy({source:this,property:p,oldValue:o,newValue:v});}return this;};}};});};if(!jQuery.sap.isDeclared('sap.chart.utils.DateFormatUtil')){jQuery.sap.declare('sap.chart.utils.DateFormatUtil');jQuery.sap.require('sap.ui.core.format.DateFormat');sap.ui.define("sap/chart/utils/DateFormatUtil",['sap/chart/TimeUnitType','sap/ui/core/format/DateFormat'],function(T,D){"use strict";var P={};P[T.yearmonthday]="yyyyMMdd";P[T.yearquarter]="yyyyQQQQQ";P[T.yearmonth]="yyyyMM";function g(t){var p=P[t];if(p){return D.getDateInstance({pattern:p});}else{return null;}}return{getInstance:g};});};if(!jQuery.sap.isDeclared('sap.chart.utils.MeasureSemantics')){jQuery.sap.declare('sap.chart.utils.MeasureSemantics');sap.ui.define("sap/chart/utils/MeasureSemantics",[],function(){"use strict";var C=['sapUiChartPaletteQualitativeHue1','sapUiChartPaletteQualitativeHue2','sapUiChartPaletteQualitativeHue3','sapUiChartPaletteQualitativeHue4','sapUiChartPaletteQualitativeHue5','sapUiChartPaletteQualitativeHue6','sapUiChartPaletteQualitativeHue7','sapUiChartPaletteQualitativeHue8','sapUiChartPaletteQualitativeHue9','sapUiChartPaletteQualitativeHue10','sapUiChartPaletteQualitativeHue11'],D=[['sapUiChartPaletteSequentialHue1','sapUiChartPaletteSequentialHue1Light2','sapUiChartPaletteSequentialHue1Dark1'],['sapUiChartPaletteSequentialHue2','sapUiChartPaletteSequentialHue2Light2','sapUiChartPaletteSequentialHue2Dark1']],S='sapUiChartPaletteSequentialNeutralDark2',L={actual:'solid',projected:'dash',reference:'dot'},P={projected:'diagonalLightStripe',reference:'noFill'};function r(M){var R={};if(M.getSemanticallyRelatedMeasures){var o=M.getSemanticallyRelatedMeasures();if(o){if(o.projectedValueMeasure){R.projected=o.projectedValueMeasure;}if(o.referenceValueMeasure){R.reference=o.referenceValueMeasure;}return R;}}return R;}function c(M){var a=M.reduce(function(a,o){a[o.getName()]={msr:o,sem:(o.getSemantics&&o.getSemantics())||"actual",rel:r(o)};return a;},{});jQuery.each(a,function(s,o){if(o.sem==="actual"){jQuery.each(o.rel,function(b,t){if(a[t]&&a[t].sem!==b){delete o.rel[b];}else{jQuery.sap.log.warning("Analytical Chart","Related measures don't match its semantic role.");}});}});return a;}function m(M,s){var t=[],i=0;jQuery.each(M.slice().sort(function(a,b){var d=s[a.getName()].sem,e=s[b.getName()].sem;if(d<e){return-1;}else if(d>e){return 1;}else{return M.indexOf(a)-M.indexOf(b);}}),function(a,o){var n=o.getName();if(!s[n]){return;}var b=s[n];var T={};var l;T[b.sem]=n;if(o.getLabel){l=o.getLabel();if(l){T.labels={};T.labels[b.sem]=l;}}T.index=i++;if(b.sem==="actual"){if(b.rel.projected&&s[b.rel.projected]){T.projected=b.rel.projected;if(s[b.rel.projected].msr.getLabel){l=s[b.rel.projected].msr.getLabel();if(l){T.labels=jQuery.extend(true,T.labels,{projected:l});}}delete s[b.rel.projected];}if(b.rel.reference&&s[b.rel.reference]){T.reference=b.rel.reference;if(s[b.rel.reference].msr.getLabel){l=s[b.rel.reference].msr.getLabel();if(l){T.labels=jQuery.extend(true,T.labels,{reference:l});}}delete s[b.rel.reference];}delete s[n];}t.push(T);});return t;}var g=function(a,s){var b={dataPointStyle:null,seriesStyle:null};if(s){var h=s.some(function(t){return t.projectedValueStartTime;}),d=(s.filter(function(t){return t.reference;}).length===1);var e=function(k){if(!b.dataPointStyle){b=jQuery.extend(true,b,{"dataPointStyle":{"rules":[],others:null}});}b.dataPointStyle.rules.push(k);};var f=function(k){if(!b.seriesStyle){b=jQuery.extend(true,b,{"seriesStyle":{"rules":[]}});}b.seriesStyle.rules.push(k);};var j=function(x,y){var z,A;if(a.indexOf('dual')===-1){A=C;z=C.length;}else{var B=(y==='valueAxis')?0:1;A=D[B];z=A.length;}return{actual:A[x%z],projected:A[x%z],reference:A[x%z]};};var t,k,l,n,o,p=function(x,y,z){return function(A){return(A.measureNames===z)&&(new Date(A[x]).getTime()>=y);};},q=function(x,y,z){return function(A){return(A.measureNames===z)&&(new Date(A[x]).getTime()<y);};},u=s.length,v,w;for(var i=0;i<u;i++){t=s[i];l=j(t.index,t.valueAxisID);if(h){if(t.projectedValueStartTime&&t.timeAxis){o={};w=(t.labels&&t.labels.actual)?t.labels.actual:t.actual;o[t.semanticMsrName]=w;e({"callback":q(t.timeAxis,t.projectedValueStartTime,t.semanticMsrName),"properties":{"lineType":L.actual,"color":l.actual,"lineColor":l.actual},"displayName":w,"dataName":o});o={};w=(t.labels&&t.labels.projected)?t.labels.projected:t.projected;o[t.semanticMsrName]=w;e({"callback":p(t.timeAxis,t.projectedValueStartTime,t.semanticMsrName),"properties":{"lineType":L.projected,"pattern":P.projected,"color":l.projected,"lineColor":l.projected},"displayName":w,"dataName":o});if(t.reference){k={};k[t.reference]='*';n=d?S:l.reference;w=(t.labels&&t.labels.reference)?t.labels.reference:t.reference;e({"dataContext":[k],"properties":{"lineType":L.reference,"color":n,"lineColor":n,"pattern":P.reference},"displayName":w});}}else{for(v in t){if(t.hasOwnProperty(v)&&v!=='valueAxisID'&&v!=='index'){k={};k[t[v]]='*';w=(t.labels&&t.labels[v])?t.labels[v]:t[v];n=(d&&v==='reference')?S:l[v];e({"dataContext":[k],"properties":{"lineType":L[v],"color":n,"lineColor":n,"pattern":P[v]},"displayName":w});}}}}else if(a&&a.indexOf('bullet')===-1){for(v in t){if(t.hasOwnProperty(v)&&v!=='valueAxisID'&&v!=='index'){k={};k[t[v]]='*';n=(d&&v==='reference')?S:l[v];f({"dataContext":[k],"properties":{"dataPoint":{"color":n,"pattern":P[v]},"line":{"type":L[v],"color":n}},"displayName":t[v]});}}}}}return{"plotArea":b};};return{getTuples:function(M){return m(M,c(M));},getSemanticVizProperties:g};});};if(!jQuery.sap.isDeclared('sap.chart.utils.SelectionAPIUtils')){jQuery.sap.declare('sap.chart.utils.SelectionAPIUtils');sap.ui.define("sap/chart/utils/SelectionAPIUtils",[],function(){"use strict";function m(k){return k.reduce(function(l,K){l[K]=true;return l;},{});}function t(v,V){var e=m(v);function g(C){return V.reduce(function(p,D){if(C.hasOwnProperty(D)){p[D]=C[D];}return p;},{});}return function(r,C){return r.filter(function(M){return e[M];}).map(function(M){var D=g(C);D[M]="*";return{data:D};});};}function a(C){var V={data:{}},M=C.measures,D=C.dimensions;if(M){V.data.measureNames=(M instanceof Array)?{"in":M}:M;}jQuery.each(D||{},function(k,v){V.data[k]=(v instanceof Array)?{"in":v}:v;});return V;}function f(V){var D=V.data;return Object.keys(D).reduce(function(o,k){var v=D[k];if(v.in&&v.in instanceof Array){v=v.in;}if(k==="measureNames"){o.measures=v;}else if(!o.dimensions){o.dimensions={};o.dimensions[k]=v;}else{o.dimensions[k]=v;}return o;},{});}function b(v,V,B,C){var e=t(v,V);return C.reduce(function(D,o){var g=B.getContexts(o.index,1);if(g.length>0){D=D.concat(e(o.measures,g[0].getObject()));}return D;},[]);}function c(e,v){return Object.keys(e).filter(function(M){return(v.indexOf(M)!==-1);});}function d(s,v,D){if(s){var I,e;for(e in s){if(s.hasOwnProperty(e)&&D.data[e]){var g=s[e];I=(D.data[g.timeAxis]<g.projectedValueStartTime)?g.projected:g.actual;}}if(I){D.measures=D.measures.filter(function(M){return(M!==I);});if(D.dataName){D.dataName=Object.keys(D.dataName).reduce(function(h,k,i){if(v.indexOf(k)!==-1){h[k]=D.dataName[k];}return h;},{});if(jQuery.isEmptyObject(D.dataName)){delete D.dataName;}}}else{var u=[];for(var k in s){if(s.hasOwnProperty(k)){e=s[k];u.push(e.actual);u.push(e.projected);}}D.measures=D.measures.filter(function(M){return u.indexOf(M)===-1;});}}}return{makeLookUp:m,toVizCtx:t,toVizCSCtx:a,fromVizCSCtx:f,buildSelectionVizCtx:b,filterVisibleMsr:c,filterSemMsr:d,match:function(r,v,M){return Object.keys(r).every(function(k){if(M.indexOf(k)!==-1){return v.hasOwnProperty(k);}else{return r[k]===v[k];}});}};});};if(!jQuery.sap.isDeclared('sap.chart.data.Dimension')){jQuery.sap.declare('sap.chart.data.Dimension');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/chart/data/Dimension",["sap/ui/core/Element","sap/chart/utils/ChartUtils"],function(E,C){"use strict";var _={category:true,category2:true,series:true};var D=E.extend("sap.chart.data.Dimension",{metadata:{library:"sap.chart",properties:{name:{type:"string"},label:{type:"string"},textFormatter:{type:"function"},textProperty:{type:"string"},displayText:{type:"boolean",defaultValue:true},role:{type:"string",defaultValue:"category"}}}});D.prototype.setLabel=C.makeNotifyParentProperty("label");D.prototype.setTextFormatter=C.makeNotifyParentProperty("textFormatter");var t=C.makeNotifyParentProperty("textProperty");D.prototype.setTextProperty=function(v,s){return t.apply(this,arguments);};D.prototype.setDisplayText=C.makeNotifyParentProperty("displayText");var r=C.makeNotifyParentProperty("role");D.prototype.setRole=function(v,s){if(!_[v]){jQuery.error("Invalide Dimension role: "+v);}return r.apply(this,arguments);};D.prototype._getFixedRole=function(){return this._sFixedRole||this.getRole();};return D;});};if(!jQuery.sap.isDeclared('sap.chart.data.TimeDimension')){jQuery.sap.declare('sap.chart.data.TimeDimension');sap.ui.define("sap/chart/data/TimeDimension",["sap/chart/data/Dimension","sap/chart/utils/ChartUtils"],function(D,C){"use strict";var T=D.extend("sap.chart.data.TimeDimension",{metadata:{library:"sap.chart",properties:{timeUnit:{type:"sap.chart.TimeUnitType"},fiscalYearPeriodCount:{type:"object"},projectedValueStartTime:{type:"any"}}}});T.prototype.setTimeUnit=C.makeNotifyParentProperty("timeUnit");T.prototype.setFiscalYearPeriodCount=C.makeNotifyParentProperty("fiscalYearPeriodCount");T.prototype.setProjectedValueStartTime=C.makeNotifyParentProperty("projectedValueStartTime");return T;});};if(!jQuery.sap.isDeclared('sap.chart.pagination.PagingController')){jQuery.sap.declare('sap.chart.pagination.PagingController');jQuery.sap.require('sap.ui.model.Sorter');sap.ui.define("sap/chart/pagination/PagingController",['sap/chart/pagination/SeriesColorTracker','sap/ui/model/Sorter'],function(S,a){"use strict";var P=500;function i(B,s,l){var c=B.getContexts(s,l),n;if(c.dataRequested){n=true;}else{n=c.some(function(C){return C===undefined;});}return!n;}var b=function(c){this._oColorTracker=new S();this._mMeasureRange={};this._iRenderedPageNo=-1;this._bUnderPaging=false;this._iMaxPageNo=-1;this._iRemainingRecords=-1;this._iOffset=null;this._oChart=c;this._bInitialized=false;this._bWaiting=false;this._aPagingSorters=null;this._bMinMaxQueried=false;var d=this._oChart._getDataset();if(d){d.setRange(0,P*2);}var v=this._oChart._getVizFrame();v.attachEvent("_scroll",b.prototype._scrollHandler.bind(this));};b.prototype.bindingChanged=function(){if(!this._bInitialized||!this._bMinMaxQueried){this.init(true);}else if(this.isUnderPaging()){this.paging(this._oChart._getVizFrame()._states().plot.transform.translate.position);}if(!this._bInitialized||this._bWaiting){this._sLoadingTimer=this._sLoadingTimer||jQuery.sap.delayedCall(200,this,function(){this._oChart._showLoading(true);});}else{this._oChart._showLoading(false);}};b.prototype.reset=function(){this._bInitialized=false;this._bWaiting=false;this._iRenderedPageNo=0;this._mMeasureRange={};this._bMinMaxQueried=false;this._oColorTracker.clear();var B=this._oChart.getBinding("data");var d=this._oChart._getDataset();if(!d||!B){return;}var f=this._oChart._prepareFeeds();f._order=f._order.filter(function(F){return F!=="MND"&&this._oChart.getDimensions().map(function(v){return v.getName();}).indexOf(F)>-1;}.bind(this));this._aPagingSorters=null;if(f._order.length){var s=this._oChart._aFeeds._order.map(function(p){return new a(p);});B.sort(s);this._aPagingSorters=s;}this._oChart._getVizFrame()._runtimeScales(this._oColorTracker.get(),true);this._oChart._getVizFrame()._readyToRender(false);var l;if(this._oChart.getBindingInfo("data").length){l=Math.min(P*2,this._oChart.getBindingInfo("data").length);}else{l=P*2;}d.setRange(0,l);d.setPagingOption({bEnabled:false});};b.prototype.getPagingSorters=function(){return this._aPagingSorters;};b.prototype.isUnderPaging=function(){return!!this._bUnderPaging;};b.prototype.init=function(n){this._bInitialized=true;this._bUnderPaging=false;var v=this._oChart._getVizFrame();var d=v.getDataset();var B=d.getBinding("data");if(!B){return;}var t=B instanceof sap.ui.model.analytics.AnalyticalBinding?B.getTotalSize():B.getLength();var p;if(t>=0){if(this._oChart.getBindingInfo("data").length){this._iTotalSize=Math.min(this._oChart.getBindingInfo("data").length,t);}else{this._iTotalSize=t;}if(this._iTotalSize>P*2){this._bUnderPaging=true;this._iMaxPageNo=Math.floor(this._iTotalSize/P)-1;this._iRemainingRecords=this._iTotalSize%P;this._iOffset=null;this._iRenderedPageNo=0;var c=P/this._iTotalSize;p={bEnabled:true,sMode:"reset",thumbRatio:c};d.setRange(0,P);if(n){this._bWaiting=true;this._bMinMaxQueried=true;this._queryMinMax(this._oChart,B,function(q){var m={};jQuery.each(q,function(M,r){m[M]={min:r.min.value,max:r.max.value};});this._mMeasureRange=m;this._bWaiting=false;this._oChart._invalidateBy({source:this._oChart,keys:{vizFrame:true}});this._oChart.setBusy(false);v._readyToRender(i(B,0,P));}.bind(this));}else{v._readyToRender(i(B,0,P));this._bWaiting=false;}this._bUnderPaging=true;}else{this._mMeasureRange={};p={bEnabled:false};this._bUnderPaging=false;d.setRange(0,this._iTotalSize);v._readyToRender(i(B,0,this._iTotalSize));}d.setPagingOption(p);}};b.prototype.paging=function(r){var c=Math.floor(this._iTotalSize*r/P);var v=this._oChart._getVizFrame();c=Math.min(c,this._iMaxPageNo);this._iOffset=null;var s=Math.max((c-1)*P,0);var l,d;if(c===0){l=P;d=P;}else if(c===this._iMaxPageNo){l=P*2+this._iRemainingRecords;d=P+this._iRemainingRecords;}else{l=P*2;d=P;}this._iOffset=(this._iTotalSize*r-c*P)/d;if(this._iRenderedPageNo===c){var t={plot:{transform:{translate:{translateByPage:{context:this._middleCtx,offset:this._iOffset}}}}};v._states(t);this._bWaiting=false;}else{if(this._pagingTimer){jQuery.sap.clearDelayedCall(this._pagingTimer);}this._bWaiting=true;var D=v.getDataset();var B=D.getBinding("data");this._pagingTimer=jQuery.sap.delayedCall(50,this,function(){D.setRange(s,l);D.setPagingOption({bEnabled:true,sMode:"update",thumbRatio:null});var e=i(B,s,l);if(e){this._iRenderedPageNo=c;D.invalidate();v._readyToRender(true);v.invalidate();this._oColorTracker.add(v._runtimeScales());v._runtimeScales(this._oColorTracker.get(),true);this._bWaiting=false;}else{this._bWaiting=true;v._readyToRender(false);}});this._sLoadingTimer=this._sLoadingTimer||jQuery.sap.delayedCall(200,this,function(){this._oChart._showLoading(true);});}};b.prototype.vizFrameRenderCompleted=function(){if(this._sLoadingTimer){jQuery.sap.clearDelayedCall(this._sLoadingTimer);this._sLoadingTimer=null;}this._oChart._showLoading(false);if(!this._bUnderPaging){return;}var v=this._oChart._getVizFrame();var d=v.getDataset();var B=d.getBinding("data");var r=this._iRenderedPageNo;if(r!==0){var m=r*P-1;this._middleCtx=B.getContexts(m,1)[0].getObject();}else{this._middleCtx=null;}if(this._middleCtx||this._iOffset){var t={plot:{transform:{translate:{translateByPage:{context:this._middleCtx,offset:this._iOffset}}}}};v._states(t);}};b.prototype._scrollHandler=function(e){if(this._oChart._isEnablePaging()){var r=e.getParameters().position;this.paging(r);}};b.prototype._queryMinMax=function(c,B,C){var d=c._getRequiredDimensions().map(function(D){return D.getName();}),m=c._getRequiredMeasures().map(function(g){return g.getName();});var r=m.reduce(function(r,s){r[s]={min:{},max:{}};return r;},{});function e(){var A=m.every(function(s){return r[s].min.requested&&r[s].max.requested;});if(A){C(r);}}function o(s,k,D){r[s][k].requested=true;r[s][k].value=parseFloat(D&&D.results[0][s]);e();}function f(s,k,D){r[s][k].requested=true;r[s][k].error=D;e();}var q=m.reduce(function(q,s){return q.concat({urlParameters:{"$select":d.concat(s).join(","),"$top":1,"$orderby":s+" asc"},success:o.bind(null,s,"min"),error:f.bind(null,s,"min")},{urlParameters:{"$select":d.concat(s).join(","),"$top":1,"$orderby":s+" desc"},success:o.bind(null,s,"max"),error:f.bind(null,s,"max")});},[]);var p=B.getPath(),M=B.getModel();q.forEach(function(Q){M.read(p,Q);});return q;};b.prototype.getCurrentContexts=function(){var v=this._oChart._getVizFrame();var d=v.getDataset();var r=d.getRange();var s=r.iStartIndex,l;if(this._iRenderedPageNo===0){l=r.iLength*2;}else{l=r.iLength;}return d.getBinding("data").getContexts(s,l);};b.prototype.getMeasureRange=function(){return this._mMeasureRange;};return b;});};if(!jQuery.sap.isDeclared('sap.chart.utils.ChartTypeAdapterUtils')){jQuery.sap.declare('sap.chart.utils.ChartTypeAdapterUtils');sap.ui.define("sap/chart/utils/ChartTypeAdapterUtils",['sap/chart/utils/ChartUtils'],function(C){"use strict";var a={};function t(c,d){var h=d.some(function(D){return D instanceof sap.chart.data.TimeDimension;});if(h){return C.CONFIG.oAdapteredChartTypes[c];}else{return c;}}a.adaptChartType=function(c,d){if(C.CONFIG.oAdapteredChartTypes[c]){return t(c,d);}else{return c;}};return a;});};if(!jQuery.sap.isDeclared('sap.chart.utils.RoleMapper')){jQuery.sap.declare('sap.chart.utils.RoleMapper');sap.ui.define("sap/chart/utils/RoleMapper",['sap/chart/data/TimeDimension','sap/chart/utils/MeasureSemantics','sap/chart/utils/ChartUtils','sap/chart/utils/DateFormatUtil'],function(T,M,C,D){"use strict";function R(f){this._bTimeFed=false;}R.prototype.toFeedingId=function(o){if(o instanceof T&&!this._bTimeFed){this._bTimeFed=true;return"timeAxis";}else{return"@context";}};function t(a){while(a.length&&!a[a.length-1]){a.pop();}return a;}function c(a){return C.CONFIG.timeChartTypes.indexOf(a)>-1;}function d(a){return a.indexOf('dual')>-1;}R.semantics={semanticBulletMsrs:function(m,c){var a=m["@semanticBulletMsrs"];var b=a.reduce(function(b,o){b[o.getName()]=o;return b;},{});var s=M.getTuples(a);var S={actualValues:[],additionalValues:[],targetValues:[]};jQuery.each(s,function(i,o){if(o.actual){S.actualValues.push(b[o.actual]);}if(o.projected){S.additionalValues.push(b[o.projected]);}if(o.reference){S.targetValues.push(b[o.reference]);}});Object.keys(S).forEach(function(k){S[k]=t(S[k]);});delete m["@semanticBulletMsrs"];jQuery.extend(m,S);},semanticPatternMsrs:function(f,e){var A=[],g=[];Object.keys(f.msrs).forEach(function(k){var s=[];var m=f.msrs[k];var h=m.reduce(function(h,a){h[a.getName()]=a;return h;},{});var S=M.getTuples(m);var j=S.filter(function(n){return n.actual&&!n.projected&&!n.reference;}).length!==m.length;if(f.dims.color&&f.dims.color.length>0){jQuery.sap.log.warning("If Chart has series dimensions, semantic pattern rule doesn't work.");}else if(j){if(e&&d(e)){S.forEach(function(v){v.valueAxisID=k;});}A=A.concat(S);if(c(e)){if(f.dims.timeAxis&&f.dims.timeAxis.length===1){var l=f.dims.timeAxis[0];var n;var p=l.getProjectedValueStartTime();if(p){var o,q=D.getInstance(l.getTimeUnit());if(q){if(q.parse(p)){o=q.parse(p).getTime();}}else{o=new Date(p).getTime();}if(o){if(e.indexOf('bullet')===-1){for(var i=0;i<S.length;i++){n=S[i];if(n.actual&&n.projected){n.timeAxis=f.dims.timeAxis[0].getName();n.projectedValueStartTime=o;n.semanticMsrName=n.actual+"-"+n.projected;s.push(n.actual);s.push(n.projected);m.push(h[n.actual].clone().setName(n.semanticMsrName));}}}f.msrs[k]=m.filter(function(a){return s.indexOf(a.getName())===-1;});g=g.concat(m.filter(function(a){return s.indexOf(a.getName())>-1;}));}}}}var r=[];var u=['actual','projected','semanticMsrName','reference'];S.forEach(function(a){for(var i=0;i<u.length;i++){if(a[u[i]]){r.push(a[u[i]]);}}});f.msrs[k].sort(function(a,b){return r.indexOf(a.getName())-r.indexOf(b.getName());});}});return{semanticTuples:A,contexts:g};}};return R;});};if(!jQuery.sap.isDeclared('sap.chart.utils.RoleFitter')){jQuery.sap.declare('sap.chart.utils.RoleFitter');jQuery.sap.require('sap.viz.ui5.data.DimensionDefinition');jQuery.sap.require('sap.viz.ui5.data.MeasureDefinition');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.FeedItem');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.AnalysisObject');sap.ui.define("sap/chart/utils/RoleFitter",['sap/viz/ui5/data/DimensionDefinition','sap/viz/ui5/data/MeasureDefinition','sap/viz/ui5/controls/common/feeds/FeedItem','sap/viz/ui5/controls/common/feeds/AnalysisObject','sap/chart/TimeUnitType','sap/chart/utils/DateFormatUtil','sap/chart/utils/ChartUtils','sap/chart/utils/RoleMapper'],function(D,M,F,A,T,a,C,R){"use strict";var s=function(){return sap.viz.vizservices.BVRService.suggestFeeds.apply(null,arguments);};var b=function(f,i){var r=sap.viz.vizservices.FeedService.validate(f,i);if(!r.valid){var k=r.results?r.results.bindings:null;if(k&&Object.keys(k).every(function(m){return k[m].allowMND&&(!k[m].missing||k[m].missing===1)&&!k[m].incorrect;})){return{valid:true};}}return r;};var _=[{"types":"*","toViz":{"category|category2":"categoryAxis","series":"color","axis1|axis2|axis3|axis4":"valueAxis"}},{"types":"column|bar|stacked_bar|stacked_column|line|combination|100_stacked_bar|100_stacked_column|stacked_combination|horizontal_stacked_combination","toViz":{}},{"types":"scatter|bubble|time_bubble|timeseries_scatter|timeseries_bubble","toViz":{"category|category2":"@context","axis1":"valueAxis","axis2":"valueAxis2"}},{"types":"bubble|time_bubble","toViz":{"axis3":"bubbleWidth"}},{"types":"pie|donut","toViz":{"category|series|category2":"color","axis1|axis2|axis3|axis4":"size"}},{"types":"bullet|vertical_bullet","toViz":{"axis1|axis2|axis3|axis4":"@semanticBulletMsrs"}},{"types":"dual_combination|dual_horizontal_combination|dual_stacked_bar|100_dual_stacked_bar|dual_stacked_column|100_dual_stacked_column|dual_bar|dual_column|dual_line|dual_stacked_combination|dual_horizontal_stacked_combination","toViz":{"axis1":"valueAxis","axis2|axis3|axis4":"valueAxis2"}},{"types":"timeseries_line|timeseries_column|timeseries_combination|timeseries_stacked_column|timeseries_100_stacked_column","toViz":{"category":"timeAxis"}},{"types":"timeseries_scatter","toViz":{"category":R,"axis2|axis3":false}},{"types":"timeseries_bubble","toViz":{"category":R,"axis2":false,"axis3":"bubbleWidth"}},{"types":"dual_timeseries_combination","toViz":{"category":"timeAxis","axis1":"valueAxis","axis2|axis3|axis4":"valueAxis2"}},{"types":"heatmap","toViz":{"category":"categoryAxis","category2|series":"categoryAxis2","axis1|axis2|axis3|axis4":"color"}},{"types":"waterfall|horizontal_waterfall","toViz":{"series":"waterfallType"}},{"types":"timeseries_bullet","toViz":{"category|series":"timeAxis","axis1|axis2|axis3|axis4":"@semanticBulletMsrs"}},{"types":"timeseries_waterfall","toViz":{"category|series":"timeAxis"}}].reduce(function(m,f){var i=Object.keys(f.toViz).reduce(function(i,k){k.split("|").forEach(function(r){i[r]=f.toViz[k];return i;});return i;},{});f.types.split("|").forEach(function(k){if(!m.hasOwnProperty(k)){m[k]=[];}m[k].push(i);});return m;},{});var c=Object.keys(_).reduce(function(m,f){if(f!=="*"){m[f]=jQuery.extend.apply(null,[true,{}].concat(_["*"].concat(_[f])));}return m;},{});function d(f,k,v){var i=(typeof k==="function")?k:function(o){return o[k];};return f.reduce(function(o,m){var n=i(m),r=(typeof v==="function")?v(m):m;if(n&&!o[n]){o[n]=[r];}else if(n){o[n].push(r);}return o;},{});}function e(m,f){var o={},r;f.forEach(function(v){var i=v.getRole();if(m.hasOwnProperty(i)){var k=m[i];if(k){if(typeof k==="function"){if(!r){r=new k();}k=r.toFeedingId(v);}if(!o[k]){o[k]=[];}o[k].push(v);}}});return o;}var L={from:F.fromLightWeightFmt,build:function(o){var f=[];jQuery.each(o.dims,function(k,v){f.push({id:k,type:"Dimension",values:v.map(g("Dimension"))});});jQuery.each(o.msrs,function(k,v){f.push({id:k,type:"Measure",values:v.map(g("Measure"))});});return f;}};function g(f){return function(o){var i=o.getName();if(i==="MND"){return{id:"MND",type:"MND"};}var k={id:i,name:i,type:f};if(o instanceof sap.chart.data.TimeDimension){k.dataType="Date";}return k;};}function w(o,l){var n=o.getName(),f=o.getLabel(),i=o.getTextProperty(),k=o.getTextFormatter(),m=o.getDisplayText();var r={identity:n,name:f||n,value:"{"+n+"}"};if(typeof k==="function"){r.displayValue={formatter:k,parts:[{path:n,type:new sap.ui.model.type.String()}]};if(i){r.displayValue.parts.push({path:i,type:new sap.ui.model.type.String()});}}else if(m&&i){r.displayValue="{"+i+"}";}var v=new D(r);if(l&&o instanceof sap.chart.data.TimeDimension){var H=a.getInstance(o.getTimeUnit());if(H){var P=H.parse.bind(H);v.getBindingInfo("value").formatter=function(V){return P(V);};}v.setDataType("Date");v._setTimeUnit(o.getTimeUnit());}return v;}function h(m){var n=m.getName();var o=new M({identity:n,name:m.getLabel()||n,value:"{"+n+"}"});o._setUnitBinding(m.getUnitBinding());return o;}function j(f,i){var m=sap.viz.api.metadata.Viz.get("info/"+f),k=d(m.bindings,"role"),n=d(i,"id"),o=k["layout.category"]||[],S=k["mark.color"]||[];if(o.length===0){return[];}else{var O=[];jQuery.each(o.concat(S),function(r,v){var H=n[v.id];if(H&&H.length>0){jQuery.each(H[0].values,function(J,V){O.push(V.id);});}});return O;}}function l(f){return C.CONFIG.timeChartTypes.indexOf(f)>-1;}function p(f,i,m,k){var r=c[f];var o={dims:e(r,i),msrs:e(r,m)};var n=null,S=null;if(o.dims["@context"]){n=o.dims["@context"];delete o.dims["@context"];}if(o.msrs["@semanticBulletMsrs"]){R.semantics.semanticBulletMsrs(o.msrs,l(f));}if(C.CONFIG.nonSemanticPatternChartType.indexOf(f)===-1&&k){S=R.semantics.semanticPatternMsrs(o,f);n=(n||[]).concat(S.contexts);}else{if(k){jQuery.sap.log.warning('Analytical Chart',f+" doesn't support semantic pattern feature.");}else{jQuery.sap.log.warning('DataPointStyle or seriesStyle have been set.');}}var v=L.build(o);v.contexts=n;if(S){v.semanticTuples=S.semanticTuples;}return v;}var I=[{chartTypes:"bar,column,line,combination,heatmap,bullet,vertical_bullet,stacked_bar,stacked_column,stacked_combination,horizontal_stacked_combination,dual_bar,dual_column,dual_line,dual_stacked_bar,dual_stacked_column,dual_combination,dual_horizontal_combination,dual_stacked_combination,dual_horizontal_stacked_combination,100_stacked_bar,100_stacked_column,100_dual_stacked_bar,100_dual_stacked_column,waterfall,horizontal_waterfall".split(","),feed:"categoryAxis"},{chartTypes:"donut,pie,scatter,bubble".split(","),feed:"color"}];function q(f,k,m){var i,n;for(i=0;i<I.length;i++){if(I[i].chartTypes.indexOf(f)!==-1){n=I[i].feed;break;}}var H=k.some(function(r){return r.id===n;});if(!H){var o=s("info/"+f,k,[{id:"MND",type:"MND"}]).feedItems;k.splice(0,k.length);o.forEach(function(r){if(r.values.length>0){k.push(r);}});k=z(f,k);}for(i=0;i<k.length;i++){if(k[i].id===n&&k[i].type==="Dimension"){k[i].values=k[i].values.concat(m.map(function(r){return{id:r.getName(),name:r.getName(),type:"Dimension",inResult:true};}));}}return b("info/"+f,k);}function t(f){f.forEach(function(o){o._sFixedRole=o.getRole();});}function u(f,i,k){i.forEach(function(o){o.values.forEach(function(m){var n=k.filter(function(n){return n.getName()===m.id;})[0];if(n){jQuery.each(c[f],function(r,v){if(v===o.id){n._sFixedRole=r;return false;}});}});});}function x(k,m,n,r,H){var J=p(k,m,n,H),K=J.contexts,N=J.semanticTuples,O=[];if(N){O=N.filter(function(f){return f.projectedValueStartTime;});}var V=b("info/"+k,J);var P=m.concat(n).concat(r);t(P);if(!V.valid){J=B(k,V,J,m,n);V=b("info/"+k,J);u(k,J,P);}if(V.valid&&r&&r.length>0){var Q=d(m,function(o){return o.getName();});q(k,J,r.filter(function(o){return!Q[o.getName()];}));}var S=J.reduce(function(i,f){f.values.forEach(function(v){i[v.id]=true;});return i;},{});var U=L.from(J);if(K){K.forEach(function(f){S[f.getName()]=true;});U._context=K.map(function(f){var o=f.getName();var v=true;for(var i=0;i<O.length;i++){if(o===O[i].actual||o===O[i].projected){v=false;break;}}return{id:o,showInTooltip:v};});}U._unused=E(J,m,n).filter(function(f){return!S[f];});U._def=G(m,V.valid?r:[],n,S,N,l(k));U._order=j(k,J);U._valid=V.valid;U._semanticTuples=N;return U;}function y(f){return d(sap.viz.api.metadata.Viz.get("info/"+f).bindings,"id");}function z(f,i,m){m=m||y(f);i.forEach(function(o){o.type=m[o.id][0].type;});return i;}function B(f,V,i,m,n){var o=y(f),r=false,H=false;var J=V.results.bindings;Object.keys(J).forEach(function(k){if(!o[k]){return;}if(o[k][0].type==="Measure"){H=true;}if(o[k][0].type==="Dimension"&&!(J[k].allowMND&&(!J[k].missing||J[k].missing===1))){r=true;}});var K=i.filter(function(k){return!((k.type==="Dimension")?r:H);}),N=K.reduce(function(k,Q){(Q.values||[]).forEach(function(v){k[v.id]=true;});return k;},{});if(i.contexts){i.contexts.forEach(function(k){N[k.getName()]=true;});}var O=m.map(g("Dimension")),P=n.map(g("Measure"));var S=s("info/"+f,K,O.concat(P).filter(function(k){return!N[k.id];})).feedItems;z(f,S,o);return S;}function E(i,k,m){var U=i.reduce(function(n,f){f.values.forEach(function(v){n[v.id]=true;});return n;},{});return k.concat(m).filter(function(n){return!U[n.getName()];}).map(function(n){return n.getName();});}function G(f,k,m,v,S,l){var o;if(l){var n;for(var i=0;i<f.length;i++){if(f[i]instanceof sap.chart.data.TimeDimension){n=f[i];break;}}o=a.getInstance(n.getTimeUnit());}return{dim:f.reduce(function(V,r){if(v[r.getName()]){V.push(w(r,l));}return V;},[]).concat(k.map(function(r){var H=w(r);H._setInResult(true);return H;})),msr:m.reduce(function(V,r){if(v[r.getName()]){V.push(h(r));}return V;},[]).concat((S||[]).reduce(function(r,H){if(H.timeAxis&&H.projectedValueStartTime){r.push(new M({identity:H.actual+"-"+H.projected,name:((H.labels&&H.labels.actual)||H.actual)+"-"+((H.labels&&H.labels.projected)||H.projected),value:{parts:[H.timeAxis,H.actual,H.projected],formatter:function(J){var K=J,N;if(J&&J.length>1){var O=J[0];if(O){if(o){var P=o.parse(O);if(P){N=P.getTime();}}else{N=new Date(O).getTime();}if(N&&(N<H.projectedValueStartTime)){K=J[1];}else{K=J[2];}}}return K;}}}));}return r;},[]))};}return{fit:x,compatible:function(f,i,m){var n="info/"+f,r={used:{},error:null,compatible:true};var H=p(f,i,m),V=b(n,H);if(!V.valid){H=B(f,V,H,i,m);V=b(n,H);r.needFix=true;}if(V.valid){r.used=d(H,function(o){return o.type;},function(o){return o.values.filter(function(v){return v.type==="Dimension"||v.type==="Measure";}).map(function(v){return v.id;});});jQuery.each(r.used,function(k,v){r.used[k]=v.reduce(function(o,O){return o.concat(O);},[]);});}else{r.compatible=false;var J=sap.viz.api.metadata.Viz.get(n).bindings,K=d(J,"type",function(o){return o.id;}),N={dim:0,msr:0,time:0};jQuery.each(V.results.bindings,function(k,v){if(!v.missing){return;}if(K.Dimension.indexOf(k)!==-1&&!(v.allowMND&&v.missing===1)){N[k==="timeAxis"?"time":"dim"]+=v.missing;}else if(K.Measure.indexOf(k)!==-1){N.msr+=v.missing;}});r.error={missing:N};}return r;}};});};if(!jQuery.sap.isDeclared('sap.chart.library')){jQuery.sap.declare('sap.chart.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.viz.ui5.format.ChartFormatter');jQuery.sap.require('sap.ui.core.library');jQuery.sap.require('sap.viz.library');sap.ui.define("sap/chart/library",['jquery.sap.global','sap/viz/ui5/format/ChartFormatter','sap/ui/core/library','sap/viz/library','sap/chart/utils/RoleFitter','sap/chart/ChartType'],function(q,C,c,v,R,a){"use strict";sap.ui.getCore().initLibrary({name:"sap.chart",dependencies:["sap.ui.core","sap.viz"],types:["sap.chart.data.MeasureSemantics"],interfaces:[],controls:["sap.chart.Chart"],elements:["sap.chart.data.Dimension","sap.chart.data.TimeDimension","sap.chart.data.Measure"],noLibraryCSS:true,version:"1.46.11"});sap.chart.SelectionMode={Multi:"MULTIPLE",Single:"SINGLE",None:"NONE"};sap.chart.SelectionBehavior={DataPoint:"DATAPOINT",Category:"CATEGORY",Series:"SERIES"};sap.chart.MessageId={NoData:"NO_DATA",MultipleUnits:"MULTIPLE_UNITS"};sap.chart.api={};sap.chart.api.getChartTypes=function(){var p=q.sap.getModulePath("sap.chart");var B=q.sap.resources({url:p+"/i18n/i18n.properties"});return Object.keys(sap.chart.ChartType).reduce(function(m,s){var f=sap.chart.ChartType[s];m[f]=B.getText("info/"+f);return m;},{});};sap.chart.data=sap.chart.data||{};sap.chart.data.MeasureSemantics={Actual:"actual",Reference:"reference",Projected:"projected"};sap.chart.coloring=sap.chart.coloring||{};sap.chart.ColoringType={Criticality:"Criticality",Emphasis:"Emphasis"};sap.chart.coloring.CriticalityType={Negative:"Negative",Critical:"Critical",Positive:"Positive",Neutral:"Neutral"};sap.chart.coloring.ImprovementDirectionType={Minimize:"Minimize",Target:"Target",Maximize:"Maximize"};sap.chart.api.getChartTypeLayout=function(s,D,m){var f,M;if(!s){throw new Error("Invalid chart type: "+String(s));}if(D){f=D.map(function(g,i){if(g&&g.name){return{getName:function(){return g.name;},getRole:function(){return g.role||"category";}};}else{throw new Error("Invalid Dimension at ["+i+"]: "+String(g)+". Dimension should be an object of the format{name:'name'}.");}});}else{f=[];}if(m){M=m.map(function(g,i){if(g&&g.name){return{getName:function(){return g.name;},getRole:function(){return g.role||"axis1";}};}else{throw new Error("Invalid Measure at ["+i+"]: "+String(g)+". Measure should be an object of the format{name:'name'}.");}});}else{M=[];}var o=R.compatible(s,f,M);return{dimensions:o.used.Dimension||[],measures:o.used.Measure||[],errors:Object.keys(o.error||{}).reduce(function(E,g){return E.concat({cause:g,detail:o.error[g]});},[])};};var F="__UI5__ShortIntegerMaxFraction10";var b="__UI5__FloatMaxFraction2";var d="__UI5__ShortIntegerMaxFraction2";var e=C.getInstance();e.registerCustomFormatter(F,function(f){var g=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short",maxFractionDigits:10});return g.format(f);});e.registerCustomFormatter(b,function(f){var g=sap.ui.core.format.NumberFormat.getFloatInstance({style:'Standard',maxFractionDigits:2});return g.format(f);});e.registerCustomFormatter(d,function(f){var g=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short",maxFractionDigits:2});return g.format(f);});this._oChartForamtter=e;if(!(sap.viz.api.env.Format.numericFormatter()instanceof C)){sap.viz.api.env.Format.numericFormatter(e);}return sap.chart;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.criticality.DimensionValues')){jQuery.sap.declare('sap.chart.coloring.criticality.DimensionValues');sap.ui.define("sap/chart/coloring/criticality/DimensionValues",['sap/chart/coloring/ColoringUtils','sap/chart/ChartLog','sap/chart/library','sap/chart/data/TimeDimension'],function(C,a,c,T){"use strict";var t=jQuery.type;var b=c.coloring.CriticalityType;var D={};var v=function(m,M,d,i,s,o){var r=m._getFixedRole();var e='Colorings.'+s+'.DimensionValues';if(m instanceof T&&m._getFixedRole()==="category"){throw new a('error',e,'Do not support '+s+' on timeAxis');}if(i.length){throw new a('error',e,'InResult dimension is not allowed in dimension based Criticality');}var S=d.filter(function(g){return g._getFixedRole()==="series";});var f=d.filter(function(g){return g._getFixedRole()==="category";});if(r==="category"&&!o.bIsPie){if(o.chartType!=="waterfall"){if(S.length>0||M.length>1){throw new a('error',e,'Existing color legend shall not be changed in Criticality');}}}else if(r==="series"||o.bIsPie){var V=false;switch(o.chartType){case"bubble":if(S.length===1){V=true;}break;case"waterfall":V=true;break;case"pie":case"donut":var A=S.concat(f);if(M.length===1&&A.length===1){V=true;}break;default:if(M.length===1||(M.length>1&&f.length===0)){if(S.length===0||(s==="Criticality"&&S.length===1&&S[0]===m)){V=true;}}}if(!V){throw new a('error',e,'Existing color legend shall not be changed in Criticality');}}return;};D.qualify=function(o,m,d,i,A,s,e){var f,g;s=s||"Criticality";var h='Colorings.'+s+'.DimensionValues';if(e.bMBC){throw new a('error','Colorings','Heatmap only support Criticality.MeasureValues.ConstantThresholds');}if(!A.parameters||!A.parameters.dimension){if(o){var k=Object.keys(o);if(k.length>1){throw new a('error',h,'Multiple dimensions are defined, please resolve by activeColoring property');}else if(k.length===1){f=k[0];}else{return null;}}}else{f=A.parameters.dimension;}if(f){var M=C.find(f,d);if(!M||!o[f]){throw new a('error',h,'Active dimension should be visible');}else{g={dim:f,setting:o};v(M,m,d,i,s,e);}}return g;};D.parse=function(o,d,s,l,e){var S={};var L={};var f=o.dim;var g=[];var r=C.find(f,d)._getFixedRole();var h=o.setting[f];jQuery.each(h,function(k,p){var q=(t(p)!=="array")?[p]:p;q.forEach(function(u){var V=(t(u.Values)!=="array")?[u.Values]:u.Values;if(V.length>1){if(!u.Legend){throw new a('error','Colorings.Criticality.DimensionValues','Legend is mandatory when one criticality type has multiple values');}else if(r==="series"||e.bIsPie){throw new a('error','Colorings.Criticality.DimensionValues','Existing color legend shall not be changed in Criticality');}}});});jQuery.each(h,function(k,p){var q=(t(p)!=="array")?[p]:p;if(k!==b.Neutral){S[k]=q.map(function(u){return(t(u.Values)==="array")?u.Values:[u.Values];});g=Array.prototype.concat.apply(g,S[k]);}L[k]=q.map(function(u){var V=(t(u.Values)==="array")?u.Values[0]:u.Values;var w=(u.Legend!=null)?u.Legend:V;return w;});});var n=function(k){return g.indexOf(k[f])===-1;};var N=[];if(h.Neutral){N=(t(h.Neutral.Values)==="array")?h.Neutral.Values:[h.Neutral.Values];}var i={callback:[n],NeutralValues:N,CriticalityValues:g};function j(V){return function(k){return V.indexOf(k[f])!==-1;};}var m={Negative:(S.Negative||[]).map(j),Critical:(S.Critical||[]).map(j),Positive:(S.Positive||[]).map(j)};return{callbacks:m,legend:L,NeutralInfo:i,status:s};};D.getContextHandler=function(o,l){var d=o.dim;var n=o.parsed.NeutralInfo;return function(e){var V=e.getProperty(d);var s=o.parsed.status;var f=this.getDimensionByName(d);if(n.CriticalityValues.indexOf(V)===-1){if(!s.singleOtherValue){s.singleOtherValue=V;}else if(s.singleOtherValue!==V&&f._getFixedRole()==="series"){var g=new a('error','Colorings.Criticality.DimensionValues','Existing color legend shall not be changed in Criticality');o.chartLog=g;}o.parsed.callbacks.Neutral=n.callback;if(n.NeutralValues.indexOf(V)===-1){o.parsed.legend.Neutral=l.getText("COLORING_TYPE_OTHER");}}};};return D;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.criticality.measureValues.ThresholdsUtils')){jQuery.sap.declare('sap.chart.coloring.criticality.measureValues.ThresholdsUtils');sap.ui.define("sap/chart/coloring/criticality/measureValues/ThresholdsUtils",['sap/chart/coloring/ColoringUtils','sap/chart/library'],function(C,c){"use strict";var T={};var M={formulas:{}};var N=c.coloring.CriticalityType.Negative;var a=c.coloring.CriticalityType.Critical;var P=c.coloring.CriticalityType.Positive;function g(u,s,l){return{upperBound:u,CriticalityType:s,level:l};}T.MBCimprovement=function(d,t,D){var s=[];var b,e;switch(d){case'maximize':b=[D.lo,t.lo,Number.POSITIVE_INFINITY];e=[N,a,P];break;case'minimize':b=[t.hi,D.hi,Number.POSITIVE_INFINITY];e=[P,a,N];break;case'target':b=[D.lo,t.lo,t.hi,D.hi,Number.POSITIVE_INFINITY];e=[N,a,P,a,N];break;default:}s=e.map(function(f,i){return g(b[i],f,0);});return{segments:s,min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};};T.improvement=function(d,m,t,D,b){var e=C.thresholdValue(D.lo);var f=C.thresholdValue(t.lo);var h=C.thresholdValue(D.hi);var i=C.thresholdValue(t.hi);var n=C.assertLevel(b,'NegativeLevels');var j=C.assertLevel(b,'CriticalLevels');var k=C.assertLevel(b,'PositiveLevels');var l=C.thresholdValue(b.MinimumMeasureValue);var o=C.thresholdValue(b.MaximumMeasureValue);switch(d){case'maximize':return{Negative:C.genLevels(n,M.formulas.maximize.negative(m,n,l,e)),Critical:C.genLevels(j,M.formulas.maximize.critical(m,j,e,f)),Positive:C.genLevels(k,M.formulas.maximize.positive(m,k,f,o))};case'minimize':return{Negative:C.genLevels(n,M.formulas.minimize.negative(m,n,h,o)),Critical:C.genLevels(j,M.formulas.minimize.critical(m,j,i,h)),Positive:C.genLevels(k,M.formulas.minimize.positive(m,k,l,i))};case'target':return{Negative:C.genLevels(n,M.formulas.target.negative(m,n,e,h,l,o)),Critical:C.genLevels(j,M.formulas.target.critical(m,j,e,f,i,h)),Positive:C.genLevels(k,M.formulas.target.positive(m,k,f,i))};default:throw new Error('Unsupported ImprovementDirection: '+d);}};M.formulas.maximize={negative:function(m,n,f,d){return function(o){var b=o[m];var e=f(o);var h=d(o);if(!C.isInRange(b,Number.NEGATIVE_INFINITY,h,null,false)){return-1;}else if(!C.isNumber(n,e)||n<=1){return 1;}else if(b<e){return n;}else{return(n-1)-Math.floor((n-1)*(b-e)/(h-e));}};},critical:function(m,n,d,t){return function(o){var b=o[m];var e=d(o);var f=t(o);if(!C.isInRange(b,e,f,true,false)){return-1;}else if(!C.isNumber(n)||n<=1){return 1;}else{return n-Math.floor(n*(b-e)/(f-e));}};},positive:function(m,n,t,f){return function(o){var b=o[m];var d=f(o);var e=t(o);if(!C.isInRange(b,e,Number.POSITIVE_INFINITY,true)){return-1;}else if(!C.isNumber(n,d)||n<=1){return 1;}else if(b>=d){return n;}else{return Math.floor((n-1)*(b-e)/(d-e))+1;}};}};M.formulas.minimize={negative:function(m,n,d,f){return function(o){var b=o[m];var e=f(o);var h=d(o);if(!C.isInRange(b,h,Number.POSITIVE_INFINITY,false)){return-1;}else if(!C.isNumber(n,e)||n<=1){return 1;}else if(b>e){return n;}else{return Math.floor((n-1)*(b-h)/(e-h))+1;}};},critical:function(m,n,t,d){return function(o){var b=o[m];var e=t(o);var f=d(o);if(!C.isInRange(b,e,f,false,true)){return-1;}else if(!C.isNumber(n)||n<=1){return 1;}else{return Math.floor(n*(b-e)/(f-e))+1;}};},positive:function(m,n,f,t){return function(o){var b=o[m];var d=f(o);var e=t(o);if(!C.isInRange(b,Number.NEGATIVE_INFINITY,e,null,true)){return-1;}else if(!C.isNumber(n,d)||n<=1){return 1;}else if(b<d){return n;}else{return(n-1)-Math.floor((n-1)*(b-d)/(e-d));}};}};M.formulas.target={negative:function(m,n,d,D,f,b){return function(o){var e=o[m];var h=d(o);var i=D(o);var j=f(o);var k=b(o);var l=C.isInRange(e,Number.NEGATIVE_INFINITY,h,null,false);var p=C.isInRange(e,i,Number.POSITIVE_INFINITY,false);if(!l&&!p){return-1;}else if(!C.isNumber(n)||n<=1){return 1;}else if(l){if(e<j){return n;}else{return n-(Math.floor((e-j)/((h-j)/(n-1)))+1);}}else{if(e>=k){return n;}else{return n-(Math.floor((k-e)/((k-i)/(n-1)))+1);}}};},critical:function(m,n,d,t,f,D){return function(o){var b=o[m];var e=d(o),h=t(o);var i=f(o),j=D(o);var k=C.isInRange(b,e,h,true,false);var l=C.isInRange(b,i,j,false,true);if(!k&&!l){return-1;}else if(!C.isNumber(n)||n<=1){return 1;}else if(k){return n-Math.floor((b-e)/((h-e)/n));}else{return Math.floor((j-b)/((j-i)/n))+1;}};},positive:function(m,n,t,f){return function(o){var b=o[m];var d=t(o);var e=f(o);if(!C.isInRange(b,d,e,true,true)){return-1;}else if(!C.isNumber(n)||n<=1){return 1;}else{return Math.min(n,n+1-Math.ceil(Math.abs(b-(d+(e-d)/2))/((e-d)/(2*n))));}};}};return T;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.emphasis.DimensionValues')){jQuery.sap.declare('sap.chart.coloring.emphasis.DimensionValues');sap.ui.define("sap/chart/coloring/emphasis/DimensionValues",['sap/chart/coloring/ColoringUtils','sap/chart/coloring/criticality/DimensionValues','sap/chart/ChartLog'],function(C,D,a){"use strict";var t=jQuery.type;var b={};b.qualify=function(c,m,d,i,A,o){return D.qualify(c,m,d,i,A,"Emphasis",o);};b.parse=function(c,l){var L={};var d=c.dim;var o=c.setting[d];var v=o.Values;var h=(t(v)==="array")?v:[v];var H=function(e){return h.indexOf(e[d])>-1;};if(h.length>1&&!(o.Legend&&o.Legend.Highlighted)){throw new a('error','Colorings.Emphasis.DimensionValues','Legend.Highlighted is mandatory when Highlight has multiple values');}else{if(o.Legend&&o.Legend.Highlighted!=null){L.Highlight=o.Legend.Highlighted;}else{L.Highlight=h[0];}}if(o.Legend&&o.Legend.Others){L.Others=o.Legend.Others;}else{L.Others=l.getText("COLORING_TYPE_OTHER");}var m={Highlight:H};return{callbacks:m,legend:L};};return b;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.emphasis.Emphasis')){jQuery.sap.declare('sap.chart.coloring.emphasis.Emphasis');sap.ui.define("sap/chart/coloring/emphasis/Emphasis",['sap/chart/coloring/emphasis/DimensionValues','sap/chart/coloring/ColorPalette','sap/chart/ChartLog'],function(D,C,a){"use strict";var S=['DimensionValues','MeasureValues'];function u(o,A){var p=A?A.parameters:{};var t=Object.keys(o).filter(function(T){return!S.indexOf(T)!==-1;});if(p&&p.dimension&&p.measure){throw new a('error','colorings.Emphasis','Both "DimensionValues" and "MeasureValues" present in coloring EMPHASIS, activeColoring.parameters is required to specify which to use');}else if(p&&p.dimension){return'DimensionValues';}else if(p&&p.measure){return'MeasureValues';}else if(t.length===1){return t[0];}else{return null;}}function c(b,l){var o=b[0];var d=o.parsed.callbacks.Highlight||[];var L=o.parsed.legend;var r=[];r.push({callback:d,properties:{color:C.EMPHASIS.Highlight},displayName:L.Highlight});var O={properties:{color:C.EMPHASIS.Others},displayName:L.Others};return{rules:r,others:O};}function g(b,l){return function(){var p={plotArea:{dataPointStyle:c(b)}};return{properties:p};};}return{getCandidateSetting:function(o,A,m,d,i,s,b,l){var e=o.Emphasis||{};var U=u(e,A);var q;switch(U){case'DimensionValues':q=D.qualify(e.DimensionValues,m,d,i,A,b);if(q){q.parsed=D.parse(q,l);q.ruleGenerator=g([q]);}break;default:return{};}return q;}};});};if(!jQuery.sap.isDeclared('sap.chart.data.Measure')){jQuery.sap.declare('sap.chart.data.Measure');jQuery.sap.require('sap.ui.core.Element');sap.ui.define("sap/chart/data/Measure",["sap/ui/core/Element","sap/chart/utils/ChartUtils","sap/chart/library"],function(E,C,l){"use strict";var _={axis1:true,axis2:true,axis3:true,axis4:true};var M=l.data.MeasureSemantics;var a=E.extend("sap.chart.data.Measure",{metadata:{library:"sap.chart",properties:{name:{type:"string"},label:{type:"string"},unitBinding:{type:"string"},valueFormat:{type:"string",defaultValue:null},role:{type:"string",defaultValue:"axis1"},semantics:{type:"sap.chart.data.MeasureSemantics",defaultValue:M.Actual},semanticallyRelatedMeasures:{type:"object",defaultValue:null}}}});a.prototype.setLabel=C.makeNotifyParentProperty("label");var r=C.makeNotifyParentProperty("role");a.prototype.setRole=function(v,s){if(!_[v]){jQuery.error("Invalide Measure role: "+v);}return r.apply(this,arguments);};a.prototype.setUnitBinding=C.makeNotifyParentProperty("unitBinding");a.prototype.setValueFormat=C.makeNotifyParentProperty("valueFormat");a.prototype.setSemantics=C.makeNotifyParentProperty("semantics");a.prototype.setSemanticallyRelatedMeasures=C.makeNotifyParentProperty("semanticallyRelatedMeasures");a.prototype._getFixedRole=function(){return this._sFixedRole||this.getRole();};return a;});};if(!jQuery.sap.isDeclared('sap.chart.utils.DataSourceUtils')){jQuery.sap.declare('sap.chart.utils.DataSourceUtils');sap.ui.define("sap/chart/utils/DataSourceUtils",['sap/chart/data/Dimension','sap/chart/data/TimeDimension','sap/chart/data/Measure','sap/chart/TimeUnitType'],function(D,T,M,a){"use strict";function g(i,B){var p=B.path;var n=(B.parameters||{}).entitySet;if(!n){n=p.split("/")[1];if(n.indexOf("(")!=-1){n=n.split("(")[0]+(i?"Results":"Set");}}return n;}function _(r,s,t){return"{/#"+r+"/"+s+"/@sap:"+t+"}";}function d(p,C){var f=D;if(p.type==="Edm.DateTime"&&p['sap:display-format']==="Date"){f=T;C.timeUnit=a.Date;}else if(p.type==="Edm.String"&&a[p['sap:semantics']]){f=T;C.timeUnit=p['sap:semantics'];}return f;}var b={getEntitySet:g.bind(null,true),deriveColumns:function(m,B){var r=m.getAnalyticalExtensions().findQueryResultByName(b.getEntitySet(B));if(!r){throw new Error("value of the \"isAnalytical\" property does not match the Data Service in use");}var R=r.getEntityType().getQName();R=R.slice(R.lastIndexOf(".")+1);var s=r.getEntityType().getSchema().namespace;var f=b.makeDimension.bind(this,R,s,r);var h=b.makeMeasure.bind(this,R);return{dimensions:jQuery.map(r.getAllDimensions(),f),measures:jQuery.map(r.getAllMeasures(),h)};},makeDimension:function(r,R,o,f){var s=f.getName();var C={name:s,label:_(r,s,"label"),textProperty:_(r,s,"text")};var A=b.ANNOTATION_ACCESS_TEMPLATE.replace(/%SCHEMANS/,R).replace(/%RESULTTYPE/,r).replace(/%DIMENSION/,s);var u=o.getModel().getODataModel().getMetaModel().getProperty(A);var h=d(u,C);return new h(C);},makeMeasure:function(r,m){return new M({name:m.getName(),label:_(r,m.getName(),"label")});},updateModel:function(C){function f(n,p,q){var t=n.getTextProperty(),j=[{name:n.getName(),grouped:false,inResult:!!p,visible:!q}];if(n.getDisplayText()&&t){j.push({name:t,grouped:false,inResult:!!p,visible:!q});}return j;}function h(n){var u=n.getUnitBinding(),j=[{name:n.getName(),total:false,inResult:false,visible:true}];if(u){j.push({name:u,total:false,inResult:false,visible:true});}return j;}var B=C.getBinding("data");if(!B){return;}var i=C._getVisibleDimensions(true);var m=C._getVisibleMeasures(true);var I=C._normalizeDorM(C.getInResultDimensions(),true);var j=i.reduce(function(j,n){return j.concat(f(n));},[]).concat(I.reduce(function(j,n){return j.concat(f(n,true,true));},[])).concat(m.reduce(function(j,n){return j.concat(h(n));},[]));var o=C._getCandidateColoringSetting();var k=o.additionalMeasures||[];var l=o.additionalDimensions||[];if(k.length){j=j.concat(C._normalizeDorM(k).reduce(function(n,p){return n.concat(h(p));},[]));}if(l.length){j=j.concat(C._normalizeDorM(l,true).reduce(function(n,p){return n.concat(f(p));},[]));}B.updateAnalyticalInfo(j);},ANNOTATION_ACCESS_TEMPLATE:"/dataServices/schema/[${"+"namespace"+"}==='%SCHEMANS']/entityType/[${"+"name"+"}==='%RESULTTYPE']/property/[${"+"name"+"}==='%DIMENSION']/"};var c={getEntitySet:g.bind(null,false),deriveColumns:function(m,B){var o=m.getMetaModel(),C={dimensions:[],measures:[]};if(o){var q=o.getODataEntitySet(c.getEntitySet(B)).entityType;var E=o.getODataEntityType(q);jQuery.each(E.property,function(i,p){var f=c.CLAZZ[p.type];if(!f){throw new Error("Unsupported type: "+p.type);}var h={name:p.name};if(p.hasOwnProperty("sap:label")){h.label=p["sap:label"];}if(f===M){C.measures.push(new f(h));}else{if(p.hasOwnProperty("sap:text")){h.textProperty=p["sap:text"];}f=d(p,h);C.dimensions.push(new f(h));}});}return C;},CLAZZ:{"Null":D,"Edm.Binary":D,"Edm.Boolean":D,"Edm.Byte":M,"Edm.DateTime":D,"Edm.Decimal":M,"Edm.Double":M,"Edm.Single":M,"Edm.Guid":D,"Edm.Int16":M,"Edm.Int32":M,"Edm.Int64":M,"Edm.SByte":M,"Edm.String":D,"Edm.Time":D,"Edm.DateTimeOffset":D},updateModel:function(C,f,m){if(C.getModel()instanceof sap.ui.model.odata.ODataModel){var h=f.reduce(function(h,o){if(o.getTextProperty()){return h.concat(o.getName(),o.getTextProperty());}else{return h.concat(o.getName());}},[]);var i=m.reduce(function(i,o){if(o.getUnitBinding()){return i.concat(o.getName(),o.getUnitBinding());}else{return i.concat(o.getName());}},[]);C._oBindingInfo.parameters=C._oBindingInfo.parameters||{};C._oBindingInfo.parameters.entitySet=c.getEntitySet(C._oBindingInfo);C._oBindingInfo.parameters.select=h.concat(i).join(",");C.bindData(C._oBindingInfo);if(C._isEnablePaging()&&C._getPagingController().getPagingSorters()){C.getBinding("data").sort(C._getPagingController().getPagingSorters());}}else{return;}}};function e(m){return function(i){var f=i?b:c;return f[m];};}return{deriveColumns:e("deriveColumns"),updateModel:e("updateModel"),getEntitySet:e("getEntitySet")};});};if(!jQuery.sap.isDeclared('sap.chart.coloring.criticality.measureValues.MeasureUtils')){jQuery.sap.declare('sap.chart.coloring.criticality.measureValues.MeasureUtils');sap.ui.define("sap/chart/coloring/criticality/measureValues/MeasureUtils",['sap/chart/coloring/ColoringUtils','sap/chart/coloring/criticality/measureValues/ThresholdsUtils','sap/chart/ChartLog','sap/chart/library'],function(C,T,a,c){"use strict";var t=jQuery.type;var b=c.coloring.CriticalityType;var m={ge:"\u2265",lt:"<",le:"\u2264",gt:">"};var M={Static:{},Calculated:{},DynamicThresholds:{},ConstantThresholds:{},Unmentioned:{}};M.Static.parse=function(o,e,p){var s=o.msr?o.msr.getName():undefined;var S=o.settings[o.type];p.callbacks=M.Static.getCallbacks(S,s);var D=o.msr.getLabel()||o.msr.getName();var f=o.settings.Legend||{};p.legend[S]=(f[S]!=null)?f[S]:D;};M.Static.getCallbacks=function(s,e){var f={};f[s]=[function(o){return o.hasOwnProperty(e);}];return f;};M.Calculated.parse=function(o,e,p,f){var s=o.settings[o.type];if(!C.find(s,e.aDims)){p.additionalDimensions.push(s);}p.status=e.oStatus;};M.Calculated.getCallbacks=function(p,s,e){var f=function(o){return(o[p]===s)&&o.hasOwnProperty(e);};return[f];};M.Calculated.getContextHandler=function(e,f,l){var o=e[0];var s=o.settings[o.type];return function(g){var S=o.parsed.status;S.legend=S.legend||{};S.callbacks=S.callbacks||{};o.parsed.legend=S.legend;o.parsed.callbacks=S.callbacks;var h=g.getProperty(s);var i=this.getDimensionByName(s);var D=this.getDimensionByName(s).getDisplayText();e.legendTitle=e.legendTitle||i.getLabel();if(!i){throw new a('error','Colorings.Criticality.Calculated','Calculated property does not exist in data model');}var j=i.getTextProperty();if(j&&D){var k=g.getProperty(j);o.parsed.legend[h]=k;}else if(h){o.parsed.legend[h]=l.getText("COLORING_TYPE_"+h.toUpperCase());}var n=o.msr.getName();var p=M.Calculated.getCallbacks(s,h,n);o.parsed.callbacks[h]=p;};};M.DynamicThresholds.parse=function(o,e,p,f,l){var s=o.settings[o.type];var g=o.msr?o.msr.getName():undefined;var D=s.ImprovementDirection.toLowerCase();var h={lo:s.ToleranceRangeLowValue,hi:s.ToleranceRangeHighValue};var i={lo:s.DeviationRangeLowValue,hi:s.DeviationRangeHighValue};d(D,h,i);var B={};if(s.Breakdown){B.NegativeLevels=s.Breakdown.NegativeLevels;B.CriticalLevels=s.Breakdown.CriticalLevels;B.PositiveLevels=s.Breakdown.PositiveLevels;B.MinimumMeasureValue=s.Breakdown.MinimumMeasureValue;B.MaximumMeasureValue=s.Breakdown.MaximumMeasureValue;}p.callbacks=T.improvement(D,g,h,i,B);p.additionalMeasures=[h.lo,h.hi,i.lo,i.hi,B.MinimumMeasureValue,B.MaximumMeasureValue].filter(function(v){return t(v)==='string';});var j={};jQuery.each(b,function(k,v){j[v]=l.getText("COLORING_TYPE_"+v.toUpperCase());});p.legend=jQuery.extend(true,{},j,o.settings.Legend);};function d(D,o,e,f){var E,r;switch(D){case'maximize':E=e.lo!=undefined&&o.lo!=undefined;r=(C.isNumber(e.lo,o.lo)&&(e.lo<o.lo));break;case'minimize':E=o.hi!=undefined&&e.hi!=undefined;r=(C.isNumber(o.hi,e.hi)&&(o.hi<e.hi));break;case'target':E=e.lo!=undefined&&o.lo!=undefined&&o.hi!=undefined&&e.hi!=undefined;r=(C.isNumber(e.lo,o.lo,o.hi,e.hi)&&(e.lo<o.lo)&&(o.lo<o.hi)&&(o.hi<e.hi));break;default:}if(!E||(f&&!r)){var s=f?"ConstantThresholds":"DynamicThresholds";throw new a('error','Colorings.Criticality.'+s,'Invalid Thresholds settings');}}M.ConstantThresholds.parse=function(o,e,p,f){var s=o.settings[o.type];var g=o.msr?o.msr.getName():undefined;var D=s.ImprovementDirection.toLowerCase();var h={lo:o.byAggregation.ToleranceRangeLowValue,hi:o.byAggregation.ToleranceRangeHighValue};var i={lo:o.byAggregation.DeviationRangeLowValue,hi:o.byAggregation.DeviationRangeHighValue};d(D,h,i,true);var B={};if(s.Breakdown){B.NegativeLevels=s.Breakdown.NegativeLevels;B.CriticalLevels=s.Breakdown.CriticalLevels;B.PositiveLevels=s.Breakdown.PositiveLevels;B.MinimumMeasureValue=o.byAggregation.Breakdown.MinimumMeasureValue;B.MaximumMeasureValue=o.byAggregation.Breakdown.MaximumMeasureValue;}if(f){p.legend=T.MBCimprovement(D,h,i);}else{p.callbacks=T.improvement(D,g,h,i,B);p.additionalMeasures=[h.lo,h.hi,i.lo,i.hi,B.MinimumMeasureValue,B.MaximumMeasureValue].filter(function(v){return t(v)==='string';});p.legend=M.ConstantThresholds.getLegend(D,g,h,i);}};M.ConstantThresholds.getLegend=function(D,s,o,e){var l={};var f=s+' '+m.ge+' '+o.lo;var g=e.lo+' '+m.le+' '+s+' '+m.lt+' '+o.lo;var h=s+' '+m.lt+' '+e.lo;var i=s+' '+m.le+' '+o.hi;var j=o.hi+' '+m.lt+' '+s+' '+m.le+' '+e.hi;var k=s+' '+m.gt+' '+e.hi;switch(D){case'maximize':l={Positive:f,Critical:g,Negative:h};break;case'minimize':l={Positive:i,Critical:j,Negative:k};break;case'target':l={Positive:o.lo+' '+m.le+' '+s+' '+m.le+' '+o.hi,Critical:g+' , '+j,Negative:h+' , '+k};break;default:}return l;};M.ConstantThresholds.getContextHandler=function(e,f){if(f){var o=e[0];var s=o.msr.getName();var l=o.parsed.legend;return function(g){var v=g.getProperty(s);l.min=Math.min(l.min,v);l.max=Math.max(l.max,v);};}else{return null;}};M.Unmentioned.getCallbacks=function(e){var f={'Unmentioned':e.map(function(o){return function(g){return g.hasOwnProperty(o.getName());};})};return f;};M.Unmentioned.parse=function(o,e,p){p.callbacks=M.Unmentioned.getCallbacks(o.settings);p.legend=o.settings.map(function(f){return f.getLabel()||f.getName();});};return M;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.criticality.measureValues.MeasureValues')){jQuery.sap.declare('sap.chart.coloring.criticality.measureValues.MeasureValues');sap.ui.define("sap/chart/coloring/criticality/measureValues/MeasureValues",['sap/chart/coloring/ColoringUtils','sap/chart/coloring/ColorPalette','sap/chart/coloring/criticality/measureValues/MeasureUtils','sap/chart/ChartLog'],function(C,a,M,b){"use strict";var t=jQuery.type;var c={};c.validate=function(d,m,D,A){if(A.length>1){var o={};d.forEach(function(e){if(e.type==="Static"){var s=e.settings.Static;if(o[s]){throw new b('error','Colorings.Criticality.Static','Measures using Static method must have different Criticality Type');}else{o[s]=true;}}else{throw new b('error','Colorings.Criticality','Only support multiple active measures using Static method');}});}else if(A.length<1){if(d.length>1){throw new b('error','Colorings.Criticality.MeasureValues','Multiple measures are defined, please resolve by activeColoring property');}}};c.qualify=function(o,m,d,s,A,e){var f=[];var g=d.map(function(D){return D.getName();}).sort().join(",");var h=[];var j=[];if(A&&A.parameters&&A.parameters.measure){j=(t(A.parameters.measure)==="array")?A.parameters.measure:[A.parameters.measure];var k=j.every(function(i){return C.find(i,m);});if(!k){throw new b('error','Colorings','Active Dimensions/Measures should be visible');}}jQuery.each(o,function(l,S){var n=Object.keys(S);var p=C.find(l,m);var E=n.filter(function(v){return v!=="Legend";});if(j.length&&j.indexOf(l)===-1){return;}if(E.length!==1){throw new b('error','Colorings.Criticality.MeasureValues','One and only one of "Static", "Calculated", "DynamicThresholds", or "ConstantThresholds" is required');}if(!p){return;}var K=E[0];f.sMethod=K;if(K==="ConstantThresholds"){var q=null;for(var i=0;i<S[K].AggregationLevels.length;i++){var r=S[K].AggregationLevels[i].VisibleDimensions.sort().join(",");if(r===g){q=S[K].AggregationLevels[i];break;}}if(q){f.push({type:K,msr:p,settings:S,byAggregation:q});h.push(p.getName());}}else{f.push({type:K,msr:p,settings:S});h.push(p.getName());}});if(f.length){c.validate(f,m,d,j);if(e.bMBC&&f[0].type!="ConstantThresholds"){throw new b('error','Colorings','Heatmap only support Criticality.MeasureValues.ConstantThresholds');}if(e.bShowUnmentionedMsr){var u=m.filter(function(i){return h.indexOf(i.getName())===-1;});if(u.length&&u.length<=5){f.push({type:"Unmentioned",settings:u});}else if(u.length>5){throw new b("warning",'Colorings.Criticality.MeasureValues',"Too many unmentioned measures (the maximum number is 5)");}}}return f;};c.parse=function(o,m,d,i,s,O,l){var e=O.bMBC;var I=O.bIsPie;var f={aMsrs:m,aDims:d,oStatus:s};var p={msr:o.msr,callbacks:{},additionalMeasures:[],additionalDimensions:[],legend:{}};if(i.length){throw new b('error','colorings.Criticality.MeasureValues','Semantic coloring could not be applied if inResult Dimensions exist');}var h=d.some(function(D){return D._getFixedRole()==="series";});if(h||(I&&d.length)){throw new b('error','colorings.Criticality.MeasureValues','Semantic coloring could not be applied if chart already has coloring');}M[o.type].parse(o,f,p,e,l);return p;};c.getContextHandler=function(s,d,m,l){if(M[s].getContextHandler){return M[s].getContextHandler(d,m,l);}else{return null;}};return c;});};if(!jQuery.sap.isDeclared('sap.chart.coloring.criticality.Criticality')){jQuery.sap.declare('sap.chart.coloring.criticality.Criticality');sap.ui.define("sap/chart/coloring/criticality/Criticality",['sap/chart/coloring/criticality/measureValues/MeasureValues','sap/chart/coloring/criticality/DimensionValues','sap/chart/coloring/ColoringUtils','sap/chart/coloring/ColorPalette','sap/chart/ChartLog','sap/chart/library'],function(M,D,C,a,b,c){"use strict";var t=jQuery.type;var S=['DimensionValues','MeasureValues'];var d=c.coloring.CriticalityType;var m=[d.Positive,d.Neutral,d.Critical,d.Negative,'Unmentioned'];var e=[d.Positive,d.Critical,d.Negative,d.Neutral];function u(o,A){var p=A?A.parameters:{};var i=Object.keys(o).filter(function(T){return!S.indexOf(T)!==-1;});if(p&&p.dimension&&p.measure){throw new b('error','colorings.Criticality','Both "DimensionValues" and "MeasureValues" present in coloring CRITICALITY, activeColoring.parameters is required to specify which to use');}else if(p&&p.dimension){return'DimensionValues';}else if(p&&p.measure){return'MeasureValues';}else if(i.length===1){return i[0];}else{return null;}}function f(i,l){var r=[];l.forEach(function(s){i.forEach(function(o){if(o.chartLog){throw o.chartLog;}var k=o.parsed.callbacks[s]||[];k.forEach(function(n,p){var q,v;if(s==="Unmentioned"){q=C.assignUnmentionedColor(a.CRITICALITY.Neutral,k.length);v=o.parsed.legend[p];}else{q=C.assignColor(a.CRITICALITY[s],k.length);var L=o.parsed.legend[s];v=(t(L)==="array")?L[p]:L;}r.push({callback:n,properties:{color:q[p]},displayName:v});});});});return r;}function g(i){var o=i[0];var l=o.parsed.legend;var p=[],B=[];var n=(l.segments[0].upperBound>l.min)?true:false;var N=(l.segments[l.segments.length-2].upperBound<l.max)?true:false;l.segments.forEach(function(s){var k=C.assignColor(a.CRITICALITY[s.CriticalityType],1);p.push(k[0]);B.push(s.upperBound);});if(n){B=[l.min].concat(B);}else{p.splice(0,1);}if(N){B[B.length-1]=l.max;}else{p.splice(p.length-1,1);B.splice(B.length-1,1);}if(p.length<=1){return null;}return{feed:"color",palette:p,numOfSegments:p.length,legendValues:B};}function h(i){var l;if(i.legendTitle){l={title:{text:i.legendTitle,visible:true}};}else{l={title:{text:null,visible:false}};}return l;}function j(i,l){return function(){var k,p;if(i.bMBC){k=g(i);}else{var r=f(i,l);p={plotArea:{dataPointStyle:{rules:r}},legend:h(i)};}return{colorScale:k,properties:p};};}return{getCandidateSetting:function(o,A,k,l,I,s,n,L){var p=n.bMBC;var q=o.Criticality||{};var U=u(q,A);var r={additionalMeasures:[],additionalDimensions:[]};var Q,P,v;switch(U){case'DimensionValues':Q=D.qualify(q.DimensionValues,k,l,I,A,"Criticality",n);if(Q){Q.parsed=D.parse(Q,l,s,L,n);r.contextHandler=D.getContextHandler(Q,L);r.ruleGenerator=j([Q],e);}break;case'MeasureValues':Q=M.qualify(q.MeasureValues,k,l,s,A,n);if(Q.sMethod){jQuery.each(Q,function(i,w){P=M.parse(w,k,l,I,s,n,L);jQuery.each(P.additionalMeasures,function(i,T){r.additionalMeasures[T]=true;});jQuery.each(P.additionalDimensions,function(i,x){r.additionalDimensions[x]=true;});w.parsed=P;if(w.settings.Legend&&w.settings.Legend.Title){Q.legendTitle=w.settings.Legend.Title;}});v=Q.sMethod;r.additionalMeasures=Object.keys(r.additionalMeasures);r.additionalDimensions=Object.keys(r.additionalDimensions);r.contextHandler=M.getContextHandler(v,Q,p,L);r.ruleGenerator=j(Q,m);Q.bMBC=p;}break;default:return{};}return r;}};});};if(!jQuery.sap.isDeclared('sap.chart.coloring.Colorings')){jQuery.sap.declare('sap.chart.coloring.Colorings');sap.ui.define("sap/chart/coloring/Colorings",["sap/chart/coloring/criticality/Criticality","sap/chart/coloring/emphasis/Emphasis",'sap/chart/ChartLog'],function(C,E,a){"use strict";var S=['Criticality','Emphasis'];function u(c,A){var u=null;var s=A?A.coloring:null;var p=A?A.parameters:null;if(p&&p.dimension&&p.measure){throw new a('error','activeColoring',"Either \"dimension\" or \"measure\" can be set in activeColoring.parameters, but not both of them");}if(S.indexOf(s)>-1){u=s;}return u;}return{getCandidateSetting:function(c,A,m,d,i,s,b,l){var e=u(c,A);var f,o={};o.bMBC=(b==="heatmap")?true:false;o.bShowUnmentionedMsr=(b==="scatter"||b==="bubble")?false:true;o.bIsPie=(b==="pie"||b==="donut")?true:false;o.chartType=b;switch(e){case'Criticality':f=C;break;case'Emphasis':f=E;break;default:f=null;break;}if(f){return f.getCandidateSetting(c,A,m,d,i,s,o,l);}else{return{};}}};});};if(!jQuery.sap.isDeclared('sap.chart.Chart')){jQuery.sap.declare('sap.chart.Chart');jQuery.sap.require('sap.viz.ui5.controls.VizFrame');jQuery.sap.require('sap.viz.ui5.controls.common.BaseControl');jQuery.sap.require('sap.viz.ui5.data.Dataset');jQuery.sap.require('sap.viz.ui5.data.FlattenedDataset');jQuery.sap.require('sap.viz.ui5.data.DimensionDefinition');jQuery.sap.require('sap.viz.ui5.data.MeasureDefinition');jQuery.sap.require('sap.ui.model.analytics.ODataModelAdapter');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.FeedItem');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.define("sap/chart/Chart",['sap/chart/library','sap/viz/ui5/controls/VizFrame','sap/viz/ui5/controls/common/BaseControl','sap/viz/ui5/data/Dataset','sap/viz/ui5/data/FlattenedDataset','sap/viz/ui5/data/DimensionDefinition','sap/viz/ui5/data/MeasureDefinition','sap/chart/data/Dimension','sap/chart/data/TimeDimension','sap/chart/data/Measure','sap/ui/model/analytics/ODataModelAdapter','sap/chart/utils/RoleFitter','sap/chart/utils/ChartUtils','sap/chart/utils/ChartTypeAdapterUtils','sap/chart/utils/DateFormatUtil','sap/chart/utils/DataSourceUtils','sap/chart/utils/SelectionAPIUtils','sap/chart/utils/MeasureSemantics','sap/viz/ui5/controls/common/feeds/FeedItem','sap/ui/model/Filter','sap/ui/model/FilterOperator','sap/ui/model/analytics/odata4analytics','sap/chart/TimeUnitType','sap/chart/coloring/Colorings','sap/chart/ChartLog','sap/chart/pagination/PagingController'],function(l,V,B,D,F,a,M,b,T,c,O,R,C,f,g,h,S,n,q,r,s,t,u,w,x,P){"use strict";var y=sap.chart.SelectionMode;var z=B.extend("sap.chart.Chart",{metadata:{library:"sap.chart",properties:{chartType:{type:"string",defaultValue:"bar"},uiConfig:{type:"object",group:"Misc"},visibleDimensions:{type:"string[]",defaultValue:[]},inResultDimensions:{type:"string[]",defaultValue:[]},visibleMeasures:{type:"string[]",defaultValue:[]},vizProperties:{type:"object",group:"Misc"},vizScales:{type:"object[]",group:"Misc"},isAnalytical:{type:"boolean"},selectionBehavior:{type:"sap.chart.SelectionBehavior",defaultValue:sap.chart.SelectionBehavior.DataPoint},selectionMode:{type:"sap.chart.SelectionMode",defaultValue:sap.chart.SelectionMode.Multi},enablePagination:{type:"boolean",defaultValue:false},customMessages:{type:"object",defaultValue:null},colorings:{type:"object",defaultValue:null},activeColoring:{type:"object",defaultValue:null}},aggregations:{data:{type:"sap.ui.core.Element",multiple:true,bindable:"bindable"},_vizFrame:{type:"sap.viz.ui5.controls.VizFrame",multiple:false,visibility:"hidden"},dimensions:{type:"sap.chart.data.Dimension",multiple:true},measures:{type:"sap.chart.data.Measure",multiple:true}},events:{drilledDown:{parameters:{dimensions:{type:"string[]"}}},drilledUp:{parameters:{dimensions:{type:"string[]"}}},renderComplete:{},selectData:{},deselectData:{}}},renderer:function(o,d){o.write("<div");o.writeControlData(d);o.addStyle("width",d.getWidth());o.addStyle("height",d.getHeight());o.writeStyles();o.write(">");o.renderControl(d.getAggregation("_vizFrame"));o.write("</div>");}});z.getMetadata().getAggregation("data")._doesNotRequireFactory=true;function A(v){return v.indexOf("%")!==-1?"100%":v;}z.prototype.setHeight=function(v){this.setProperty("height",v);var o=this._getVizFrame();if(o){o.setHeight(A(this.getProperty("height")));}return this;};z.prototype.setWidth=function(v){this.setProperty("width",v);var o=this._getVizFrame();if(o){o.setWidth(A(this.getProperty("width")));}return this;};z.prototype.setChartType=function(d,e){this.setProperty("chartType",d,e);this._bIsPagingChartType=C.CONFIG.pagingChartTypes.indexOf(d)>-1;if(this._isEnablePaging()){this._getPagingController().init(false);}else{var o=this._getDataset();if(o){o.setPagingOption(null);o.setRange(-1,-1);}}this._invalidateBy({source:this,keys:{vizFrame:true}});this._bNeedToApplyDefaultProperties=true;return this;};z.prototype.setColorings=function(v){this.setProperty("colorings",v);this._invalidateBy({source:this,keys:{vizFrame:true,checkBinding:true}});return this;};z.prototype.setActiveColoring=function(v){this.setProperty("activeColoring",v);this._invalidateBy({source:this,keys:{vizFrame:true,checkBinding:true}});return this;};z.prototype.removeDimension=function(d){var v=this._getVisibleDimensions()||[];var i;if(this.getIsAnalytical()===false&&d&&d.getName()){i=v.indexOf(d.getName());if(i!==-1){jQuery.sap.log.error('Data source does not support aggregation. The method "removeDimension" therefore cannot be used!');return;}}var o=this.removeAggregation("dimensions",d);if(o){i=v.indexOf(o.getName());if(i!==-1){v.splice(i,1);this.setVisibleDimensions(v);}var e=this.getInResultDimensions()||[];i=e.indexOf(o.getName());if(i!==-1){e.splice(i,1);this.setInResultDimensions(e);}}return o;};z.prototype.removeAllDimensions=function(){var o;if(this.getIsAnalytical()===false){jQuery.sap.log.error('Data source does not support aggregation. The method "removeAllDimensions" therefore cannot be used!');}else{o=this.removeAllAggregation("dimensions");this.setVisibleDimensions([]);this.setInResultDimensions([]);}return o;};z.prototype.destroyDimensions=function(){var o;if(this.getIsAnalytical()===false){jQuery.sap.log.error('Data source does not support aggregation. The method "destroyDimensions" therefore cannot be used!');}else{o=this.destroyAggregation("dimensions");this.setVisibleDimensions([]);this.setInResultDimensions([]);}return o;};z.prototype.removeMeasure=function(m){var o=this.removeAggregation("measures",m);if(o){var v=this._getVisibleMeasures()||[],i=v.indexOf(o.getName());if(i!==-1){v.splice(i,1);this.setVisibleMeasures(v);}}return o;};z.prototype.removeAllMeasures=function(){var o=this.removeAllAggregation("measures");this.setVisibleMeasures([]);return o;};z.prototype.destroyMeasures=function(){var o=this.destroyAggregation("measures");this.setVisibleMeasures([]);return o;};z.prototype._getVisibleDimensions=function(N){var o=this._getDrillStateTop();var d=o?o.dimensions:this.getProperty("visibleDimensions");return N?this._normalizeDorM(d,true):d;};z.prototype.getVisibleDimensions=function(){var v=this._getVisibleDimensions();return this._aFeeds?v.filter(function(d){return this._aFeeds._unused.indexOf(d)===-1;},this):v;};z.prototype._getVisibleMeasures=function(N){var o=this._getDrillStateTop();var m=o?o.measures:this.getProperty("visibleMeasures");return N?this._normalizeDorM(m):m;};z.prototype.getVisibleMeasures=function(){var v=this._getVisibleMeasures();return this._aFeeds?v.filter(function(d){return this._aFeeds._unused.indexOf(d)===-1;},this):v;};z.prototype.setVisibleDimensions=function(v,d){var m=this._dimensionSanityCheck({visible:v});this.setProperty("visibleDimensions",v,d);this.setProperty("inResultDimensions",m.inResult,d);this._createDrillStack();this._invalidateBy({source:this,keys:{binding:true,dataSet:true,vizFrame:true}});return this;};z.prototype.setInResultDimensions=function(i,d){var m=this._dimensionSanityCheck({inResult:i});this.setProperty("inResultDimensions",i,d);this.setProperty("visibleDimensions",m.visible,d);this._createDrillStack();this._invalidateBy({source:this,keys:{binding:true,dataSet:true,vizFrame:true}});};z.prototype.setVisibleMeasures=function(m,d){this.setProperty("visibleMeasures",m,d);this._createDrillStack();this._invalidateBy({source:this,keys:{binding:true,dataSet:true,vizFrame:true}});return this;};z.prototype.setEnablePagination=function(e,d){if(!this._bIsInitialized){this.setProperty("enablePagination",e,d);this._invalidateBy({source:this,keys:{binding:true,dataSet:true,vizFrame:true,drillStack:true}});}return this;};z.prototype._dimensionSanityCheck=function(d){var v=d.visible||this.getVisibleDimensions()||[],i=d.inResult||this.getInResultDimensions()||[];var m=[].concat(v).concat(i).reduce(function(e,j){var k=v.indexOf(j)!==-1,o=i.indexOf(j)!==-1;if(k&&o){e.common[j]=true;}else if(k){e.visible[j]=true;}else if(o){e.inResult[j]=true;}return e;},{visible:{},inResult:{},common:{}});m.visible=Object.keys(m.visible);m.inResult=Object.keys(m.inResult);m.common=Object.keys(m.common);return m;};z.prototype._prepareFeeds=function(){if(!this._aFeeds){var d=this._normalizeDorM(this._getVisibleDimensions(),true),m=this._normalizeDorM(this._getVisibleMeasures(),false),i=this._normalizeDorM(this.getInResultDimensions(),true);this._sAdapteredChartType=this.getEnablePagination()?this.getChartType():f.adaptChartType(this.getChartType(),d);this._aFeeds=R.fit(this._sAdapteredChartType,d,m,i,this._enableSemanticPattern());if((!this._aFeeds._valid||this._aFeeds._unused.length)&&this._sAdapteredChartType!==this.getChartType()){this._sAdapteredChartType=this.getChartType();this._aFeeds=R.fit(this._sAdapteredChartType,d,m,i);}if(this._sAdapteredChartType!==this.getChartType()){this._bNeedToApplyDefaultProperties=true;}}return this._aFeeds;};z.prototype._normalizeDorM=function(m,i){var d=i?this.getDimensions():this.getMeasures(),L=d.reduce(function(j,k){j[k.getName()]=k;return j;},{}),e=i?b:c;var o=m.reduce(function(o,j){var k;if(typeof j==="string"){k=j;}else if(j instanceof e){k=j.getName();}else{o.errors.push(j);}if(L[k]){o.normalized.push(L[k]);}else{o.errors.push(j);}return o;},{normalized:[],errors:[]});var N=o.normalized;if(o.errors.length>0){N.errors=o.errors;}return N;};z.prototype._redundantsFromSelection=function(){var d=this._getVizFrame().vizSelection();if(!d||d.length===0){return{measureNames:{}};}var o=this._getContinuesSemanticTuples();var m=d.reduce(function(i,j){var p=[];for(var L in o){if(o.hasOwnProperty(L)){var N=o[L];if(j.data[L]){p.push((j.data[N.timeAxis]<N.projectedValueStartTime)?N.projected:N.actual);}else{p.push(N.actual);p.push(N.projected);}}}jQuery.each(j.data,function(k,v){if(!(p.length>0&&p.indexOf(k)>-1)){if(!i[k]){i[k]=[];}if(i[k].indexOf(v)===-1){i[k].push(v);}}});return i;},{});var e=this._getVisibleDimensions().reduce(function(i,j){var v=m[j];if(v.length===1){i[j]=v[0];}return i;},{});e.measureNames=this._getVisibleMeasures().reduce(function(i,j){if(!m[j]){i[j]=true;}return i;},{});return e;};z.prototype._deriveFilterFromSelection=function(){var v=this._getVisibleDimensions();var d=this;var e=this._getVizFrame().vizSelection().map(function(o){var j=v.reduce(function(k,m){var p=d.getDimensionByName(m);var L;L=o.data[m];if(C.CONFIG.timeChartTypes.indexOf(d._sAdapteredChartType)>-1&&p instanceof T){var N=g.getInstance(p.getTimeUnit());if(N){var Q=N.format.bind(N);L=Q(new Date(o.data[m]));}}k.filters.push(new r({path:m,operator:s.EQ,value1:L}));k.signature.push(m+"="+o.data[m]);return k;},{filters:[],signature:[]});j.signature=j.signature.join(";");return j;});var U=e.reduce(function(m,o){if(!m[o.signature]&&o.filters.length>0){m[o.signature]=new r(o.filters,true);}return m;},{});var i=Object.keys(U).map(function(k){return U[k];});if(i.length>1){return new sap.ui.model.Filter(i,false);}else if(i.length===1){return i[0];}else{return null;}};z.prototype._checkDrilldownValid=function(i){var v=this._getVisibleDimensions().concat(this.getInResultDimensions()).reduce(function(e,j){e[j]=true;return e;},{});if(i.some(function(e){return v[e.getName()];})){jQuery.sap.log.error("Drill down not possible, because one of the given dimensions is already drilled down!");return false;}var m=i.reduce(function(e,j){e[j.getName()]=j;return e;},{});function d(e){if(jQuery.isArray(e.aFilters)){return e.aFilters.some(d);}else{return!!m[e.sPath];}}var o=this._getDrillStateTop();if(o&&o.filter&&d(o.filter)){jQuery.sap.log.error("Drill down not possible, because one of the given dimensions is already filtered!");return false;}return true;};z.prototype._createDrillStack=function(){var v=this.getProperty("visibleDimensions")||[],d=this.getProperty("visibleMeasures")||[],e=[{dimensions:[],measures:d,filter:undefined}],j=[];for(var i=0;i<v.length;i++){j.push(v[i]);e.push({dimensions:j.slice(),measures:d,filter:undefined});}this._drillStateStack=e;};z.prototype._invalidateBy=function(o){var d=o.source;var e=this._oCandidateColoringSetting?(this._oCandidateColoringSetting.additionalDimensions||[]):[];if(d===this){jQuery.each(o.keys||{},function(k,v){this._markForUpdate(k,v);}.bind(this));}else if(d instanceof c&&this._getVisibleMeasures().indexOf(d.getName())!==-1){this._markForUpdate("dataSet",true);this._markForUpdate("vizFrame",true);if(o.property==="unitBinding"){this._markForUpdate("binding",true);}}else if(d instanceof b&&this._getVisibleDimensions().concat(e).indexOf(d.getName())!==-1){this._markForUpdate("dataSet",true);this._markForUpdate("vizFrame",true);if(d.getDisplayText()&&(o.property==="textProperty"||o.property==="displayText")){this._markForUpdate("binding",true);}}this.invalidate(o);};z.prototype._handleNonAnalyticalFeeding=function(){var d=this;var i=this.getInResultDimensions();var v=this._getVisibleDimensions(),e=this.getDimensions().map(function(o){return o.getName();});var j=[];e.forEach(function(m){if(d.getDimensionByName(m)){var o=d.getDimensionByName(m).getTextProperty();if(o){j.push(o);}}});var k=v.concat(e.filter(function(m){return(v.indexOf(m)<0);})).filter(function(m){return(j.indexOf(m)<0)&&(i.indexOf(m)<0);});this.setProperty("visibleDimensions",k);this._createDrillStack();};z.prototype._markForUpdate=function(k,N){if(!this._mNeedToUpdate){this._mNeedToUpdate={};}this._mNeedToUpdate[k]=N;var o=this._updaters.onInvalidate[k];if(o){o.call(this);}};z.prototype._updaters=(function(){return{onInvalidate:{vizFrame:function(){this._aFeeds=null;this._bColoringParsed=null;},checkBinding:function(){this._bColoringParsed=null;},binding:function(){this._bColoringParsed=null;}},checkBinding:function(){var o=this._getCandidateColoringSetting();var d=o.additionalDimensions;var e=o.additionalMeasures;if((d&&d.length)||(e&&e.length)){this._markForUpdate("binding",true);}},drillStack:function(){this._createDrillStack();},dataSet:function(){this._getDataset().invalidate();},binding:function(){var o=this._getDataset().getBinding("data"),i=this.getInResultDimensions();if(!o){return;}var d=this._getVisibleDimensions(true).concat(this._normalizeDorM(i,true));var m=this._getVisibleMeasures(true);h.updateModel(this.getIsAnalytical())(this,d,m);var e=this._getDrillStateTop();if(d.length>0||m.length>0){this._getVizFrame()._readyToRender(false);this.setBusy(true);}o.filter((e&&e.filter)?e.filter:undefined);},vizFrame:function(){if(this._mNeedToUpdate['binding']){if(this._isEnablePaging()){this._getPagingController().reset();this._oColoringStatus={};}else{this._getDataset().setPagingOption(null);}}else{this._markForUpdate('loopData',true);}var d=this,o=this._getDataset(),v=this._getVizFrame(),m=this._isEnablePaging()?this._getPagingController().getMeasureRange():{};o.removeAllAggregation("dimensions",true);o.removeAllAggregation("measures",true);v.removeAllAggregation("feeds",true);if(this.getIsAnalytical()===false){this._handleNonAnalyticalFeeding();}var e=this._prepareFeeds();e._def.dim.forEach(function(L){o.addAggregation("dimensions",L,true);},this);e._def.msr.forEach(function(L){if(L){var N=m[L.getIdentity()];if(N){L.setRange([N.min,N.max]);}if(!d.getDimensionByName(L.getUnit())){L.setUnit(null);}o.addAggregation("measures",L,true);}},this);e.forEach(function(L){v.addFeed(L);});this._semanticTuples=e._semanticTuples;var i=e._context||[];var j=this._getCandidateColoringSetting();var k=j.additionalMeasures||[];var p=j.additionalDimensions||[];k.forEach(function(L){i.push({id:L,showInTooltip:false});o.addMeasure(new M({name:L,identity:L,value:'{'+L+'}'}));});p.forEach(function(L){i.push({id:L,showInTooltip:false});o.addDimension(new a({name:L,identity:L,value:'{'+L+'}'}));});o.setContext(i);v.invalidate();o.invalidate();v.setVizType(this._sAdapteredChartType);v.setVizProperties(this._getEffectiveProperties());v._setCustomMessages(this.getCustomMessages());},loopData:function(){var v=this._getVizFrame();try{this._prepareData();}catch(e){if(e instanceof x){e.display();}else{throw e;}}var o=this._getEffectiveProperties();this._usingDisplayNameForSemantics(o);v.setVizProperties(o);this._setEffectiveScales();}};})();z.prototype._getDrillStateTop=function(){return this._drillStateStack?this._drillStateStack[this._drillStateStack.length-1]:null;};z.prototype._getVizFrame=function(){return this.getAggregation("_vizFrame");};z.prototype._getDataset=function(){var v=this._getVizFrame();return v?v.getDataset():null;};z.prototype._restoreUserSemanticColoringProperties=function(){this._oColoringsDataPointStyle={plotArea:{dataPointStyle:this._oDataPointStyle},legend:{title:this._oLegendtitle}};this._oColoringScale=null;};z.prototype._prepareData=function(){var o={},d;var i=this.getVisibleMeasures().some(function(m){return this.getMeasureByName(m).getSemantics()!==sap.chart.data.MeasureSemantics.Actual;}.bind(this));if(!i&&((this._sAdapteredChartType==="heatmap"&&this._oVizColorScale===undefined)||(this._sAdapteredChartType!=="heatmap"&&!this._oDataPointStyle))){o=this._getCandidateColoringSetting();d=o.contextHandler;}var j=[];if(d){j.push(d);this._loopContext(j);}if(i){this._oColoringsDataPointStyle=null;}else{if(o.ruleGenerator){var k;try{k=o.ruleGenerator();this._oColoringsDataPointStyle=k.properties;this._oColoringScale=k.colorScale;}catch(e){if(e instanceof x){e.display();}else{throw e;}this._restoreUserSemanticColoringProperties();}}else{this._restoreUserSemanticColoringProperties();}}};z.prototype._getContexts=function(){var o=this.getBinding("data");if(o){if(this._isEnablePaging()&&this._getPagingController().isUnderPaging()){return this._getPagingController().getCurrentContexts();}else{var i=0;var L=o instanceof sap.ui.model.analytics.AnalyticalBinding?o.getTotalSize():o.getLength();return o.getContexts(i,L);}}else{return[];}};z.prototype._loopContext=function(d){var e=this._getContexts();if(e.length>0&&!e.dataRequested){var i=this;e.forEach(function(o){d.forEach(function(j){j.call(i,o);});});}};z.prototype._bindingChangeListener=function(){var v=this._getVizFrame();v.invalidate();this.setBusy(false);if(this._isEnablePaging()){this._getPagingController().bindingChanged();}else{v._readyToRender(true);}try{this._prepareData();}catch(e){if(e instanceof x){e.display();}}var o=this._getEffectiveProperties();this._usingDisplayNameForSemantics(o);v.setVizProperties(o);this._setEffectiveScales();};z.prototype._enableSemanticPattern=function(){return!(this._oDataPointStyle||this._oSeriesStyle);};z.prototype._hasSemanticPattern=function(){return this._semanticTuples&&this._semanticTuples.length>0;};z.prototype._getContinuesSemanticTuples=function(){var d={};if(this._hasSemanticPattern()){d=this._semanticTuples.reduce(function(e,i){if(i.semanticMsrName){e[i.semanticMsrName]=i;}return e;},{});}return d;};z.prototype._getContinuesSemanticMap=function(){var d=[];if(this._hasSemanticPattern()){d=this._semanticTuples.filter(function(e){return e.projectedValueStartTime;});}return d;};z.prototype._getInternalVisibleMeasures=function(){var m=this._getVisibleMeasures();if(this._hasSemanticPattern()){m=m.concat(this._getContinuesSemanticMap().map(function(d){return d.semanticMsrName;}));}return m;};z.prototype._buildSelectedDataPoints=function(o,d){var m=this._getInternalVisibleMeasures(),e=this._getVisibleDimensions().concat(this.getInResultDimensions()),i=this._getEffectiveContinuesDataPoints(d);return S.buildSelectionVizCtx(m,e,o,i);};z.prototype._getEffectiveContinuesSeries=function(d){var e=d.slice(),i=this._getContinuesSemanticMap();if(this._hasSemanticPattern()){var m=e.map(function(j){return j.measures;});i.forEach(function(j){if(m.indexOf(j.actual)>-1||m.indexOf(j.projected)>-1){e=e.filter(function(k){return k.measures!==j.actual&&k.measures!==j.projected;});if(m.indexOf(j.actual)>-1&&m.indexOf(j.projected)>-1){e.push({measures:j.semanticMsrName});}}});}return e;};z.prototype._getEffectiveContinuesDataPoints=function(d){var e=d.slice(),k=this._getContinuesSemanticMap();if(this._hasSemanticPattern()){var m,p,o,v;for(var i=0;i<e.length;i++){o=e[i].measures;for(var j=0;j<k.length;j++){v=k[j];m=o.indexOf(v.actual);if(m>-1){o.splice(m,1);}p=o.indexOf(v.projected);if(p>-1){o.splice(p,1);}if(m>-1||p>-1){o.push(v.semanticMsrName);}}}}return e;};z.prototype._buildSelectEventData=function(d){if(d&&d.length>0&&this._hasSemanticPattern()){var v,e;var k=this._getContinuesSemanticMap();for(var i=0;i<d.length;i++){v=jQuery.extend(true,{},d[i].data);for(var j=0;j<k.length;j++){e=k[j];if(v.measureNames===e.semanticMsrName){if(v[e.timeAxis]<e.projectedValueStartTime){v.measureNames=e.actual;delete v[e.projected];delete v[e.semanticMsrName];}else{v.measureNames=e.projected;delete v[e.actual];delete v[e.semanticMsrName];}}else{if(v[e.actual]&&v.measureNames!==e.actual){delete v[e.actual];}if(v[e.projected]&&v.measureNames!==e.projected){delete v[e.projected];}}}d[i].data=v;}}};z.prototype.addData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "addData" therefore cannot be used programmatically!');};z.prototype.destroyData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "destroyData" therefore cannot be used programmatically!');};z.prototype.getData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "getData" therefore cannot be used programmatically!');};z.prototype.indexOfData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "indexOfData" therefore cannot be used programmatically!');};z.prototype.insertData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "insertData" therefore cannot be used programmatically!');};z.prototype.removeData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "removeData" therefore cannot be used programmatically!');};z.prototype.removeAllData=function(){jQuery.sap.log.error('Chart manages the "data" aggregation only via data binding. The method "removeAllData" therefore cannot be used programmatically!');};z.prototype._createOData4SAPAnalyticsModel=function(m){var o=null;try{o=new t.Model(new t.Model.ReferenceByModel(m));}catch(e){return undefined;}return o;};z.prototype.getIsAnalytical=function(){return this.getProperty("isAnalytical");};z.prototype.setIsAnalytical=function(v,d){if(this._bIsInitialized){jQuery.sap.log.error('The proeprty isAnalytical will programmatically set according to data source. The method "setIsAnalytical" therefore cannot be used!');}else{this.setProperty("isAnalytical",v,d);}};z.prototype._setIsAnalyticalProperty=function(o,d){var v=o.findQueryResultByName(h.getEntitySet(this.getIsAnalytical())(d))!==undefined;if(this.getIsAnalytical()!==v){this.setProperty("isAnalytical",v);}};z.prototype.bindAggregation=function(N,o){if(N==="data"){this._oBindingInfo=jQuery.extend(true,{},o);var m=this.getModel(o.model);var d;if(m){if(m instanceof sap.ui.model.json.JSONModel){if(this.getIsAnalytical()!==false){this.setProperty("isAnalytical",false);}else if(this.getEnablePagination()!==false){this.setProperty("enablePagination",false);}}else{d=this._createOData4SAPAnalyticsModel(m);this._setIsAnalyticalProperty(d,o);}if(this.getIsAnalytical()){if(o){var e=true;if(o.length!=undefined||this._isEnablePaging()){e=false;}o.parameters=jQuery.extend(true,{},{analyticalInfo:[{name:""}],useBatchRequests:true,provideGrandTotals:false,provideTotalsResultSize:false,autoexpand:false,reloadSingleUnitMeasures:true,noPaging:e},o.parameters);}O.apply(m);if(d){m.setAnalyticalExtensions(d);}}}}return B.prototype.bindAggregation.apply(this,arguments);};z.prototype._bindAggregation=function(N,o){if(N==="data"){var m=this.getModel(o.model);if(m){if(m instanceof sap.ui.model.json.JSONModel){if(this.getIsAnalytical()!==false){this.setProperty("isAnalytical",false);}else if(this.getEnablePagination()!==false){this.setProperty("enablePagination",false);}}else{var d=this._createOData4SAPAnalyticsModel(m);this._setIsAnalyticalProperty(d,o);}if(this.getIsAnalytical()){if(o){var e=true;if(o.length!=undefined||this._isEnablePaging()){e=false;}o.parameters=jQuery.extend(true,{},{analyticalInfo:[{name:""}],useBatchRequests:true,provideGrandTotals:false,provideTotalsResultSize:false,autoexpand:false,reloadSingleUnitMeasures:true,noPaging:e},o.parameters);}O.apply(m);if(d){m.setAnalyticalExtensions(d);}}this._deriveColumns(m,o);}this._getDataset().bindAggregation("data",o);this._invalidateBy({source:this,keys:{binding:true,vizFrame:true}});}else{B.prototype._bindAggregation.apply(this,arguments);}};z.prototype.unbindAggregation=function(N,d){if(N==="data"){var o=this._getDataset();if(o){o.unbindAggregation.apply(o,arguments);}d=true;}return B.prototype.unbindAggregation.apply(this,[N,d]);};z.prototype.unbindData=function(){if(!this.getIsAnalytical()){this.removeAllAggregation("dimensions");this.removeAllAggregation("measures");this.setProperty("visibleDimensions",[]);this.setProperty("inResultDimensions",[]);this.setProperty("visibleMeasures",[]);this._createDrillStack();}this.unbindAggregation("data");};z.prototype._deriveColumns=function(m,o){var d=this.getAggregation("dimensions");var e=this.getAggregation("measures");if((d===null||d.length===0)&&(e===null||e.length===0)){var i=h.deriveColumns(this.getIsAnalytical())(m,o);i.dimensions.forEach(this.addDimension.bind(this));i.measures.forEach(this.addMeasure.bind(this));}};z.prototype.onBeforeRendering=function(){B.prototype.onBeforeRendering.apply(this,arguments);var o=["onInvalidate","drillStack","dataSet","vizFrame","checkBinding","binding","loopData"];o.forEach(function(k){if(this._mNeedToUpdate[k]){this._updaters[k].call(this);}}.bind(this));jQuery.each(this._mNeedToUpdate,function(k){this._mNeedToUpdate[k]=false;}.bind(this));};z.prototype.onAfterRendering=function(){this._showLoading(this._bLoading);};z.prototype.onlocalizationChanged=function(){this._invalidateBy({source:this,keys:{vizFrame:true}});};z.prototype.exit=function(){this._getDataset().unbindAggregation('data',true);B.prototype.exit.apply(this,arguments);var v=this._getVizFrame();if(this._delegateEventHandlers){this._delegateEventHandlers.forEach(function(o){v["detach"+o.name](o.handler,this);delete o.handler;},this);delete this._delegateEventHandlers;}v.detachRenderComplete(this._vizFrameRenderCompleteHandler,this);};z.prototype.applySettings=function(){this._oDataPointStyle=null;this._oSeriesStyle=null;sap.ui.core.Control.prototype.applySettings.apply(this,arguments);var d=new F();d.attachEvent("dataChange",{},this._bindingChangeListener,this);var i=jQuery.extend(true,{},{'applicationSet':'fiori'},this.getUiConfig());this.setUiConfig(i);this._bNeedToApplyDefaultProperties=true;var v=new V({width:A(this.getWidth()),height:A(this.getHeight()),vizType:this.getChartType(),uiConfig:this.getUiConfig(),vizProperties:jQuery.extend(true,{'title':{'visible':false}},this._getEffectiveProperties())});v.setDataset(d);v.attachRenderComplete(null,this._updateLoadingIndicator.bind(this));this._rendered=false;v.attachEventOnce("renderComplete",function(){this._rendered=true;},this);v.attachEvent("renderFail",null,function(e){this._showLoading(false);},this);v._readyToRender(false);this.setAggregation("_vizFrame",v);this._delegateEvents();this._sAdapteredChartType=this.getChartType();this._bIsInitialized=true;this._oCandidateColoringSetting={};this._oDataPointStyle=null;this._oLegendtitle=null;this._oColoringStatus={};this._mNeedToUpdate={};if(this._isEnablePaging()){this._getPagingController();}};z.prototype.setCustomMessages=function(o){this.setProperty("customMessages",o);var v=this._getVizFrame();if(v){v._setCustomMessages(o);}return this;};z.prototype.resetLayout=function(){this._invalidateBy({source:this,keys:{binding:true,vizFrame:true,drillStack:true,dataSet:true}});return this;};z.prototype.setSelectedDataPoints=function(d){if(this.getSelectionMode()!==y.None){var o=this.getBinding("data"),v=this._getVizFrame();if(!o||!v||this.getSelectionBehavior().toUpperCase()!=="DATAPOINT"){return this;}v.vizSelection([],{clearSelection:true});v.vizSelection(this._buildSelectedDataPoints(o,d),{selectionMode:this.getSelectionMode()});}return this;};z.prototype.addSelectedDataPoints=function(d){if(this.getSelectionMode()!==y.None){var o=this.getBinding("data"),v=this._getVizFrame();if(!o||!v||this.getSelectionBehavior().toUpperCase()!=="DATAPOINT"){return this;}v.vizSelection(this._buildSelectedDataPoints(o,d),{selectionMode:y.Multi});}return this;};z.prototype.getSelectedDataPoints=function(){var v=this._getVizFrame();if(!v||this.getSelectionBehavior().toUpperCase()!=="DATAPOINT"){return{count:0,dataPoints:[]};}var o=this._getContinuesSemanticTuples();var m=this._getVisibleMeasures(),d=this._getDataset(),e=v.vizSelection(),j={};for(var i=0,k=e.length;i<k;i++){var p=e[i],L=p.data._context_row_number;if(!j[L]){j[L]={index:L,measures:[],context:d.findContext({"_context_row_number":L})};}p.measures=S.filterVisibleMsr(p.data,m);if(!jQuery.isEmptyObject(o)){S.filterSemMsr(o,m,p);}j[L].measures=j[L].measures.concat(p.measures);if(p.unit){j[L].unit=jQuery.extend(true,j[L].unit,p.unit);}if(p.dataName){j[L].dataName=jQuery.extend(true,j[L].dataName,p.dataName);}}return{count:e.length,dataPoints:Object.keys(j).map(function(N){return j[N];})};};z.prototype.removeSelectedDataPoints=function(d){if(this.getSelectionMode()!==y.None){var o=this.getBinding("data"),v=this._getVizFrame();if(!v||this.getSelectionBehavior().toUpperCase()!=="DATAPOINT"){return this;}var e=this._buildSelectedDataPoints(o,d);v.vizSelection(e,{deselection:true});}return this;};z.prototype.setSelectedCategories=function(d){if(this.getSelectionMode()!==y.None){var v=this._getVizFrame(),e=this.getSelectionBehavior().toUpperCase();if(!v||e!=="CATEGORY"){return this;}v.vizSelection([],{clearSelection:true});v.vizSelection(d.map(S.toVizCSCtx),{selectionMode:this.getSelectionMode()});}return this;};z.prototype.addSelectedCategories=function(d){if(this.getSelectionMode()!==y.None){var v=this._getVizFrame(),e=this.getSelectionBehavior().toUpperCase();if(!v||e!=="CATEGORY"){return this;}v.vizSelection(d.map(S.toVizCSCtx),{selectionMode:y.Multi});}return this;};z.prototype.removeSelectedCategories=function(d){if(this.getSelectionMode()!==y.None){var v=this._getVizFrame(),e=this.getSelectionBehavior().toUpperCase();if(!v||e!=="CATEGORY"){return this;}v.vizSelection(d.map(S.toVizCSCtx),{deselection:true});}return this;};z.prototype.getSelectedCategories=function(){var v=this._getVizFrame(),d=this.getSelectionBehavior().toUpperCase();if(!v||d!=="CATEGORY"){return{count:0,categories:[]};}else{var e=v.vizSelection();return{count:e.length,categories:(e.category||[]).map(S.fromVizCSCtx)};}};z.prototype.setSelectedSeries=function(d){if(this.getSelectionMode()!==y.None){var v=this._getVizFrame(),e=this.getSelectionBehavior().toUpperCase();if(!v||e!=="SERIES"){return this;}v.vizSelection([],{clearSelection:true});var i=this._getEffectiveContinuesSeries(d);v.vizSelection(i.map(S.toVizCSCtx),{selectionMode:this.getSelectionMode()});}return this;};z.prototype.addSelectedSeries=function(d){if(this.getSelectionMode()!==y.None){var v=this._getVizFrame(),e=this.getSelectionBehavior().toUpperCase();if(!v||e!=="SERIES"){return this;}var i=this._getEffectiveContinuesSeries(d);v.vizSelection(i.map(S.toVizCSCtx),{selectionMode:y.Multi});}return this;};z.prototype.removeSelectedSeries=function(d){if(this.getSelectionMode()!==y.None){var v=this._getVizFrame(),e=this.getSelectionBehavior().toUpperCase();if(!v||e!=="SERIES"){return this;}var i=this._getEffectiveContinuesSeries(d);v.vizSelection(i.map(S.toVizCSCtx),{deselection:true});}return this;};z.prototype.getSelectedSeries=function(){var v=this._getVizFrame(),d=this.getSelectionBehavior().toUpperCase();if(!v||d!=="SERIES"){return{count:0,series:[]};}else{var e=v.vizSelection(),i=(e.series||[]).map(S.fromVizCSCtx),j=[],k=this._getContinuesSemanticTuples();i=i.filter(function(m){var o=true;if(m&&m.measures){var p=k[m.measures];if(p&&p.semanticMsrName===m.measures){j.push({measures:p.actual});j.push({measures:p.projected});o=false;}}return o;});i=i.concat(j);return{count:e.length,series:i};}};z.prototype.drillDown=function(d){if(this.getIsAnalytical()===false){jQuery.sap.log.error('Data source does not support drillDown/drillUp. The method "drillDown" therefore cannot be used!');return;}if(d&&!(d instanceof Array)){d=[d];}var e=this._normalizeDorM(d,true);if(e.length===0){return;}if(!this._checkDrilldownValid(e)){jQuery.sap.log.warning("Drill down not possible for "+e+". Already drilled down.");return;}var o=this._getDrillStateTop(),m=this._redundantsFromSelection(),i=this._deriveFilterFromSelection();var N;if(i){N=!(o&&o.filter)?i:new r([i,o.filter],true);}this._drillStateStack.push({dimensions:o.dimensions.slice().concat(e.map(function(k){return k.getName();})).filter(function(k){return!m[k];}),measures:o.measures.filter(function(k){return!m.measureNames[k];}),filter:N,redundant:m});var j=e.map(function(k){return k.getName();});this.fireDrilledDown({dimensions:j});this._invalidateBy({source:this,keys:{binding:true,vizFrame:true}});};z.prototype.drillUp=function(i){if(this.getIsAnalytical()===false){jQuery.sap.log.error('Data source does not support drillDown/drillUp. The method "drillUp" therefore cannot be used!');return;}if(arguments.length===0){i=this._drillStateStack.length-2;}var N=this._drillStateStack[i];if(N&&i!=this._drillStateStack.length-1){var p=this._drillStateStack.pop();this._drillStateStack.splice(i+1);this.fireDrilledUp({dimensions:p.dimensions.filter(function(d){return N.dimensions.indexOf(d)===-1;})});this._invalidateBy({source:this,keys:{binding:true,vizFrame:true}});}};z.prototype.getDrillStack=function(){if(this.getIsAnalytical()===false){jQuery.sap.log.error('Data source does not support drillDown/drillUp. The method "getDrillStack" therefore cannot be used!');return;}return jQuery.map(this._drillStateStack||[],function(o,i){return{dimension:o.dimensions.slice(),measure:o.measures.slice(),filter:o.filter};});};z.prototype.setUiConfig=function(U){this.setProperty("uiConfig",U);if(this._getVizFrame()){this._getVizFrame().setUiConfig(U);}};var E=(function(){var d=["interaction.selectability.mode","interaction.selectability.behavior"];function e(o,p){var j=o,v;v=p.reduce(function(m,L){if(j.hasOwnProperty(L)){m.push({parent:j,val:j[L],key:L});j=j[L];}return m;},[]);if(v.length!==p.length){return;}var k=v.pop();delete k.parent[k.key];while(v.length>0){k=v.pop();if(Object.keys(k.val).length>0){return;}else{delete k.parent[k.key];}}}function i(v,j){var o=jQuery.extend(true,{},v);d.forEach(function(p){delete o[p];e(o,p.split("."));});return o;}return{sanitize:i,modify:function(p,k,j){var m=k.split("."),N=p;while(m.length>1&&N.hasOwnProperty(m[0])){N=N[m.shift()];}var o=m[0];if(m.length===1&&N.hasOwnProperty(o)){N[o]=j(N[o]);}}};})();z.prototype.setVizProperties=function(v){v=E.sanitize(v);this.setProperty("vizProperties",v);this._oLegendtitle=v.legend?v.legend.title:null;if(v.plotArea){if(v.plotArea.dataPointStyle){this._oDataPointStyle=v.plotArea.dataPointStyle;this._invalidateBy({source:this,keys:{loopData:true}});}if(v.plotArea.seriesStyle){this._oSeriesStyle=v.plotArea.seriesStyle;}}if(this._getVizFrame()){this._getVizFrame().setVizProperties(this._getEffectiveProperties());}};z.prototype.getVizProperties=function(){var o=this._getVizFrame();var d=E.sanitize(o?o.getVizProperties():this.getProperty("vizProperties"));function e(i){var j=sap.viz.api.env.Format.numericFormatter();if(!j||jQuery.type(j.stripUnit)!=="function"){return i;}if(jQuery.type(i)==="string"){return j.stripUnit(i);}else if(jQuery.type(i)==="object"){jQuery.each(i,function(k,v){i[k]=j.stripUnit(v);});return i;}else{return i;}}E.modify(d,"plotArea.dataLabel.formatString",e);E.modify(d,"tooltip.formatString",e);return d;};z.prototype.setVizScales=function(v){this.setProperty("vizScales",v);this._oVizColorScale=v.filter(function(o){return o.feed==="color";})[0];if(this._getVizFrame()){this._getVizFrame().setVizScales(v);}};z.prototype.getVizScales=function(){var v=this._getVizFrame();return v?v.getVizScales():this.getProperty("vizScales");};z.prototype.getVizUid=function(){return this._getVizFrame().getVizUid();};z.prototype.zoom=function(o){this._getVizFrame().zoom(o);};var G=["selectData","deselectData"];z.prototype._delegateEvents=function(){if(this._delegateEventHandlers){return;}var v=this._getVizFrame();this._delegateEventHandlers=G.map(function(e){var N=e.charAt(0).toUpperCase()+e.slice(1);var d=function(o){var p=o.getParameters();this._buildSelectEventData(p.data);delete p.id;this.fireEvent(e,p);};d=d.bind(this);v["attach"+N](null,d);return{name:N,handler:d};},this);this._vizFrameRenderCompleteHandler=K.bind(this);v.attachRenderComplete(null,this._vizFrameRenderCompleteHandler);};z.getChartTypes=sap.chart.api.getChartTypes;z.prototype.getAvailableChartTypes=function(){var d=this._getVisibleDimensions(true),m=this._getVisibleMeasures(true);return C.CONFIG.chartTypes.reduce(function(o,e){var i=R.compatible(e,d,m);if(i.compatible){o.available.push({chart:e});}else{var j={};if(i.error.missing.dim){j.Dimension=i.error.missing.dim;}if(i.error.missing.time){j.DateTimeDimension=i.error.missing.time;}if(i.error.missing.msr){j.Measure=i.error.missing.msr;}o.unavailable.push({chart:e,error:j});}return o;},{available:[],unavailable:[]});};z.prototype._getEffectiveProperties=function(){var v={};if(this._bNeedToApplyDefaultProperties){v=jQuery.extend(true,v,this._getDefaultVizProperties());this._bNeedToApplyDefaultProperties=false;}v=jQuery.extend(true,v,n.getSemanticVizProperties(this._sAdapteredChartType,this._semanticTuples),this._oColoringsDataPointStyle,this.getProperty("vizProperties"),this._getHostedVizProperties(),this._getPagingVizProperties(),this._getTimeProperties());return v;};z.prototype._setEffectiveScales=function(){var v=this._getVizFrame();if(this._oColoringScale){v.setVizScales([this._oColoringScale]);}};z.prototype._usingDisplayNameForSemantics=function(v){var d=function(o){if((typeof(o)==='undefined')||(o===null)){return false;}return true;};if(v.plotArea&&v.plotArea.dataPointStyle&&v.plotArea.dataPointStyle.rules){var e=this._getContexts();if(e.length>0&&!e.hasOwnProperty("dataRequested")){var k=this.getVisibleDimensions(),m=v.plotArea.dataPointStyle.rules;for(var i=0;i<m.length;i++){var p=m[i].dataContext;if(p&&p.length!==0){var L=Object.keys(p);if(!d(m[i].displayName)&&L.length===1){var N=L[0];if(p[N].hasOwnProperty("equal")&&k.indexOf(N)!==-1){var Q=this.getDimensionByName(N).getTextProperty();for(var j=0;j<e.length;j++){if(e[j].getProperty(N)===p[N].equal){var U=e[j].getProperty(Q);if(!d(Q)||!d(U)||typeof(U)==="object"||this.getDimensionByName(N).getDisplayText()===false){m[i].displayName=p[N].equal;break;}else{m[i].displayName=U;break;}}}}}}}}}};z.prototype._getCandidateColoringSetting=function(){if(!this._bColoringParsed){this._bColoringParsed=true;this._oCandidateColoringSetting={};var o=this.getColorings();var d=this.getActiveColoring();var m=this._normalizeDorM(this.getVisibleMeasures());var i=this._normalizeDorM(this.getVisibleDimensions(),true);var j=this._normalizeDorM(this.getInResultDimensions(),true);if(o){try{var U=jQuery.sap.getResourcePath("sap/chart/i18n/i18n.properties");var k=jQuery.sap.resources({url:U});this._oCandidateColoringSetting=w.getCandidateSetting(o,d,m,i,j,this._oColoringStatus||{},this.getChartType(),k);}catch(e){if(e instanceof x){e.display();}else{throw e;}}}}return this._oCandidateColoringSetting;};z.prototype._hostedVizProperties={selectionMode:{prop:"interaction.selectability.mode"},selectionBehavior:{prop:"interaction.selectability.behavior"}};z.prototype._getHostedVizProperties=function(){return Object.keys(this._hostedVizProperties).reduce(function(o,p){var d=this._hostedVizProperties[p].prop.split(".").reverse().reduce(function(o,e){var i={};i[e]=o;return i;},this.getProperty(p));return jQuery.extend(true,o,d);}.bind(this),{});};var H="__UI5__ShortIntegerMaxFraction10";var I="__UI5__FloatMaxFraction2";var J="__UI5__ShortIntegerMaxFraction2";z.prototype._getDefaultVizProperties=function(){var d='info/'+(this._sAdapteredChartType||this.getChartType());var i=(d.indexOf("info/100_")===0);var j=(d==="info/pie"||d==="info/donut");var o={interaction:{extraEventInfo:true}};return jQuery.extend(true,o,v({},d,["valueAxis.label.formatString","valueAxis2.label.formatString"],i?'':H),v({},d,["legend.formatString","sizeLegend.formatString"],J),v({},d,["plotArea.dataLabel.formatString"],j?'':J),v({},d,["tooltip.formatString"],i?'':I));function k(e,L,N){if(L.length===0){return N;}e=e||{};var p=e[L[0]];e[L[0]]=k(p,L.slice(1),N);return e;}function m(p,L){if(p==null||L.legnth===0){return p;}var e=p[L[0]];if(e&&e.children){return m(e.children,L.slice(1));}return e;}function v(e,L,N,Q){var U=sap.viz.api.metadata.Viz.get(L);if(U){var W=U.properties;N.forEach(function(X){X=X.split(".");var p=m(W,X);if(p&&p.hasOwnProperty("defaultValue")){k(e,X,Q);}});}return e;}};z.prototype._getPagingVizProperties=function(){if(this._isEnablePaging()){var p={interaction:{zoom:{enablement:false},selectability:{mode:"NONE"}},plotArea:{isFixedDataPointSize:true}};return p;}else{return{};}};z.prototype._getTimeProperties=function(){var d=["year","month","day"];var o=null;var e=this;var i=this.getVisibleDimensions().filter(function(m){var v=e.getDimensionByName(m);return(v instanceof sap.chart.data.TimeDimension&&v._getFixedRole()==="category");})[0];if(i){var j=this.getDimensionByName(i);switch(j.getTimeUnit()){case u.yearmonthday:d=["year","month","day"];break;case u.yearquarter:d=["year","quarter"];break;case u.yearmonth:d=["year","month"];break;case u.fiscalyear:d=["fiscal_year"];break;case u.fiscalyearperiod:d=["fiscal_period","fiscal_year"];break;default:}o=j.getFiscalYearPeriodCount();}var p=this.getProperty("vizProperties");if(p&&p.timeAxis){var k=p.timeAxis;if(k.levels){d=k.levels;}if(k.fiscal&&k.fiscal.periodNumbers){o=k.fiscal.periodNumbers;}}return{"timeAxis":{"levels":d,"fiscal":{"periodNumbers":o}}};};z.prototype.setSelectionMode=function(v){this.setProperty("selectionMode",v);var o=this._getVizFrame();if(o){o.setVizProperties({interaction:{selectability:{mode:v}}});}return this;};z.prototype.getSelectionMode=function(){var v=this._getVizFrame();if(v){return v.getVizProperties().interaction.selectability.mode;}else{return this.getProperty("selectionMode");}};z.prototype.setSelectionBehavior=function(v){this.setProperty("selectionBehavior",v);var o=this._getVizFrame();if(o){o.setVizProperties({interaction:{selectability:{behavior:v}}});}return this;};z.prototype.getSelectionBehavior=function(){var v=this._getVizFrame();if(v){return v.getVizProperties().interaction.selectability.behavior;}else{return this.getProperty("selectionBehavior");}};z.prototype.getDimensionByName=function(N){return this.getDimensions().filter(function(d){return d.getName()===N;})[0];};z.prototype.getMeasureByName=function(N){return this.getMeasures().filter(function(m){return m.getName()===N;})[0];};z.prototype.getTimeDimensions=function(){return this.getDimensions().filter(function(d){return d instanceof T;});};z.prototype._isEnablePaging=function(){this._bMobile=sap.ui.Device.system.tablet||sap.ui.Device.system.phone;var d=this.getEnablePagination()&&this._bIsPagingChartType&&!this._bMobile;return d;};function K(e){var p=e.getParameters();delete p.id;if(this._isEnablePaging()){this._getPagingController().vizFrameRenderCompleted();}this.fireEvent("renderComplete",p);}z.prototype._showLoading=function(L){var $=this.$();if(!$){return;}if(!L){if(this._$loadingIndicator){this._$loadingIndicator.remove();}}else{if(!this._$loadingIndicator){this._$loadingIndicator=this._createLoadingIndicator();}this._updateLoadingIndicator();$.append(this._$loadingIndicator);}this._bLoading=L;};z.prototype._createLoadingIndicator=function(){var $=jQuery(sap.ui.core.BusyIndicatorUtils.getElement());var d=jQuery("<p>").attr("class","loading-text").text("Loading");d.css({"position":"absolute","transform":"translateY(-3em)","width":"100%","text-align":"center"});d.insertBefore($.children()[0]);$.css({opacity:1});return $;};z.prototype._updateLoadingIndicator=function(){var $=this.$();if(!$||!this._$loadingIndicator){return;}var d=this._sAdapteredChartType,e=d==="bar"||d.indexOf("horizontal")!==-1;var i=$.find(".v-plot-bound"),o=$.offset(),p={top:o.top,left:o.left,width:$.width(),height:$.height()};if(i.length){var j=i.offset(),k=i[0].getBoundingClientRect();p.top=j.top-1;p.left=j.left;p.width=k.width+1;if(e){p.height=Math.ceil(k.height+1);}else{p.height=Math.floor(k.height+1);}}this._$loadingIndicator.css(p);var m=this._$loadingIndicator.find(".loading-text");m.css({"top":p.height/2,"font-weight":sap.ui.core.theming.Parameters.get("sapUiChartTitleFontWeight"),"font-size":sap.ui.core.theming.Parameters.get("sapUiChartMainTitleFontSize"),"color":sap.ui.core.theming.Parameters.get("sapUiChartMainTitleFontSize")});this._$loadingIndicator.css({"background-color":sap.ui.core.theming.Parameters.get("sapUiExtraLightBG")});};z.prototype._getRequiredDimensions=function(){var v=this._getVisibleDimensions(),i=this.getInResultDimensions();return this._normalizeDorM(v.concat(i),true);};z.prototype._getRequiredMeasures=function(){return this._getVisibleMeasures(true);};z.prototype.exportToSVGString=function(o){var d="<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\" height=\"100%\"/>",v=this._getVizFrame();if(v){d=v.exportToSVGString(o);}return d;};z.prototype._getPagingController=function(){if(!this._pagingController){this._pagingController=new P(this);}return this._pagingController;};return z;});};
