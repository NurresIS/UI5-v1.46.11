jQuery.sap.declare('sap.suite.ui.generic.template.library-all');if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.P13nDimMeasurePanelExt')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.P13nDimMeasurePanelExt');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.m.library');jQuery.sap.require('sap.m.P13nDimMeasurePanel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/P13nDimMeasurePanelExt",["jquery.sap.global","sap/m/library","sap/m/P13nDimMeasurePanel"],function(q,l,P){"use strict";var a=P.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.P13nDimMeasurePanelExt",{renderer:{}});a.prototype._includeModelItem=function(i,I){if(I<0){I=this._oTable.getItems().length;}var g=function(){return[{key:"row",text:"Row"},{key:"column",text:"Column"}];};var m={columnKey:i.getColumnKey(),visible:true,text:i.getText(),tooltip:i.getTooltip(),aggregationRole:i.getAggregationRole(),availableRoleTypes:g(),persistentIndex:-1,persistentSelected:undefined,role:undefined,tableIndex:undefined};var M=this.getModel("$sapmP13nDimMeasurePanel");M.getData().items.splice(I,0,m);};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.SmartFilterBarExt')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.SmartFilterBarExt');jQuery.sap.require('sap.ui.comp.smartfilterbar.SmartFilterBar');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.m.SegmentedButtonItem');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/SmartFilterBarExt",["sap/ui/comp/smartfilterbar/SmartFilterBar","sap/m/SegmentedButton","sap/m/SegmentedButtonItem"],function(S,a,b){"use strict";var F="compact";var c=S.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.SmartFilterBarExt",{metadata:{properties:{mode:{type:"string",group:"Misc",defaultValue:F},smartVisualFilterBarId:{type:"string",group:"Misc",defaultValue:null},hideVisualFilter:{type:"boolean",group:"Misc",defaultValue:null}},events:{switchToVisualFilter:{}}},renderer:{}});c.prototype.setMode=function(m){this.setProperty("mode",m);};c.prototype.getFilterCount=function(){var f=S.prototype.retrieveFiltersWithValues.apply(this,arguments);return f?f.length:0;};c.prototype._getView=function(){if(this._view)return this._view;var p=this.getParent();while(p){if(p instanceof sap.ui.core.mvc.View){this._view=p;break;}p=p.getParent();}return this._view;};c.prototype._createFilters=function(){var f=S.prototype._createFilters.apply(this,arguments);if(this.getHideVisualFilter()===false){var d=[new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-fields",width:"inherit",key:"compact",tooltip:"{i18n>FILTER_COMPACT}"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-analytics",width:"inherit",key:"visual",tooltip:"{i18n>FILTER_VISUAL}"})];var e=new a({width:"inherit",selectedKey:"compact",items:d});e.attachSelect(function(){var i=this.verifySearchAllowed();if(i.hasOwnProperty("pending")||i.hasOwnProperty("error")||i.hasOwnProperty("mandatory")){e.setSelectedKey("compact");}else{this._searchRequested(f);this.fireSwitchToVisualFilter();}}.bind(this));var t=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,content:[new sap.m.ToolbarSpacer(),e]}).addStyleClass("alpFilterDialogToolbar");f.setToolbar(t);}return f;};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItem')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItem');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.model.Filter');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItem",["sap/ui/core/Control","sap/ui/model/Filter"],function(C){"use strict";var F=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItem",{metadata:{properties:{filterRestriction:{type:"string",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null},dimensionField:{type:"string",group:"Misc",defaultValue:null},dimensionFieldIsDateTime:{type:"boolean",group:"Misc",defaultValue:false},dimensionFieldDisplay:{type:"string",group:"Misc",defaultValue:null},dimensionFilter:{type:"object[]",group:"Misc",defaultValue:null},dimensionFilterExternal:{type:"sap.ui.model.Filter",group:"Misc",defaultValue:null},measureField:{type:"string",group:"Misc",defaultValue:null},measureSortDescending:{type:"boolean",group:"Misc",defaultValue:false},unitField:{type:"string",group:"Misc",defaultValue:null},isCurrency:{type:"boolean",group:"Misc",defaultValue:false},isMandatory:{type:"boolean",group:"Misc",defaultValue:false},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:""},outParameter:{type:"string",group:"Misc",defaultValue:null},inParameters:{type:"object[]",group:"Misc",defaultValue:null},parentProperty:{type:"string",group:"Misc",defaultValue:null},sortOrder:{type:"object[]",group:"Misc",defaultValue:null},scaleFactor:{type:"string",group:"Misc",defaultValue:null}},aggregations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{filterChange:{},titleChange:{}}},renderer:{}});return F;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChart')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChart');jQuery.sap.require('sap.viz.ui5.controls.VizFrame');jQuery.sap.require('sap.viz.ui5.format.ChartFormatter');jQuery.sap.require('sap.viz.ui5.api.env.Format');jQuery.sap.require('sap.ui.model.Sorter');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChart",["sap/viz/ui5/controls/VizFrame","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItem","sap/ui/model/Sorter"],function(V,C,F,a,S){"use strict";var b=a.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChart",{metadata:{aggregations:{control:{type:"sap.viz.ui5.controls.VizFrame",multiple:false}}},renderer:function(r,c){r.renderControl(c.getAggregation("control"));if(c._multiUnit){var o=c.getIsCurrency()?c.getModel("i18n").getResourceBundle().getText("MULTIPLE_CURRENCY_OVERLAY_MESSAGE"):c.getModel("i18n").getResourceBundle().getText("MULTIPLE_UNIT_OVERLAY_MESSAGE");r.write('<div class = "sapUiOverlay alpVFOverflow"');r.addStyle("width",c._chart.getWidth());r.addStyle("height",String(parseFloat(c.getHeight())-0.25)+"rem");r.writeStyles();r.write('>');r.write('<Label>'+o+'</Label>');r.write('</div>');}}});b.prototype._formattingId="__UI5__ShortIntegerMaxFraction2";b.prototype._maxFractionalDigits=1;b.prototype._maxFractionalDigitsValsLessThanZero=7;b.prototype._minFractionalDigits=1;b.prototype._shortRefNumber=undefined;b.prototype._thousandsRefNumber=undefined;b.prototype._isTriggeredBySync=false;b.prototype._multiUnit=false;b.prototype.init=function(){this._registerChartFormatters();this._attachChartEvents();};b._getSorter=function(s){var c=[],d=[],e=[];for(var i=0;i<s.length;i++){c[i]=s[i].Field.String;d[i]=s[i].Descending.Boolean;e.push(new S(c[i],d[i]));}var o={sorter:e,sortFields:c};return o;};b.prototype._getNumberFormatter=function(s,m){var f=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short",minFractionDigits:this._minFractionalDigits,maxFractionDigits:m,showScale:s,shortRefNumber:this._shortRefNumber});return f;};b.prototype._registerChartFormatters=function(){var c=C.getInstance();var m=this;c.registerCustomFormatter(this._formattingId,function(v){var d=m._maxFractionalDigits;var s=Math.abs(v)/m._thousandsRefNumber;if(m._thousandsRefNumber!=undefined&&s<1){var i=0;for(;i<m._maxFractionalDigitsValsLessThanZero&&s<1;i++)s*=10;d=i;}var f=m._getNumberFormatter(false,d);return f.format(v);});F.numericFormatter(c);};b.prototype._attachChartEvents=function(){if(this._chart.onAfterRendering){var o=this._chart.onAfterRendering;var m=this;this._chart.onAfterRendering=function(){m._registerChartFormatters();o.apply(this,arguments);m._applyDimensionFilter();m._chart.setBusy(false);m.rerender();};}this._chart.attachSelectData(this._onChartSelectData,this);this._chart.attachDeselectData(this._onChartDeselectData,this);};b.prototype.setWidth=function(w){this.setProperty("width",w);this._chart.setWidth(w);};b.prototype.setHeight=function(h){this.setProperty("height",h);this._chart.setHeight(h);};b.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._updateBinding();};b.prototype.setDimensionField=function(d){this.setProperty("dimensionField",d);this._updateBinding();};b.prototype.setDimensionFieldIsDateTime=function(d){this._isDateTimeChanged=this.getDimensionFieldIsDateTime()!=d;this.setProperty("dimensionFieldIsDateTime",d);this._updateBinding();this._isDateTimeChanged=false;};b.prototype.setDimensionFieldDisplay=function(d){this.setProperty("dimensionFieldDisplay",d);this._updateBinding();};b.prototype.setMeasureField=function(m){this.setProperty("measureField",m);this._updateBinding();};b.prototype.setMeasureSortDescending=function(m){this.setProperty("measureSortDescending",m);this._updateBinding();};b.prototype.setUnitField=function(u){this.setProperty("unitField",u);this._updateBinding();};b.prototype.setSortOrder=function(s){this.setProperty("sortOrder",s);this._updateBinding();};b.prototype.setDimensionFilterExternal=function(f,i){this.setProperty("dimensionFilterExternal",f);if(!this._isTriggeredBySync){this._isTriggeredBySync=(i!=undefined&&i);}this._updateBinding();};b.prototype._onChartSelectData=function(e){var d=this.getDimensionFilter(),c=e.getParameter("data");if(this._ignoreNextSelectionChange){this._ignoreNextSelectionChange=false;return;}var f=this.getDimensionFieldDisplay();var g=this.getFilterRestriction();var d=this.getDimensionFilter();var h=this.getDimensionFieldIsDateTime();if(!d||g=="single"){d=[];}var j=function(l){return l.dimValue===this;};for(var i=0;i<c.length;i++){var k=c[i].data;var v=d.filter(j,k[f]);if(v.length===0){d.push({dimValue:k[f],dimValueDisplay:h?k[f+".d"].toUTCString():k[f+".d"]});}}this.setProperty("dimensionFilter",d);this.fireFilterChange({filterList:d,property:this.getParentProperty(),filterRestriction:g});};b.prototype._onChartDeselectData=function(e){if(this._ignoreNextSelectionChange){this._ignoreNextSelectionChange=false;return;}var d=this.getDimensionFieldDisplay();var v=[];var c=e.getParameter("data");for(var i=0;i<c.length;i++){var f=c[i].data;v.push({dimValue:f[d],dimValueDisplay:f[d+".d"]});}var g=this.getDimensionFilter();if(!g)g=[];for(var i=0;i<v.length;i++){var h=v[i].dimValue;for(var j=0;j<g.length;j++){if(h==g[j].dimValue)g.splice(j,1);}}this.setProperty("dimensionFilter",g);this.fireFilterChange({filterList:g,property:this.getParentProperty(),filterRestriction:this.getFilterRestriction(),removeGlobalFilter:this.getOutParameter(),removeGlobalFilterValue:f[d]});};b.prototype.getP13NConfig=function(){var p=["width","height","filterRestriction","sortOrder","scaleFactor","entitySet","dimensionField","dimensionFieldDisplay","dimensionFieldIsDateTime","dimensionFilter","measureField","measureSortDescending","unitField","isCurrency","isMandatory","outParameter","inParameters","parentProperty"];var c={};for(var i=0;i<p.length;i++){var n=p[i];c[n]=this.getProperty(n);if((n=='outParameter'||n=='inParameters')&&c[n]==""){c[n]=undefined;}}return c;};b.prototype.setDimensionFilter=function(d){this.setProperty("dimensionFilter",d);this._applyDimensionFilter();};b.prototype._applyDimensionFilter=function(){var p=[];var d=this.getDimensionFilter();if(d){this._ignoreNextSelectionChange=this._ignoreNextSelectionChange||d.length>0;var c=this.getDimensionFieldDisplay();for(var i=0;i<d.length;i++){var e={};e[c]=d[i].dimValue;p.push({data:e});}}this._chart.vizSelection(p,{});var f=this._chart.vizSelection();if(this._ignoreNextSelectionChange===true&&(f&&f.length===0)&&d.length>0){this._ignoreNextSelectionChange=false;}};b.prototype._onDataReceived=function(e){var d=e.getParameter("data");if(!d||!d.results)return;if(this.getControl().getVizType()!="donut"){this._determineUnit(d.results);var m=this.getMeasureField();var c=null;var f=null;for(var i=0;i<d.results.length;i++){var v=Math.abs(parseFloat(d.results[i][m]));c=i==0?v:Math.min(c,v);f=i==0?v:Math.max(f,v);}if(!c)c=0;if(!f)f=0;this._applyMinMaxValue(c,f);}};b.prototype._determineUnit=function(d){var u=this.getUnitField();if(u){var p="";this._multiUnit=false;for(var i=0;i<d.length;i++){if(d[i]["__IS_OTHER__"]!==true){var c=d[i][u];}if(!c||(p&&c!=p)){if(d.length>1){this._multiUnit=true;}break;}p=c;}var t=this.getModel("_templPriv");var e=t.getProperty("/alp/visualFilter/"+this.getParentProperty());if(!e){e={hasMultiUnit:this._multiUnit};}else{e.hasMultiUnit=this._multiUnit;}t.setProperty("/alp/visualFilter/"+this.getParentProperty(),e);this._applyUnitValue(this._multiUnit?"":p);}else{this._applyUnitValue("");}};b.prototype._applyUnitValue=function(v){if(this._lastUnitValue!=v){this._lastUnitValue=v;this.fireTitleChange();}};b.prototype._applyMinMaxValue=function(m,c){if(this._lastMinValue!=m||this._lastMaxValue!=c){this._lastMinValue=m;this._lastMaxValue=c;this._scaleValue="";this._shortRefNumber=undefined;var d=Math.max(Math.abs(m),Math.abs(c));if(d){var s=this.getScaleFactor()?this.getScaleFactor():this._getScaleFactor(d);this._shortRefNumber=s;this._determineThousandsRefNumber(s);var f=this._getNumberFormatter(true,this.maxFractionalDigits);this._scaleValue=f.getScale()?f.getScale():"";}this.fireTitleChange();}};b.prototype._determineThousandsRefNumber=function(s){var c=s;if(s>=1000){var t=0;while(c>=1000){c/=1000;t++;}this._thousandsRefNumber=t==0?undefined:t*1000;}else{this._thousandsRefNumber=undefined;}};b.prototype._getScaleFactor=function(v){var v=parseFloat(v);var p=this._minFractionalDigits;for(var i=0;i<14;i++){var s=Math.pow(10,i);if(Math.round(Math.abs(v)/s,p-1)<10)return s;}return undefined;};b.prototype.rerender=function(){if(this._multiUnit&&!this._chart.$().has("div.sapUiOverlay.alpVFOverflow").length){var o=this.getIsCurrency()?this.getModel("i18n").getResourceBundle().getText("MULTIPLE_CURRENCY_OVERLAY_MESSAGE"):this.getModel("i18n").getResourceBundle().getText("MULTIPLE_UNIT_OVERLAY_MESSAGE");var $=jQuery("<Label>").text(o);var c=jQuery("<div></div>").addClass("sapUiOverlay alpVFOverflow").css({"height":String(parseFloat(this._chart.getHeight())-0.25)+"rem","width":this._chart.getWidth()});this._chart.$().append(c.append($));}};b.prototype.getTitle=function(){var m=this.getModel();if(!m)return"";var c="/"+this.getEntitySet()+"/";var d=m.getData(c+this.getMeasureField()+"/#@sap:label");if(d===undefined){d=this.getMeasureField();}var e=m.getData(c+this.getDimensionField()+"/#@sap:label");if(e===undefined){e=this.getDimensionField();}var u=this._lastUnitValue?this._lastUnitValue:"";var s=this._scaleValue?this._scaleValue:"";var i=this.getModel("i18n");if(!i)return"";var r=i.getResourceBundle();var t="";if(s&&u)t=r.getText("VIS_FILTER_TITLE_MD_UNIT_CURR",[d,e,s,u]);else if(u)t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[d,e,u]);else if(s)t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[d,e,s]);else t=r.getText("VIS_FILTER_TITLE_MD",[d,e]);return t;};return b;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartBar')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartBar');jQuery.sap.require('sap.viz.ui5.controls.VizFrame');jQuery.sap.require('sap.viz.ui5.data.FlattenedDataset');jQuery.sap.require('sap.viz.ui5.data.DimensionDefinition');jQuery.sap.require('sap.viz.ui5.data.MeasureDefinition');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.FeedItem');jQuery.sap.require('sap.viz.ui5.format.ChartFormatter');jQuery.sap.require('sap.viz.ui5.api.env.Format');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChartBar",["sap/viz/ui5/controls/VizFrame","sap/viz/ui5/data/FlattenedDataset","sap/viz/ui5/data/DimensionDefinition","sap/viz/ui5/data/MeasureDefinition","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format","sap/ui/model/Sorter","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChart","sap/ui/model/json/JSONModel"],function(V,F,D,M,a,C,b,S,c,J){"use strict";var d=c.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartBar",{metadata:{properties:{labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3},fixedCount:{type:"int",defaultValue:3}},aggregations:{dataset:{type:"sap.viz.ui5.data.Dataset",multiple:false}}},renderer:{}});d.prototype.init=function(){this._chart=new V({vizType:"bar",legendVisible:false});this.setControl(this._chart);this._chart.setModel(new J());this._sorters=[];c.prototype.init.apply(this,arguments);};d.prototype._updateBinding=function(){this._chart.setBusy(true);var e=this.getEntitySet();var f=this.getDimensionField();var g=this.getDimensionFieldDisplay();var m=this.getMeasureField();var u=this.getUnitField();var h=this.getDimensionFilterExternal();var s=[],i=[];s=this.getSortOrder();var o=c._getSorter(s);this._sorters=o.sorter;i=o.sortFields;if(!e||!m||!f||!g)return;var v={general:{background:{color:"transparent"}},plotArea:{colorPalette:["#006ca7"],dataLabel:{formatString:this._formattingId,visible:true,position:"inside"},gridline:{visible:false},background:{color:"transparent"},gap:{barSpacing:0.5}},valueAxis:{visible:false},categoryAxis:{title:{visible:false},axisTick:{visible:false},axisLine:{visible:false},hoverShadow:{color:"transparent"},layout:{width:this.getLabelWidthPercent()}},tooltip:{visible:false},title:{visible:false},interaction:{selectability:{mode:"MULTIPLE"},enableDeselectAll:false}};if(JSON.stringify(v)!=JSON.stringify(this.lastVizProps))this._chart.setVizProperties(v);this.lastVizProps=v;var j=this._chart.getFeeds();var k=true;if(j&&j.length==2){var l=j[0];var n=j[1];k=l.getValues()!=g||n.getValues()!=m;}var p=[g],q=[m];if(k){this._chart.removeAllFeeds();this._chart.addFeed(new a({"uid":"categoryAxis","type":"Dimension","values":p}));this._chart.addFeed(new a({"uid":"valueAxis","type":"Measure","values":q}));}var r=[m,f,i];if(f!=g)r.push(g);if(u)r.push(u);var t=[];if(h&&h.aFilters&&h.aFilters.length>0)t=[h];this.setDataset(this._getDataSet(e,r,t,m,f,g));this._chart.setDataset(this._getChartDataSet(e,t,m,f,g));this._applyDimensionFilter();};d.prototype._getDataSet=function(e,s,f,m,g,h){var i=this;var j=this.getFixedCount();var k=new F({data:{path:"/"+e,startIndex:0,length:j,sorter:this._sorters,filters:f,parameters:{select:s.join(",")},events:{dataReceived:function(n){i._onDataReceived(n);}}},dimensions:new D({name:h,value:"{"+g+"}",displayValue:{parts:[h,m],formatter:function(n,o){var k=i.getDataset();if(!k)return"";var p=k.getBinding("data");if(!p)return"";p.getContexts(0,j);return"";}}}),measures:[new M({name:m,value:"{"+m+"}"})]});var l=k.getBinding("data");if(l)l.getContexts(0,j);return k;};d.prototype._getChartDataSet=function(e,f,m,g,h){var i=new F({data:{path:"/"+e},dimensions:new D({name:h,value:"{"+g+"}",displayValue:{parts:[h],formatter:function(j){var j=j instanceof Date?j.toDateString():j;return j&&typeof j=="string"&&j.indexOf("__DUMMY_")==0?"":j;}}}),measures:[new M({"name":m,"value":"{"+m+"}"})]});return i;};d.prototype._onDataReceived=function(e){var f=this.getDataset();if(!f)return;var g=this.getDimensionField();var h=this.getDimensionFieldDisplay();var p=[g,h,this.getMeasureField(),this.getUnitField()];var k=[];var l=this.getFixedCount();var m=f.getBinding("data").getContexts(0,l);for(var i=0;i<m.length;i++){var n=m[i];var r={};for(var j=0;j<p.length;j++){var o=p[j];r[o]=n.getObject(o);}k.push(r);}for(var i=m.length;i<l;i++){var r={};for(var j=0;j<p.length;j++){var o=p[j];r[o]="";}r[g]="__DUMMY_"+i;k.push(r);}var q={};var s=this.getEntitySet();q[s]=k;this._chart.setModel(new J(q));c.prototype._onDataReceived.apply(this,arguments);this._chart.rerender();};return d;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartDonut')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartDonut');jQuery.sap.require('sap.viz.ui5.controls.VizFrame');jQuery.sap.require('sap.viz.ui5.controls.VizFrameRenderer');jQuery.sap.require('sap.viz.ui5.data.FlattenedDataset');jQuery.sap.require('sap.viz.ui5.data.DimensionDefinition');jQuery.sap.require('sap.viz.ui5.data.MeasureDefinition');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.FeedItem');jQuery.sap.require('sap.viz.ui5.format.ChartFormatter');jQuery.sap.require('sap.viz.ui5.api.env.Format');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChartDonut",["sap/viz/ui5/controls/VizFrame","sap/viz/ui5/controls/VizFrameRenderer","sap/viz/ui5/data/FlattenedDataset","sap/viz/ui5/data/DimensionDefinition","sap/viz/ui5/data/MeasureDefinition","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format","sap/ui/model/Sorter","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChart","sap/ui/model/json/JSONModel"],function(V,a,F,D,M,b,C,c,S,d,J){"use strict";var e=d.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartDonut",{metadata:{properties:{labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/2}},aggregations:{dataset:{type:"sap.viz.ui5.data.Dataset",multiple:false},totalDataset:{type:"sap.viz.ui5.data.Dataset",multiple:false}}},renderer:{}});e.prototype.init=function(){this._chart=new V({vizType:"donut",legendVisible:false});this.setControl(this._chart);this._chart.setModel(new J());this._otherField="__IS_OTHER__";this._otherID="__OTHER__";this._measureScaledField="__MEASURE_SCALED__";this._percentField="__PERCENT__";this._sorters=[];d.prototype.init.apply(this,arguments);};e.prototype._updateBinding=function(){this._chart.setBusy(true);var f=this.getEntitySet();var g=this.getDimensionField();var h=this.getDimensionFieldDisplay();var m=this.getMeasureField();var u=this.getUnitField();var i=this.getDimensionFilterExternal();var s=[],j=[];s=this.getSortOrder();var o=d._getSorter(s);this._sorters=o.sorter;j=o.sortFields;if(!f||!m||!g||!h)return;var v={general:{layout:{paddingRight:10,padding:0},background:{color:"transparent"}},legend:{visible:true,itemMargin:1.5},legendGroup:{layout:{alignment:"center",width:((this.getLabelWidthPercent()*100)+"%")}},plotArea:{innerRadiusRatio:0.65,colorPalette:["#006ca7","#55A1C4","#8BBDD4"],background:{visible:false}},tooltip:{visible:false},title:{visible:false},interaction:{selectability:{mode:"MULTIPLE"},enableDeselectAll:false}};if(JSON.stringify(v)!=JSON.stringify(this.lastVizProps))this._chart.setVizProperties(v);this.lastVizProps=v;var k=this._chart.getFeeds();var l=true;if(k&&k.length==2){var n=k[0];var p=k[1];l=n.getValues()!=h||p.getValues()!=this._measureScaledField;}if(l){this._chart.removeAllFeeds();var q=[h],r=[this._measureScaledField];this._chart.addFeed(new b({"uid":"color","type":"Dimension","values":q}));this._chart.addFeed(new b({"uid":"size","type":"Measure","values":r}));}var t=[m,g,j];if(g!=h)t.push(h);if(u)t.push(u);var w=[];if(i&&i.aFilters&&i.aFilters.length>0)w=[i];this._totalReady=false;this.setDataset(this._getDataSet(f,t,w,m,g,h));this.setTotalDataset(this._getTotalDataSet(f,w,m,g,h));this._chart.setDataset(this._getChartDataSet(f,w,m,g,h));this._applyDimensionFilter();};e.prototype._getDataSet=function(f,s,g,m,h,i){var j=this;var k=4;var l=new F({data:{path:"/"+f,startIndex:0,length:k,sorter:this._sorters,filters:g,parameters:{select:s.join(",")},events:{dataReceived:function(o){j._topTwoReady=true;j._onDataReceived(o);}}},dimensions:new D({name:i,value:"{"+h+"}",displayValue:{parts:[i,m],formatter:function(o,p){var l=j.getDataset();if(!l)return"";var q=l.getBinding("data");if(!q)return"";q.getContexts(0,k);return"";}}}),measures:[new M({name:m,value:m})]});var n=l.getBinding("data");if(n)n.getContexts(0,k);return l;};e.prototype._getTotalDataSet=function(f,g,m,h,i){var j=this;var k=1;var t=new F({data:{path:"/"+f,startIndex:0,length:k,filters:g,parameters:{select:m},events:{dataReceived:function(n){j._onTotalReceived(n);}}},dimensions:new D({name:i,value:"{"+h+"}",displayValue:{parts:[i,m],formatter:function(n,o){var t=j.getTotalDataset();if(!t)return"";var p=t.getBinding("data");if(!p)return"";p.getContexts(0,k);return"";}}}),measures:[new M({name:m,value:m})]});var l=t.getBinding("data");if(l)l.getContexts(0,k);return t;};e.prototype._getChartDataSet=function(f,g,m,h,i){var j=this;var k=3;var l=new F({data:{path:"/"+f},dimensions:new D({name:i,value:"{"+h+"}",displayValue:{parts:[i,this._percentField],formatter:function(n,p){var l=j._chart.getDataset();if(!l)return"";var o=l.getBinding("data");if(!o)return"";o.getContexts(0,k);return n+": "+p+"%";}}}),measures:[new M({name:this._measureScaledField,value:{path:this._measureScaledField,formatter:function(v){return v;}}})]});return l;};e.prototype._getMaxScaleFactor=function(f,g){var m;for(var i=0;i<f.length;i++){var h=f[i];var v=Math.abs(parseFloat(h.getObject(g)));m=i==0?v:Math.max(m,v);}return this._getScaleFactor(m);};e.prototype._onDataReceived=function(f){if(f.getParameter('data').results.length===0){this._chart.setBusy(false);return;}if(!(this._totalReady&&this._topTwoReady))return;var g=this.getDataset();var t=this.getTotalDataset(t);if(!g||!t)return;var h=this.getDimensionField();var k=this.getDimensionFieldDisplay();var m=this.getMeasureField();var u=this.getUnitField();var p=[h,k,m,u];var l=[];var n=t.getBinding("data").getContexts(0,1);if(n.length!=1)return;var o=n[0];var q=g.getBinding("data").getContexts();var r=q.length>3?2:q.length;var s=parseFloat(o.getObject(m));var v=parseFloat(o.getObject(m));var w=0;for(var i=0;i<r;i++){var x=q[i];var y={};for(var j=0;j<p.length;j++){var z=p[j];y[z]=x.getObject(z);if(z==m){y[this._measureScaledField]=y[z];}}l.push(y);w+=parseFloat(y[this._measureScaledField]);s-=parseFloat(y[m]);}if(q.length>3){var A=this.getModel("i18n");var y={};y[this._otherField]=true;y[h]=this._otherID;y[k]=A?A.getResourceBundle().getText("VIS_FILTER_DONUT_OTHER"):"";y[m]=s;y[this._measureScaledField]=v-w;y[u]="";l.push(y);}var B=sap.ui.core.format.NumberFormat.getFloatInstance({style:"short",minFractionDigits:this._minFractionalDigits,maxFractionDigits:this._maxFractionalDigits});for(var i=0;i<l.length;i++){var E=l[i][this._measureScaledField]/v*100;l[i][this._percentField]=B.format(E);}if(l){this._determineUnit(l);}var G={};var H=this.getEntitySet();G[H]=l;this._chart.setModel(new J(G));d.prototype._onDataReceived.apply(this,arguments);this._totalReady=false;this._topTwoReady=false;this._chart.rerender();};e.prototype._getScaledValue=function(v,s,k){var f=this._maxFractionalDigits*10;var g=k?parseFloat(v):Math.abs(parseFloat(v));var h=Math.round(g*f/s)/f;return h;};e.prototype._onTotalReceived=function(f){this._totalReady=true;this._onDataReceived(f);};e.prototype._onChartSelectData=function(f){var g=this.getDimensionField();var s=this._chart.vizSelection();var h=this._chart.getDataset().getBinding("data");var r=false;var p=[];for(var i=0;i<s.length;i++){var j=s[i].data;var k=h.getContexts(j._context_row_number,1)[0].getObject();if(k[this._otherField]){r=true;s.splice(i,1);}else{var l={};l[g]=j[g];p.push({data:l});}}if(r){var m=this.getModel("i18n");var n=this.getDimensionFieldDisplay();var p=[];var l={};if(g===n){l[g]=m?m.getResourceBundle().getText("VIS_FILTER_DONUT_OTHER"):"";}else{l[n]=this._otherID;}p.push({data:l});this._ignoreNextSelectionChange=true;this._chart.vizSelection(p,{deselection:true});this._chart.rerender();}else{d.prototype._onChartSelectData.apply(this,arguments);}};return e;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartLine')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartLine');jQuery.sap.require('sap.viz.ui5.controls.VizFrame');jQuery.sap.require('sap.viz.ui5.controls.VizFrameRenderer');jQuery.sap.require('sap.viz.ui5.data.FlattenedDataset');jQuery.sap.require('sap.viz.ui5.data.DimensionDefinition');jQuery.sap.require('sap.viz.ui5.data.MeasureDefinition');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.FeedItem');jQuery.sap.require('sap.viz.ui5.format.ChartFormatter');jQuery.sap.require('sap.viz.ui5.api.env.Format');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChartLine",["sap/viz/ui5/controls/VizFrame","sap/viz/ui5/controls/VizFrameRenderer","sap/viz/ui5/data/FlattenedDataset","sap/viz/ui5/data/DimensionDefinition","sap/viz/ui5/data/MeasureDefinition","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/format/ChartFormatter","sap/viz/ui5/api/env/Format","sap/ui/model/Sorter","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemChart","sap/ui/model/json/JSONModel"],function(V,a,F,D,M,b,C,c,S,d,J){"use strict";var e=d.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartLine",{metadata:{properties:{labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3},fixedCount:{type:"int",defaultValue:6}},aggregations:{dataset:{type:"sap.viz.ui5.data.Dataset",multiple:false}}},renderer:{}});e.prototype.init=function(){this._chart=new V({vizType:"line",legendVisible:false});this.setControl(this._chart);this._chart.setModel(new J());this._generateFiller=true;this._sorters=[];d.prototype.init.apply(this,arguments);};e.prototype._updateBinding=function(){this._chart.setBusy(true);var f=this.getEntitySet();var g=this.getDimensionField();var h=this.getDimensionFieldDisplay();var i=this.getDimensionFieldIsDateTime();var m=this.getMeasureField();var u=this.getUnitField();var j=this.getDimensionFilterExternal();var s=[],k=[];s=this.getSortOrder();var o=d._getSorter(s);this._sorters=o.sorter;k=o.sortFields;if(!f||!m||!g||!h)return;var l=false;if(i&&this._chart.getVizType()!="timeseries_line"){this._chart=new V({vizType:"timeseries_line",legendVisible:false});l=true;}else if(!i&&this._chart.getVizType()!="line"){this._chart=new V({vizType:"line",legendVisible:false});l=true;}if(l){this.setControl(this._chart);this._chart.setWidth(this.getWidth());this._chart.setHeight(this.getHeight());this._attachChartEvents();}var v=this._getVizProps(i);if(l||JSON.stringify(v)!=JSON.stringify(this.lastVizProps))this._chart.setVizProperties(v);this.lastVizProps=v;var n=this._chart.getFeeds();var p=true;if(n&&n.length==2){var q=n[0];var r=n[1];p=q.getValues()!=h||r.getValues()!=m;}if(l||p){this._chart.removeAllFeeds();var t=[h],w=[m];this._chart.addFeed(new b({"uid":i?"timeAxis":"categoryAxis","type":"Dimension","values":t}));this._chart.addFeed(new b({"uid":"valueAxis","type":"Measure","values":w}));}var x=[m,g,k];if(g!=h)x.push(h);if(u)x.push(u);var y=[];if(j&&j.aFilters&&j.aFilters.length>0)y=[j];this.setDataset(this._getDataSet(f,x,y,m,g,h));this._chart.setDataset(this._getChartDataSet(f,y,m,g,h));this._applyDimensionFilter();};e.prototype._getVizProps=function(i){var v;if(i){v={general:{background:{color:"transparent"},layout:{padding:0}},plotArea:{colorPalette:["#006ca7"],dataLabel:{formatString:this._formattingId,visible:true},window:{start:"firstDataPoint",end:"lastDataPoint"},gridline:{visible:false},background:{color:"transparent"}},valueAxis:{visible:false},timeAxis:{title:{visible:false},axisTick:{visible:false},hoverShadow:{color:"transparent"},levels:["day","month"],levelConfig:{year:{visible:false}}},tooltip:{visible:false},title:{visible:false},interaction:{selectability:{mode:"MULTIPLE"},enableDeselectAll:false}};}else{v={general:{background:{color:"transparent"},layout:{padding:0}},plotArea:{colorPalette:["#006ca7"],dataLabel:{formatString:this._formattingId,visible:true,position:"inside"},gridline:{visible:false},background:{color:"transparent"}},valueAxis:{visible:false},categoryAxis:{title:{visible:false},axisTick:{visible:false},hoverShadow:{color:"transparent"},label:{angle:0,rotation:"auto"}},tooltip:{visible:false},title:{visible:false},interaction:{selectability:{mode:"MULTIPLE"},enableDeselectAll:false}};}return v;};e.prototype._getDataSet=function(f,s,g,m,h,i){var j=this;var k=this.getFixedCount();var l=this.getDimensionFieldIsDateTime();var n=new F({data:{path:"/"+f,startIndex:0,length:k,sorter:this._sorters,filters:g,parameters:{select:s.join(",")},events:{dataReceived:function(p){j._onDataReceived(p);}}},dimensions:new D({name:i,value:"{"+h+"}",displayValue:{parts:[i,m],formatter:function(p,q){var n=j.getDataset();if(!n)return"";var r=n.getBinding("data");if(!r)return"";r.getContexts(0,k);return"";}},dataType:l?"date":"string"}),measures:[new M({name:m,value:"{"+m+"}"})]});var o=n.getBinding("data");if(o)o.getContexts(0,k);return n;};e.prototype._getChartDataSet=function(f,g,m,h,i){var j=this.getDimensionFieldIsDateTime();var k=new F({data:{path:"/"+f},dimensions:new D({name:i,value:"{"+h+"}",displayValue:{parts:[i],formatter:function(l){return l&&typeof l=="string"&&l.indexOf("__DUMMY_")==0?"":l;}},dataType:j?"date":"string"}),measures:[new M({name:m,value:"{"+m+"}"})]});return k;};e.prototype._onDataReceived=function(f){var g=this.getDataset();if(!g)return;var p=this._propsToCopy();var h=[];var k=this.getFixedCount();var l=g.getBinding("data").getContexts(0,k);for(var i=0;i<l.length;i++){var m=l[i];var r={};for(var j=0;j<p.length;j++){var n=p[j];r[n]=m.getObject(n);}h.push(r);}if(this._generateFiller){if(this.getDimensionFieldIsDateTime())h=this._generateDateTimeFiller(l,h,k);else h=this._generateStringFiller(l,h,k);}this._adjustMinMax(h);var o={};var q=this.getEntitySet();o[q]=h;this._chart.setModel(new J(o));d.prototype._onDataReceived.apply(this,arguments);this._chart.rerender();};e.prototype._adjustMinMax=function(f){var m=this.getMeasureField();var g=0;var h=100;for(var i=0;i<f.length;i++){var r=f[i];var v=parseFloat(r[m]);if(isNaN(v))v=0;if(i==0){g=h=v;}else{g=Math.min(g,v);h=Math.max(h,v);}}var j=parseInt(this.getHeight(),10)*0.4;var k=h-g;var l=2;if(k!=0){var p=(j-2*l)/j;var n=(k-k*p)/2;g-=n;h+=n;}this._chart.setVizScales([{feed:"valueAxis",min:g,max:h}]);};e.prototype._propsToCopy=function(){var p=[this.getDimensionField(),this.getDimensionFieldDisplay(),this.getMeasureField(),this.getUnitField()];return p;};e.prototype._generateDateTimeFiller=function(f,g,h){var j=this.getDimensionField();var p=this._getPeriodIncrementFn();var k=[];k=g;var l=k[0][j];k.forEach(function(m){if((m[j].getUTCFullYear()>=l.getUTCFullYear())&&(m[j].getUTCMonth()>=l.getUTCMonth())&&(m[j].getUTCDate()>=l.getUTCDate())){l=m[j];}});for(var i=g.length;i<h;i++){var m=p.apply(this,[l,true,false]);k.push(this._createDummyRowDate(m));l=m;}return k;};e.prototype._createDummyRowDate=function(f){var p=this._propsToCopy();var g=this.getDimensionField();var h=this.getDimensionFieldDisplay();var m=this.getMeasureField();var r={};for(var j=0;j<p.length;j++){var i=p[j];r[i]="";}r[g]=f;r[h]=f;r[m]=null;return r;};e.prototype._getPeriodIncrementFn=function(){var f=this.getMeasureSortDescending();var g=function(h,o,H){var m=h.getTime();var i=(f?-1:1);if(o)i*=-1;m=m+i*(H?86400000/4:86400000);return new Date(m);};return g;};e.prototype._generateStringFiller=function(f,g,h){var p=this._propsToCopy();var k=this.getDimensionField();for(var i=f.length;i<h;i++){var r={};for(var j=0;j<p.length;j++){var l=p[j];r[l]="";}r[k]="__DUMMY_"+i;g.splice(0,0,r);}return g;};return e;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar');jQuery.sap.require('sap.suite.ui.microchart.InteractiveBarChart');jQuery.sap.require('sap.suite.ui.microchart.InteractiveBarChartBar');jQuery.sap.require('sap.viz.ui5.controls.common.feeds.FeedItem');jQuery.sap.require('sap.viz.ui5.data.FlattenedDataset');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.viz.ui5.data.DimensionDefinition');jQuery.sap.require('sap.viz.ui5.data.MeasureDefinition');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroBar",["sap/suite/ui/microchart/InteractiveBarChart","sap/suite/ui/microchart/InteractiveBarChartBar","sap/viz/ui5/controls/common/feeds/FeedItem","sap/viz/ui5/data/FlattenedDataset","sap/ui/model/Sorter","sap/viz/ui5/data/DimensionDefinition","sap/viz/ui5/data/MeasureDefinition"],function(I,a,F,b,S,D,M){"use strict";var c=I.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar",{metadata:{properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},dimensionField:{type:"string",group:"Misc",defaultValue:null},dimensionFieldIsDateTime:{type:"boolean",group:"Misc",defaultValue:false},dimensionFieldDisplay:{type:"string",group:"Misc",defaultValue:null},dimensionFilter:{type:"string[]",group:"Misc",defaultValue:null},dimensionFilterExternal:{type:"sap.ui.model.Filter",group:"Misc",defaultValue:null},measureField:{type:"string",group:"Misc",defaultValue:null},measureSortDescending:{type:"boolean",group:"Misc",defaultValue:false},unitField:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3}},aggregations:{control:{type:"sap.suite.ui.microchart.InteractiveBarChart",multiple:false}},events:{filterChange:{},unitChange:{}}},renderer:function(r,C){r.renderControl(C.getAggregation("control"));}});c.prototype.init=function(){var B=new a({label:"S/4 Hana Implementations",value:20});this._chart=new sap.suite.ui.microchart.InteractiveBarChart({maxDisplayedSegemnts:3,selectionEnabled:true,bars:[B.clone(),B.clone(),B.clone()],min:0,max:100});this.setControl(this._chart);this._attachChartEvents();};c.prototype._attachChartEvents=function(){if(this._chart.onAfterRendering){var o=this._chart.onAfterRendering;var m=this;this._chart.onAfterRendering=function(){o.apply(this,arguments);m._chart.setBusy(false);};}};c.prototype.setWidth=function(w){this.setProperty("width",w);};c.prototype.setHeight=function(h){this.setProperty("height",h);};c.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._updateBinding();};c.prototype.setDimensionField=function(d){this.setProperty("dimensionField",d);this._updateBinding();};c.prototype.setDimensionFieldIsDateTime=function(d){this._isDateTimeChanged=this.getDimensionFieldIsDateTime()!=d;this.setProperty("dimensionFieldIsDateTime",d);this._updateBinding();this._isDateTimeChanged=false;};c.prototype.setDimensionFieldDisplay=function(d){this.setProperty("dimensionFieldDisplay",d);this._updateBinding();};c.prototype.setMeasureField=function(m){this.setProperty("measureField",m);this._updateBinding();};c.prototype.setMeasureSortDescending=function(m){this.setProperty("measureSortDescending",m);this._updateBinding();};c.prototype.setUnitField=function(u){this.setProperty("unitField",u);this._updateBinding();};c.prototype.setDimensionFilterExternal=function(f){this.setProperty("dimensionFilterExternal",f);this._updateBinding();};c.prototype.getP13NConfig=function(){var p=["width","height","entitySet","dimensionField","dimensionFieldDisplay","dimensionFieldIsDateTime","dimensionFilter","measureField","measureSortDescending"];var d={};for(var i=0;i<p.length;i++){var n=p[i];d[n]=this.getProperty(n);}return d;};c.prototype.setDimensionFilter=function(d){this.setProperty("dimensionFilter",d);};c.prototype._updateBinding=function(){var e=this.getEntitySet();var d=this.getDimensionField();var f=this.getDimensionFieldDisplay();var m=this.getMeasureField();var u=this.getUnitField();var g=this.getDimensionFilterExternal();if(!e||!m||!d||!f)return;var h=this._chart.getFeeds();var i=true;if(h&&h.length==2){var j=h[0];var k=h[1];i=j.getValues()!=f||k.getValues()!=m;}if(i){this._chart.removeAllFeeds();this._chart.addFeed(new F({"uid":"categoryAxis","type":"Dimension","values":f}));this._chart.addFeed(new F({"uid":"valueAxis","type":"Measure","values":m}));}var s=[m,d];if(d!=f)s.push(f);if(u)s.push(u);var l=[];if(g&&g.aFilters&&g.aFilters.length>0)l=[g];var n=this;var o=3;var p=this.getMeasureSortDescending();var q={path:"/"+e,startIndex:0,length:o,sorter:new S(m,p),filters:l,parameters:{select:s.join(",")},events:{dataReceived:function(v){n._onDataReceived(v);}}};var r=new b({data:q,dimensions:new D({name:f,value:"{"+d+"}",displayValue:"{"+f+"}"}),measures:[new M({"name":m,"value":"{"+m+"}"})]});this._chart.setDataset(r);this._applyDimensionFilter();var t=r.getBinding("data");if(t)t.getContexts(0,o);this._chart.setBusy(true);};c.prototype._onDataReceived=function(e){var d=e.getParameter("data");var u=this.getUnitField();if(!d||!d.results||!u){this._applyUnitValue("");return;}var p="";for(var i=0;i<d.results.length;i++){var f=d.results[i][u];if(!f||(p&&f!=p)){this._applyUnitValue("");return;}p=f;}this._applyUnitValue(p);};c.prototype._applyUnitValue=function(v){if(this._lastUnit!=v){this._lastUnit=v;this.fireUnitChange({unitValue:v});}};return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut');jQuery.sap.require('sap.suite.ui.microchart.InteractiveDonutChart');jQuery.sap.require('sap.suite.ui.microchart.InteractiveDonutChartSegment');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroDonut",["sap/suite/ui/microchart/InteractiveDonutChart","sap/suite/ui/microchart/InteractiveDonutChartSegment"],function(I,a){"use strict";var F=I.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut",{metadata:{properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},dimensionField:{type:"string",group:"Misc",defaultValue:null},dimensionFieldIsDateTime:{type:"boolean",group:"Misc",defaultValue:false},dimensionFieldDisplay:{type:"string",group:"Misc",defaultValue:null},dimensionFilter:{type:"string[]",group:"Misc",defaultValue:null},dimensionFilterExternal:{type:"sap.ui.model.Filter",group:"Misc",defaultValue:null},measureField:{type:"string",group:"Misc",defaultValue:null},measureSortDescending:{type:"boolean",group:"Misc",defaultValue:false},unitField:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3}},aggregations:{control:{type:"sap.suite.ui.microchart.InteractiveDonutChart",multiple:false}},events:{filterChange:{},unitChange:{}}},renderer:function(r,c){r.renderControl(c.getAggregation("control"));}});F.prototype.init=function(){var s=new sap.suite.ui.microchart.InteractiveDonutChartSegment({label:"Phase 1",value:20});this._chart=new sap.suite.ui.microchart.InteractiveDonutChart({maxDisplayedSegemnts:3,selectionEnabled:true,segments:[s.clone(),s.clone(),s.clone().setLabel("others")]});this.setControl(this._chart);};F.prototype.setWidth=function(w){this.setProperty("width",w);};F.prototype.setHeight=function(h){this.setProperty("height",h);};return F;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine');jQuery.sap.require('sap.suite.ui.microchart.InteractiveLineChart');jQuery.sap.require('sap.suite.ui.microchart.InteractiveLineChartPoint');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroLine",["sap/suite/ui/microchart/InteractiveLineChart","sap/suite/ui/microchart/InteractiveLineChartPoint"],function(I,a){"use strict";var F=I.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine",{metadata:{properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},dimensionField:{type:"string",group:"Misc",defaultValue:null},dimensionFieldIsDateTime:{type:"boolean",group:"Misc",defaultValue:false},dimensionFieldDisplay:{type:"string",group:"Misc",defaultValue:null},dimensionFilter:{type:"string[]",group:"Misc",defaultValue:null},dimensionFilterExternal:{type:"sap.ui.model.Filter",group:"Misc",defaultValue:null},measureField:{type:"string",group:"Misc",defaultValue:null},measureSortDescending:{type:"boolean",group:"Misc",defaultValue:false},unitField:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3}},aggregations:{control:{type:"sap.suite.ui.microchart.InteractiveLineChart",multiple:false}},events:{filterChange:{},unitChange:{}}},renderer:function(r,c){r.renderControl(c.getAggregation("control"));}});F.prototype.init=function(){var p=new sap.suite.ui.microchart.InteractiveLineChartPoint({label:"May",value:40,unit:"%"});this._chart=new sap.suite.ui.microchart.InteractiveLineChart({maxDisplayedPoints:6,selectionEnabled:true,points:[p,p.clone(),p.clone(),p.clone(),p.clone(),p.clone()]});this.setControl(this._chart);};F.prototype.setWidth=function(w){this.setProperty("width",w);};F.prototype.setHeight=function(h){this.setProperty("height",h);};return F;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.DetailController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.DetailController');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.comp.personalization.Util');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.model.FilterType');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/DetailController",["sap/ui/base/EventProvider","sap/ui/comp/personalization/Util","sap/ui/table/AnalyticalTable","sap/ui/core/mvc/Controller","sap/ui/model/FilterType"],function(E,P,A,C,F){"use strict";var b=new E();var t=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.DetailController",{setState:function(s){var m=this;this.oState=s;this._enableExpandByFilter=true;this._enableUpdateExpandLevelInfo=false;this._isRebindTriggeredByChart=false;var a=this.oState.oSmartTable;var c=a.getTable();c.attachEvent("_rowsUpdated",function(e){m._updateRows("_rowsUpdated");});var o=this.oState.oController.getOwnerComponent();var T=this.oState.oController.getOwnerComponent().getModel("_templPriv");T.setProperty('/alp/autoHide',o.getAutoHide()?"filter":"highlight");a.attachInitialise(this._onSmartTableInit,this);a.attachBeforeRebindTable(this._onBeforeRebindTable,this);},_onSmartTableInit:function(){var s=this.oState.oSmartTable,a=s.getCustomToolbar(),T=a.getContent(),n;if(this.oState._pendingTableToolbarInit){a.insertContent(this.oState.alr_viewSwitchButtonOnTable,T.length);}if(this.oState._pendingTableToolbarInit){for(var i=0;i<T.length;i++){if(T[i].mProperties.text==="Settings"){n=i;}}a.insertContent(this.oState._autoHideToggleBtn,n);}delete this.oState._pendingTableToolbarInit;this.oState.oSmartTable.attachShowOverlay(function(e){this.oState.oSmartTable.getCustomToolbar().setEnabled(!e.getParameter("overlay").show);},this);},_onBindingDataReceived:function(){var a=this.oState.oSmartTable.getTable();if(a instanceof A){this._expandByFilter("bindingDataReceived");}if(!this.isFilter()){this._applyParamsToTableAsHighlight("bindingDataReceived");}},_onBeforeRebindTable:function(o){var v=this.oState.oSmartTable.fetchVariant(),l=v,c={};if(!v)return;if(this.isFilter())this._applyChartSelectionOnTableAsFilter(o);var g=[];var a=this.oState.oSmartTable.getTable().getColumns();for(var i=0;i<a.length;i++){var d=a[i];if(d.getGrouped&&d.getGrouped())g.push(d.getLeadingProperty?d.getLeadingProperty():P.getColumnKey(d));}this._updateExpandLevelInfo(g);var s=[];if(v.sort&&v.sort.sortItems){for(var i=0;i<v.sort.sortItems.length;i++){var f=v.sort.sortItems[i].operation==="Descending"?true:false;s.push(new sap.ui.model.Sorter(v.sort.sortItems[i].columnKey,f));}}else if(!l.sort){c.allTableSortRemoved=true;}this._isRebindTriggeredByChart=false;if(this.oState.oSmartFilterbar&&this.oState.oSmartFilterbar.getAnalyticBindingPath&&this.oState.oSmartFilterbar.getConsiderAnalyticalParameters()){try{var h=this.oState.oSmartFilterbar.getAnalyticBindingPath();if(h){this.oState.oSmartTable.setTableBindingPath(h);}}catch(e){jQuery.sap.log.warning("Mandatory parameters have no values","","AnalyticalListPage");}}this.oState.oController.onBeforeRebindTableExtension(o);},attachTableChange:function(d,f,l){return b.attachEvent("TableChange",d,f,l);},detachTableChange:function(f,l){return b.detachEvent("TableChange",f,l);},isFilter:function(){var T=this.oState.oController.getOwnerComponent().getModel("_templPriv");return T.getProperty("/alp/autoHide")==="filter";},applyParamsToTable:function(){this._isRebindTriggeredByChart=true;this.oState.oSmartTable.rebindTable();},_getBindingProperty:function(a,n){if(a.getProperty){return a.getProperty(n);}else{var p=a.oEntityType.property;for(var i=0;i<p.length;i++){if(p[i].name==n)return p[i];}return null;}},_isFilterDiff:function(f,a){if($.isArray(f)!=$.isArray(a))return true;if($.isArray(f))return this._isFilterListDiff(f,a);else return this._isFilterObjDiff(f,a);},_isFilterObjDiff:function(f,c){if(!f||!c)return true;for(var a in f){if(a=="aFilters"){if(this._isFilterListDiff(f.aFilters,c.aFilters))return true;}else if(f[a]!=c[a])return true;}return false;},_isFilterListDiff:function(l,L){if(!l||!L)return true;if(l.length!=L.length)return true;for(var i=0;i<l.length;i++){var f=l[i];var a=L[i];if(this._isFilterObjDiff(f,a))return true;}return false;},_getPageFilters:function(B){var p=this.oState.oSmartFilterbar.getFilters();for(var i=0;i<p.length;i++){if(p[i].aFilters!==undefined){var f=p[i].aFilters;for(var j=0;j<f.length;j++){var a=f[j];var n=a.sPath;if(!B.getProperty(n)){jQuery.sap.log.warning("Could not apply filter with name \""+n+"\" as that field does not exist in the entity type");continue;}a.sPath=n;}}else{var a=p[i];var n=a.sPath;if(!B.getProperty(n)){jQuery.sap.log.warning("Could not apply filter with name \""+n+"\" as that field does not exist in the entity type");continue;}a.sPath=n;}}return p;},_applyParamsToTableAsHighlight:function(u){if(!this.oState)return;var c=this.oState.oSmartChart.getChart();if(!c){return;}var p=this._getSelParamsFromChart(c);var d=c.getVisibleDimensions();var l=this.oState.oSmartChart._lastSelected;var a=this.oState.oSmartTable.getTable();var e=this._getTableBinding(a);if(!e){jQuery.sap.log.error("No table binding to apply the selection(s) to");return;}var f=[];for(var i=0;i<p.length;i++){var g=p[i];var h={};for(var n in g){if(d.indexOf(n)==-1||!this._getBindingProperty(e,n))continue;h[n]=g[n];}f.push(h);}var j=this.oState.oSmartChart.getDrillStackFilters();j.forEach(function(o){var n=o.sPath,m={};m[n]=o.oValue1;f.push(m);});var h={};f.forEach(function(o){for(var m in o){if(!h.hasOwnProperty(m)){h[m]=[o[m]];}else{h[m].push(o[m]);}}});if(!this._lastFilter){this._lastFilter=e.aApplicationFilter;}var k=this._getPageFilters(e);if(this._isFilterDiff(this._lastFilter,k)){e.filter(k,F.Application);this._lastFilter=k;}this._paramListFiltered=f;this._lastSelected=l;this._paramMap=h;this._updateRows(u);},_expandByFilter:function(u){if(!this._enableExpandByFilter)return;var a=this.oState.oSmartTable.getTable();var c=this._getTableBinding(a);if(c&&this._lastBinding!=c){var m=this;c.attachDataReceived(this._onBindingDataReceived,this);c.attachEvent("change",function(g){if(m._expandingProgrammatically)return;var h=g.getParameter("reason");if(h=="expand"||h=="collapse")m._inUserChartSelectMode=false;});this._lastBinding=c;}if(u=="selection"||u=="bindingDataReceived")this._firstVisibleRelevantEventTS=new Date().getTime();if(u=="selection")this._inUserChartSelectMode=true;if(!this._inUserChartSelectMode)return;var r=this._getTableRows();for(var i=0;i<r.length;i++){var d=r[i];var e=d.getBindingContext();if(!e)continue;var f=a.getFirstVisibleRow()+i;if(this._isRowHighlighted(e.getObject())){if(a.isExpanded(f))continue;if(!d._bHasChildren)continue;if(!c.findNode(f))continue;this._expandingProgrammatically=true;a.expand(f);this._expandingProgrammatically=false;}else{if(!a.isExpanded(f))continue;if(!d._bHasChildren)continue;if(!c.findNode(f))continue;this._expandingProgrammatically=true;a.collapse(f);this._expandingProgrammatically=false;}}this._updateFirstVisibleRow(u);},_updateFirstVisibleRow:function(u){var a=this.oState.oSmartTable.getTable();var c=this._getTableBinding(a);var d=c.getTotalSize();if(d==0||(new Date().getTime()-this._firstVisibleRelevantEventTS)>250)return;var a=this.oState.oSmartTable.getTable();if(u=="selection"&&(!this._paramListFiltered||this._paramListFiltered.length==0)){a.setFirstVisibleRow(0);return;}var e=c.getContexts(0,d);for(var i=0;i<e.length;i++){var r=e[i].getObject();if(!this._isRowHighlighted(r))continue;if(this._lastSelected&&!this._rowMatch(this._lastSelected,r))continue;var l=a.getFirstVisibleRow();if(u=="selection"||this.isFilter()){a.setFirstVisibleRow(i);}else{if(i>l)a.setFirstVisibleRow(i);}break;}},_rowMatch:function(s,r){for(var n in s){if(n.indexOf("__")!=-1)continue;if(!r.hasOwnProperty(n))continue;if(s[n]!=r[n])return false;}return true;},_updateExpandLevelInfo:function(g){if(!this._enableUpdateExpandLevelInfo)return false;var T=this.oState.oSmartTable.getTable();if(!T.getNumberOfExpandedLevels)return false;var B=T.getBinding();if(!B)return false;var e=g.length;var l=false;if(e>=B.aMaxAggregationLevel.length){l=true;e=B.aMaxAggregationLevel.length-1;this.wasAtMaxLevel=true;}else{l=T.getNumberOfExpandedLevels()!=e||this.wasAtMaxLevel;this.wasAtMaxLevel=false;}if(l){if(e>=0){T.setNumberOfExpandedLevels(e);T.bindRows(T.getBindingInfo("rows"));}var a=T.getGroupedColumns();T.fireGroup({column:a[0],groupedColumns:a,type:sap.ui.table.GroupEventType.group});}return l;},_updateRows:function(u){var c=this.oState.oSmartChart.getChart();var p=this._getSelParamsFromChart(c);this._latestUpdateRow(p.length);var a=this.oState.oSmartTable.getTable();if(a instanceof A){this._expandByFilter(u);}},_getTableRows:function(){var a=this.oState.oSmartTable.getTable();if(a.getRows)return a.getRows();else return a.getItems();},_isRowHighlighted:function(r){var p=this._paramMap;if(!p||jQuery.isEmptyObject(p))return false;var m=true;for(var n in p){if(!r.hasOwnProperty(n))continue;if(p[n].indexOf(r[n])==-1){m=false;}}return m;},_getTableBinding:function(a){return a.getBinding()?a.getBinding():a.getBinding("items");},_applyChartSelectionOnTableAsFilter:function(e){var f=this.oState.oSmartChart.getDrillStackFilters();e.mParameters.bindingParams.filters.push.apply(e.mParameters.bindingParams.filters,f);var c=this.oState.oSmartChart.getChart();if(!c){return;}var p=this._getSelParamsFromChart(c);if(p.length>0){var d=c.getVisibleDimensions();for(var i=0;i<p.length;i++){var a=p[i];for(var n in a){if(d.indexOf(n)==-1){jQuery.sap.log.warning("Could not apply filter with name \""+n+"\" as that field does not exist in the entity type");continue;}e.mParameters.bindingParams.filters.push(new sap.ui.model.Filter({path:n,operator:sap.ui.model.FilterOperator.EQ,value1:a[n]}));}}}this._latestUpdateRow(p.length);},_latestUpdateRow:function(p){var a=this.isFilter();var r=this._getTableRows();var c=false;for(var i=0;i<r.length;i++){var d=r[i];if(!a){if(d.getBindingContext()){var e=d.getBindingContext().getObject();c=this._isRowHighlighted(e);}}var f=d.getDomRefs?d.getDomRefs(true):d.getDomRef();if(!f)continue;if(f.row)f.row.toggleClass("alr_rowHighlighted",(a&&p)?a:c);else $(f).toggleClass("alr_rowHighlighted",(a&&p)?a:c);}},_getSelParamsFromChart:function(c){var d=[];if(c._getVizFrame().vizSelection())d=c.getSelectedDataPoints().dataPoints;return this._getSelParamsFromDPList(d);},_getSelParamsFromDPList:function(d){if(!d)return[];var p=[];for(var i=0;i<d.length;i++){var a=d[i];var c=a.context;if(!c)continue;var e=c.getProperty(c.sPath);var f={};if(this._selectFilterByMeasure){for(var j=0;j<a.measures.length;j++){var n=a.measures[j];var v=e[n];f[n]=v;}}else{for(var n in e)f[n]=e[n];}p.push(f);}return p;}});return t;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.SmartChartController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.SmartChartController');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.ToolbarDesign');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/SmartChartController",["sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/FlexItemData","sap/m/ToolbarDesign","sap/ui/core/mvc/Controller"],function(O,T,F,b,C){"use strict";var c=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.SmartChartController",{setState:function(s){this.triggeredByTableSort=false;this.tableSortSelection;this._selectFilterByMeasure=false;this.oState=s;s.oSmartChart.attachInitialise(this._onSmartChartInit,this);s.oSmartChart.attachBeforeRebindChart(this._onBeforeRebindChart,this);this.oState.attachSearchButtonPressed(this._onSearchButtonPressed,this);},_onBeforeRebindChart:function(E){if(this.triggeredByTableSort&&this.tableSortSelection){var v=this.oState.oSmartChart.fetchVariant();if(this.tableSortSelection.length>0){v.sort={};v.sort.sortItems=[];for(var i=0;i<(this.tableSortSelection.length);i++){E.mParameters.bindingParams.sorter.push(this.tableSortSelection[i]);v.sort.sortItems.push({columnKey:this.tableSortSelection[i].sPath,operation:this.tableSortSelection[i].bDescending?"Descending":"Ascending"});}}else{E.mParameters.bindingParams.sorter=this.tableSortSelection;if(v.sort){delete v.sort;}}this.oState.oSmartChart.applyVariant(v);this.triggeredByTableSort=false;}if(this.oState.oSmartFilterbar&&this.oState.oSmartFilterbar.getAnalyticBindingPath&&this.oState.oSmartFilterbar.getConsiderAnalyticalParameters()){try{var a=this.oState.oSmartFilterbar.getAnalyticBindingPath();if(a){this.oState.oSmartChart.setChartBindingPath(a);}}catch(e){jQuery.sap.log.warning("Mandatory parameters have no values","","AnalyticalListPage");}}this.oState.oController.onBeforeRebindChartExtension(E);this.checkToPreventChartBinding(E);},_onSmartChartInit:function(){var s=this.oState;this.oChart=s.oSmartChart.getChart();s.oSmartChart.attachShowOverlay(function(e){s.oSmartChart.getToolbar().setEnabled(!e.getParameter("overlay").show);},this);this.oChart.attachSelectData(this._onChartSelectData,this);this.oChart.attachDeselectData(this._onChartDeselectData,this);if(this.oState._pendingChartToolbarInit){this.oState.oSmartChart.getToolbar().insertContent(this.oState.alr_viewSwitchButtonOnChart,this.oState.oSmartChart.getToolbar().getContent().length);}delete this.oState._pendingChartToolbarInit;this.oState.oSmartChart.getChart().setVizProperties({"valueAxis":{"title":{"visible":false}},"legendGroup":{"layout":{"position":"bottom"}}});jQuery.sap.log.info("Smart Chart Annotation initialized");},_onChartSelectData:function(e){var a=this.oState.oSmartChart.getChart();if(a._getVizFrame().vizSelection()){var s=a.getSelectedDataPoints().dataPoints;this._lastSelected=this._getLastSel(s,this._lastSelectedList);this._lastSelectedList=s;}this._updateTable("selection");},_getLastSel:function(n,o){var d=this.oState.oSmartChart.getChart();var e=this.oState.detailController._getSelParamsFromDPList(n);var f=this.oState.detailController._getSelParamsFromDPList(o);for(var i=0;i<e.length;i++){var g=e[i];var m=false;for(var j=0;j<f.length;j++){var h=f[j];m=true;for(var a in h){if(a.indexOf("__")!=-1)continue;if(g[a]!=h[a]){m=false;break;}}if(m)break;}if(!m){var k=d.getVisibleDimensions();var l={};for(var j=0;j<k.length;j++){var p=k[j];l[p]=g[p];}return l;}}return null;},_onChartDeselectData:function(e){var m=this;this._lastSelected=null;setTimeout(function(){var d=m.oState.oSmartChart.getChart();if(d.getSelectedDataPoints().count==0)m._updateTable("selection");else if(d.getSelectionMode()=="MULTIPLE")m._onChartSelectData(e);},1);var a=e.getParameter("oSource");if(a&&a instanceof sap.m.Link&&a.getParent()instanceof sap.m.Breadcrumbs)m._onChartDrilledUp(e);},_onChartDrilledUp:function(e){this._updateTable();},_onChartDrilledDown:function(e){this._updateTable();},_onSearchButtonPressed:function(){this._updateTable();},updateTable:function(){var v=this.oState.oSmartChart.fetchVariant(),s={};if(v.sort&&v.sort.sortItems){s.sortList=v.sort.sortItems;s.allSortRemoved=false;}else{s.sortList=undefined;s.allSortRemoved=true;}this._updateTable(undefined,s);},_updateTable:function(u){var a=this.oState.oSmartChart.getChart();if(!a){return;}var d=[];if(a._getVizFrame().vizSelection())d=a.getSelectedDataPoints().dataPoints;if(!d||d.length==0)this._lastSelected=null;this.oState.detailController.applyParamsToTable();},checkToPreventChartBinding:function(e){var p=false;var a=e.mParameters.bindingParams.filters;var d=e.mParameters.bindingParams.sorter;p=this._lastFilter&&!this.oState.detailController._isFilterDiff(this._lastFilter,a);p=p?this._lastSorter&&!this.oState.detailController._isFilterDiff(this._lastSorter,d):false;this._lastFilter=a;this._lastSorter=d;var s=e.mParameters.bindingParams.parameters.custom&&e.mParameters.bindingParams.parameters.custom.search;var f=s?e.mParameters.bindingParams.parameters.custom.search:s;if(this._lastSearch||f){p=p?(this._lastSearch===f):false;this._lastSearch=f;}var o=this.oState.oSmartFilterbar.getFilterData();var g={};for(var k in o){if(k.indexOf("$Parameter")!==-1){g[k]=o[k];}}p=p?this._lastParam&&!this.oState.detailController._isFilterObjDiff(this._lastParam,g):false;this._lastParam=g;if(p){e.mParameters.bindingParams.preventChartBind=true;this.oState.oSmartChart.showOverlay(false);}}});return c;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.ToolbarController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.ToolbarController');jQuery.sap.require('sap.m.SegmentedButtonItem');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/ToolbarController",["sap/m/SegmentedButtonItem","sap/m/Button","sap/m/ButtonType","sap/ui/base/EventProvider","sap/m/SegmentedButton","sap/ui/core/mvc/Controller"],function(S,B,a,E,b,C){"use strict";var c="table",d="chart",e="charttable";var t=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.ToolbarController",{setState:function(s){var m=this;m.oState=s;m._uiCompRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var f=s.oController.getOwnerComponent().getDefaultContentView();m.oState._pendingTableToolbarInit=true;m.oState._pendingChartToolbarInit=true;if(!m.oState.alr_viewSwitchButtonOnChart||!m.oState.alr_viewSwitchButtonOnTable){m.oState.alr_viewSwitchButtonOnChart=m.createViewSwitchButton(true);m.oState.alr_viewSwitchButtonOnTable=m.createViewSwitchButton(false);}var T=m.oState.oController.getOwnerComponent().getModel("_templPriv");T.setProperty('/alp/contentView',f);},createViewSwitchButton:function(f){var g=[new sap.m.SegmentedButtonItem({tooltip:"{i18n>CONTAINER_VIEW_CHARTTABLE}",key:e,icon:"sap-icon://chart-table-view"}),new sap.m.SegmentedButtonItem({tooltip:"{i18n>CONTAINER_VIEW_CHART}",key:d,icon:"sap-icon://vertical-bar-chart-2"}),new sap.m.SegmentedButtonItem({tooltip:"{i18n>CONTAINER_VIEW_TABLE}",key:c,icon:"sap-icon://table-view"})];var h={select:jQuery.proxy(function(){this.oState.oController._templateEventHandlers.onSegmentButtonPressed(!this.oState.oController.getOwnerComponent().getProperty('smartVariantManagement'));},this),layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),items:g,selectedKey:"{_templPriv>/alp/contentView}"};if(f){jQuery.extend(h,{visible:"{= (${_templPriv>/alp/contentView} === 'chart' || ${_templPriv>/alp/contentView} === 'charttable') && !${_templPriv>/alp/fullScreen} }"});var s=new b(h);}else{jQuery.extend(h,{visible:"{= (${_templPriv>/alp/contentView} === 'table') && !${_templPriv>/alp/fullScreen} }"});var s=new b(h);}return s;}});return t;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterBarController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterBarController');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterBarController",["sap/ui/core/mvc/Controller"],function(C){"use strict";var v=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterBarController",{init:function(s){this.oState=s;var o=this.oState.oController.getOwnerComponent();this._filterBar=this.oState.alr_visualFilterBar;this._filterBar.setEntitySet(o.getEntitySet());}});return v;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.NonDraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.NonDraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/extensionAPI/NonDraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){var e="none";function E(){e="none";}return{edit:function(C){if(!C){throw new Error("Nothing to edit provided");}if(e!=="none"){throw new Error("Attempt to edit multiple contexts ("+C+")");}if(c.getView().getModel().hasPendingChanges()){throw new Error("Attempt to edit while already pending changes exist");}e="editing";},cancel:function(){if(e!=="editing"){throw new Error("Nothing edited");}t.oServices.oTransactionController.resetChanges();E();},save:function(){if(e!=="editing"){throw new Error("Nothing edited");}e="saving";var p=t.oServices.oTransactionController.triggerSubmitChanges();p.then(E,function(){e="editing";});return p;}};}return B.extend("sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.NonDraftTransactionController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationHelper",["sap/ui/base/Object","sap/ui/model/Context","sap/ui/model/odata/AnnotationHelper"],function(B,C,O){"use strict";var A=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper.criticalityConstants={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};A.selectionPresentationVariantResolveWithQualifier=function(c){var k=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");var e=M.getODataEntitySet(k.entitySet);var E=M.getODataEntityType(e.entityType);var a=E.$path+"/com.sap.vocabularies.UI.v1.SelectionPresentationVariant#"+k.qualifier;return M.createBindingContext(a);};A.resolveParameterizedEntitySet=function(d,e,s){jQuery.sap.require("sap.ui.model.analytics.odata4analytics");var p="";var o=new sap.ui.model.analytics.odata4analytics.Model(sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(d));var q=o.findQueryResultByName(e.name);var a=new sap.ui.model.analytics.odata4analytics.QueryResultRequest(q);var b=q.getParameterization();if(b){a.setParameterizationRequest(new sap.ui.model.analytics.odata4analytics.ParameterizationRequest(b));jQuery.each(s.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){a.getParameterizationRequest().setParameterValue(this.PropertyName.PropertyPath,this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{a.getParameterizationRequest().setParameterValue(this.PropertyName.PropertyPath,this.PropertyValue.String);}});}try{p=a.getURIToQueryResultEntitySet();}catch(c){q=a.getQueryResult();p="/"+q.getEntitySet().getQName();jQuery.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+c||c.message);}return p;};return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil",["sap/ui/base/Object","sap/ui/model/Context"],function(B,C){"use strict";var K=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiUtil");K.getNumberValue=function(v){var a;if(v){if(v.String){a=Number(v.String);}else if(v.Int){a=Number(v.Int);}else if(v.Decimal){a=Number(v.Decimal);}else if(v.Double){a=Number(v.Double);}else if(v.Single){a=Number(v.Single);}}return a;};K.getBooleanValue=function(v,d){if(v&&v.Bool){if(v.Bool.toLowerCase()==="true"){return true;}else if(v.Bool.toLowerCase()==="false"){return false;}}return d;};K.getPrimitiveValue=function(v){var a;if(v){if(v.String){a=v.String;}else if(v.Bool){a=K.getBooleanValue(v);}else if(v.EnumMember){a=v.EnumMember.split("/")[1];}else{a=K.getNumberValue(v);}}return a;};K.getPathOrPrimitiveValue=function(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return K.getPrimitiveValue(i);}}else{return"";}};K.isBindingValue=function(v){return(typeof v==="string")&&v.charAt(0)==="{";};K.getNumberFormatter=function(s,a,m){var f=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short",minFractionDigits:0,maxFractionDigits:m,showScale:s,shortRefNumber:a});return f;};K.determineThousandsRefNumber=function(s){var a=s;if(s>=1000){var t=0;while(a>=1000){a/=1000;t++;}return t==0?undefined:t*1000;}else{return undefined;}};K.formatNumberForPresentation=function(v,s,n,S){var a=Number(v);var c=sap.ui.getCore().getConfiguration().getLanguage();var o=new sap.ui.core.Locale(c);if(n>2){n=2;}var N=sap.ui.core.format.NumberFormat.getFloatInstance({style:"short",showScale:s,minFractionDigits:0,maxFractionDigits:2,decimals:n,shortRefNumber:S},o).format(a);return N;};K.formatNumberForPercentPresentation=function(v,n){var p=Number(v);if(n){var m=0;var a=n;if(n>2){a=2;}var b=sap.ui.core.format.NumberFormat.getPercentInstance({style:"short",minFractionDigits:m,maxFractionDigits:a});return b.format(p);}else{var b=sap.ui.core.format.NumberFormat.getPercentInstance({style:"short",minFractionDigits:0,maxFractionDigits:1});return b.format(p);}};K.getUnitofMeasure=function(m,e){var r;if(e&&e["Org.OData.Measures.V1.Unit"]){var u=e["Org.OData.Measures.V1.Unit"];r=K.getPathOrPrimitiveValue(u);}else if(e&&e["Org.OData.Measures.V1.ISOCurrency"]){var i=e["Org.OData.Measures.V1.ISOCurrency"];r=K.getPathOrPrimitiveValue(i);}if(r===undefined){r="";}return r;};K.isRelative=function(d){var t=d.TrendCalculation;var r=false;if(t){var a=t.IsRelativeDifference.DefaultValue;r=K.getBooleanValue(t.IsRelativeDifference,a?({"true":true,"false":false})[a.toLowerCase()]:false);}return r;};return K;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.ModelUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.ModelUtil');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/ModelUtil",["sap/ui/base/Object"],function(B){"use strict";var M=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.ModelUtil");var F="Filter";M.hasVisibleChild=function(c){var C=this.getContent();for(var i=0;i<C.length;i++){var t=C[i].getMetadata().getName();if(t==='sap.m.HBox'){var a=C[i].data(F);if(c.indexOf(a)!==-1){return true;}}}return false;};return M;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/OperationCode",function(){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode");sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode={"EQ":{"code":"="},"GT":{"code":">"},"GE":{"code":">="},"LT":{"code":"<"},"LE":{"code":"<="},"NE":{"code":"!"},"BT":{"code":"...","position":"mid"},"EndsWith":{"code":"*"},"StartsWith":{"code":"*","position":"last"},"Contains":{"code":"*","position":"mid"}};return sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms",function(){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms");sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms={Label:"com.sap.vocabularies.Common.v1.Label",Unit:"Org.OData.Measures.V1.Unit",ISOCurrency:"Org.OData.Measures.V1.ISOCurrency",FilterRestrictions:"Org.OData.Capabilities.V1.FilterRestrictions",SelectionFields:"com.sap.vocabularies.UI.v1.SelectionFields",FieldGroup:"com.sap.vocabularies.UI.v1.FieldGroup",ValueList:"com.sap.vocabularies.Common.v1.ValueList",DataPoint:"com.sap.vocabularies.UI.v1.DataPoint",SelectionRangeSignType:"com.sap.vocabularies.UI.v1.SelectionRangeSignType",ValueListParameterIn:"com.sap.vocabularies.Common.v1.ValueListParameterIn",ValueListParameterOut:"com.sap.vocabularies.Common.v1.ValueListParameterOut",ValueListParameterInOut:"com.sap.vocabularies.Common.v1.ValueListParameterInOut"};return sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.AnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.AnnotationHelper');sap.ui.define("sap/suite/ui/generic/template/ListReport/AnnotationHelper",[],function(){"use strict";var A={resolveMetaModelPath:function(c){var p=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(p);},createWorkingContext:function(c){var p=c.getObject(),m=c.getModel(),M=m.getProperty("/metaModel"),e=M.getODataEntitySet(p.entitySet),E=M.getODataEntityType(e.entityType),a="",w={};a=E.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant";w.presentationVariantQualifier="";w.presentationVariant=M.getObject(a);w.presentationVariantPath=a;if(w.presentationVariant&&w.presentationVariant.Visualizations){w.presentationVariant.Visualizations.forEach(function(v){var P="/"+v.AnnotationPath.slice(1);if(P.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a=E.$path+P;w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier=a.split("#")[1]||"";}});}if(!w.lineItem){a=E.$path+"/com.sap.vocabularies.UI.v1.LineItem";w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier="";}m.setProperty("/workingContext",w);return"/workingContext";}};return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.IappStateHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.IappStateHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/IappStateHandler",["jquery.sap.global","sap/ui/base/Object","sap/ui/generic/app/navigation/service/SelectionVariant"],function(q,B,S){"use strict";var d="sap.suite.ui.generic.template.customData",a="sap.suite.ui.generic.template.genericData";var I=["INIT","DATA_SUITE","CANCEL","RESET","SET_VM_ID"];function n(o){if(o){for(var p in o){o[p]=null;}}}function N(o,O){var k=Object.keys(o);if(k.length!==Object.keys(O).length){return true;}for(var i=0;i<k.length;i++){var K=k[i];var p=o[K];var P=O[K];if(p.length!==P.length){return true;}for(var j=0;j<p.length;j++){if(p[j]!==P[j]){return true;}}}return false;}function g(s,c,o){var b=c.getOwnerComponent().getSmartVariantManagement();var e=Promise.resolve({appStateKey:"",urlParams:{},selectionVariant:"",tableVariantId:""});var D=false;var O=0;var f=0;var A=false;var E=c.byId("editStateFilter");var h;s.oSmartFilterbar.setSuppressSelection(true);var j=(function(){var i;return function(){i=i||s.oSmartFilterbar.getNonVisibleCustomFilterNames();return i;};})();function k(){return D;}function l(){var M={};M[d]={};var V=[];var Q=j();for(var i=0;i<Q.length;i++){var T=Q[i];if(s.oSmartFilterbar.isVisibleInFilterBarByName(T)){V.push(T);}}M[a]={suppressDataSelection:!D,visibleCustomFields:V};if(E){M[a].editStateFilter=E.getSelectedKey();}c.getCustomAppStateDataExtension(M[d]);return M;}function m(){var M=s.oSmartFilterbar.getDataSuiteFormat();var Q=new S(M);var V=c.getVisibleSelectionsWithDefaults();for(var i=0;i<V.length;i++){if(!Q.getValue(V[i])){Q.addSelectOption(V[i],"I","EQ","");}}var T={selectionVariant:Q.toJSONString(),tableVariantId:(!b&&s.oSmartTable.getCurrentVariantId())||"",customData:l()};return T;}function r(){f--;}function p(){if(!A){return;}A=false;f++;var i;try{i=o.storeInnerAppState(m());}catch(M){q.sap.log.error("ListReport.fnStoreCurrentAppStateAndAdjustURL: "+M);}if(i){i.then(r,r);}else{f--;}}function R(M,Q){if(M&&M.editStateFilter!==undefined){if(E){E.setSelectedKey((M.editStateFilter===null)?0:M.editStateFilter);}}var V=M&&M.visibleCustomFields;if(V&&V.length>0){var T=s.oSmartFilterbar.getAllFilterItems();for(var i=0;i<T.length;i++){var U=T[i];var W=U.getName();if(V.indexOf(W)!==-1){U.setVisibleInFilterBar(true);}}}D=Q&&!(M&&M.suppressDataSelection);if(D){s.oSmartFilterbar.search();}}function t(i){c.restoreCustomAppStateDataExtension(i||{});}function u(i,M){i=i||{};if(i.hasOwnProperty(d)&&i.hasOwnProperty(a)){t(i[d]);R(i[a],M);}else{if(i._editStateFilter!==undefined){R({editStateFilter:i._editStateFilter});delete i._editStateFilter;}t(i);}}function v(){return e.then(function(i){if(i.appStateKey){return{"sap-iapp-state":[i.appStateKey]};}return i.urlParams;});}function w(i,M){if(O===0&&(i||M!==D)){D=M;if(!A){A=true;if(!s.oSmartFilterbar.isDialogOpen()){setTimeout(p,0);}}}}function x(M,Q,T,U,V){s.oSmartFilterbar.setSuppressSelection(false);var W=T.appStateKey||"";var X=T.selectionVariant||"";var Y=(!b&&T.tableVariantId)||"";var Z=(!W&&U)||{};if((M.appStateKey!==W||M.selectionVariant!==X||M.tableVariantId!==Y||N(M.urlParams,Z))&&V!==sap.ui.generic.app.navigation.service.NavType.initial){if(f===0){var $=T&&T.bNavSelVarHasDefaultsOnly;if(T.oSelectionVariant&&M.selectionVariant!==X){var _=T.oSelectionVariant.getParameterNames().concat(T.oSelectionVariant.getSelectOptionsPropertyNames());for(var i=0;i<_.length;i++){s.oSmartFilterbar.addFieldToAdvancedArea(_[i]);}}if($&&s.oSmartFilterbar.isCurrentVariantStandard()){s.oSmartFilterbar.setDataSuiteFormat(X);}else if(!$||s.oSmartFilterbar.isCurrentVariantStandard()){s.oSmartFilterbar.clearVariantSelection();s.oSmartFilterbar.clear();s.oSmartFilterbar.setDataSuiteFormat(X,true);}if(Y!==M.tableVariantId){s.oSmartTable.setCurrentVariantId(Y);}u(T.customData,true);}e=Promise.resolve({appStateKey:W,urlParams:Z,selectionVariant:X,tableVariantId:Y});}if(V!==sap.ui.generic.app.navigation.service.NavType.iAppState){var a1=(V===sap.ui.generic.app.navigation.service.NavType.xAppState&&!T.bNavSelVarHasDefaultsOnly)||(V===sap.ui.generic.app.navigation.service.NavType.URLParams&&!U.bNavSelVarHasDefaultsOnly);D=a1||h||s.oSmartFilterbar.isCurrentVariantExecuteOnSelectEnabled();if(D){s.oSmartFilterbar.search();}}Q();}function y(i,M,U,Q){var T=e;T.then(function(V){if(T!==e){y(i,M,U,Q);return;}x(V,i,M,U,Q);});}function z(){O--;}function P(){O++;var i=new Promise(function(M,Q){var T=o.parseNavigation();T.done(y.bind(null,M));T.fail(Q);});i.then(z,z);return i;}function C(i){var M=m();s.oSmartFilterbar.setFilterData({_CUSTOM:M.customData});}function F(){w(true,D);}function G(i){var M=i.getParameter("context");var Q=s.oSmartFilterbar.getFilterData();if(Q._CUSTOM!==undefined){u(Q._CUSTOM);}else{var T=l();n(T[d]);n(T[a]);u(T);}if(I.indexOf(M)<0){D=i.getParameter("executeOnSelect");w(true,D);}}function H(){if(!b){w(true,D);}}function J(){if(!b){w(true,D);}}function K(){if(f>0){P();return true;}return false;}function L(){h=s.oSmartTable.getEnableAutoBinding();s.oSmartFilterbar.attachFiltersDialogClosed(p);}s.getCurrentAppState=m;return{areDataShownInTable:k,parseUrlAndApplyAppState:P,getUrlParameterInfo:v,changeIappState:w,onSmartFilterBarInitialise:L,onBeforeSFBVariantSave:C,onAfterSFBVariantSave:F,onAfterSFBVariantLoad:G,onAfterTableVariantSave:H,onAfterApplyTableVariant:J,isStateChange:K};}return B.extend("sap.suite.ui.generic.template.lib.IappStateHandler",{constructor:function(s,c,o){q.extend(this,g(s,c,o));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.extensionAPI.NonDraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.extensionAPI.NonDraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/extensionAPI/NonDraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){var e="none";function E(){e="none";}return{edit:function(C){if(!C){throw new Error("Nothing to edit provided");}if(e!=="none"){throw new Error("Attempt to edit multiple contexts ("+C+")");}if(c.getView().getModel().hasPendingChanges()){throw new Error("Attempt to edit while already pending changes exist");}e="editing";},cancel:function(){if(e!=="editing"){throw new Error("Nothing edited");}t.oServices.oTransactionController.resetChanges();E();},save:function(){var f=function(){if(e!=="editing"){throw new Error("Nothing edited");}e="saving";var P=t.oServices.oTransactionController.triggerSubmitChanges();P.then(E,function(){e="editing";});return P;};var p={};p=q.extend(true,{busy:{set:true,check:true},dataloss:{popup:false,navigation:false}},p);return t.oCommonUtils.securedExecution(f,p,s);}};}return B.extend("sap.suite.ui.generic.template.ListReport.extensionAPI.NonDraftTransactionController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.extensionAPI.DraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.extensionAPI.DraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/extensionAPI/DraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c){return{attachAfterActivate:function(f){t.oComponentUtils.attach(c,"AfterActivate",f);},detachAfterActivate:function(f){t.oComponentUtils.detach(c,"AfterActivate",f);},attachAfterCancel:function(f){t.oComponentUtils.attach(c,"AfterCancel",f);},detachAfterCancel:function(f){t.oComponentUtils.detach(c,"AfterCancel",f);},attachAfterDelete:function(f){t.oComponentUtils.attach(c,"AfterDelete",f);},detachAfterDelete:function(f){t.oComponentUtils.detach(c,"AfterDelete",f);},saveDraft:function(f){t.oServices.oApplicationController.addOperationToQueue(f,{draftSave:true});},executeSideEffects:function(s){s=s||{};t.oServices.oApplicationController.executeSideEffects(c.getView().getBindingContext(),s.sourceProperties,s.sourceEntities,false);}};}return B.extend("sap.suite.ui.generic.template.ObjectPage.extensionAPI.DraftTransactionController",{constructor:function(t,c){q.extend(this,g(t,c));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.extensionAPI.NonDraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.extensionAPI.NonDraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/extensionAPI/NonDraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){return{attachAfterSave:function(f){t.oComponentUtils.attach(c,"AfterSave",f);},detachAfterSave:function(f){t.oComponentUtils.detach(c,"AfterSave",f);},attachAfterDelete:function(f){t.oComponentUtils.attach(c,"AfterDelete",f);},detachAfterDelete:function(f){t.oComponentUtils.detach(c,"AfterDelete",f);},attachAfterCancel:function(f){t.oComponentUtils.attach(c,"AfterCancel",f);},detachAfterCancel:function(f){t.oComponentUtils.detach(c,"AfterCancel",f);},registerUnsavedDataCheckFunction:function(h){s.aUnsavedDataCheckFunctions.push(h);}};}return B.extend("sap.suite.ui.generic.template.ObjectPage.extensionAPI.NonDraftTransactionController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/view/fragments/DummyBlock",['sap/uxap/BlockBase'],function(B){"use strict";var D=B.extend("sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock",{metadata:{views:{Collapsed:{viewName:"sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock",type:"XML"},Expanded:{viewName:"sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock",type:"XML"}}}.fragments});return D;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.app.blankAnalyticalListPage.Component')){jQuery.sap.require('sap.ui.generic.app.AppComponent');jQuery.sap.declare("sap.suite.ui.generic.template.app.blankAnalyticalListPage.Component");sap.ui.generic.app.AppComponent.extend("sap.suite.ui.generic.template.app.blankAnalyticalListPage.Component",{metadata:{manifest:"json"}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.NavigationController')){jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.NavigationController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/NavigationController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){return{navigateExternal:function(o,p){var m=c.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var O=m.crossNavigation.outbounds[o];if(!O){q.sap.log.error("navigateExternal: mandatory parameter 'Outbound' is missing, or different from manifest entry");return;}if(p){O.parameters=p;}else{}t.oCommonUtils.navigateExternal(O,s);},navigateInternal:function(C,n){if(C){t.oCommonUtils.navigateToContext(C,n);}}};}return B.extend("sap.suite.ui.generic.template.extensionAPI.NavigationController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.UIMode')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.UIMode');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/UIMode",[],function(){"use strict";var U={Create:"Create",Display:"Display",Edit:"Edit"};return U;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.fragments.MessagePage.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.fragments.MessagePage.controller');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/fragments/MessagePage.controller",["sap/ui/core/mvc/Controller"],function(C){"use strict";return C.extend("sap.suite.ui.generic.template.fragments.MessagePage",{navButtonPress:function(){window.history.back();}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.AnnotationHelper')){(function(){"use strict";jQuery.sap.require('sap.ui.comp.smartfield.SmartField');var U=sap.ui.require("sap/suite/ui/generic/template/extensionAPI/UIMode");jQuery.sap.declare("sap.suite.ui.generic.template.js.AnnotationHelper");var a={buildDeleteButtonEnablementExpression:function(f){var b=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f)+"::deleteEntry";return"{= !!${_templPriv>/generic/controlProperties/"+b+"/enabled}}";},getSmartTableId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="listReport";if(s){r=r.concat("-"+s);}return r;},getAnalyticalTableId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="analyticalTable";if(s){r=r.concat("-"+s);}return r;},getGridTableId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="GridTable";if(s){r=r.concat("-"+s);}return r;},getResponsiveTableId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="responsiveTable";if(s){r=r.concat("-"+s);}return r;},getAddEntryId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="addEntry";if(s){r=r.concat("-"+s);}return r;},getDeleteEntryId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="deleteEntry";if(s){r=r.concat("-"+s);}return r;},getShowDetailsId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="showDetails";if(s){r=r.concat("-"+s);}return r;},getDraftObjectMarkerId:function(m,t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(m,t);var r="DraftObjectMarker";if(s){r=r.concat("-"+s);}return r;},getIconTabFilterKey:function(m,t){if(t&&t.key){return t.key;}else{for(var i in m){if(m[i].qualifier===t.qualifier){return t.qualifier;}}}return"";},getIconTabFilterText:function(i,m){var M=i.getModel();var e=M.oData.entityType;var E=M.oData.metaModel.getODataEntityType(e);var s=E[m.qualifier];if(s&&s.Text){return s.Text.String;}},buildAnnotatedActionButtonEnablementExpression:function(i,d,f,e,I){var F,b,A,m;if(e&&e["sap:semantics"]==="aggregate"&&!I){return true;}A=d&&d.Action&&d.Action.String;if(A){b=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartForDatafieldActionButton(d,f);if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(!d.RequiresContext||d.RequiresContext.Bool!=="false"){return"{= !!${_templPriv>/generic/controlProperties/"+b+"/enabled}}";}}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){m=i.getInterface(0).getModel();F=m.getODataFunctionImport(A);if(!F){jQuery.sap.log.error("The function import "+A+" is not defined in the metadata. Buttons that call this function import will not behave as expected.");}else if(F["sap:action-for"]&&F["sap:action-for"]!==""&&F["sap:action-for"]!==" "){return"{= !!${_templPriv>/generic/controlProperties/"+b+"/enabled}}";}}return true;}},getLabelForDFwithIBN:function(i,d,e,g){var m,t,E,p,r;if(d.Label){return d.Label.String;}else{m=i.getInterface(0).getModel();if(m&&e){if(g&&g.Target&&g.Target.AnnotationPath){t=sap.suite.ui.generic.template.js.AnnotationHelper.getTargetEntitySet(m,e,g.Target.AnnotationPath);E=m.getODataEntityType(t.entityType);}else{E=m.getODataEntityType(e.entityType);}if(d.Value&&d.Value.Path){p=m.getODataProperty(E,d.Value.Path);r=p["sap:label"]||(p["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return r;}}}},getLinkTextForDFwithIBN:function(i,d,e,g){var E,t,p,r;var m=i.getInterface(0).getModel();if(m&&e){if(g&&g.Target&&g.Target.AnnotationPath){t=sap.suite.ui.generic.template.js.AnnotationHelper.getTargetEntitySet(m,e,g.Target.AnnotationPath);E=m.getODataEntityType(t.entityType);}else{E=m.getODataEntityType(e.entityType);}if(d.Value&&d.Value.Path){p=m.getODataProperty(E,d.Value.Path);r=p["sap:text"]||(p["com.sap.vocabularies.Common.v1.Text"]||d.Value).Path||"";return"{"+r+"}";}}},getTargetEntitySet:function(m,s,A){var n,N,e,o;n=A.split('/');if(n.length>1){N=n[0];}if(N){e=m.getODataEntityType(s.entityType);o=m.getODataAssociationSetEnd(e,N);if(o&&o.entitySet){return m.getODataEntitySet(o.entitySet);}}return s;},getApplicablePathForChartToolbarActions:function(I,c,e){var m=I.getInterface(0).getModel();var E=m.getODataEntityType(e);var A=(c&&c.Actions)||[];var f,F,o,b=[],d=[],s;for(var i=0;i<A.length;i++){if(A[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&(!A[i].Inline||A[i].Inline.Bool!=="true")&&(!A[i].Determining||A[i].Determining.Bool!=="true")){f=A[i].Action&&A[i].Action.String;F=m.getODataFunctionImport(f);if(F){b.push(F);}}}for(var i=0;i<b.length;i++){F=b[i];if(F&&F["sap:action-for"]&&F["sap:action-for"]!==""&&F["sap:action-for"]!==" "&&F["sap:applicable-path"]&&F["sap:applicable-path"]!==""&&F["sap:applicable-path"]!==" "){s=F["sap:applicable-path"];o=m.getODataProperty(E,s);if(o&&o["sap:aggregation-role"]==="dimension"){d.push(s);}else{jQuery.sap.log.error("AnnotationHelper.js - method getApplicablePathForChartToolbarActions: the applicable-path "+s+" is either pointing to an entity type property which doesn't exist or does not have 'sap:aggregation-role' set to to 'dimension'.");}}}if(d.length>0){return d.join();}},buildBreadCrumbExpression:function(c,t,T){var b,B=sap.ui.model.odata.AnnotationHelper.format(c,t);if(t&&t.Path&&T&&T.String){var s=T.String.replace(/'/g,"\\'");b="{= $"+B+" ? $"+B+" : '"+s+"' }";return b;}else{if(!B){return("no title");}return B;}},buildRatingIndicatorSubtitleExpression:function(s){if(s){return"{parts: [{path: '"+s.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorSubTitle'}";}},formatRatingIndicatorSubTitle:function(s){if(s){var r=this.getModel("i18n").getResourceBundle();if(this.getCustomData().length>0){return r.getText("RATING_INDICATOR_SUBTITLE",[s,this.data("Subtitle")]);}else{var S=s>1?r.getText("RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):r.getText("RATING_INDICATOR_SUBTITLE_LABEL");return r.getText("RATING_INDICATOR_SUBTITLE",[s,S]);}}},buildRatingIndicatorFooterExpression:function(v,t){if(t){return"{parts: [{path: '"+v.Path+"'}, {path: '"+t.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorFooterText'}";}return"{parts: [{path: '"+v.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorFooterText'}";},formatRatingIndicatorFooterText:function(v,t){if(v){var r=this.getModel("i18n").getResourceBundle();if(t){return r.getText("RATING_INDICATOR_FOOTER",[v,t]);}else if(this.getCustomData().length>0){return r.getText("RATING_INDICATOR_FOOTER",[v,this.data("Footer")]);}else{var R=sap.m.RatingIndicator.getMetadata().getPropertyDefaults().maxValue;return r.getText("RATING_INDICATOR_FOOTER",[v,R]);}}},buildRatingIndicatorAggregateCountExpression:function(v){return"{parts: [{path: '"+v.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorAggregateCount'}";},formatRatingIndicatorAggregateCount:function(v){var r=this.getModel("i18n").getResourceBundle();var t;if(v){t=r.getText("RATING_INDICATOR_AGGREGATE_COUNT",[v]);}else if(this.getCustomData().length>0){t=r.getText("RATING_INDICATOR_AGGREGATE_COUNT",[this.data("AggregateCount")]);}else{t="";}return t;},getEditActionButtonVisibility:function(i,r,e,p){var m=i.getInterface(0).getModel();if(sap.suite.ui.generic.template.js.AnnotationHelper._areUpdateRestrictionsValid(m,e,r)){var u="!${ui>/editable}";if(r){if(r.Updatable.Path){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,r.Updatable.Path,e);return"{= ${"+r.Updatable.Path+"} ? "+u+" : false}";}else if(r.Updatable.Bool==="false"&&!p){return false;}}return"{="+u+"}";}else{return false;}},getDeleteActionButtonVisibility:function(i,r,e){var m=i.getInterface(0).getModel();if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(m,e,r)){var u="!${ui>/editable}";if(r){if(r.Deletable.Path){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,r.Deletable.Path,e);return"{= ${"+r.Deletable.Path+"} ? "+u+" : false}";}else if(r.Deletable.Bool==="false"){return false;}}return"{="+u+"}";}else{return false;}},getIdForMoreBlockContent:function(f){if(f["com.sap.vocabularies.UI.v1.PartOfPreview"]&&f["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"){return"::MoreContent";}},checkMoreBlockContent:function(f){return sap.suite.ui.generic.template.js.AnnotationHelper.checkFacetContent(f,false);},checkBlockContent:function(f){return sap.suite.ui.generic.template.js.AnnotationHelper.checkFacetContent(f,true);},checkFacetContent:function(f,b){var p;var i=f.getInterface(0);var F=f.getModel().getProperty("",f);var c=f.getPath().split("/Facets");var C=i.getModel().getContext(c[0]);if(i.getModel().getProperty('',C).RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){return C.getPath();}else{if(!F){return;}for(var d=0;d<F.length;d++){if(!b){if(F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"]&&F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"){p=i.getPath()+"/"+d;break;}}else{if(F[d].RecordType!=="com.sap.vocabularies.UI.v1.ReferenceFacet"||(!F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"]||F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true")){p=i.getPath()+"/"+d;break;}}}}return p;},isInlineCreate:function(f,s){var S=s[sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f)];return!!(S&&S.createMode&&S.createMode==="inline");},isImageUrl:function(p){var s=p["com.sap.vocabularies.UI.v1.IsImageURL"]||p["com.sap.vocabularies.UI.v1.IsImageUrl"];if(s&&s.Bool&&s.Bool==="false"){return false;}else if(s){return true;}return false;},_addFullPathToImageUrlIfNeeded:function(i,A){if(!i){return"";}if((i.substring(0,1)==="/")||(i.substring(0,11)==="sap-icon://")||(i.substring(0,7)==="http://")||(i.substring(0,8)==="https://")){return i;}else{return jQuery.sap.getModulePath(A,"/")+i;}},formatImageUrl:function(i,I,A,e){if(I&&(I.Path||I.Apply)&&e){a.formatWithExpandSimple(i,I);}if(I&&I.Path){return"{parts: [{path: '"+I.Path+"'}, {path: '_templPrivGlobal>/generic/appComponentName'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatImageUrlRuntime'}";}else if(I&&I.String){return a._addFullPathToImageUrlIfNeeded(I.String,A);}else if(I&&I.Apply){I.Apply.Parameters[0].Value=a._addFullPathToImageUrlIfNeeded(I.Apply.Parameters[0].Value,A);return sap.ui.model.odata.AnnotationHelper.format(i,I);}else{return"";}},formatImageUrlRuntime:function(i,A){return a._addFullPathToImageUrlIfNeeded(i,A);},formatHeaderImage:function(i,h,A){if(h.ImageUrl){return a.formatImageUrl(i,h.ImageUrl,A,true);}else if(h.TypeImageUrl){return a.formatImageUrl(i,h.TypeImageUrl,A,true);}else{return"";}},matchesBreadCrumb:function(I,c,p){if(p){var s=p.split("/");var e,E,A;if(s.length>0){var m=I.getInterface(0).getModel();var b=s[0];for(var i=0;i<s.length;i++){if(i>0){e=m.getODataEntitySet(b);E=m.getODataEntityType(e.entityType);A=m.getODataAssociationSetEnd(E,s[i]);b=A.entitySet;}if((i+1)===s.length){if(b===c.name){return true;}else{return false;}}}}}},showFullScreenButton:function(r,f){if(r&&f){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(r.component&&r.component.settings&&r.component.settings.sections&&r.component.settings.sections[F]&&r.component.settings.sections[F].tableMode==="FullScreenTable"){return true;}}return false;},getPersistencyKeyForSmartTable:function(r){return"listReportFloorplanTable";},getCreateNavigationIntent:function(l,s,A){return sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l,s,A,'create');},getDisplayNavigationIntent:function(l,s,A){return sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l,s,A,'display');},getSubObjectPageIntent:function(l,s,A,m){var n;if(A){n=A.split("/")[0];}if(l&&s&&s.length>0){if(n){for(var i=0;i<s.length;i++){if(l===s[i].entitySet&&n===s[i].navigationProperty&&s[i].navigation&&s[i].navigation[m]){return s[i].navigation[m].target;}}}else{for(var i=0;i<s.length;i++){if(l===s[i].entitySet&&s[i].navigation&&s[i].navigation[m]){return s[i].navigation[m].target;}}}}},extensionPointFragmentExists:function(f,F){var i=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(i===F){return true;}else{return false;}},containsFormWithBreakoutAction:function(f,i){var c=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(c===i){if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")!=-1){return true;}}return false;},formatWithExpandSimple:function(i,d,e){var E=[],s,o;var m=i&&i.getModel&&i.getModel();if(!m){i=i.getInterface(0);m=i.getModel();}if(e){o=m.getODataEntityType(e.entityType);}else{var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(i.getPath());if(M&&M.length&&M[0]){var b=m.getProperty(M[0]);var n=m.getODataEntityContainer().namespace;o=m.getODataEntityType(n+'.'+b.name);}}if(o){if(d&&d.Path){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,d.Path);if(s){E.push(s);}}else if(d&&d.Apply&&d.Apply.Name==="odata.concat"){d.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,P.Value);if(s){if(E.indexOf(s)===-1){E.push(s);}}}});}if(E.length>0){var p=i.getSetting("preprocessorsData");if(p){var r=p.rootContextExpand||[];for(var j=0;j<E.length;j++){if(r.indexOf(E[j])===-1){r.push(E[j]);}}p.rootContextExpand=r;}}}return sap.ui.model.odata.AnnotationHelper.format(i,d);},formatWithExpand:function(i,d,e){sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand(i,d,e);i=i.getInterface(0);sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple(i,d,e);return sap.ui.model.odata.AnnotationHelper.format(i,d);},_getNavigationPrefix:function(m,e,p){var E="";var P=p.split("/");if(P.length>1){for(var i=0;i<(P.length-1);i++){var A=m.getODataAssociationEnd(e,P[i]);if(A){e=m.getODataEntityType(A.type);if(E){E=E+"/";}E=E+P[i];}else{return E;}}}return E;},getCurrentPathWithExpand:function(i,c,e,n){i=i.getInterface(0);var E=[],N;var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(i.getPath()));var b=m.getODataEntityType(e.entityType);E=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetExpand(r,m,b,o);if(E.length>0){N="{ path : '"+n+"', parameters : { expand : '"+E.join(',')+"'} }";}else{N="{ path : '"+n+"' }";}if(N==="{}"){N="";}return N;},getNavigationPathWithExpand:function(i,c,e){i=i.getInterface(0);var E=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(i.getPath()));var n=sap.ui.model.odata.AnnotationHelper.getNavigationPath(i,c);var N=n.replace("{","").replace("}","");if(N){var b=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(b,N);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);}}else{var b=m.getODataEntityType(e.entityType);}E=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetExpand(r,m,b,o);if(E.length>0){if(N===""){var p=i.getSetting("preprocessorsData");if(p){var R=p.rootContextExpand||[];for(var j=0;j<E.length;j++){if(R.indexOf(E[j])===-1){R.push(E[j]);}}p.rootContextExpand=R;}}else{n="{ path : '"+N+"', parameters : { expand : '"+E.join(',')+"'} }";}}if(n==="{}"){n="";}return n;},getFacetExpand:function(r,m,E,o){var d=[],b=[],f,F=[];if(r){F=m.getObject(r)||[];}F=F.Data||F;var g=function(p,I){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,E,p);if(s){if(b.indexOf(s)===-1){b.push(s);}}if(I){try{d=sap.ui.comp.smartfield.SmartField.getSupportedAnnotationPaths(m,o,p,true)||[];}catch(e){d=[];}for(var i=0;i<d.length;i++){if(b.indexOf(d[i])===-1){b.push(d[i]);}}}};var A=function(p){if(p.Type==="LabeledElement"){g(p.Value.Path);}else if(p.Type==="Path"){g(p.Value);}};for(var i=0;i<F.length;i++){f=F[i];if(f.Value&&f.Value.Path){g(f.Value.Path,true);}if(f.Value&&f.Value.Apply&&f.Value.Apply.Name==="odata.concat"){f.Value.Apply.Parameters.forEach(A);}if(f.Action&&f.Action.Path){g(f.Action.Path);}if(f.Target){if(f.Target.Path){g(f.Target.Path);}if(f.Target.AnnotationPath){g(f.Target.AnnotationPath);}}if(f.SemanticObject&&f.SemanticObject.Path){g(f.SemanticObject.Path);}if(f.Url&&f.Url.Path){g(f.Url.Path);}if(f.Url&&f.Url.Apply&&f.Url.Apply.Parameters){f.Url.Apply.Parameters.forEach(A);}if(f.UrlContentType&&f.UrlContentType.Path){g(f.UrlContentType.Path);}}if(F.name){g(F.name,true);}return b;},isSelf:function(p){if(p===undefined||(p&&p.indexOf('@')===0&&p.indexOf('/')===-1)){return true;}return false;},number:function(v){if(!v){return NaN;}else if(v.Decimal){return+v.Decimal;}else if(v.Path){return'{'+v.Path+'}';}else{return NaN;}},formatColor:(function(){function f(v){if(!v){return NaN;}else if(v.Decimal){return v.Decimal;}else if(v.EnumMember){return'\''+v.EnumMember+'\'';}else if(v.Path){return'${'+v.Path+'}';}else{return NaN;}}function b(d){var e=d.Criticality;return'{= '+f(e)+' === \'UI.CriticalityType/Negative\' ? \'Error\' : '+f(e)+'=== \'UI.CriticalityType/Critical\' ? \'Critical\' : \'Good\'}';}function c(d){var v=f(d.Value);var C=d.CriticalityCalculation;return'{= ('+v+' < '+f(C.DeviationRangeLowValue)+' || '+v+' > '+f(C.DeviationRangeHighValue)+') ? \'Error\' : ('+v+' < '+f(C.ToleranceRangeLowValue)+' || '+v+' > '+f(C.ToleranceRangeHighValue)+') ? \'Critical\' : \'Good\'}';}return function(d){if(d.Criticality){return b(d);}else if(d.CriticalityCalculation){return c(d);}};})(),_determineColumnIndex:function(c){var C=c.getPath();var i=Number(C.slice(C.lastIndexOf("/")+1));var l=C.slice(0,C.lastIndexOf("/"));var L=c.getModel().getObject(l);var b=0;for(var r=0;r<i;r++){if((L[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||L[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&(!L[r].Inline||L[r].Inline.Bool==="false")){continue;}else{b++;}}return b;},createP13NColumnForAction:function(c,d){var C=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(c);var s=a.createP13NColumnKey(d);var p='\\{"columnKey":"'+s+'", "columnIndex":"'+C+'", "actionButton":"true" \\}';return p;},createP13NColumnForContactPopUp:function(i,c,d,D,A){var p="";var n="";var b=[];var m=i.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,A);}}var C=a.createP13NColumnKey(d);if(n){p='\\{"columnKey":"'+C+'", "leadingProperty":"'+n;n=n+"/";}else{p='\\{"columnKey":"'+C;}if(D.fn&&D.fn.Path){b.push(n+D.fn.Path);}if(b.length>0){var s="";b.forEach(function(P){if(s){s=s+",";}s=s+P;});p+='", "additionalProperty":"'+s;}var o=i.getInterface(1);var f=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(o);if(f){p+='", "columnIndex":"'+f;}p+='" \\}';return p;},createP13NColumnForIndicator:function(i,c,C,d,D,o,A){var p="";var n="";var b=[];var m=i.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,A);}}var s=a.createP13NColumnKey(d);if(n){p='\\{"columnKey":"'+s+'", "leadingProperty":"'+n;n=n+"/";}else{p='\\{"columnKey":"'+s;}if(D.Value&&D.Value.Path){b.push(n+D.Value.Path);}if(D.TargetValue&&D.TargetValue.Path){b.push(n+D.TargetValue.Path);}if(D.Criticality&&D.Criticality.Path){b.push(n+D.Criticality.Path);}if(b.length>0){var f="";b.forEach(function(P){if(f){f=f+",";}f=f+P;});p+='", "additionalProperty":"'+f;}var g=i.getInterface(2);var h=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(g);if(h){p+='", "columnIndex":"'+h;}p+='" \\}';return p;},createP13NColumnForChart:function(i,c,d,D,A){var p="",b=[],n="";var m=i.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,A);}}var C=a.createP13NColumnKey(d);if(n){p='\\{"columnKey":"'+C+'", "leadingProperty":"'+n;n=n+"/";}else{p='\\{"columnKey":"'+C;}if(D.Dimensions){D.Dimensions.forEach(function(g){b.push(n+g.PropertyPath);});}if(D.Measures){D.Measures.forEach(function(M){b.push(n+M.PropertyPath);});}if(b.length>0){p+='", "additionalProperty":"'+b.join();}var o=i.getInterface(1);var f=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(o);if(f){p+='", "columnIndex":"'+f;}p+='" \\}';return p;},createP13NColumnKey:function(d,c){var C="";var f="template";var s="::";if(d.RecordType==="com.sap.vocabularies.UI.v1.DataField"){C=d.Value.Path;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){C=f+s+"DataFieldWithIntentBasedNavigation"+s+d.SemanticObject.String+s+d.Action.String+s+d.Value.Path;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){C=f+s+"DataFieldForIntentBasedNavigation"+s+d.SemanticObject.String+s+d.Action.String;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){C=f+s+"DataFieldForAction"+s+d.Action.String;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(d.Target.AnnotationPath.indexOf('@com.sap.vocabularies.Communication.v1.Contact')>=0||d.Target.AnnotationPath.indexOf('@com.sap.vocabularies.UI.v1.DataPoint')>=0||d.Target.AnnotationPath.indexOf('@com.sap.vocabularies.UI.v1.Chart')>=0){C=f+s+"DataFieldForAnnotation"+s+d.Target.AnnotationPath;C=C.replace('@','');}}return C;},createP13N:function(I,c,C,d,D,o){var p="",A=[],n="";if(d.RecordType==="com.sap.vocabularies.UI.v1.DataField"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){if(d.Value.Path){var s=a.createP13NColumnKey(d,C);p='\\{"columnKey":"'+s+'", "leadingProperty":"'+d.Value.Path;var m=I.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,d.Value.Path);if(n){n=n+"/";}}}}else if(d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){d.Value.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){if(!p){p='\\{"columnKey":"'+P.Value+'", "leadingProperty":"'+P.Value;}else{A.push(P.Value);}}});}if((C.type==="Edm.DateTime")&&(C["sap:display-format"]==="Date")){p+='", "type":"date';}if(d.Criticality&&d.Criticality.Path){A.push(d.Criticality.Path);}if(C["com.sap.vocabularies.Common.v1.Text"]&&C["com.sap.vocabularies.Common.v1.Text"].Path){A.push(n+C["com.sap.vocabularies.Common.v1.Text"].Path);}if(C["Org.OData.Measures.V1.ISOCurrency"]&&C["Org.OData.Measures.V1.ISOCurrency"].Path){A.push(n+C["Org.OData.Measures.V1.ISOCurrency"].Path);}if(C["Org.OData.Measures.V1.Unit"]&&C["Org.OData.Measures.V1.Unit"].Path){A.push(n+C["Org.OData.Measures.V1.Unit"].Path);}if(C["com.sap.vocabularies.Common.v1.FieldControl"]&&C["com.sap.vocabularies.Common.v1.FieldControl"].Path){A.push(n+C["com.sap.vocabularies.Common.v1.FieldControl"].Path);}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Apply&&d.Url.Apply.Parameters){d.Url.Apply.Parameters.forEach(function(P){if(P.Type==="LabeledElement"){A.push(P.Value.Path);}});}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Path){A.push(d.Url.Path);}if(A.length>0){var b="";A.forEach(function(P){if(b){b=b+",";}b=b+P;});p+='", "additionalProperty":"'+b;}var N=false;if(c["Org.OData.Capabilities.V1.SortRestrictions"]&&c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties){var f=c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties;for(var i=f.length-1;i>=0;i--){if(f[i].PropertyPath===d.Value.Path){N=true;break;}}}if(!N){if(n){p+='", "sortProperty":"'+n+C.name;}else{p+='", "sortProperty":"'+C.name;}}var g=false;if(c["Org.OData.Capabilities.V1.FilterRestrictions"]){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].Filterable!=='false'){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties){var h=c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties;for(var j=h.length-1;j>=0;j--){if(h[j].PropertyPath===d.Value.Path){g=true;break;}}}}else{g=true;}}if(!g){p+='", "filterProperty":"'+C.name;}var k=I.getInterface(2);var l=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(k);if(l>=0){p+='", "columnIndex":"'+l;}}else{p='\\{"columnKey":"'+d.Label.String+'", "actionButton":"true';}return p+'" \\}';},hasActions:function(P){for(var i=0;i<P.length;i++){if(P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){return true;}}return false;},hasCustomActions:function(r,e,m,f){if(e&&m){if(f){if(m[e]){var M=m[e];if(M.EntitySet===e){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(!M.Sections){return false;}var s=M.Sections[F];if(s&&s.id===F&&s.Actions){for(var i in s.Actions){if(s.Actions[i].requiresSelection!==false){return true;}}}}}}else{if(m["sap.suite.ui.generic.template.ListReport.view.ListReport"]){m=m["sap.suite.ui.generic.template.ListReport.view.ListReport"]["sap.ui.generic.app"];}else if(m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]){m=m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"];}if(m&&m[e]){var M=m[e];if(M.EntitySet===e){if(M.Actions){for(var i in M.Actions){if(M.Actions[i].requiresSelection!==false){return true;}}}}}}}return false;},getSelectionModeGridTable:function(e,r,m,f,E,R,I){for(var i in R.pages){if(R.pages[i].entitySet===r&&sap.suite.ui.generic.template.js.AnnotationHelper.hasSubObjectPage(E,R.pages[i].pages)){return"Single";}}if((sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f))){return"Single";}var d=E["Org.OData.Capabilities.V1.DeleteRestrictions"];if(d&&d.Deletable){if(d.Deletable.Bool&&d.Deletable.Bool!=='false'){return"{= ${ui>/editable} ? 'Single' : 'None' }";}if(d.Deletable.Path){return"{= ${ui>/editable} ? 'Single' : 'None' }";}}if(I){return"{= ${ui>/editable} ? 'Single' : 'None' }";}return"None";},getSelectionModeResponsiveTable:function(e,r,m,f,E,R,i){if(sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f)){return"SingleSelectLeft";}var d=E["Org.OData.Capabilities.V1.DeleteRestrictions"];if(d&&d.Deletable){if(d.Deletable.Bool&&d.Deletable.Bool!=='false'){return"{= ${ui>/editable} ? 'SingleSelectLeft' : 'None' }";}if(d.Deletable.Path){return"{= ${ui>/editable} ? 'SingleSelectLeft' : 'None' }";}}if(i){return"{= ${ui>/editable} ? 'SingleSelectLeft' : 'None' }";}return"None";},getSortOrder:function(P){var s='';for(var i=0;i<P.length;i++){if(!s){s=P[i].Property.PropertyPath;}else{s=s+', '+P[i].Property.PropertyPath;}if(P[i].Descending){s=s+' '+P[i].Descending.Bool;}}return s;},replaceSpecialCharsInId:function(i){if(i.indexOf(" ")>=0){jQuery.sap.log.error("Annotation Helper: Spaces are not allowed in ID parts. Please check the annotations, probably something is wrong there.");}return i.replace(/@/g,"").replace(/\//g,"::").replace(/#/g,"::");},getStableIdPartFromDataField:function(d){var p="",I="";if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.RecordType&&(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation")){if(d.SemanticObject.String){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.String);}else if(d.SemanticObject.Path){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.Path);}if(d.Action&&d.Action.String){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.Action&&d.Action.Path){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.Path);}return I;}else if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Target.AnnotationPath);}else if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the annotations.");}},getStableIdPartFromDataPoint:function(d){var p="";if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create stable ID derived from annotations.");}},getStableIdPartFromFacet:function(f){var h="";if(typeof this.getContext==="function"&&this.getContext()&&this.getContext().getPath()&&this.getContext().getPath().indexOf("com.sap.vocabularies.UI.v1.HeaderFacets")>=0){h="headerEditable::";}if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. You have to set an ID at all collection facets.");return Math.floor((Math.random()*99999)+1).toString();}}else if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{return h+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(f.Target.AnnotationPath);}}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the facet annotations.");return Math.floor((Math.random()*99999)+1).toString();}},extensionPointBeforeFacetExists:function(e,f,m){if(m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[E];}return false;},extensionPointAfterFacetExists:function(e,f,m){if(m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[E];}return false;},getExtensionPointBeforeFacetTitle:function(e,f,m){var E="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getExtensionPointAfterFacetTitle:function(e,f,m){var E="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[E];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getRepeatIndex:function(v){if(v&&v.getPath()){var p="0000000000";var P=p+((parseInt(v.getPath().substring(v.getPath().lastIndexOf("/")+1),10)+1)*10).toString();return P.substr(P.length-p.length);}else{jQuery.sap.log.error("Annotation Helper: Unable to get index.");}},getColumnListItemType:function(l,s){if(sap.suite.ui.generic.template.js.AnnotationHelper.hasSubObjectPage(l,s)){return"Navigation";}else{return"Inactive";}},hasSubObjectPage:function(l,s){var h=false;if(l.name&&s&&s.length>0){s.forEach(function(S){if(l.name===S.entitySet){h=true;return h;}});}return h;},isRelatedEntityCreatable:function(I,s,r,S,f,o){var b=false;var m=I.getInterface(0).getModel();var c=s["Org.OData.Capabilities.V1.InsertRestrictions"];var d=m.getODataEntityType(s.entityType);if(a.hasSubObjectPage(r,S)||(o&&a.isInlineCreate(f,o))){b="{= ${ui>/editable}}";if(c&&c.NonInsertableNavigationProperties&&c.NonInsertableNavigationProperties.length>0){for(var i=0;i<c.NonInsertableNavigationProperties.length;i++){var n=c.NonInsertableNavigationProperties[i];var N=sap.suite.ui.generic.template.js.AnnotationHelper._getNonInsertableNavigationPropertyPath(n);if(N){var A=m.getODataAssociationSetEnd(d,N);if(A&&A.entitySet===r.name){if(n.If&&n.If.length===2){var e=n.If[0];var F=e.Not?e.Not.Path:e.Path;if(sap.suite.ui.generic.template.js.AnnotationHelper._isPropertyPathBoolean(m,d.entityType,F)){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(I,F,d.name);if(e.Not){b="{= ${ui>/editable} ? ${"+F+"} : false}";}else{b="{= ${ui>/editable} ? !${"+F+"} : false}";}}else{b=false;jQuery.sap.log.warning("Creatable-Path is not valid. Creation for "+r.name+" is disabled");}}else{b=false;}break;}}}}}return b;},_getNonInsertableNavigationPropertyPath:function(n){var N;if(n.NavigationPropertyPath){N=n.NavigationPropertyPath;}else if(n.If){N=n.If[1].NavigationPropertyPath;}return N;},areDeleteRestrictionsValid:function(m,e,r){var b=!(r&&r.Deletable&&r.Deletable.Bool&&r.Deletable.Path)&&((!r)||(r.Deletable&&r.Deletable.Bool)||(r.Deletable&&r.Deletable.Path&&sap.suite.ui.generic.template.js.AnnotationHelper._isPropertyPathBoolean(m,e,r.Deletable.Path)));if(!b){jQuery.sap.log.error("Service Broken: Delete Restrictions annotations are invalid. ");}return b;},_areUpdateRestrictionsValid:function(m,e,r){var b=!(r&&r.Updatable&&r.Updatable.Bool&&r.Updatable.Path)&&((!r)||(r.Updatable&&r.Updatable.Bool)||(r.Updatable&&r.Updatable.Path&&sap.suite.ui.generic.template.js.AnnotationHelper._isPropertyPathBoolean(m,e,r.Updatable.Path)));if(!b){jQuery.sap.log.error("Service Broken: Delete Restrictions annotations are invalid. ");}return b;},_isPropertyPathBoolean:function(m,e,p){var P=p;var o=m.getODataEntityType(e);if(P.indexOf("/")>-1){var b=P.split("/");for(var j=0;j<b.length-1;j++){var A=m.getODataAssociationEnd(o,b[j]);o=m.getODataEntityType(A.type);}P=b[b.length-1];}var O=m.getODataProperty(o,P);return(O&&O.type==="Edm.Boolean");},actionControl:function(i,A,e){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,A,e);if(A){return"{path: '"+A+"'}";}else{return"true";}},_actionControlExpand:function(i,p,e){var E=[],s;i=i.getInterface(0);var m=i.getModel();var o=m.getODataEntityType(e);if(p){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,p);if(s){E.push(s);}}if(E.length>0){var P=i.getSetting("preprocessorsData");if(P){var r=P.rootContextExpand||[];for(var j=0;j<E.length;j++){if(r.indexOf(E[j])===-1){r.push(E[j]);}}P.rootContextExpand=r;}}},getEntityTypesForFormPersonalization:function(i,f,e){i=i.getInterface(0);var E=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var F=[];if(f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"&&f.Facets){F=f.Facets;}else if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){F.push(f);}F.forEach(function(f){var n;if(f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("/")>0){n=f.Target.AnnotationPath.split("/")[0];var b=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(b,n);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);if(E.indexOf(o.entityType.split(".")[1])===-1){E.push(o.entityType.split(".")[1]);}}}else{if(E.indexOf(e.entityType.split(".")[1])===-1){E.push(e.entityType.split(".")[1]);}}});return E.join(", ");},formatHeaderTitle:function(i,d){return"{parts: [{path: 'ui>/createMode'}, {path: '"+d.Title.Value.Path+"'}], formatter: '._templateFormatters.formatDefaultObjectTitle'}";},_mapTextArrangement4smartControl:function(t){var T="descriptionAndId";switch(t){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":T="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":T="idOnly";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly":T="descriptionOnly";break;default:break;}return T;},getTextArrangementForSmartControl:function(i,f,r,e){i=i.getInterface(0);var E;var m=i.getModel();if(r.name==undefined){E=m.getODataEntityType(e.entityType);}else{E=m.getODataEntityType(r.entityType);}var t="descriptionAndId";if(m.getODataProperty(E,f.Value.Path)){var p=m.getODataProperty(E,f.Value.Path)["com.sap.vocabularies.Common.v1.Text"];if(p&&p["com.sap.vocabularies.UI.v1.TextArrangement"]&&p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=sap.suite.ui.generic.template.js.AnnotationHelper._mapTextArrangement4smartControl(p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}}if(E["com.sap.vocabularies.UI.v1.TextArrangement"]&&E["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=sap.suite.ui.generic.template.js.AnnotationHelper._mapTextArrangement4smartControl(E["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}return t;},getTextArrangement:function(e,f){var t;if(f["com.sap.vocabularies.UI.v1.TextArrangement"]&&f["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=a._mapTextArrangement4smartControl(f["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}if(!t){var p=f["com.sap.vocabularies.Common.v1.Text"];if(p&&p["com.sap.vocabularies.UI.v1.TextArrangement"]&&p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=a._mapTextArrangement4smartControl(p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}}if(!t){if(e&&e["com.sap.vocabularies.UI.v1.TextArrangement"]&&e["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=a._mapTextArrangement4smartControl(e["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}}if(!t){t="descriptionAndId";}return t;},isDeepFacetHierarchy:function(f){if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){return true;}}}return false;},doesCollectionFacetOnlyContainForms:function(f){var r=true;if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].Target&&f.Facets[i].Target.AnnotationPath){if((f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")<0)&&(f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.Identification")<0)&&(f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.DataPoint")<0)){r=false;}}}}else{r=false;}return r;},doesFieldGroupContainOnlyOneMultiLineDataField:function(f,F){if(f.Data.length!==1){return false;}if((F['com.sap.vocabularies.UI.v1.MultiLineText']===undefined)||(f.Data[0].RecordType!=="com.sap.vocabularies.UI.v1.DataField")){return false;}return true;},testFormatter:function(v){return"formatted:"+v;},getFacetID:function(e,f){return e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);},formatComponentSettings:function(i,e,r,n){var t=i.getInterface(0),m=t.getModel(),E=m.getODataEntityType(e.entityType);n=n||r.binding;if(n){var A=m.getODataAssociationSetEnd(E,n);if(A&&A.entitySet){e=m.getODataEntitySet(A.entitySet);E=m.getODataEntityType(e.entityType);}}var s=sap.ui.model.odata.AnnotationHelper.format(t,e["com.sap.vocabularies.Common.v1.SemanticObject"]);var o="";E.key.propertyRef.forEach(function(k){o+="{"+k.name+"}::";});o=o.replace(/::$/,"");var b={"uiMode":"{= ${ui>/createMode} ? '"+U.Create+"' : ( ${ui>/editable} ? '"+U.Edit+"' : '"+U.Display+"') }","semanticObject":s||""};if(r){jQuery.extend(b,r.settings);var v=JSON.stringify(b);v=v.replace(/\}/g,"\\}").replace(/\{/g,"\\{");return v;}},isListReportTemplate:function(r){if(r){return r.template==="sap.suite.ui.generic.template.ListReport";}},isAnalyticalListPageOrListReportTemplate:function(r){if(r){return(r.template==="sap.suite.ui.generic.template.AnalyticalListPage"||r.template==="sap.suite.ui.generic.template.ListReport");}},getStableIdPartForDatafieldActionButton:function(d,f){var s="";var D="";var F="";if(f){F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);}if(d){D=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}s=(F!==""?F+"::":"")+"action::"+D;return s;},_hasCustomDeterminingActionsInListReport:function(e,m){if(m&&m[e]){var M=m[e];if(M.Actions){for(var b in M.Actions){if(M.Actions[b].determining){return true;}}}}return false;},_hasCustomDeterminingActionsInObjectPage:function(e,m){if(m&&m[e]){var M=m[e];if(M.Header&&M.Header.Actions){for(var b in M.Header.Actions){if(M.Header.Actions[b].determining){return true;}}}}return false;},hasDeterminingActionsRespectingApplicablePath:function(c,t,e,m){var A="";c=c.getInterface(0);if(e&&m&&m["sap.suite.ui.generic.template.ObjectPage.view.Details"]&&sap.suite.ui.generic.template.js.AnnotationHelper._hasCustomDeterminingActionsInObjectPage(e,m["sap.suite.ui.generic.template.ObjectPage.view.Details"]["sap.ui.generic.app"])){return"true";}if(t){for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction")&&t[r].Determining&&t[r].Determining.Bool==="true"){var f=c.getModel().getODataFunctionImport(t[r].Action.String,true);var F=c.getModel().getObject(f);if(F["sap:applicable-path"]){if(A.length>0){A+=" || ";}A+="${path: '"+F["sap:applicable-path"]+"'}";}else{return"true";}}}}if(A.length>0){return"{= "+A+" || ${ui>/editable}}";}else{return"{ui>/editable}";}},hasDeterminingActions:function(t,e,m){if(e&&m&&m["sap.suite.ui.generic.template.ListReport.view.ListReport"]&&sap.suite.ui.generic.template.js.AnnotationHelper._hasCustomDeterminingActionsInListReport(e,m["sap.suite.ui.generic.template.ListReport.view.ListReport"]["sap.ui.generic.app"])){return"true";}else if(e&&m&&m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]&&sap.suite.ui.generic.template.js.AnnotationHelper._hasCustomDeterminingActionsInListReport(e,m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"])){return"true";}for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&t[r].Determining&&t[r].Determining.Bool==="true"){return"true";}}return"false";},actionControlDetermining:function(r,A){if(sap.suite.ui.generic.template.js.AnnotationHelper.isListReportTemplate(r)||!A){return true;}else{return"{path: '"+A+"'}";}},actionControlInline:function(A){if(!A){return true;}else{return"{path: '"+A+"'}";}},actionControlBreakout:function(A){if(!A){return true;}else{return"{path: '"+A+"'}";}},buildExpressionForProgressIndicatorPercentValue:function(i,d,u){var p="0";if(d.Value&&d.Value.Path){var v="$"+sap.ui.model.odata.AnnotationHelper.format(i,d.Value);var t,s;if(d.TargetValue){t=sap.ui.model.odata.AnnotationHelper.format(i,d.TargetValue);t=d.TargetValue.Path?"$"+t:t;}if(u){u=u['Org.OData.Measures.V1.Unit']||u["Org.OData.Measures.V1.ISOCurrency"];if(u){s=sap.ui.model.odata.AnnotationHelper.simplePath(i,u);s=s&&u.Path?"$"+s:"'"+s+"'";}}var e="({0} > 100 ? 100 : {0} < 0 ? 0 : {0})";var E="(({1} > 0) ? (({0} > {1}) ? 100 : (({0} < 0) ? 0 : ({0} / {1} * 100))) : 0)";var b="'{'= ({2} === ''%'') ? "+e+" : "+E+" '}'";p=jQuery.sap.formatMessage(b,[v,t,s]);}return p;},buildExpressionForProgressIndicatorDisplayValue:function(i,d,u){var p;var b=function(i,P){var s=sap.suite.ui.generic.template.js.AnnotationHelper.trimCurlyBraces(sap.ui.model.odata.AnnotationHelper.format(i,P));var c="{path: '"+s+"'}";return c;};p=b(i,d.Value)+", "+b(i,d.TargetValue)+", "+b(i,u);var D="{ parts: ["+p+"], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatDisplayValue' }";return D;},formatDisplayValue:function(v,t,u){var d="";if(v){var c=this;var r=c.getModel("i18n").getResourceBundle();var C=c.getCustomData();t=t||C[0].getValue();u=u||C[1].getValue();if(u){if(u==='%'){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_PERCENT",[v]);}else{if(t){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT",[v,t,u]);}else{d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT_NO_TARGET_VALUE",[v,u]);}}}else{if(t){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[v,t]);}else{d=v;}}}else{jQuery.sap.log.warning("Value property is mandatory, the default (empty string) will be returned");}return d;},buildExpressionForProgressIndicatorCriticality:function(i,d){var f=sap.ui.core.ValueState.None;var e;var c=d.Criticality;if(c){e="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+sap.ui.core.ValueState.Error+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+sap.ui.core.ValueState.Warning+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+sap.ui.core.ValueState.Success+"'' : "+"''"+sap.ui.core.ValueState.None+"'' '}'";if(c.Path){var C='$'+sap.ui.model.odata.AnnotationHelper.simplePath(i,c);f=jQuery.sap.formatMessage(e,C);}else if(c.EnumMember){var s="'"+c.EnumMember+"'";f=jQuery.sap.formatMessage(e,s);}else{jQuery.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}}else{jQuery.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}return f;},trimCurlyBraces:function(v){return v?v.replace("{","").replace("}",""):undefined;},getEntitySetName:function(r,e){var E="";try{E=r.name||e.name;}catch(o){jQuery.sap.log.warning("At least one of the input parameters is undefined. Returning default value for entity set name.");}return E;},getBreakoutActionEnabledKey:function(A){var e="{_templPriv>/generic/listCommons/breakoutActionsEnabled/"+A.id+"/enabled}";return e;},buildVisibilityExprOfDataFieldForIntentBasedNaviButton:function(d){if(!!d.RequiresContext&&d.RequiresContext.Bool=="false"&&(!d.Inline||d.Inline.Bool==="false")){var s=d.SemanticObject.String;var A=d.Action.String;return"{= !!${_templPriv>/generic/supportedIntents/"+s+"/"+A+"/visible}}";}else{return true;}},searchForFirstSemKey_Title_Description:function(e){var t,d,D,T,E,f,l,h,H,s,L,i;var b=e.getPath();var c=b+'/'+"com.sap.vocabularies.UI.v1.LineItem"+'/';if(e){E=e.getObject();f=E["com.sap.vocabularies.Common.v1.SemanticKey"]&&E["com.sap.vocabularies.Common.v1.SemanticKey"][0]&&E["com.sap.vocabularies.Common.v1.SemanticKey"][0].PropertyPath;l=E["com.sap.vocabularies.UI.v1.LineItem"];h=E["com.sap.vocabularies.UI.v1.HeaderInfo"];H=h&&h["Title"]&&h["Title"].Value&&h["Title"].Value.Path;s=h&&h["Description"]&&h["Description"].Value&&h["Description"].Value.Path;L=l&&l.length;for(i=0;i<L;i++){if(l[i].RecordType==="com.sap.vocabularies.UI.v1.DataField"&&l[i].Value.Path===f){if(a.isPropertyHidden(l[i])){continue;}c=c+i+'/Value/Path';return c;}if(l[i].RecordType==="com.sap.vocabularies.UI.v1.DataField"&&l[i].Value.Path===H){if(a.isPropertyHidden(l[i])){continue;}t=true;T=i;}if(l[i].RecordType==="com.sap.vocabularies.UI.v1.DataField"&&l[i].Value.Path===s){if(a.isPropertyHidden(l[i])){continue;}d=true;D=i;}}if(t){c=c+T+'/Value/Path';return c;}else if(d){c=c+D+'/Value/Path';return c;}}else{jQuery.sap.log.warning("No entity type provided");}},isPropertyHidden:function(l){var h=false;if(l["com.sap.vocabularies.UI.v1.Hidden"]||(l["com.sap.vocabularies.Common.v1.FieldControl"]&&l["com.sap.vocabularies.Common.v1.FieldControl"].EnumMember&&l["com.sap.vocabularies.Common.v1.FieldControl"].EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden")){h=true;}return h;},getColumnHeaderText:function(d,D){var r;if(D.Label){return D.Label.String;}else{r=d["sap:label"]||(d["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return r;}},getTextForDataField:function(d){var v=d["com.sap.vocabularies.Common.v1.Text"]&&d["com.sap.vocabularies.Common.v1.Text"].Path;return v;},getColumnCellFirstText:function(d,D,e){var r,t;t=a.getTextArrangement(e,d);switch(t){case"idAndDescription":r=D.Value.Path;if(!r){r=a.getTextForDataField(d);}break;case"idOnly":r=D.Value.Path;if(!r){r=a.getTextForDataField(d);}break;case"descriptionAndId":case"descriptionOnly":default:r=a.getTextForDataField(d);if(!r){r=D.Value.Path;}break;}if(r){return"{"+r+"}";}},getColumnCellSecondText:function(d,D,e){var r,t;t=a.getTextArrangement(e,d);switch(t){case"idOnly":case"descriptionOnly":break;case"idAndDescription":if(!D.Value.Path){break;}r=a.getTextForDataField(d);break;case"descriptionAndId":default:if(!a.getTextForDataField(d)){break;}r=D.Value.Path;break;}if(r){return"{"+r+"}";}},getAdditionalSemanticObjects:function(d){var A;var b=[];for(A in d){if(A.indexOf("com.sap.vocabularies.Common.v1.SemanticObject#")!=-1){b.push(d[A].String);}}if(b.length>0){return b;}},getColumnCellFirstTextVisibility:function(d,D,e){var v=!!a.getColumnCellFirstText(d,D,e);return v;},getColumnCellSecondTextVisibility:function(d,D,e){var v=!!a.getColumnCellSecondText(d,D,e);return v;}};sap.suite.ui.generic.template.js.AnnotationHelper=a;sap.suite.ui.generic.template.js.AnnotationHelper.getLinkTextForDFwithIBN.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getLabelForDFwithIBN.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatComponentSettings.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getRepeatIndex.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getCurrentPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEntityTypesForFormPersonalization.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.actionControl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatHeaderTitle.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getTextArrangementForSmartControl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.matchesBreadCrumb.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13N.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForIndicator.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForAction.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForContactPopUp.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForChart.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.hasDeterminingActionsRespectingApplicablePath.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildExpressionForProgressIndicatorPercentValue.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildExpressionForProgressIndicatorDisplayValue.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildExpressionForProgressIndicatorCriticality.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEditActionButtonVisibility.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getDeleteActionButtonVisibility.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.isRelatedEntityCreatable.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildBreadCrumbExpression.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getApplicablePathForChartToolbarActions.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildAnnotatedActionButtonEnablementExpression.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterText.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatImageUrl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatHeaderImage.requiresIContext=true;})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.AnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.AnnotationHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/AnnotationHelper",["sap/ui/base/Object","sap/ui/model/Context","sap/ui/model/odata/AnnotationHelper","sap/ui/model/json/JSONModel"],function(B,C,O,J){"use strict";var A=B.extend("sap.suite.ui.generic.template.js.QuickTemplates.AnnotationHelper");A.TITLE_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/Title/Value","com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value","com.sap.vocabularies.UI.v1.Identification/0/Value"];A.HEADLINE_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/HeadLine/Value","com.sap.vocabularies.Communication.v1.Contact/role","com.sap.vocabularies.UI.v1.HeaderInfo/Description/Value","com.sap.vocabularies.UI.v1.Identification/0/Value","com.sap.vocabularies.UI.v1.Identification/1/Value"];A.IMAGEURL_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/ImageUrl/Value","com.sap.vocabularies.UI.v1.HeaderInfo/ImageUrl/Value"];A.ICONURL_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/TypeImageUrl/Value"];A.TYPENAME_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.HeaderInfo/TypeName/Value","com.sap.vocabularies.Common.v1.SemanticObject/String"];A._getAnnotationItem=function(c,v,f,F){if(c&&v&&f){var V=c.getProperty(v);if(F&&V&&V[f]){var i=V[f];return i[F];}return V?V[f]:null;}return undefined;};A.getAnnotationItemForVocabulary=function(c,v){if(v){var p=v.split("/");return A._getAnnotationItem(c,p[0],p.length>1?p[1]:null,p.length>2?p[2]:null);}return undefined;};A.getAnnotationFirstItemFromVocabularies=function(c,v,s){var I=null;if(v&&Array.isArray(v)){for(var i=0;!I&&i<v.length;++i){I=A.getAnnotationItemForVocabulary(c,v[i]);if(s&&I&&A._isEqualValues(s,I)){I=null;}}}return I;};A._resolveBadgeImgUrl=function(c){return A.getAnnotationFirstItemFromVocabularies(c,A.IMAGEURL_ANNO_HEURISTIC);};A._resolveBadgeIconUrl=function(c){var i=A.getAnnotationFirstItemFromVocabularies(c,A.ICONURL_ANNO_HEURISTIC);if(!i){i="sap-icon://form";}return i;};A._resolveBadgeTitle=function(c){return A.getAnnotationFirstItemFromVocabularies(c,A.TITLE_ANNO_HEURISTIC);};A._resolveBadgeTypeName=function(c){return A.getAnnotationFirstItemFromVocabularies(c,A.TYPENAME_ANNO_HEURISTIC);};A._resolveBadgeHeadline=function(c,t){return A.getAnnotationFirstItemFromVocabularies(c,A.HEADLINE_ANNO_HEURISTIC,t);};A._getAnnotationObject=function(i){if(i){var p={};if(i.Label){p.Path=i.Label.Path||i.Label;}else if(i.Value){p.Path=i.Value.Path||i.Value;}else if(i.String){p.String=i.String;}else if(i.Path){p.Path=i.Path;}else{p.String=i;}return p;}return undefined;};A._isEqualValues=function(i,I){if(i&&I){if(i.String&&I.String){return i.String===I.String;}if(i.Value&&I.Value){return i.Value.Path===I.Value.Path;}if(i.Label&&I.Label){return i.Label.Path===I.Label.Path;}}return false;};A._createBadgeContext=function(i,t,T,o,s){var m=new J();var b=new C(m,"/");var I={};var a=A._getAnnotationObject(i);var c=A._getAnnotationObject(t);if(a&&a.String&&a.String.toLowerCase().indexOf("sap-icon://")<0){I.ImageUrl=a;}else{I.TypeImageUrl=c||a;}I.Title=A._getAnnotationObject(T);I.TypeName=A._getAnnotationObject(o);I.SubTitle=A._getAnnotationObject(s);m.setData(I);return b;};A.resolveBadgeTarget=function(c){if(c){var i=A._resolveBadgeImgUrl(c);var t=A._resolveBadgeIconUrl(c);var T=A._resolveBadgeTitle(c);var s=A._resolveBadgeTypeName(c);var h=A._resolveBadgeHeadline(c,T);return A._createBadgeContext(i,t,T,s,h);}return undefined;};A.resolveFieldGroupTarget=function(c){var f=A._getFacetOfType(c,"FieldGroup");if(f){return O.resolvePath(c.getModel().createBindingContext(c.getPath()+"/"+f.index+"/Target"));}return null;};A.resolveLineItemTarget=function(c){var f=A._getFacetOfType(c,"LineItem");if(f){return O.resolvePath(c.getModel().createBindingContext(c.getPath()+"/"+f.index+"/Target"));}return null;};A.resolveFieldGroupFacet=function(c){var f=A._getFacetOfType(c,"FieldGroup");if(f){return c.getPath()+"/"+f.index;}return undefined;};A.resolveLineItemFacet=function(c){var f=A._getFacetOfType(c,"LineItem");if(f){return c.getPath()+"/"+f.index;}return undefined;};A._getFacetOfType=function(c,f){var a=c.getObject();var t=-1;var b=null;if(Array.isArray(a)){jQuery.each(a,function(i,d){if(d.Target&&d.Target.AnnotationPath&&d.Target.AnnotationPath.indexOf(f)>=0){t=i;b=d;}});}if(t>=0){return{facet:b,index:t};}return undefined;};A.getAllPropertyPathsFromFacet=function(c,f){var i=A.createFormatterInterface(c);var m=c.getModel().getMetaModel();var M=A.getMetaDataForContext(c);var o=A.getMetaModelContextForFacetType(i,M.entityType.namespace+"."+M.entityType.name,f);var r=O.resolvePath(o);var R=m.getProperty(r);var a=R.Data||R;var p=[];if(a&&Array.isArray(a)){jQuery.each(a,function(b,d){if(d.RecordType==='com.sap.vocabularies.UI.v1.DataField'&&d.Value&&d.Value.Path){p.push(d.Value.Path);}});}return p;};A.getMetaModelContextForFacetType=function(I,e,f){var m=I.getModel()||I.getModel(0);var E=m.getODataEntityType(e);var s=["QuickCreate","QuickView"];var F="";var M=null;var a=null;for(var i=0;i<s.length;i++){F="com.sap.vocabularies.UI.v1."+s[i]+"Facets";if(E[F]){a=E[F];break;}}if(a){var t=-1;if(Array.isArray(a)){jQuery.each(a,function(i,b){if(b.Target&&b.Target.AnnotationPath&&b.Target.AnnotationPath.indexOf(f)>=0){t=i;}});}if(t>=0){M=new C(m,E.$path+"/"+F+"/"+t+"/Target");}}return M;};A.formatExpandBindingPathForHeaderObject=function(i,e){var h=A.getNavigationPathsFromFacet(i,e,"FieldGroup");return A.formatExpandPaths(h);};A.getMetaDataForContext=function(c){var m=c.getModel().getMetaModel();var e=m.getODataEntityType(c.getObject().__metadata.type);var E=null;var o=m.getProperty(m.getODataEntityContainer(true)).entitySet;jQuery.each(o,function(i,b){if(b.entityType===c.getObject().__metadata.type){E=b.name;}});var a=m.getODataEntitySet(E);return{entityType:e,entitySet:a};};A.getNavigationPathsUsingAnnotationHeuristics=function(o,e){var m={};var M=o.getModel().getMetaModel();if(o&&o.getObject()){m=A.getMetaDataForContext(o);}else if(e){m.entityType=M.getODataEntityType(e);}var n={};if(m&&m.entityType){var t=A.TITLE_ANNO_HEURISTIC.concat(A.HEADLINE_ANNO_HEURISTIC);var i=0;for(;i<t.length;i++){var a=new C(M,m.entityType.$path+"/"+t[i]);var b=O.getNavigationPath(a);if(b){b=b.replace(/[{}]/g,'');if(b){n[b]="";}}}}return Object.keys(n);};A.getNavigationPathsFromFacet=function(I,e,f){var m=I.getModel()||I.getModel(0);var M=A.getMetaModelContextForFacetType(I,e,f);if(!M){return[];}var r=O.resolvePath(M);var R=m.getProperty(r);var n={};var p="/";if(R.Data){p+="Data/";}var a=R.Data||R;if(a&&Array.isArray(a)){jQuery.each(a,function(i,d){if(d.RecordType=='com.sap.vocabularies.UI.v1.DataField'&&d.Value&&d.Value.Path){var b=new C(m,r+p+i+"/Value");var c=O.getNavigationPath(b);c=c.replace(/[{}]/g,'');if(c){n[c]="";}}});}return Object.keys(n);};A.getLineItemsNavPropertyName=function(i,e){var m=A.getMetaModelContextForFacetType(i,e,"LineItem");if(m){var c=O.getNavigationPath(m);c=c.replace(/[{}]/g,'');return c;}return undefined;};A.formatBindingPathForLineItems=function(i,e,I){var l=A.getLineItemsNavPropertyName(i,e);if(arguments.length===2){I=false;}if(I){var a=A.getNavigationPathsFromFacet(i,e,"LineItem");if(a&&a.length>0){return"{path: '"+l+"', parameters : {expand:'"+A.formatExpandPaths(a)+"'}}";}}return"{path: '"+l+"'}";};A.formatExpandPaths=function(e){var E="";for(var i=0;i<e.length;i++){E+=e[i];if(i<e.length-1){E+=",";}}return E;};A.createFormatterInterface=function(b){var m=b.getModel().getMetaModel().getMetaContext(b.getPath());var i={getModel:function(){return b.getModel().getMetaModel();},getContext:function(){return m;},getPath:function(){return m.getPath();}};return i;};A.formatBindingPathForLineItems.requiresIContext=true;A.getMetaModelContextForFacetType.requiresIContext=true;A.formatExpandBindingPathForHeaderObject.requiresIContext=true;A.resolveFieldGroupTarget.requiresIContext=true;A.resolveLineItemTarget.requiresIContext=true;A.resolveLineItemFacet.requiresIContext=true;A.resolveFieldGroupFacet.requiresIContext=true;A.resolveBadgeTarget.requiresIContext=true;return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.ODataModelHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.ODataModelHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/ODataModelHelper",["sap/ui/base/Object","./AnnotationHelper","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context"],function(B,Q,O,C){"use strict";var a=B.extend("sap.suite.ui.generic.template.js.QuickTemplates.ODataModelHelper");a.createKeyFromPath=function(s,t,T){try{var b=a.parseEntityKeysFromContextPath(s);var c=a.getKeyInfoForEntitySet(t,T);if(c.entitySet===b.entitySet&&b.keys.length===c.keys.length){if(s.startsWith("/")){return s.substring(1);}return s;}var r=""+c.entitySet+"(";jQuery.each(c.keys,function(i,d){if(!d.mapped){jQuery.each(b.keys,function(j,f){if(f.property===d.property&&f.type===d.type){d.value=f.value;d.mapped=true;return false;}return true;});}if(!d.mapped){jQuery.each(b.keys,function(j,f){var g=f.property.toLowerCase();var h=d.property.toLowerCase();if(h.indexOf(g)>=0&&f.type===d.type){d.value=f.value;d.mapped=true;return false;}return true;});}if(!d.mapped){jQuery.each(b.keys,function(j,f){if(f.property===d.property){if(f.type==="Edm.String"&&d.type!=="Edm.String"){d.value=f.value.substring(1,f.value.length-1);}else if(f.type!=="Edm.String"&&d.type==="Edm.String"){d.value="'"+f.value+"'";}else{d.value=f.value;}d.mapped=true;return false;}return true;});}if(!d.mapped){jQuery.each(b.keys,function(j,f){if(f.type===d.type){d.value=f.value;d.mapped=true;return false;}return true;});}r+=d.property+"="+d.value;if(i<c.keys.length-1){r+=",";}});r+=")";return r;}catch(e){if(s&&s.startsWith("/")){return s.substring(1);}return s;}};a.parseEntityKeysFromContextPath=function(p){var b=p;var r={entitySet:"",keys:[]};if(!b){return r;}if(b.startsWith("/")){b=b.substring(1);}var c=b.split("(");if(c.length>1){r.entitySet=c[0];var k=c[1].split(")")[0];if(k){var d=k.split(",");jQuery.each(d,function(i,e){if(e){var f=e.split("=");var g={};if(f.length==1){g.value=f[0];g.property="";}else if(f.length==2){g.property=f[0];g.value=f[1];}if(g.value){if(g.value.indexOf("guid")==0&&g.value.length==42){g.type="Edm.Guid";}else if(g.value.charAt(0)==="'"&&g.value.charAt(g.value.length-1)==="'"){g.type="Edm.String";}else if(g.value=="true"||g.value=="false"){g.type="Edm.Boolean";}else if(jQuery.isNumeric(g.value)){g.type="Edm.Int";}else{g.type="";}r.keys.push(g);}}});}}return r;};a.getKeyInfoForEntitySet=function(m,e){var r={entitySet:"",keys:[]};var k={};if(m&&e){var b=m.getODataEntitySet(e);r.entitySet=b.name;var c=m.getODataEntityType(b.entityType);jQuery.each(c.key.propertyRef,function(i,p){k[p.name]="1";});jQuery.each(c.property,function(i,p){if(k[p.name]){var d={property:p.name,value:a.getDefaultKeyValueForProperty(p),type:(p.type.indexOf("Edm.Int")>=0?"Edm.Int":p.type)};r.keys.push(d);}});}return r;};a.getDefaultKeyValueForProperty=function(p){if(p.name.indexOf("IsActive")>=0&&p.type==="Edm.Boolean"){return"true";}else{switch(p.type){case"Edm.String":{return"''";}case"Edm.Guid":{return"guid'00000000-0000-0000-0000-000000000000'";}case"Edm.Boolean":{return"false";}default:{if(p.type.indexOf("Int")>=0){return"0";}return"''";}}}};a.initializeObjectProperties=function(o,p,c){var t=[];var k=o.getModel().getKey(o.getObject());var b=o.getModel().oData[k];if(b){t.push(b);}var d=o.getModel().mChangedEntities[k];if(d){t.push(d);}var e=Q.getMetaDataForContext(o);var i=0;if(p&&Array.isArray(p)){jQuery.each(p,function(f,g){var h=g.split("/");var j=h[0];var l=null;if(h.length>1){l=h.slice(1).join("/");}if(jQuery.isNumeric(j)&&l){a.initializeObjectProperties(o,[l],c);return;}i=0;var m=false;if(e.entityType.navigationProperty){for(;i<e.entityType.navigationProperty.length;i++){if(e.entityType.navigationProperty[i].name===j){m=true;break;}}}if(m&&!b[j]){var n=o.getModel().createEntry(o.getPath()+"/"+j,c);b[j]={__deferred:{}};a.restoreNavigationPropertyReferences(o,j,n);if(l){a.initializeObjectProperties(n,[l],c);}}});}};a.restoreLineItemReferences=function(e,c){var i=Q.createFormatterInterface(c);var m=Q.getMetaModelContextForFacetType(i,e,"LineItem");if(m){var s=O.getNavigationPath(m);s=s.replace(/[{}]/g,'');a.restoreNavigationPropertyReferences(c,s);}};a.restoreNavigationPropertyReferences=function(p,n,c){if(!n){return;}if(!p.getObject()){return;}var m=p.getModel().getMetaModel();var o=p.getModel().getKey(p.getObject());var b=p.getModel().oData[o];var e=m.getODataEntityType(b.__metadata.type);var N=m.getODataAssociationEnd(e,n);var s=null;var E=m.getProperty(m.getODataEntityContainer(N.type)).entitySet;jQuery.each(E,function(i,g){if(g.entityType===N.type){s=g.name;}});if(!b[n]){b[n]={};}if(b[n].__list){b[n].__list=[];}var d=function(k){if(b[n].__deferred){delete b[n].__deferred;}if(N.multiplicity==="*"){if(!b[n].__list){b[n].__list=[];}b[n].__list.push(k);}else{b[n].__ref=k;}};if(!c){var f=Object.keys(p.getModel().oData);jQuery.each(f,function(i,k){if(k.indexOf(s)>=0){d(k);}});}else{var k=c.getPath().substring(1);d(k);}};a.findObjects=function(){var p,b,c;if(arguments.length===3){p=arguments[0];b=arguments[1];c=arguments[2];}else if(arguments.length==2){b=arguments[0];c=arguments[1];}var k=c.key||undefined,m=c.matchCallback||undefined,n=c.noMatchCallback||undefined,d=c.maxNestedLevel||3;var e=true;if(!d){d=3;}if(!a.findObjects._recursionCount){a.findObjects._recursionCount=0;}a.findObjects._recursionCount++;if(a.findObjects._recursionCount>d){a.findObjects._recursionCount--;return;}var f=function(o){var s=Object.prototype.toString.call(o);return(s==='[object Array]'||s==='[object Object]');};var h=Object.prototype.hasOwnProperty.bind(b);if(b){for(var i in b){if(h(i)){var I=f(b[i]);if(b[i]&&I){b[i].__nestedKey=i;}e=true;if(i===k&&m){e=m(p,b,b[i]);}else if(n){e=n(p,b,b[i]);}if(e&&I){a.findObjects(b,b[i],{key:k,matchCallback:m,noMatchCallback:n,maxNestedLevel:d});}if(b[i]&&I){delete b[i].__nestedKey;}}}}a.findObjects._recursionCount--;};return a;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.QuickActionBaseController')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.QuickActionBaseController');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/QuickActionBaseController",["sap/ui/core/mvc/Controller","sap/m/MessageBox","./AnnotationHelper"],function(M,a,A){"use strict";var B=M.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickActionBaseController",{onInit:function(){if(!this._bIsInitialized){this._bIsInitialized=true;this.oComponent=this.getOwnerComponent()||this.getView().getViewData().component;var v=this.getView();v.setModel(this.oComponent.getModel());this.sEntitySet=this.oComponent.getEntitySet();this.oDraftController=this.oComponent.getTransactionController().getDraftController();this.bDraftEnabled=this.oDraftController.getDraftContext().isDraftEnabled(this.sEntitySet);var m=this.getView().getModel().getMetaModel();this.oEntitySetMeta=m.getODataEntitySet(this.sEntitySet);this.oEntityTypeMeta=m.getODataEntityType(this.oEntitySetMeta.entityType);this.oSmartFieldEventDelegate={onAfterRendering:jQuery.proxy(function(e){this._onSmartFieldAfterRendering(e);},this)};}},_onMetaModelLoaded:function(){},_onSmartFieldAfterRendering:function(e){},onBeforeRendering:function(){if(!this._bMetaDataInit){this._bMetaDataInit=true;this.getView().getModel().getMetaModel().loaded().then(jQuery.proxy(this._onMetaModelLoaded,this),jQuery.proxy(this.onError,this));}this.setBusy(false);},setBusy:function(b){if(this.getView().getModel("ui")){this.getView().getModel("ui").setProperty("/busy",b);this.getView().getModel("ui").updateBindings();}},bindView:function(c){var i=this._getFormatterInterface(c);var e=A.formatExpandBindingPathForHeaderObject(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name);this.oContext=c;this.getView().bindElement({path:c.getPath(),parameters:{expand:e}});},onError:function(e){this.setBusy(false);if(e.message){this._showErrorMessage(e);}else if(e.response){this._showErrorMessage(e.response);}else{this._showErrorMessage({message:this.formatI18NMessage("QuickAction_Generic_Error")});}},onSmartFieldsCreated:function(e){var c=e.getParameters()[0];if(c&&typeof c.addEventDelegate==='function'){c.removeEventDelegate(this.oSmartFieldEventDelegate);c.addEventDelegate(this.oSmartFieldEventDelegate);}},formatI18NMessage:function(){if(arguments&&arguments[0]){var i=arguments[0];var r=this.getView().getModel("i18n").getResourceBundle();if(arguments.length>1){var b=Array.prototype.slice.call(arguments);return r.getText(i,b.splice(1,arguments.length-1));}return r.getText(i);}return arguments;},_getFormatterInterface:function(c){var b=c?c:this.getView().getBindingContext();return A.createFormatterInterface(b);},_setBindingContext:function(c){this.getView().setBindingContext(c);this.setBusy(false);},_showErrorMessage:function(e){var b=e.response||e;var d=b.message;if(b.statusText){d=b.statusText;}if(b&&b.responseText){try{var E=jQuery.parseJSON(b.responseText);var s=this._getErrorDetail(E);d=(s&&s.length>0)?s:d;}catch(c){}}a.show(d,{icon:a.Icon.ERROR,title:this.formatI18NMessage("QuickAction_Error_Popover"),actions:[a.Action.OK]});},_getErrorDetail:function(e){var d="";if(e&&e.error&&e.error.message){if(e.error.innererror&&e.error.innererror.errordetails&&e.error.innererror.errordetails.length>0){jQuery.each(e.error.innererror.errordetails,jQuery.proxy(function(i,b){d+=b.severity+": "+b.message+"\n\n";},this));}else if(e.error.message.value){d=e.error.message.value;}}return d;}});return B;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.QuickCreateAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.QuickCreateAPI');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.generic.app.transaction.DraftContext');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/QuickCreateAPI",["sap/ui/base/ManagedObject","sap/ui/generic/app/transaction/DraftContext","sap/m/MessageToast"],function(M,D,a){"use strict";var Q=M.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickCreateAPI",{metadata:{library:"sap.suite.ui.generic.template",properties:{},events:{objectCreated:{parameters:{context:{type:"sap.ui.model.Context"}}},destroyed:{parameters:{collectionItemGuid:{type:"String"}}},autofillLineItems:{parameters:{numberOfLineItems:{type:"Number"}}}}}});Q.EVENT_CONSTANTS={EventChannel:"sap.fiori.cp.quickactions.EventChannel",QUICKCREATE_LINE_ITEMS_FOUND:"LineItemsFound",QUICKCREATE_VIEW_CREATED:"QuickCreateViewCreated"};Q.CopilotModelName="FioriCopilotODataModel";Q._Instances={};Q.getInstance=function(c){if(!c){return undefined;}if(c.copilotEntity){return Q._Instances[c.copilotEntity.getODataKey()];}else{return Q._Instances[c];}};Q.createAPI=function(c,C,o){function g(){return o.getView().getBindingContext().getObject();}function b(){return o.getQuickCreateItem();}function d(){return C;}function e(){return c;}function f(){return sap.ui.getCore().getModel(Q.CopilotModelName);}function u(i){if(this._bDestroyed){return;}var G=this.getQuickCreateItem();if(G.draftid===i){return;}G.draftid=i;G.copilotEntity.update(G,{error:jQuery.proxy(function(H){jQuery.sap.log.error(H,"","QuickCreateAPI");},this)});}function h(){return C.getAggregation("rootControl");}function j(){return this.oRootView;}function s(i){this.oRootView=i;this.calculateViewHeight(this.oRootView,true);}function k(){if(this.oRootView&&this.oRootView.getController()&&this.oRootView.getController().bDraftEnabled!==undefined){return this.oRootView.getController().bDraftEnabled;}if(!this.oRootView||!this.oRootView.getBindingContext()){return undefined;}var i=new D(this.getQuickCreateModel());return i.hasDraft(this.oRootView.getBindingContext());}function l(){var i=this.getComponentInstance().getModel();if(!i&&this.oRootView){i=this.oRootView.getModel();}return i;}function m(){return o.isCurrentUserCreator();}function n(){if(!this.oRootView){return undefined;}return this.oRootView.getBindingContext();}function p(){var i=this.getQuickCreateRootBindingContext();if(i&&i.getObject()){return i.getObject().__metadata.type;}return undefined;}function _(i,G,P){var H=P.numberOfLineItems;if(H<=0){return;}this.fireAutofillLineItems({numberOfLineItems:H});}function q(){this._attachToModelBindingChanges();if(!this.oRootView){var V=o.oViewUtils.findFirstViewFromControlHierarchy(this.getRootControl());if(V){this.setRootView(V);}}}function r(){if(!this._bBindingChangeAttached){var i=C.getModel();if(i){var G=i.addBinding.bind(i);var H=this;i.addBinding=function(I){G(I);I.attachEvent("change",H._onDataBindingChanged);};this._bBindingChangeAttached=true;}}}function t(){return new Promise(jQuery.proxy(function(i,G){var H=this.getCopilotModel();H.read("/"+H.getKey(this.getQuickCreateItem()),{success:jQuery.proxy(function(I,R){if(I.modeljson){var J=this.getQuickCreateModel();this._loadingJSON=true;if(this.isDraftEnabled()){J.oData=JSON.parse(I.modeljson);}else{var K=JSON.parse(I.modeljson);J.mChangedEntities=K.mChangedEntities;J.mChangeHandles=K.mChangeHandles;J.mDeferredRequests=K.mDeferredRequests;J.oData=K.oData;}J.updateBindings();}if(i){i();}delete this._loadingJSON;},this),error:jQuery.proxy(function(I){if(G){G(I);}},this)});},this));}function v(){if(!this._oUpdateModelJSONTimer){this._oUpdateModelJSONTimer=setTimeout(this._updateModelJSON,2000);}}function w(){if(this._loadingJSON||this._bDestroyed||!this.isCurrentUserCreator()){return;}this._oUpdateModelJSONTimer=null;var G=this.getQuickCreateItem();var H=this.getQuickCreateModel();var I="";if(this.isDraftEnabled()){var J={};var K=Object.keys(H.mChangedEntities);var L=Object.keys(H.oData);var N={};jQuery.each(L,jQuery.proxy(function(i,P){if(H.mChangedEntities[P]){N={};jQuery.extend(N,H.oData[P]);jQuery.extend(N,H.mChangedEntities[P]);J[P]=N;}else{J[P]=H.oData[P];}},this));jQuery.each(K,jQuery.proxy(function(i,P){if(!J[P]){J[P]=H.mChangedEntities[P];}},this));I=JSON.stringify(J);}else{var O={};O.mChangedEntities=H.mChangedEntities;O.mChangeHandles=H.mChangeHandles;O.mDeferredRequests=H.mDeferredRequests;O.oData=H.oData;I=JSON.stringify(O);}if(I===G.modeljson){return;}G.modeljson=I;G.copilotEntity.update(G,{error:jQuery.proxy(function(i){jQuery.sap.log.error(i,"","QuickCreateAPI");},this)});}function x(){return new Promise(jQuery.proxy(function(i,G){var H=this.getQuickCreateModel();if(this.oRootView&&this.oRootView.getBindingContext()){if(this.isDraftEnabled()){H.remove(this.oRootView.getBindingContext().getPath(),{success:function(){a.show("Draft has been discarded");i();},error:function(I){G(I);}});}else{H.resetChanges();i();}}else{i();}},this));}function y(V,i){if(V){o.calculateViewHeight(V,i);}}function z(i){o.setComponentContainerHeight(i);}function A(i){if(this._bDestroyed){return;}this.fireObjectCreated({context:i});}function B(){sap.ui.getCore().getEventBus().publish(Q.EVENT_CONSTANTS.EventChannel,Q.EVENT_CONSTANTS.QUICKCREATE_VIEW_CREATED,{api:this});}function E(){if(this._bDestroyed){return;}if(this._oUpdateModelJSONTimer){clearTimeout(this._oUpdateModelJSONTimer);this._oUpdateModelJSONTimer=null;}delete Q._Instances[this._InstanceKey];if(c&&!c._bIsBeingDestroyed&&!c.bIsDestroyed){c.destroy();}this.oRootView=undefined;sap.ui.getCore().getEventBus().unsubscribe(Q.EVENT_CONSTANTS.EventChannel,Q.EVENT_CONSTANTS.QUICKCREATE_LINE_ITEMS_FOUND,this._onLineItemsFound,this);this.fireDestroyed({collectionItemGuid:this._InstanceKey});M.prototype.destroy.call(this);this._bDestroyed=true;}var F=new Q();jQuery.extend(F,{getCollectionItem:g.bind(F),getQuickCreateItem:b.bind(F),updateDraftID:u.bind(F),getRootControl:h.bind(F),isDraftEnabled:k.bind(F),isCurrentUserCreator:m.bind(F),getQuickCreateRootBindingContext:n.bind(F),getQuickCreateRootEntityType:p.bind(F),_onComponentContainerAfterRendering:q.bind(F),calculateViewHeight:y.bind(F),setComponentContainerHeight:z.bind(F),getQuickCreateModel:l.bind(F),objectCreated:A.bind(F),destroy:E.bind(F),getRootView:j.bind(F),setRootView:s.bind(F),getComponentInstance:d.bind(F),getComponentContainer:e.bind(F),_onDataBindingChanged:v.bind(F),_attachToModelBindingChanges:r.bind(F),loadQuickCreateModelFromJSON:t.bind(F),_updateModelJSON:w.bind(F),getCopilotModel:f.bind(F),discardQuickCreateDraft:x.bind(F),_onLineItemsFound:_.bind(F),fireQuickCreateViewCreated:B.bind(F)});c.addEventDelegate({onAfterRendering:F._onComponentContainerAfterRendering});F._InstanceKey=F.getCollectionItem().copilotEntity.getODataKey();if(Q._Instances[F._InstanceKey]){Q._Instances[F._InstanceKey].destroy();}delete Q._Instances[F._InstanceKey];Q._Instances[F._InstanceKey]=F;sap.ui.getCore().getEventBus().subscribe(Q.EVENT_CONSTANTS.EventChannel,Q.EVENT_CONSTANTS.QUICKCREATE_LINE_ITEMS_FOUND,F._onLineItemsFound,F);C.oQuickCreateAPI=F;return C.oQuickCreateAPI;};return Q;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.generic.app.ApplicationController');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/QuickTemplateComponentFactory",["sap/ui/base/Object","sap/ui/core/UIComponent","sap/ui/model/resource/ResourceModel","sap/ui/core/mvc/ViewType","sap/ui/model/json/JSONModel","sap/ui/generic/app/ApplicationController"],function(B,U,R,V,J,A){"use strict";var f=B.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory");function e(o){var I=new R({bundleName:"sap/suite/ui/generic/template/QuickCreate/i18n/i18n"});var q=new R({bundleName:"sap/suite/ui/generic/template/QuickView/i18n/i18n"});I.enhance(q.getResourceBundle());var t=o.getModel("i18n");if(t){I.enhance(t.getResourceBundle());}o.setModel(I,"i18n");}function d(o){return o.getMetadata().getComponentName()+"::"+o.getViewName()+"::"+o.getEntitySet();}function c(o,s){var a=o.getTransactionController().getDraftController().getDraftContext().isDraftEnabled(o.getEntitySet());var S=null;var b=o.oContainer.getSettings();S=jQuery.extend({},b);delete S.appComponent;delete S.entitySet;delete S.navigationProperty;return new J({entitySet:o.getEntitySet(),entityType:s,"sap-ui-debug":window["sap-ui-debug"],isDraftEnabled:a,settings:S,manifest:o.getManifest()});}function C(o){return new Promise(jQuery.proxy(function(r,a){var v=null;var m=this.getModel().getMetaModel();m.loaded().then(jQuery.proxy(function(){var b=m.getODataEntitySet(this.getEntitySet());if(!b||!b.entityType){jQuery.sap.log.error("The specified entity set "+this.getEntitySet()+" was not found in loaded metadata of service");if(a){a();}return;}var s=d(this);v=sap.ui.getCore().byId(s);if(v){jQuery.sap.log.warning("View with ID: "+s+" already exists - old view is getting destroyed now!");try{v.destroy();}catch(g){jQuery.sap.log.warning("Error destroying view: "+g);}v=null;}var p=this.getComponentData()?this.getComponentData().preprocessorsData:null;v=sap.ui.view({async:false,viewData:{component:this},preprocessors:{xml:{bindingContexts:{meta:m.createBindingContext(m.getODataEntityType(b.entityType,true)),entitySet:m.createBindingContext(m.getODataEntitySet(this.getEntitySet(),true))},models:{meta:m,entitySet:m,parameter:c(this,b.entityType)},preprocessorsData:p}},id:s,type:V.XML,viewName:this.getViewName(),height:"100%"});r(v);},this));},o));}function i(){U.prototype.init.apply(this,arguments);this._oApplicationController=new A(this.getModel());}function E(){if(this._oApplicationController){this._oApplicationController.destroy();}this._oApplicationController=null;}f.createQuickTemplateComponent=function(o,a){var g={metadata:{library:"sap.suite.ui.generic.template",properties:{viewName:{type:"string",defaultValue:null},entitySet:{type:"string",defaultValue:null}}},getAppComponent:function(){return this;},onBeforeRendering:function(){var j=this.oContainer;var m=!this.createViewStarted&&this.getModel();if(m){m.getMetaModel().loaded().then(function(){if(!this.createViewStarted){this.createViewStarted=true;C(this).then(function(v){this.setAggregation("rootControl",v);if(this.oQuickCreateAPI){this.oQuickCreateAPI.fireQuickCreateViewCreated();}e(this);var k=this.getModel("i18n");if(k){v.setModel(k,"i18n");}j.invalidate();}.bind(this));}}.bind(this));}},getTransactionController:function(){return this._oApplicationController.getTransactionController();},getApplicationController:function(){return this._oApplicationController;}};var b=a.init;a.init=function(){i.apply(this,arguments);if(typeof b==="function"){b.apply(this,arguments);}};var h=a.exit;a.exit=function(){E.apply(this,arguments);if(typeof h==="function"){h.apply(this,arguments);}};jQuery.extend(true,g,a);return U.extend(o,g);};return f;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ComponentUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ComponentUtils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ComponentUtils",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";var C={};function g(c,o){var h;var H=null;var a;var b;var I=false;var e=[];function d(i){var J;var M=c.getModel();if(i){if(M){J=M.getProperty(i);}}else{var K=c.getBindingContext();if(K){J=K.getObject();}}return!!(J&&J.__metadata&&J.__metadata.created);}function f(){return c.getModel("_templPriv");}function j(){return f().getProperty("/generic/viewLevel");}function k(){return o.preprocessorsData;}function l(){var i=c.getModel("i18n").getResourceBundle();return{dataLoadFailedTitle:i.getText("ST_GENERIC_ERROR_LOAD_DATA_TITLE"),dataLoadFailedText:i.getText("ST_GENERIC_ERROR_LOAD_DATA_TEXT")};}function A(T,i,J){if(typeof J!=="function"){throw new Error("Event handler must be a function");}e.push({template:T,event:i,handler:J});}function D(T,J,K){for(var i=e.length;i--;){if(e[i].handler===K&&e[i].event===J&&e[i].template===T){e.splice(i,1);}}}function F(T,J,K){for(var i=0;i<e.length;i++){if(e[i].event===J&&e[i].template===T){e[i].handler(K);}}}function m(i){return i.getMetadata().getName();}function p(i){h.then(function(J){if(J&&!i.outdated){var N=o.oNavigationObserver.getProcessFinished(true);N.then(function(){F(m(o.oController),"PageDataLoaded",{context:J});});}});}function s(){o.oHeaderLoadingObserver.startProcess();if(!b){var i=new Promise(function(J){b=J;});o.oApplication.getBusyHelper().setBusy(i);}}function n(){I=true;if(!H){h=new Promise(function(i){H=i;});}if(!c.getComponentContainer().getElementBinding().isSuspended()){s();}}function E(){if(b){b();b=null;}o.oHeaderLoadingObserver.stopProcess();}function r(i){return i.getSource().getBoundContext()||C;}function t(){if(!a||c.getComponentContainer().getElementBinding().isSuspended()){return;}if(a===C){var i=l();var N=c.getAppComponent().getNavigationController();N.navigateToMessagePage({title:i.dataLoadFailedTitle,text:i.dataLoadFailedText,viewLevel:j()});}else{if(H){H(a);}(o.methods.updateBindingContext||q.noop)();}H=null;a=null;}function u(i){E();t();I=false;}function v(i){a=r(i);t();o.oHeaderLoadingObserver.stopProcess();}function R(i){var P={};var J=k();if(J.rootContextExpand&&J.rootContextExpand.length){P.expand=J.rootContextExpand.join(",");}o.oHeaderLoadingObserver.startProcess();h=new Promise(function(K){a=null;H=K;c.getComponentContainer().bindElement({path:i,events:{dataRequested:n,dataReceived:u,change:v},parameters:P,batchGroupId:"Changes",changeSetId:"Changes"});});}function U(){var i=c.getComponentContainer();i.unbindElement();a=null;}function w(i,J){if(!i){return;}var K=c.getComponentContainer();if(!K){return;}if(d(i)){U();K.setBindingContext(K.getModel().getContext(i));}else{var L=o.oApplication.getCurrentDisplayObject();var M=K.getElementBinding();if(M){if(M.getPath()===i){if(M.isSuspended()){M.resume();t();}if(I){s();}if(!J){p(L);}return;}else if(!J){U();}}var N=c.getModel("ui");N.setProperty("/enabled",false);N.setProperty("/editable",false);R(i);p(L);}}function S(){var i=c.getComponentContainer();var J=i.getElementBinding();if(J&&!J.isSuspended()){J.suspend();E();}}function x(i){o.oApplication.setBackNavigation(i);}function y(T){o.oApplication.setTitle(T);}function z(i){return o.oApplication.registerContext(i);}function G(){return o.oApplication.getBreadCrumbInfo(c.getEntitySet());}return{setEditableNDC:function(i){o.oApplication.setEditableNDC(i);},getEditableNDC:function(){return o.oApplication.getEditableNDC();},getBusyHelper:function(){return o.oApplication.getBusyHelper();},isNonDraftCreate:d,attach:function(i,J,K){A(m(i),J,K);},detach:function(i,J,K){D(m(i),J,K);},fire:function(i,J,K){F(m(i),J,K);},getCurrentDisplayObject:function(){return o.oApplication.getCurrentDisplayObject();},getPreprocessorsData:k,bindComponent:w,suspendBinding:S,setBackNavigation:x,setTitle:y,getTemplatePrivateModel:f,registerContext:z,getViewLevel:j,getBreadCrumbInfo:G};}return B.extend("sap.suite.ui.generic.template.lib.ComponentUtils.js",{constructor:function(c,o){q.extend(this,g(c,o));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ContextBookkeeping')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ContextBookkeeping');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ContextBookkeeping",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(a){var p={};function c(C){var D=a.getTransactionController().getDraftController();var o=D.getDraftContext();var i=C.getObject();var I=o.hasDraft(C);var n=I&&!i.IsActiveEntity;var H=i.HasActiveEntity;var s;if(n){if(H){s=false;}else{s=true;}}else{s=false;}return{bIsDraft:n,bIsDraftSupported:I,bIsCreate:s};}function r(C){var P=C.getPath();var o=c(C);p[P]={oContextInfo:o,oContext:C};return o;}function b(C){var P=C.getPath();var R=p[P];if(!R){r(C);R=p[P];}return R;}function d(M,P){return new Promise(function(R,i){M.read(P+"/SiblingEntity",{success:function(o){var n=M.getContext("/"+M.getKey(o));R(n);},error:function(E){i(E);}});});}function e(C){var o=b(C);if(o.oContextInfo.bIsCreate){return Promise.resolve();}var s=o.oSiblingPromise;if(!s){s=o.oContextInfo.bIsDraftSupported?d(C.getModel(),C.getPath()):Promise.resolve(C);if(o.oContextInfo.bIsDraft||!o.oContextInfo.bIsDraftSupported){o.oSiblingPromise=s;}}return s;}function f(C,R){var o=b(C);o.oRemovalPromise=R;R.then(function(i){var D=i.context.getPath();var n=p[D];if(n){delete n.oEditingPromise;}o.oContext=null;},function(){delete o.oRemovalPromise;});}function h(C,o){f(C,o);}function j(C,o){f(C,o);}function k(C,E){var o=b(C);o.oEditingPromise=new Promise(function(R,i){var n=function(){delete o.oEditingPromise;i();};E.then(function(s){if(s.draftAdministrativeData){n();}else{R(s);}},n);});o.oEditingPromise.catch(q.noop);}function l(P){var C=p[P];if(!C){return Promise.resolve();}return new Promise(function(R){var o=null;var i=function(){R(o);};var H=function(E){E.then(function(n){var s=n.context.getPath();var t=p[s];if(!t||t.oContext){o={context:n.context,iDisplayMode:2};}i();},i);};if(C.oRemovalPromise){C.oRemovalPromise.then(function(n){o={context:n.context,iDisplayMode:1};var D=n.context.getPath();var s=p[D];var E=s&&s.oEditingPromise;if(E){H(E);}else{i();}},i);}else if(C.oEditingPromise){H(C.oEditingPromise);}else{i();}});}function A(P){var C=p[P];if(C){C.oContext=null;}}function m(D){for(var i=0;i<D.length;i++){A(D[i]);}}return{registerContext:r,getDraftSiblingPromise:e,activationStarted:h,cancellationStarted:j,editingStarted:k,getAlternativeContextPromise:l,adaptAfterDeletion:m};}return B.extend("sap.suite.ui.generic.template.lib.ContextBookkeeping",{constructor:function(a){q.extend(this,g(a));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.FlexEnabler')){jQuery.sap.declare("sap.suite.ui.generic.template.lib.FlexEnabler");sap.ui.core.Control.extend("sap.suite.ui.generic.template.lib.FlexEnabler",{metadata:{properties:{flexEnabled:{type:"boolean",group:"Misc",defaultValue:true}}},renderer:function(r,c){"use strict";}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.f.FlexibleColumnLayoutSemanticHelper');jQuery.sap.require('sap.f.LayoutType');sap.ui.define("sap/suite/ui/generic/template/lib/FlexibleColumnLayoutHandler",["jquery.sap.global","sap/ui/base/Object","sap/f/FlexibleColumnLayoutSemanticHelper","sap/f/LayoutType"],function(q,B,F,L){"use strict";function o(O){sap.ui.require(["sap/suite/ui/generic/template/lib/routingHelper"],O);}var r=Promise.resolve();var d=2;var c=["begin","mid","end"];var m=["messagePageBeginColumn","messagePageMidColumn","messagePageEndColumn"];function t(v){return c[v]?v:d;}function a(v){return t(v)===v;}function g(v){return c[t(v)]+"ColumnPages";}function A(R,T,p){R.showBeginColumn=R.viewLevel<3;R.showMidColumn=R.viewLevel===1||R.viewLevel===2;R.showEndColumn=R.viewLevel>1;R.target=R.showMidColumn?p.concat([T]):T;return g(R.viewLevel);}function b(C){for(var i=0;i<c.length;i++){C(m[i],g(i));}}function e(v){return m[t(v)];}function f(v){return c[t(v)];}function h(j,n){var M=n.oTemplateContract.oAppComponent.getManifestEntry("sap.ui.generic.app");var k=M.settings&&M.settings.flexibleColumnLayout;var l=F.getInstanceFor(j,k);var D=l.getDefaultLayouts();var R;var p;var u;var C;var s;var v=-1;var E;var T=n.oTemplateContract,w=n.oRouter;function x(i){return i===D.defaultLayoutType||i===D.defaultTwoColumnLayoutType||i===D.defaultThreeColumnLayoutType;}function y(i,k1,l1){var m1=T.mRouteToTemplateComponentPromise[l1];if(m1){return m1.then(function(n1){return n.activateOneComponent(k1,i,n1);});}return r;}function z(i){var k1=i.substring(i.length-5,i.length);if(k1==="query"){return i.substring(0,i.length-5);}return i;}function G(i){return Promise.all(i).then(n.afterActivation);}function H(i,k1){var l1=x(i);if(p.name.lastIndexOf("query")===p.name.length-"query".length){p.arguments.query=p.arguments["?query"];if(l1){delete p.arguments.query.FCLLayout;if(q.isEmptyObject(p.arguments.query)){delete p.arguments.query;p.name=z(p.name);}}else{p.arguments.query.FCLLayout=i;}}else if(!l1){p.name=p.name+"query";p.arguments.query={FCLLayout:i};}var m1=w.getURL(p.name,p.arguments);m1=m1.replace("/?","?");n.navigate(m1,k1);}function I(i,k1){return new Promise(function(l1){o(function(m1){l1(m1.determinePath(i,k1,T.routeViewLevel1.pattern));});});}function J(){var i=function(k1){var l1={};var m1=p.event.getParameter("config").viewLevel;if(m1<3){l1.begin={route:"root",path:"",isVisible:u.columnsVisibility.beginColumn};if(m1===0){k1(l1);return;}}var n1=z(p.name);if(m1>0){var o1=f(m1);l1[o1]={route:n1,path:p.path,isVisible:m1>2||(m1===1&&u.columnsVisibility.midColumn)||(m1===2&&u.columnsVisibility.endColumn)};}if(m1===2){I(p.routeConfig,p.event).then(function(p1){l1.mid={route:T.routeViewLevel1.name,path:p1,isVisible:u.columnsVisibility.midColumn};k1(l1);});}else{k1(l1);}};return new Promise(i);}function K(i){var k1=J();k1.then(function(l1){var m1=[];var n1=[l1.begin,l1.mid,l1.end];var o1=n.performPseudoHashChange(n1);for(var p1 in i){if(i[p1]){var q1=l1[p1];if(q1){m1.push(y(o1,q1.path,q1.route));}}}G(m1);});}function N(i){var k1=l.getCurrentUIState();var l1={};l1.end=u&&(u.columnsVisibility.endColumn!==k1.columnsVisibility.endColumn);l1.mid=u&&(u.columnsVisibility.midColumn!==k1.columnsVisibility.midColumn);l1.begin=u&&(u.columnsVisibility.beginColumn!==k1.columnsVisibility.beginColumn);u=k1;T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/midActionButtons",{fullScreen:u.actionButtonsInfo.midColumn.fullScreen!==null,exitFullScreen:u.actionButtonsInfo.midColumn.exitFullScreen!==null,closeColumn:u.actionButtonsInfo.midColumn.closeColumn!==null});T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/endActionButtons",{fullScreen:u.actionButtonsInfo.endColumn.fullScreen!==null,exitFullScreen:u.actionButtonsInfo.endColumn.exitFullScreen!==null,closeColumn:u.actionButtonsInfo.endColumn.closeColumn!==null});T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/isLogicallyFullScreen",u.isLogicallyFullScreen);var m1;if(u.columnsVisibility.endColumn){m1=m1=T.oTemplatePrivateGlobalModel.getProperty("/generic/routeLevel");}else if(u.columnsVisibility.midColumn){m1=1;}else{m1=0;}T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/highestViewLevel",m1);var n1;if(u.columnsVisibility.midColumn){n1=1;}else{n1=T.oTemplatePrivateGlobalModel.getProperty("/generic/routeLevel");}T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/lowestDetailViewLevel",n1);if(p&&C!==u.layout){H(u.layout,true);}else if((l1.begin||l1.mid||l1.end)&&!i){K(l1);}}function O(i,k1,l1,m1){return new Promise(function(n1){N(true);var o1=J();o1.then(function(p1){E=p1;var q1=[];for(var r1 in p1){var s1=p1[r1];if(s1.isVisible){q1.push(y(m1,s1.path,s1.route));}}G(q1).then(n1);});});}function P(i){var k1=i.getParameter("config").viewLevel;var l1=i.getParameter("arguments")["?query"];if(a(k1)){C=(l1&&l1.FCLLayout);if(!C){switch(k1){case 0:C=D.defaultLayoutType;break;case 1:C=D.defaultTwoColumnLayoutType;break;case 2:C=D.defaultThreeColumnLayoutType;}}}else{C=L.EndColumnFullScreen;}j.setLayout(C);}function Q(i,k1,l1,m1){v=-1;var n1=T.oTemplatePrivateGlobalModel.getProperty("/generic/routeLevel");R=n1===2?i:null;p={name:i.getParameter("name"),arguments:i.getParameter("arguments"),path:l1,event:i,routeConfig:k1};return O(i,k1,l1,m1);}function S(i){return x(i)?{}:{FCLLayout:[i]};}function U(i){return i===L.EndColumnFullScreen||i===L.MidColumnFullScreen;}function V(i,k1){if(!a(i)){return n.getParStringPromise(k1,false);}var l1=s||l.getNextUIState(i).layout;q.extend(k1,S(l1));s=null;if(U(l1)){return n.getParStringPromise(k1,false);}var m1=(i===2)?n.addUrlParameterInfoForRoute(T.routeViewLevel1.name,k1):r;return new Promise(function(n1){m1.then(function(){n.getParStringPromise(k1,true).then(n1);});});}function W(){n.navigateToRoot(true);}function X(){s=u.actionButtonsInfo.endColumn.closeColumn;var i=R.getParameter("config");I(i,R).then(function(k1){n.navigateToContext(k1,null,true,0);});}function Y(i,k1){var l1=n.oHashChanger.getHash()||"";l1=l1.split("?")[0];var m1=n.getParStringPromise(i,k1);n.navigateToParStringPromise(l1,m1,false);}function Z(){var k1=u.actionButtonsInfo.midColumn.fullScreen;var l1;if(k1===null){k1=u.actionButtonsInfo.endColumn.fullScreen;var m1=n.getActiveComponents();for(var i=0;i<m1.length;i++){var n1=T.componentRegistry[m1[i]];if(n1.viewLevel===2){l1=n1.route;break;}}}else{l1=T.routeViewLevel1.name;}var o1=S(k1);n.addUrlParameterInfoForRoute(l1,o1).then(function(){Y(o1,false);});}function $(){var i=u.actionButtonsInfo.midColumn.exitFullScreen;var k1;var l1;if(i===null){i=u.actionButtonsInfo.endColumn.exitFullScreen;}var m1=S(i);if(i===u.actionButtonsInfo.endColumn.exitFullScreen){var n1=n.getActiveComponents();var o1=n1[0];var p1=T.componentRegistry[o1];if(p1){k1=n.addUrlParameterInfoForRoute(p1.route,m1);l1=I(p.routeConfig,p.event);}}(k1||r).then(function(){(l1||r).then(function(q1){var r1=n.addUrlParameterInfoForRoute(T.routeViewLevel1.name,m1,q1);r1.then(function(){Y(m1,true);});});});}function _(i){return a(i)&&{onCloseColumnPressed:i===1?W:X,onFullscreenColumnPressed:Z,onExitFullscreenColumnPressed:$};}function a1(i){return T.oApplicationProxy.getDraftSiblingPromise(i);}function b1(i){if(T.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/highestViewLevel")===2){var k1=R.getParameter("config");var l1=T.mRouteToTemplateComponentPromise[z(k1.name)];l1.then(function(m1){var n1=m1.getBindingContext();var o1=a1(n1,true);o1.then(function(p1){o(function(q1){var r1=k1.navigationProperty;var s1=i.getPath()+"/"+q1.determineNavigationPath(p1,r1).path;s=u.layout;n.navigateToContext(s1,null,true,2);});});});}else{n.navigateToContext(i,null,true,2);}}function c1(i){if(T.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/highestViewLevel")!==2){return Promise.resolve(i);}return new Promise(function(k1){var l1=R.getParameter("config");var m1=T.mRouteToTemplateComponentPromise[z(l1.name)];m1.then(function(n1){var o1=n1.getBindingContext();var p1=a1(o1,true);p1.then(function(q1){if(!q1){k1(i);return;}o(function(r1){var s1=l1.navigationProperty;var t1=i.getPath()+"/"+r1.determineNavigationPath(q1,s1).path;k1(t1);});});});});}function d1(i,k1){var l1=E.mid&&i.indexOf(E.mid.path)>=0;var m1=E.end&&i.indexOf(E.end.path)>=0;if(l1){n.navigateToRoot(true);}else if(m1){n.navigateToContext(E.mid.path,null,true);}}T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL",{});function e1(i){var k1=n.getTargetLevel(i);switch(k1){case 1:return!u.columnsVisibility.midColumn;case 2:return!u.columnsVisibility.endColumn;default:return true;}}function f1(i){C=l.getNextUIState(i).layout;j.setLayout(C);}function g1(i,k1){k1(u.isLogicallyFullScreen&&i);}function h1(k1){v=t(k1.viewLevel);f1(k1.viewLevel);var l1=n.oRouter.getTargets();var m1=e(k1.viewLevel);l1.display(m1);var n1;if(k1.viewLevel===v){n1=[];for(var i=0;i<k1.viewLevel;i++){n1.push(true);}}return n1;}function i1(i){if(i<v||v<0){return u.columnsVisibility[f(i)+"Column"];}return false;}function j1(i,k1){if(!a(k1)){return i;}var l1=l.getNextUIState(k1).layout;if(x(l1)){return i;}return i+"?FCLLayout="+l1;}j.attachStateChange(N.bind(null,false));return{adaptRoutingInfo:A,createMessagePageTargets:b,displayMessagePage:h1,isLevelActive:i1,handleBeforeRouteMatched:P,handleRouteMatched:Q,getAppStateParStringForNavigation:V,getActionButtonHandlers:_,navigateToDraft:b1,getTargetAfterCancelPromise:c1,adaptAfterDeletion:d1,isNewHistoryEntryRequired:e1,setTitleForActiveComponent:g1,adaptBreadCrumbUrl:j1};}return B.extend("sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler",{constructor:function(i,n){q.extend(this,h(i,n));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.MessageUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.MessageUtils');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.ui.generic.app.util.MessageUtil');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/lib/MessageUtils",["sap/ui/generic/app/util/ModelUtil","sap/ui/generic/app/util/MessageUtil","sap/m/MessageBox"],function(M,G,a){"use strict";var l=new jQuery.sap.log.getLogger("sap.suite.ui.generic.template.lib.MessageUtils");function h(o,c,s,e,p){p=p||{};var E=G.parseErrorResponse(e);var m=E.messageText;var b;var n=false;var S=false;var C=c&&c.getOwnerComponent();var r=p.resourceBundle||C.getModel("i18n").getResourceBundle();var N=p.navigationController||s.oNavigationController;var d=p.model||C.getModel();l.debug("handleError has been called with operation "+o+" and HTTP response status code "+E.httpStatusCode);switch(E.httpStatusCode){case"400":switch(o){case G.operations.modifyEntity:break;case G.operations.callAction:m=r.getText("ST_GENERIC_BAD_REQUEST_ACTION");break;case G.operations.deleteEntity:m=r.getText("ST_GENERIC_BAD_REQUEST_DELETE");break;case G.operations.editEntity:m=r.getText("ST_GENERIC_BAD_REQUEST_EDIT");break;case G.operations.saveEntity:case G.operations.activateDraftEntity:if(s&&s.oTemplateCapabilities&&s.oTemplateCapabilities.oMessageButtonHelper&&s.oTemplateCapabilities.oMessageButtonHelper.showMessagePopover){s.oTemplateCapabilities.oMessageButtonHelper.showMessagePopover();S=true;}else{l.info("A MessageButtonHelper class instance could not be found as one of the services' template capabilities.");}break;default:m=r.getText("ST_GENERIC_BAD_REQUEST");break;}break;case"401":n=true;m=r.getText("ST_GENERIC_ERROR_AUTHENTICATED_FAILED");b=r.getText("ST_GENERIC_ERROR_AUTHENTICATED_FAILED_DESC");break;case"403":switch(o){case G.operations.callAction:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_ACTION");break;case G.operations.deleteEntity:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_DELETE");break;case G.operations.editEntity:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_EDIT");break;default:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED");b=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_DESC");n=true;break;}break;case"404":switch(o){case G.operations.callAction:m=r.getText("ST_GENERIC_BAD_REQUEST_ACTION");break;default:m=r.getText("ST_GENERIC_BAD_REQUEST");break;}break;case"409":break;case"500":case"501":case"502":case"503":case"504":case"505":n=true;switch(o){case G.operations.callAction:m=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_FOR_ACTION");break;default:m=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE");break;}b=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC");break;case undefined:n=false;S=true;break;default:n=true;m=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE");b=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC");break;}if(n){var v;if(C){var t=C.getModel("_templPriv");v=t.getProperty("/generic/viewLevel");}N.navigateToMessagePage({title:r.getText("ST_GENERIC_ERROR_TITLE"),text:m,description:b,icon:"sap-icon://message-error",viewLevel:v});}else{if(!E.containsTransientMessage&&!S){G.addTransientErrorMessage(m,b,d);}}}return{operations:G.operations,handleTransientMessages:G.handleTransientMessages,handleError:h,removeTransientMessages:G.removeTransientMessages};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ProcessObserver')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ProcessObserver');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ProcessObserver",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(s){var p;var P;function f(){if(s.processName){q.sap.log.info("Process "+s.processName+" started");}p=p||new Promise(function(r){P=r;});}function a(){if(s.processName){q.sap.log.info("Process "+s.processName+" stopped");}if(p){P();p=null;P=null;}}if(s.eventHandlers){s.eventHandlers.attachProcessStart(f);s.eventHandlers.attachProcessStop(a);}function h(){var o=null;for(var i=0;i<s.processObservers.length&&!o;i++){var d=s.processObservers[i];o=d.getProcessFinished();}if(o){f();o.then(h);}else{a();}}function b(A){if(!p&&s.processObservers){h();}return p||(A&&Promise.resolve());}function c(o){s.processObservers.push(o);}return{startProcess:f,stopProcess:a,getProcessFinished:b,addObserver:c};}return B.extend("sap.suite.ui.generic.template.lib.ProcessObserver",{constructor:function(s){q.extend(this,g(s||{}));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateComponent')){jQuery.sap.require('sap.ui.core.CustomizingConfiguration');(function(){"use strict";var o=sap.ui.core.CustomizingConfiguration.getViewExtension;sap.ui.core.CustomizingConfiguration.getViewExtension=function(v,e,a){var c=a&&typeof a==="string"?a:(a&&sap.ui.core.Component.getOwnerIdFor(a));var C=c&&sap.ui.component(c);if(C instanceof sap.suite.ui.generic.template.lib.TemplateComponent){a=C.getAppComponent().getId();}var r=o(v,e,a);return r;};var O=sap.ui.core.CustomizingConfiguration.getControllerExtension;sap.ui.core.CustomizingConfiguration.getControllerExtension=function(c,C){var a=null;if(C){a=sap.ui.component(C);if(a instanceof sap.suite.ui.generic.template.lib.TemplateComponent){a=a.getAppComponent();if(a){C=a.getId();}}}var r=O(c,C);return r;};jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateComponent');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateComponent",["jquery.sap.global","sap/ui/core/mvc/ViewType","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/Device"],function(q,V,U,J,R,D){function e(C){var i=new R({bundleName:"sap/suite/ui/generic/template/lib/i18n/i18n"});var t=C.getModel("i18n");if(t){i.enhance(t.getResourceBundle());}var m=C.getAppComponent().getModel("i18n|"+C.getMetadata().getComponentName()+"|"+C.getEntitySet());if(m){i.enhance(m.getResourceBundle());}C.setModel(i,"i18n");}function E(C,m){var M=C.getAppComponent().getManifestEntry("sap.ui5");var f=M.extends&&M.extends.extensions&&M.extends.extensions["sap.ui.controllerExtensions"];var t=C.getTemplateName();var T=f&&f[t]&&f[t]["sap.ui.generic.app"];var g=m.getMetaModel();var s=g.getODataEntitySet(C.getEntitySet()).name;var B=T&&T[s]&&T[s].Actions;var h={};if(B){a(h,B);}else{var S=T&&T[g.getODataEntitySet(C.getEntitySet()).name];for(var i in S){B=S[i]["Actions"];if(B){a(h,B);}}}C.getModel("_templPriv").setProperty("/generic/listCommons/breakoutActionsEnabled",h);}function a(B,f){var g;for(var A in f){g=true;if(f[A].requiresSelection){g=false;}B[f[A].id]={enabled:g};}}function d(C){if(C.getAppComponent().getMetadata().getComponentName()===""||C.getTemplateName()===""||C.getEntitySet()===""){}return C.getAppComponent().getMetadata().getComponentName()+"::"+C.getTemplateName()+"::"+C.getEntitySet();}function c(s,C,m,t){var i=C.getAppComponent().getTransactionController().getDraftController().getDraftContext().isDraftEnabled(C.getEntitySet());var S=null;var A=C.getComponentContainer().getSettings();S=q.extend({},A);delete S.appComponent;delete S.entitySet;delete S.navigationProperty;return new J({entitySet:C.getEntitySet(),entityType:s,"sap-ui-debug":window["sap-ui-debug"],isDraftEnabled:i,settings:S,manifest:C.getAppComponent().getInternalManifest(),metaModel:m,templateSpecific:t&&t(),appComponentName:C.getAppComponent().getMetadata().getComponentName(),helper:{bool:{"true":true,"false":false}}});}function b(C,f){var g=C.oComponent,h=C.createViewController,t=C.methods&&C.methods.getTemplateSpecificParameters;var v=null;var m=g.getModel();var M=g.getModel().getMetaModel();var i=M.getODataEntitySet(g.getEntitySet());if(!i||!i.entityType){return null;}e(g);E(g,m);q.sap.require("sap.ui.model.odata.AnnotationHelper");var s=d(g);v=sap.ui.getCore().byId(s);if(v){q.sap.log.warning("View with ID: "+s+" already exists - old view is getting destroyed now!");try{v.destroy();}catch(j){q.sap.log.warning("Error destroying view: "+j);}v=null;}var k=new J(D);k.setDefaultBindingMode("OneWay");g.runAsOwner(function(){var p=C.preprocessorsData;var l={async:true,preprocessors:{xml:{bindingContexts:{meta:M.createBindingContext(M.getODataEntityType(i.entityType,true)),entitySet:M.createBindingContext(M.getODataEntitySet(g.getEntitySet(),true))},models:{device:k,meta:M,entitySet:M,parameter:c(i.entityType,g,M,t)},preprocessorsData:p}},id:s,type:V.XML,viewName:g.getTemplateName(),height:"100%",cache:{keys:f,additionalData:[p]}};if(h){var n=h();l.controller=new n();}v=sap.ui.view(l);});return v;}return U.extend("sap.suite.ui.generic.template.lib.TemplateComponent",{metadata:{properties:{templateName:{type:"string",defaultValue:null},entitySet:{type:"string",defaultValue:null},navigationProperty:{type:"string",defaultValue:null},appComponent:{type:"object",defaultValue:null},isRefreshRequired:{type:"boolean",defaultValue:false},isLeaf:{type:"boolean"}},library:"sap.suite.ui.generic.template"},init:function(){(U.prototype.init||q.noop).apply(this,arguments);var u=new J({editable:false,enabled:false});this.setModel(u,"ui");var p=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("URLParsing");var t=new J({generic:{crossAppNavSupport:!!p&&p.isIntentUrl(document.URL),draftIndicatorState:sap.m.DraftIndicatorState.Clear,listCommons:{functionEnabled:{}},viewLevel:this.getComponentData().registryEntry.viewLevel,controlProperties:{},supportedIntents:{}}});t.setDefaultBindingMode("TwoWay");this.setModel(t,"_templPriv");},getComponentContainer:function(){return this.oContainer;},onBeforeRendering:function(C){if(C){var f=C.oComponent.getComponentContainer();var m=!C.createViewStarted&&f&&f.getModel();if(m){m.getMetaModel().loaded().then(function(){if(!C.createViewStarted){var g=[];var p=m.metadataLoaded().then(function(P){var s;if(P&&P.lastModified){s=new Date(P.lastModified).getTime()+"";}else{q.sap.log.error("TemplateComponent: no valid cache key segment last modification date provided by the OData Model");s=new Date().getTime()+"";}return s;});g.push(p);var h=m.annotationsLoaded().then(function(P){var j=0;if(P){for(var i=0;i<P.length;i++){if(P[i].lastModified){var l=new Date(P[i].lastModified).getTime();if(l>j){j=l;}}}}if(j===0){q.sap.log.error("TemplateComponent: no valid cache key segment last modification date provided by OData annotations");j=new Date().getTime();}return j+"";});g.push(h);C.createViewStarted=true;b(C,g).loaded().then(function(v){C.oComponent.setAggregation("rootControl",v);f.invalidate();});}});}}},setContainer:function(){U.prototype.setContainer.apply(this,arguments);},getRouter:function(){if(this.getAppComponent()){return this.getAppComponent().getRouter();}return U.prototype.getRouter.apply(this,arguments);}});});})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateViewController')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateViewController');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateViewController",["sap/ui/core/mvc/Controller"],function(m){"use strict";return m.extend("sap.suite.ui.generic.template.lib.TemplateViewController",{metadata:{library:"sap.suite.ui.generic.template"}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.testableHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.testableHelper');sap.ui.define("sap/suite/ui/generic/template/lib/testableHelper",[],function(){"use strict";var t=0;var p;var s={};var c=0;var S={};var C=[];function a(d){return function(I){if(t>=0){return null;}var l=d.log||[];for(var i=0;i<l.length;i++){var L=l[i];if(L.me===I){return L.args;}}};}function r(d){delete d.replace;delete d.observer;if(d.log){if(d.isStatic){var n=[];for(var i=0;i<d.log.length;i++){var l=d.log[i];if(l.testMode===0){n.push(l);}}if(n.length>0){d.log=n;}else{delete d.log;}}else{delete d.log;}}}function b(){C.forEach(r);}function o(f,d){var e;for(var i=0;i<C.length;i++){e=C[i];if(e.fnConstructor===f){e.isStatic=e.isStatic||d;return e;}}e={fnConstructor:f,isStatic:d};e.observable=function(){var g=e.replace?e.observer:f;var R=Object.create(g.prototype);R=g.apply(R,arguments)||R;if(t<0||(t===0&&e.isStatic)){var l={me:R,args:arguments,testMode:t};e.log=e.log||[];e.log.push(l);if(e.observer&&!e.replace){e.observer(R,arguments);}}return R;};C.push(e);return e;}return{startTest:function(){if(t!==0){return null;}t=-1;p={};return p;},endTest:function(){if(t<0){t=0;p=null;b();}},startApp:function(){if(t<0){return{};}t++;c++;var R={id:c};s[c]=R;return R;},endApp:function(A){if(t>0){var i=A.id;if(A===s[i]){t--;delete s[i];}}},testable:function(f,n){if(t===-1){p[n]=f;return function(){return p[n].apply(null,arguments);};}return f;},testableStatic:function(f,n){if(t>0||(t===0&&S[n])){return f;}S[n]=S[n]||f;return function(){return S[n].apply(null,arguments);};},getStaticStub:function(){return t===-1&&S;},observableConstructor:function(f,d){if(t>0){return f;}return o(f,d).observable;},observeConstructor:function(f,O,R){if(t>=0){return null;}var d=o(f);if(O&&d.observer){throw new Error("Constructor is already observed");}d.observer=O;d.replace=O&&R;return a(d);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.library')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.library');sap.ui.define("sap/suite/ui/generic/template/library",['jquery.sap.global','sap/ui/core/library'],function(q,l){"use strict";sap.ui.getCore().initLibrary({name:"sap.suite.ui.generic.template",dependencies:["sap.ui.core"],types:[],interfaces:[],controls:[],elements:[],version:"1.46.8"});return sap.suite.ui.generic.template;},false);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiCardController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiCardController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Fragment');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiCardController",["jquery.sap.global","sap/ui/core/Fragment","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/thirdparty/d3","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil"],function(q,F,C,J,D,K){"use strict";q.sap.require("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter");var c=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiCardController",{onInit:function(e){this.busyDelegate={onBeforeRendering:function(){this.setBusy(true);}};this.freeDelegate={onAfterRendering:function(){this.setBusy(false);}};},onExit:function(){},_updateTitle:function(t,s,u,i){var l=this.byId(i);l.setBusy(true);var f=K.getNumberFormatter(true,s,2);var S=f.getScale()?f.getScale():"";if(u===undefined||u==="%"){u="";}var a=this.getView().getModel("i18n");if(!a){return"";}var r=a.getResourceBundle();if(S){l.setText(r.getText("KPI_CARD_TITLE_SF",[t,S]));}else{l.setText(r.getText("KPI_CARD_TITLE",[t]));}l.setBusy(false);},onBeforeRendering:function(){var v=this._getVizFrameContainer();if(!v){q.sap.log.error("no kpi card VIZ container"+": ("+this.getView().getId()+")");}else{v.addEventDelegate(this.busyDelegate,v);var s=this.getView().data("qualifierSettings");var d=this.getView().data("dataPointMeasure");var o=this.getView().data("chart");var e=this.getView().data("entityTypeProperty");var u=K.getUnitofMeasure(s.model,e);var S="";var t=K.getPathOrPrimitiveValue(o.Title);if(d&&d.ValueFormat&&d.ValueFormat.ScaleFactor){S=K.getPathOrPrimitiveValue(d.ValueFormat.ScaleFactor);}this._updateTitle(t,S,u,"template::KpiChartHeaderTitle");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.formatChartAxes(S);sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.setupChartAttributes(v,s);var b=v.getDataset().getBinding("data");if(b.getPath()){b.attachDataReceived(q.proxy(this.onDataReceived,this));}else{}}},onAfterRendering:function(){},onDataReceived:function(e){var v=this._getVizFrameContainer();v.addEventDelegate(this.freeDelegate,v);},_getVizFrameContainer:function(){var m=this;if(!m._oChart){m._oChart=m.getView().byId("template::KpiCardChartVizFrame");}return m._oChart;},handleNavigationPress:function(e){var E=e.getSource();var n=sap.ushell.Container.getService("CrossApplicationNavigation");n.toExternal({target:{semanticObject:E.data("target"),action:e.getSource().data("action")},params:JSON.parse(E.data("parameters"))});}});return c;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.m.Popover');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiTagController",["sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiCardController","sap/ui/model/json/JSONModel","sap/ui/model/json/JSONModel","sap/ui/core/mvc/ViewType","sap/m/Popover"],function(K,J,F,V,P){"use strict";return{_kpiCards:[],init:function(s){var m=this;m.oState=s;m.oGenericModel=new J();var g={header:"Some Header",title:"Some Title",titleUrl:"",icon:"sap-icon://camera"};m.oGenericModel.setData(g);},openKpiCard:function(e){var m=this;var s;if(typeof e.currentTarget!="undefined"){s=sap.ui.getCore().byId(e.currentTarget.id);}else{s=e.getSource();}m.createPopover(function(){var m=this;m._openCard(s);}.bind(m,s),s);},_openCard:function(s){var m=this;jQuery.sap.delayedCall(0,this,function(){m._kpiCards[s.getQualifier()].openBy(s);});},handleKpiPress:function(e){this.openKpiCard(e);},createPopover:function(o,s){var m=this;var q=s.getQualifier();var c=m.oState.oController.getOwnerComponent();var S=c.getComponentContainer().getSettings();var Q=S.keyPerformanceIndicators[q];var a=S.appComponent.getManifestEntry("/sap.app/crossNavigation/outbounds/"+Q.detailNavigation);var M=c.getModel(Q.model);M.getMetaModel().loaded().then(function(){var m=this;m._oCardController=new K();var c=m.oState.oController.getOwnerComponent();var p=new J();var Q=arguments[0];var M=c.getModel(Q.model);var b=M.getMetaModel();var e=b.getODataEntitySet(Q.entitySet);var E=b.getODataEntityType(e.entityType);var d=E["com.sap.vocabularies.UI.v1.DataPoint#"+q];var f=b.getODataProperty(E,d.Value.Path);var D;var C=E["com.sap.vocabularies.UI.v1.Chart#"+q];if(C.MeasureAttributes[0]&&C.MeasureAttributes[0].DataPoint){D=E[(C.MeasureAttributes[0].DataPoint.AnnotationPath).toString().substring(1)];}Q.metaModel=b;p.setData(Q);var v=sap.ui.view({async:false,preprocessors:{xml:{bindingContexts:{entityType:b.createBindingContext(b.getODataEntityType(e.entityType,true)),entitySet:b.createBindingContext(b.getODataEntitySet(Q.entitySet,true))},models:{entitySet:b,entityType:b,parameter:p},dataModel:M,settings:p,preprocessorsData:c.getComponentData().preprocessorsData}},type:V.XML,viewName:"sap.suite.ui.generic.template.AnalyticalListPage.view.KpiCardSizeM",height:"100%"});v.data({"qualifierSettings":Q,"dataPoint":d,"dataPointMeasure":D,"chart":C,"entityTypeProperty":f});v.setModel(c.getModel(Q.model));var g=new sap.ui.model.json.JSONModel();var h={"visible":Q.detailNavigation?true:false};if(Q.detailNavigation&&a){h.target=a.semanticObject;h.action=a.action;h.parameters=JSON.stringify(a.parameters?a.parameters:{});}else{h.visible=false;}g.setData(h);v.setModel(g,"detailNavigation");if(typeof m._kpiCards[q]!="undefined"){m._kpiCards[q].destroy();}m._kpiCards[q]=new P();m._kpiCards[q].setShowHeader(false);m._kpiCards[q].addContent(v);m._oKpiCardController=v.getController();m.oState.oController.getView().addDependent(m._kpiCards[q]);o();}.bind(this,Q));},onExit:function(){if(this._oKpiCard){this._oKpiCard.destroy();}},_setModel:function(m){this._oKpiCard.setModel(m);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/AnalyticalListPage/extensionAPI/NonDraftTransactionController","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,N,a){"use strict";function g(t,c,s){var T;var n;return{getSelectedContexts:function(u){var C=s.oSmartTable;if(u){C=c.byId(u);}return t.oCommonUtils.getSelectedContexts(C);},getTransactionController:function(){if(t.oCommonUtils.isDraftEnabled()){throw new Error("Transaction support on AnalyticalListPage for draft case not implemented yet");}T=T||new N(t,c,s);return T;},rebindTable:function(){s.oSmartTable.rebindTable();},refreshTable:function(){t.oCommonUtils.refreshSmartTable(s.oSmartTable);},attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var b,p;if(!C){b=[];}else if(C instanceof sap.ui.model.Context){b=[C];}else{b=C;}if(u){p={urlParameters:u};}return t.oServices.oApplicationController.invokeActions(f,b,p);},getNavigationController:function(){if(!n){n=new a(t,c,s);}return n;},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,s);}};}return B.extend("sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper')){(function(){"use strict";jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.model.Context');sap.ui.require("sap/suite/ui/generic/template/extensionAPI/UIMode");jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper={getDetailEntitySet:function(c){var o=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(M.getODataEntitySet(o,true));},resolveMetaModelPath:function(c){var p=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(p);},createWorkingContext:function(c){var p=c.getObject(),s=p.settings,m=c.getModel(),M=m.getProperty("/metaModel"),E=M.getODataEntitySet(p.entitySet),o=M.getODataEntityType(E.entityType),a="",w={};a=o.$path+"/com.sap.vocabularies.UI.v1.SelectionPresentationVariant"+(s&&s.qualifier?"#"+s.qualifier:"");w.selectionPresentationVariant=M.getObject(a);w.selectionPresentationVariantQualifier=a.split("#")[1]||"";w.selectionPresentationVariantPath=a;if(w.selectionPresentationVariant&&w.selectionPresentationVariant.PresentationVariant){a=w.selectionPresentationVariant.PresentationVariant.Path||w.selectionPresentationVariant.PresentationVariant.AnnotationPath||w.selectionPresentationVariantPath+"/PresentationVariant";if(a.indexOf("@")===0){a=o.$path+"/"+a.substr(1);}}else{a=o.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant"+(s&&s.qualifier?"#"+s.qualifier:"");}if(typeof a==="string"){w.presentationVariant=M.getObject(a);w.presentationVariantPath=a;w.presentationVariantQualifier=a.split("#")[1]||"";}if(s.qualifier&&!w.presentationVariant){var e=new Error("Error in manifest.json: Not SelectionPresentationVariant or PresentationVariant found for qualifier: "+s.qualifier,"./manifest.json");throw e;}if(w.presentationVariant&&w.presentationVariant.Visualizations){w.presentationVariant.Visualizations.forEach(function(v){var P="/"+v.AnnotationPath.slice(1);if(P.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a=o.$path+P;w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier=a.split("#")[1]||"";}if(P.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){a=o.$path+P;w.chart=M.getObject(a);w.chartPath=a;w.chartQualifier=a.split("#")[1]||"";}});}if(!w.lineItem){a=o.$path+"/com.sap.vocabularies.UI.v1.LineItem";w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier="";}if(!w.chart){a=o.$path+"/com.sap.vocabularies.UI.v1.Chart";w.chart=M.getObject(a);w.chartPath=a;w.chartQualifier="";}m.setProperty("/workingContext",w);return"/workingContext";},hasDeterminingActionsForALP:function(t,c,e,m){if(e&&m&&m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]&&sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper._hasCustomDeterminingActionsInALP(e,m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"])){return true;}for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&t[r].Determining&&t[r].Determining.Bool==="true"){return true;}}for(var r=0;r<c.length;r++){if((c[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||c[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&c[r].Determining&&c[r].Determining.Bool==="true"){return true;}}return false;},_hasCustomDeterminingActionsInALP:function(e,m){if(m&&m[e]){var M=m[e];if(M.Actions){for(var a in M.Actions){if(M.Actions[a].determining){return true;}}}}return false;}};sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper.getDetailEntitySet.requiresIContext=true;})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.FilterUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.FilterUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil",["sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/AnalyticalListPage/util/OperationCode"],function(B,C,O){"use strict";var F=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.FilterUtil");F.createTitle=function(d,D){var t;if(!d){return D;}if(d.indexOf(':')!==-1){d=d.substring(0,d.indexOf(':'));}if(d.indexOf(D)===-1){t=d+" ("+D+")";}else{t=d;}return t;};F.readProperty=function(o,n){var a=o,i=0;var p=typeof n==='string'?n.split("."):[];while(i<p.length){if(!a){return undefined;}a=a[p[i++]];}return a;};F.executeFunction=function(o,f,a){var b=o,i=0,p;var P=typeof f==='string'?f.split("."):[];while(i<P.length){if(!b){return undefined;}p=b;b=b[P[i++]];}return typeof b==='function'?b.apply(p,a):undefined;};F.createTitleFromCode=function(f){var v=F.readProperty(f,"value1");var V=F.readProperty(f,"value2");var o=F.readProperty(f,"operation");if(!v||!o||!O[o]){return undefined;}var r;if(V){r=v+O[o].code+V;}else if(O[o].position==="last"){r=v+O[o].code;}else if(O[o].position==="mid"){r=O[o].code+v+O[o].code;}else{r=O[o].code+v;}if(f.exclude){r="!("+r+")";}return r;};F.formatFiltersLink=function(c){var i=this.getModel("i18n"),r=i.getResourceBundle();if(c){var l=Object.keys(c).length;if(c["_CUSTOM"]){l--;}if(l){return r.getText("VISUAL_FILTER_FILTERS_WITH_COUNT",[l]);}}return r.getText("VISUAL_FILTER_FILTERS");};F.getBooleanValue=function(v,d){if(v&&v.Bool){if(v.Bool.toLowerCase()==="true"){return true;}else if(v.Bool.toLowerCase()==="false"){return false;}}return d;};F.getPrimitiveValue=function(v){var a;if(v){if(v.String){a=v.String;}else if(v.Bool){a=F.getBooleanValue(v);}else if(v.EnumMember){a=v.EnumMember.split("/")[1];}else{a=F.getNumberValue(v);}}return a;};F.getNumberValue=function(v){var a;if(v){if(v.String){a=Number(v.String);}else if(v.Int){a=Number(v.Int);}else if(v.Decimal){a=Number(v.Decimal);}else if(v.Double){a=Number(v.Double);}else if(v.Single){a=Number(v.Single);}}return a;};F.getPathOrPrimitiveValue=function(i){if(i){if(i.Path){return"{path:'"+i.Path+"'}";}else{return F.getPrimitiveValue(i);}}else{return"";}};return F;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter')){
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationFormatter",["sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationHelper"],function(K,V,a){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter={};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions={count:0};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.NumberFormatFunctions={};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.criticalityConstants={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};function c(l,C){var S;if(C){S=C.None;if(l&&l.EnumMember){var v=l.EnumMember;if(e(v,"Negative")){S=C.Negative;}else if(e(v,"Critical")){S=C.Critical;}else if(e(v,"Positive")){S=C.Positive;}}}return S;}function e(S,l){return S&&S.indexOf(l,S.length-l.length)!==-1;}function b(v,I,l,m,t,n,C){var o={};o.EnumMember="None";if(v!==undefined){v=Number(v);if(e(I,"Minimize")||e(I,"Minimizing")){o.EnumMember="None";if(n||m){if(v<=n){o.EnumMember="Positive";}else if(v>m){o.EnumMember="Negative";}else{o.EnumMember="Critical";}}}else if(e(I,"Maximize")||e(I,"Maximizing")){o.EnumMember="None";if(t||l){if(v>=t){o.EnumMember="Positive";}else if(v<l){o.EnumMember="Negative";}else{o.EnumMember="Critical";}}}else if(e(I,"Target")){o.EnumMember="None";if(t&&n){if(v>=t&&v<=n){o.EnumMember="Positive";}else if(v<l||v>m){o.EnumMember="Negative";}else{o.EnumMember="Critical";}}}}return c(o,C);}function d(l,r,u,m){if(!l||!r){return;}l=Number(l);if(!u&&(l-r>=0)){return"Up";}if(!m&&(l-r<=0)){return"Down";}if(r&&u&&(l-r>=u)){return"Up";}if(r&&m&&(l-r<=m)){return"Down";}}function f(v,n,S,u){var l=true;var m=K.formatNumberForPresentation(v,l,n,S);return m+" "+(u?u:"");}function g(l,n,t,S,u){var m=true;if(!l){return;}l=Number(l);var D=l-t;var o=K.formatNumberForPresentation(D,m,n,S);return o+" "+(u?u:"");}function h(v,r,l){if(!r){return;}r=Number(r);if(l){return r+"%";}return r;}function i(v,t,n,S,u){var l=true;if(!t){return;}else{t=Number(t);var m=K.formatNumberForPresentation(t,l,n,S);return m+" "+(u?u:"");}}sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiTargetValue=function(C,D){if(!D||!D.Value||!D.TargetValue){return"";}var S=C.getSetting("settings").getData();var v=K.getPathOrPrimitiveValue(D.Value);var t=K.getPathOrPrimitiveValue(D.TargetValue);var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var u=K.getUnitofMeasure(S.model,l);var I=K.isBindingValue(t);var n=K.isBindingValue(v);var p=0;var q;if(D.ValueFormat){p=K.getPathOrPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits);q=K.getPathOrPrimitiveValue(D.ValueFormat.ScaleFactor);}var r=K.isBindingValue(u);var w=false;var P="parts: ["+(n?v:"{path: 'DUMMY'}");P+=I?","+t:"";P+=r?","+u:"";P+="]";if(u==="%"){w=true;}if(p===""||p===undefined){p=0;if(w){p=1;}}q=q==""?undefined:q;var x=function(){var y=1;if(w){return i(n?arguments[0]:v,I?arguments[y++]:t,p,q,r?arguments[y++]:u);}else{return i(n?arguments[0]:v,I?arguments[y++]:t,p,q);}};var F=s(x,"formatReferenceValueCalculation");return"{"+P+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiReferenceValue=function(C,D){var v=K.getPathOrPrimitiveValue(D.Value);var r=K.getPathOrPrimitiveValue(D.TrendCalculation.ReferenceValue);var l=K.isRelative(D);var I=K.isBindingValue(r);var p="parts: ["+v;p+=I?","+r:"";p+="]";var m=function(){var n=1;return h(arguments[0],I?arguments[n++]:r,l);};var F=s(m,"formatReferenceValueCalculation");return"{"+p+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiValue=function(C,D){if(!D||!D.Value){return"";}var S=C.getSetting("settings").getData();var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var u=K.getUnitofMeasure(S.model,l);var S=C.getSetting("settings").getData();var v=K.getPathOrPrimitiveValue(D.Value);var I=K.isBindingValue(u);var n=K.isBindingValue(v);var p="parts: ["+(n?v:"{path: 'DUMMY'}");p+=I?","+u:"";p+="]";var q=false;if(u==="%"){q=true;}var r=0;var t;if(D.ValueFormat){r=K.getPathOrPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits);t=K.getPathOrPrimitiveValue(D.ValueFormat.ScaleFactor);}if(r===""||r===undefined){r=0;if(q){r=1;}}t=t==""?undefined:t;var w=function(){var x=1;if(q){return f(n?arguments[0]:v,r,t,I?arguments[x++]:u);}else{return f(n?arguments[0]:v,r,t);}};var F=s(w,"formatFieldWithScaleCalculation");return"{"+p+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolveKpiHeaderState=function(C,D){return j(C,D,sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.criticalityConstants.ColorValues);};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForDeviation=function(C,D){if(!D||!D.Value||!D.TargetValue){return"";}var S=C.getSetting("settings").getData();var v=K.getPathOrPrimitiveValue(D.Value);var t=K.getPathOrPrimitiveValue(D.TargetValue);var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var u=K.getUnitofMeasure(S.model,l);var I=K.isBindingValue(t);var n=K.isBindingValue(u);var p=K.isBindingValue(v);var q=false;var r=0;var w;if(D.ValueFormat){r=K.getPathOrPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits);w=K.getPathOrPrimitiveValue(D.ValueFormat.ScaleFactor);}var P="parts: ["+(p?v:"{path: 'DUMMY'}");P+=I?","+t:"";P+=n?","+u:"";P+="]";if(u==="%"){q=true;}if(r===""||r===undefined){r=0;if(q){r=1;}}w=w==""?undefined:w;var x=function(){var y=1;if(q){return g(p?arguments[0]:v,r,I?arguments[y++]:t,w,n?arguments[y++]:u);}else{return g(p?arguments[0]:v,r,I?arguments[y++]:t,w);}};var F=s(x,"formatDeviationCalculation");return"{"+P+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForTrendIcon=function(C,D){if(!D||!D.Value||!D.Value.Path||!D.TrendCalculation){return"";}if(D.Trend){var t=K.getPathOrPrimitiveValue(D.Trend);return t;}var v=K.getPathOrPrimitiveValue(D.Value);var r=K.getPathOrPrimitiveValue(D.TrendCalculation.ReferenceValue);var l=K.getPathOrPrimitiveValue(D.TrendCalculation.DownDifference);var u=K.getPathOrPrimitiveValue(D.TrendCalculation.UpDifference);var I=K.isBindingValue(r);var m=K.isBindingValue(l);var n=K.isBindingValue(u);var p="parts: ["+v;p+=I?","+r:"";p+=m?","+l:"";p+=n?","+u:"";p+="]";var o=function(){var q=1;return d(arguments[0],I?arguments[q++]:r,m?arguments[q++]:l,n?arguments[q++]:u);};var F=s(o,"formatTrendDirection");return"{"+p+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatDPTitle=function(C,D){var S=C.getSetting("settings").getData();var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var t=K.getPathOrPrimitiveValue(D.Title);var r="",u="";if(l["Org.OData.Measures.V1.Unit"]){var U=l["Org.OData.Measures.V1.Unit"];u=K.getPathOrPrimitiveValue(U);}else if(l["Org.OData.Measures.V1.ISOCurrency"]){var n=l["Org.OData.Measures.V1.ISOCurrency"];u=K.getPathOrPrimitiveValue(n);}var p=function(v,w){w=w||t;v=v||u;var x=(u==="%");if(v===undefined){return w;}else{return!x?this.getModel('i18n').getResourceBundle().getText("KPI_CARD_TITLE_UNIT",[w,v]):w;}};var F=s(p,"formatTitleForDP");var I=K.isBindingValue(u),q=K.isBindingValue(t);var P="["+(I?u:"{path:'DUMMY'}")+", "+(q?t:"{path: 'DUMMY'}")+"]";r="{parts: "+P+", formatter: '"+F+"'}";return r;};function j(C,D,o){var S=o.None;if(D.Criticality){var l=D.Criticality?D.Criticality.EnumMember.split("/")[1]:undefined;var I=K.isBindingValue(l);if(I){S=l;}else{S=c(D.Criticality,o);}}else if(D.CriticalityCalculation&&D.Value&&D.Value){S=k(C,D,o);}return S;}function k(C,D,o){var v=K.getPathOrPrimitiveValue(D.Value);var I=K.isBindingValue(v);var l=D.CriticalityCalculation.ImprovementDirection.EnumMember;var m=D.CriticalityCalculation.DeviationRangeLowValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.DeviationRangeLowValue):undefined;var n=D.CriticalityCalculation.DeviationRangeHighValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.DeviationRangeHighValue):undefined;var t=D.CriticalityCalculation.ToleranceRangeLowValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.ToleranceRangeLowValue):undefined;var p=D.CriticalityCalculation.ToleranceRangeHighValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.ToleranceRangeHighValue):undefined;var q=K.isBindingValue(m);var r=K.isBindingValue(n);var u=K.isBindingValue(t);var w=K.isBindingValue(p);var P="parts: ["+(I?v:"{path:'DUMMY'}");P+=q?","+m:"";P+=r?","+n:"";P+=u?","+t:"";P+=w?","+p:"";P+="]";var x=function(){var y=1;return b(I?arguments[0]:v,l,q?arguments[y++]:m,r?arguments[y++]:n,u?arguments[y++]:t,w?arguments[y++]:p,o);};var F=s(x,"formatCriticalityCalculation");return"{"+P+", formatter: '"+F+"'}";}function s(l,n){if(!sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n]){sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n]=0;}sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n]++;var F=n+sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n];sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[F]=l;return"sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions."+F;}sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.getAggregateNumber=function(C,E,D,S,o){var l=S&&S.SelectOptions;var p;var m=",filters:";var n=[];if(l){l.forEach(function(z){p=z.PropertyName.PropertyPath;z[p].forEach(function(R){if(R.Sign.EnumMember===V.SelectionRangeSignType+"/I"){var F={path:p,operator:R.Option.EnumMember.split("/")[1],value1:R.Low.String,value2:R.High?R.High.String:""};n.push(F);}});});}var q=D&&D.Value&&D.Value.Path;var t=D&&D.TargetValue&&D.TargetValue.Path;var r="";m+=JSON.stringify(n);var P=a.resolveParameterizedEntitySet(C.getSetting("dataModel"),E,S);r+="{path: '"+P+"',length:1";var u=o.metaModel.getODataEntityType(E.entityType,false);var v=o.metaModel.getODataProperty(u,q);var w=v&&v[V.Unit]&&v[V.Unit].Path;var x=v&&v[V.ISOCurrency]&&v[V.ISOCurrency].Path;var y=[];y.push(q);if(w){y.push(w);}if(t){y.push(t);}if(x){y.push(x);}if(D.TrendCalculation&&D.TrendCalculation.ReferenceValue&&D.TrendCalculation.ReferenceValue.Path){y.push(D.TrendCalculation.ReferenceValue.Path);}return r+", parameters:{select:'"+y.join(",")+"'}"+m+"}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.getAggregateNumber.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolveKpiHeaderState.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForTrendIcon.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiValue.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForDeviation.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiTargetValue.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatDPTitle.requiresIContext=true;return sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiVizAnnotationHelper",["sap/ui/base/Object","sap/ui/model/Context","sap/ui/model/odata/AnnotationHelper","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(B,C,O,V){"use strict";var A=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.constants={LABEL_KEY:"sap:label",TEXT_KEY:"sap:text",TYPE_KEY:"type"};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.config={"Line":{"type":"line","dimensions":{"min":1,"defaultRole":"Category"},"measures":{"min":1},"feeds":[{"uid":"valueAxis","type":"measure"},{"uid":"categoryAxis","min":1,"type":"dimension","role":"Category"},{"uid":"color","type":"dimension","role":"Series"}]},"Column":{"type":"column","dimensions":{"min":1,"defaultRole":"Category"},"measures":{"min":1,"defaultRole":"Axis1"},"feeds":[{"uid":"valueAxis","min":1,"type":"measure"},{"uid":"categoryAxis","min":1,"type":"dimension"}]},"Donut":{"type":"donut","dimensions":{"min":1},"measures":{"min":1,"max":1},"feeds":[{"uid":"size","min":1,"max":1,"type":"measure"},{"uid":"color","min":1,"type":"dimension"}]},"Bar":{"type":"bar","dimensions":{"min":1,"defaultRole":"Category"},"measures":{"min":1,"defaultRole":"Axis1"},"feeds":[{"uid":"valueAxis","min":1,"type":"measure"},{"uid":"categoryAxis","min":1,"type":"dimension"}]}};A._createSortObject=function(d,m,c){var s="";if(c.EnumMember=="com.sap.vocabularies.UI.v1.ChartType/Line"){s=d[0].Dimension.PropertyPath;}else{s=m[0].Measure.PropertyPath;}return s;};A.formatItems=function(c,e,s,p,D,M,o,S){var a=c.getSetting("dataModel");var r="{";var b=[];var f=[];var g=[];var F=s&&s.SelectOptions;var P=s&&s.Parameters;var h=p&&p.SortOrder;var j=p&&p.MaxItems,k=null;var t;var l=null;var n=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper;var q="sap:text";if(j){k=j.Int32?j.Int32:j.Int;}if(k){if(k=="0"){jQuery.sap.log.error("maxItems is configured as "+k);r+="}";return r;}if(!/^\d+$/.test(k)){jQuery.sap.log.error("maxItems is Invalid. "+"Please enter an Integer.");r+="}";return r;}}if(P){var u=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper.resolveParameterizedEntitySet(a,e,s);r+="path: '"+u+"'";}else{r+="path: '"+S.model+">/"+e.name+"'";}var v=[];if(!S){jQuery.sap.log.error("NO KPI card settings in card formmater");r+="}";return r;}l=S.entitySet;if(!a||!l){return r;}var w=n.getMetadata(a,l);if(F){F.forEach(function(d){var m=d.PropertyName.PropertyPath;d[m].forEach(function(R){if(R.Sign.EnumMember===V.SelectionRangeSignType+"/I"){var I={path:m,operator:R.Option.EnumMember.split("/")[1],value1:R.Low.String,value2:R.High?R.High.String:""};v.push(I);}});});}if(v.length>0){r+=", filters: "+JSON.stringify(v);}if(h){var x=p.SortOrder;if(x.length<1){jQuery.sap.log.warning("Kpi Card no Sort annotaion defined");}else{var y="";var z;var E;var G;for(var i=0;i<x.length;i++){z=x[i];G=z.Property.PropertyPath;if(!G||!w[G]){G=n._createSortObject(D,M,o);}g.push(G);if(typeof z.Descending=="undefined"){E="true";}else{var H=z.Descending.Bool;if(!H){jQuery.sap.log.warning(n.errorMessages.CARD_WARNING+n.errorMessages.BOOLEAN_ERROR);E="true";}else{E=H.toLowerCase()==="true";}}y=y+"{path: '"+G+"',descending: "+E+"},";}r+=", sorter: ["+y.substring(0,y.length-1)+"]";}}jQuery.each(M,function(i,m){t=m.Measure.PropertyPath;f.push(t);if(w&&w[t]&&w[t][q]&&t!=w[t][q]){f.push(w[t][q]?w[t][q]:t);}});jQuery.each(D,function(i,d){t=d.Dimension.PropertyPath;b.push(t);if(w&&w[t]&&w[t][q]&&t!=w[t][q]){b.push(w[t][q]?w[t][q]:t);}});r+=", parameters: {select:'"+[].concat(b,f).join(",");if(g.length>0){r+=","+g.join(",");}r+="'}";if(k){r+=", length: "+k;}r+="}";return r;};A.getChartType=function(c){var a=[];if(!c.EnumMember||!(a=c.EnumMember.split("/"))||a.length<2){jQuery.sap.log.error("KPI Card M - wrong or missing chart type");return"";}else{return A.config[a[1]].type;}};A.setupChartAttributes=function(v,s){var c,e,a;var o,b,d,D,m;var f;var q,Q,g;var p,h=[],M=[];d=A.config;var l=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper;if(!(c=s)){jQuery.sap.log.error("KPI Card no card settings");return;}var n=v.getModel();var r=n.getMetaModel();var t=c.entitySet;var E=r.getODataEntitySet(t);if(!n||!t){return;}e=r.getODataEntityType(E.entityType,false);if(!e){jQuery.sap.log.error("KPI Card no entityType");return;}var u=l.getMetadata(n,t);var w="com.sap.vocabularies.UI.v1.Chart#"+c.qualifier;if(!w||!(a=e[w])){jQuery.sap.log.error("KPI Card no chart annotations");return;}if(!(D=a.DimensionAttributes)||!D.length){jQuery.sap.log.error("KPI Card no dimension annotations defined");return;}if(!(m=a.MeasureAttributes)||!m.length){jQuery.sap.log.error("KPI Card no measure annotations defined");return;}var x=[];o=a.ChartType;if(!o.EnumMember||!(x=o.EnumMember.split("/"))||x.length<2){jQuery.sap.log.error("KPI Card M - wrong or missing chart type");}else{b=x[1];}var H=true;v.removeAllAggregation();f={legend:{isScrollable:false},general:{background:{color:"transparent"},layout:{padding:15},groupData:false},title:{visible:false},interaction:{noninteractiveMode:false,selectability:{legendSelection:false,axisLabelSelection:false,mode:"NONE",plotLassoSelection:false,plotStdSelection:true}},plotArea:{window:{start:"firstDataPoint",end:"lastDataPoint"},background:{color:"transparent"}}};Q=D.slice();g=m.slice();jQuery.each(d[b].feeds,function(i,y){var z=y.uid;var F=[];if(y.type){var P,G,I;if(y.type==="dimension"){P=D.length;G="Dimension";I="dimensions";q=Q;p=h;}else{P=m.length;G="Measure";I="measures";q=g;p=M;}var J=0,K=P;if(y.min){J=J>y.min?J:y.min;}if(y.max){K=K<y.max?K:y.max;}if(!y.role){var L=q.length;for(var j=0;j<L&&F.length<K;++j){var N=q[j];q.splice(j,1);--L;--j;F.push(N);}}else{var R=y.role.split("|");jQuery.each(R,function(j,W){if(F.length==K){return false;}var L=q.length;for(var k=0;k<L&&F.length<K;++k){var N=q[k];if(N&&N.Role&&N.Role.EnumMember&&N.Role.EnumMember.split("/")&&N.Role.EnumMember.split("/")[1]){var X=N.Role.EnumMember.split("/")[1];if(X==W){q.splice(k,1);--L;--k;F.push(N);}}else if(jQuery.inArray(N,p)==-1){p.push(N);}}});if(F.length<K){jQuery.each(p,function(k,N){var W;var X;if((W=d[I].defaultRole)&&(jQuery.inArray(W,R)!==-1)&&(X=jQuery.inArray(N,q))!==-1){q.splice(X,1);F.push(N);if(F.length==K){return false;}}});}if(F.length<J){jQuery.sap.log.error("KPI card feed propperties < min");return false;}}if(F.length){var S=[];var T;if(!(T=v.getDataset())){jQuery.sap.log.error("KPI Card Viz framework no Dataset");return false;}jQuery.each(F,function(i,N){if(!N||!N[G]||!N[G].PropertyPath){jQuery.sap.log.error("KPI Card invalid chart annotations - propertypath");return false;}var k=N[G].PropertyPath;var W=k;var X=k;if(u&&u[k]){W=u[k][l.constants.LABEL_KEY]||k;X=u[k][l.constants.TEXT_KEY]||k;}var Y="{"+X+"}";S.push(W);if(G=="Dimension"){T.addDimension(new sap.viz.ui5.data.DimensionDefinition({name:W,value:"{"+k+"}",displayValue:Y}));}else{T.addMeasure(new sap.viz.ui5.data.MeasureDefinition({name:W,value:"{"+k+"}"}));}});var U=new sap.viz.ui5.controls.common.feeds.FeedItem({"uid":z,"type":G,"values":S});v.addFeed(U);f[z]={title:{visible:H?false:true,text:S.join(", ")},label:{formatString:"axisFormatter"}};if(z=="valueAxis"){f[z].layout={maxWidth:0.4};}}}});v.setVizProperties(f);};A.formatByType=function(m,p,v){var s=sap.ovp.cards.charts.VizAnnotationManager;var t=s.constants.TYPE_KEY;if(!m||!m[p]||!m[p][t]){return v;}var n=["Edm.Int","Edmt.Int16","Edm.Int32","Edm.Int64","Edm.Decimal"];var c=m[p][t];if(jQuery.inArray(c,n)!==-1){return Number(v);}return v;};A.getMetadata=function(m,e){var a=this.cacheODataMetadata(m);if(!a){return undefined;}return a[e];};A.cacheODataMetadata=function(m){var s=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper;if(m){if(!jQuery.sap.getObject("sap.suite.ui.generic.template.AnalyticalListPage.kpi.cachedMetaModel")){s.cachedMetaModel={};}var a=s.cachedMetaModel[m.getId()];if(!a){var b=m.getMetaModel();a={};var c=b.getODataEntityContainer();jQuery.each(c.entitySet,function(d,e){var f=b.getODataEntityType(e.entityType);var g={};jQuery.each(f.property,function(p,h){g[h.name]=h;});a[e.name]=g;});s.cachedMetaModel[m.getId()]=a;}return a;}else{jQuery.sap.log.error(s.errorMessages.CARD_ERROR+s.errorMessages.CACHING_ERROR);}};A.formatChartAxes=function(s){jQuery.sap.require("sap.viz.ui5.format.ChartFormatter");jQuery.sap.require("sap.ui.core.format.NumberFormat");jQuery.sap.require("sap.viz.ui5.api.env.Format");var c=sap.viz.ui5.format.ChartFormatter.getInstance();var S=true;if(!s){s=undefined;}else{S=false;}if(c!=null){c.registerCustomFormatter("axisFormatter",function(v){var n=sap.ui.core.format.NumberFormat.getFloatInstance({style:"short",minFractionDigits:0,maxFractionDigits:1,decimals:2,showScale:S,shortRefNumber:s});return n.format(Number(v));});sap.viz.ui5.api.env.Format.numericFormatter(c);}};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.formatItems.requiresIContext=true;return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/ListReport/extensionAPI/NonDraftTransactionController","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,N,a){"use strict";function g(t,c,s){var T;var n;return{getSelectedContexts:function(){return t.oCommonUtils.getSelectedContexts(s.oSmartTable);},getTransactionController:function(){if(t.oCommonUtils.isDraftEnabled()){throw new Error("Transaction support on ListReport for draft case not implemented yet");}T=T||new N(t,c,s);return T;},rebindTable:function(){s.oSmartTable.rebindTable();},refreshTable:function(){t.oCommonUtils.refreshSmartTable(s.oSmartTable);},attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var b,p;if(!C){b=[];}else if(C instanceof sap.ui.model.Context){b=[C];}else{b=C;}if(u){p={urlParameters:u};}if(s.oSmartTable){s.oSmartTable.getTable().attachEventOnce("updateFinished",function(){t.oCommonUtils.setEnabledToolbarButtons(s.oSmartTable);t.oCommonUtils.setEnabledFooterButtons(s.oSmartTable,c);});}return t.oServices.oApplicationController.invokeActions(f,b,p);},getNavigationController:function(){if(!n){n=new a(t,c,s);}return n;},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,s);}};}return B.extend("sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.m.ListBase');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/ui/table/Table","sap/m/ListBase","sap/ui/comp/smarttable/SmartTable","sap/suite/ui/generic/template/ObjectPage/extensionAPI/DraftTransactionController","sap/suite/ui/generic/template/ObjectPage/extensionAPI/NonDraftTransactionController","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,U,L,S,D,N,a){"use strict";function g(t,c,s){var T;var n;return{getSelectedContexts:function(u){var C=c.byId(u);return t.oCommonUtils.getSelectedContexts(C);},rebind:function(u){var C=c.byId(u);if(C instanceof S){C.rebindTable();}},refresh:function(u){var C=c.byId(u);if(C instanceof S){t.oCommonUtils.refreshSmartTable(C);return;}var A;if(C instanceof L){A="items";}else if(C instanceof U){A="rows";}var b=A&&C.getBinding(A);if(b){b.refresh();}},getTransactionController:function(){if(!T){var C=t.oCommonUtils.isDraftEnabled()?D:N;T=new C(t,c,s);}return T;},attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var b,p;if(!C){b=[];}else if(C instanceof sap.ui.model.Context){b=[C];}else{b=C;}if(u){p={urlParameters:u};}return t.oServices.oApplicationController.invokeActions(f,b,p);},attachPageDataLoaded:function(f){t.oComponentUtils.attach(c,"PageDataLoaded",f);},detachPageDataLoaded:function(f){t.oComponentUtils.detach(c,"PageDataLoaded",f);},registerMessageFilterProvider:function(p){s.messageButtonHelper.registerMessageFilterProvider(p);},getNavigationController:function(){if(!n){n=new a(t,c,s);}return n;},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,s);}};}return B.extend("sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickCreate.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickCreate.Component');jQuery.sap.require('sap.ca.ui.utils.Lessifier');sap.ui.define("sap/suite/ui/generic/template/QuickCreate/Component",["../js/QuickTemplates/QuickTemplateComponentFactory","../js/AnnotationHelper","../js/QuickTemplates/AnnotationHelper","sap/ca/ui/utils/Lessifier"],function(Q,A,a,L){"use strict";return Q.createQuickTemplateComponent("sap.suite.ui.generic.template.QuickCreate.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"viewName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.QuickCreate.view.QuickCreate"}},"manifest":"json","includes":["css/custom.css"]},init:function(){L.lessifyCSS("sap.suite.ui.generic.template.QuickCreate","css/custom.css",true);}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickCreate.view.QuickCreate.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickCreate.view.QuickCreate.controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/QuickCreate/view/QuickCreate.controller",["../../js/QuickTemplates/QuickActionBaseController","../../js/QuickTemplates/QuickCreateAPI","sap/m/MessageToast","../../js/QuickTemplates/AnnotationHelper","sap/ui/model/odata/AnnotationHelper","../../js/QuickTemplates/ODataModelHelper","sap/ui/model/json/JSONModel","sap/ui/model/Context"],function(B,Q,M,a,b,O,J,C){"use strict";var c=B.extend("sap.suite.ui.generic.template.QuickCreate.view.QuickCreate",{onInit:function(){if(!this._bIsInitialized){B.prototype.onInit.apply(this);this.oQuickCreateAPI=this.oComponent.oQuickCreateAPI;this.oTransactionController=this.oComponent.getTransactionController();if(this.oQuickCreateAPI){this.oQuickCreateAPI.setRootView(this.getView());}this.sDraftEntityPath=this.oQuickCreateAPI?this.oQuickCreateAPI.getQuickCreateItem().draftid:undefined;this.bIsCreator=this.oQuickCreateAPI?this.oQuickCreateAPI.isCurrentUserCreator():true;this.sQuickCreateUserName=this.oQuickCreateAPI?this.oQuickCreateAPI.getQuickCreateItem().createdByName:"";this.bFormEnabled=!this.bDraftEnabled||this.bIsCreator;this._sDeferredGroupId="QuickCreateChanges";var q=new J({});this._sQuickCreateUIModelName="quickCreate";this.getView().setModel(q,this._sQuickCreateUIModelName);this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",true);this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/quickCreateUser",this.sQuickCreateUserName);if(!this.bDraftEnabled){this.getView().getModel().setDeferredGroups([this._sDeferredGroupId]);}if(this.oQuickCreateAPI){this.oQuickCreateAPI.attachAutofillLineItems(this._onLineItemsFound,this);}}},onExit:function(){if(this._bIsBeingDestroyed||this._bDestroyed){return;}this._bIsBeingDestroyed=true;if(this.oQuickCreateAPI){this.oQuickCreateAPI.destroy();}if(B.prototype.onExit){B.prototype.onExit.apply(this);}this._bDestroyed=true;delete this._bIsBeingDestroyed;},onBeforeRendering:function(){B.prototype.onBeforeRendering.apply(this);if(!this.getView().getModel("ui")){var u=new J({});this.getView().setModel(u,"ui");}this.getView().getModel("ui").setProperty("/enabled",this.bFormEnabled);this.getView().getModel("ui").setProperty("/editable",true);},_onMetaModelLoaded:function(){var t=this;this.setBusy(true);if(this.sDraftEntityPath){var o=new C(this.getView().getModel(),this.sDraftEntityPath);if(this.bDraftEnabled&&!this.bIsCreator){o._bLocalBinding=true;}else if(!this.bDraftEnabled){o._bLocalBinding=true;}if(o._bLocalBinding){if(this.oQuickCreateAPI){this.oQuickCreateAPI.loadQuickCreateModelFromJSON().then(jQuery.proxy(function(){if(o.getObject()){this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",true);}else{this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",false);}this.bindView(o);},this));}}else{this.getView().getModel().read(this.sDraftEntityPath,{success:jQuery.proxy(function(D,r){this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",true);this.bindView(o);},this),error:jQuery.proxy(function(e){this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",false);this.bindView(o);},this)});}}else if(this.bDraftEnabled){this.oDraftController.createNewDraftEntity(this.sEntitySet,"/"+this.sEntitySet).then(function(r){if(t.oQuickCreateAPI){t.oQuickCreateAPI.updateDraftID(r.context.getPath());}t.bindView(r.context);},jQuery.proxy(this.onError,this));}else{var d=this.getView().getModel().createEntry("/"+this.sEntitySet,{groupId:this._sDeferredGroupId});d._bLocalBinding=true;if(this.oQuickCreateAPI){this.oQuickCreateAPI.updateDraftID(d.getPath());}this._initializeObject(d,"FieldGroup");this.bindView(d);}},onChange:function(e){if(this.bDraftEnabled){var o=this.getView().getElementBinding();var m=new Promise(jQuery.proxy(function(r,d){var E=this.oComponent.getEntitySet();var v=e.getSource().getBindingPath("value");var f=e.getSource();var s=null;if(f){s=this.oComponent.getApplicationController();}else{s=this.oComponent.getTransactionController();}s.propertyChanged(E,v,o,f).then(function(){if(r){r();}},function(){if(d){d();}});},this));m.then(function(){o.refresh();});}},onCreatePress:function(e){var t=this;this._createButton=e.getSource();this._createButton.setEnabled(false);this.setBusy(true);var r=function(R){t.setBusy(false);var f=null;var o=[];var p={key:"__metadata",matchCallback:function(h,i,j){o.push(i);return false;}};O.findObjects(R,p);var g=t.oEntityTypeMeta.namespace+"."+t.oEntityTypeMeta.name;jQuery.each(o,function(i,h){if(!f&&h.__metadata&&h.__metadata.type===g){var k=t.getView().getModel().getKey(h);f=new C(t.getView().getModel(),"/"+k);}});if(f){M.show(t.formatI18NMessage("QuickCreate_Success_CreateObject"));if(t.oQuickCreateAPI){t.oQuickCreateAPI.objectCreated(f);}}else{this._showErrorMessage({message:t.formatI18NMessage("QuickCreate_No_Created_Object")});}};var d=function(E){t.setBusy(false);if(t._createButton){t._createButton.setEnabled(true);}t.onError(E);};if(this.bDraftEnabled){this.oDraftController.activateDraftEntity(this.getView().getBindingContext()).then(r,d);}else{var f=this.getView().getBindingContext();var m=this.getView().getModel().getProperty(f.getPath(),f,true);var p={key:"results",matchCallback:function(g,h,i){if(h.__nestedKey&&Array.isArray(i)){g[h.__nestedKey]=i;}return true;},maxNestedLevel:5};O.findObjects(m,p);p={key:"__metadata",matchCallback:function(g,h,i){delete h["__metadata"];return true;},maxNestedLevel:5};O.findObjects(m,p);this.getView().getModel().create("/"+this.sEntitySet,m,{success:r,error:d});}},onAddLineItemPress:function(e){this._getLineItemsTableFromEvent(e);var t=this;this.setBusy(true);var d=this.getView().getBindingContext();var f=function(s){t._createLineItem(d).then(function(o){t._refreshLineItems();if(t.oQuickCreateAPI){t.oQuickCreateAPI.calculateViewHeight(t.getView(),true);}t.setBusy(false);},jQuery.proxy(t.onError,t));};if(this.bDraftEnabled){this.oTransactionController.triggerSubmitChanges().then(function(s){f(s);},jQuery.proxy(this.onError,this));}else{f();}},onRemoveLineItemPress:function(e){var t=this;this.setBusy(true);var d=e.getSource().getBindingContext();if(this.bDraftEnabled){this.oTransactionController.triggerSubmitChanges().then(function(r){t._deleteLineItem(d);},jQuery.proxy(function(E){this.setBusy(false);this.onError(E);},this));}else{this.getView().getModel().deleteCreatedEntry(d);this.setBusy(false);if(this.oQuickCreateAPI){this.oQuickCreateAPI.calculateViewHeight(this.getView(),false);}this._refreshLineItems();}},bindView:function(o){this.setBusy(false);if(this.getView().getModel(this._sQuickCreateUIModelName).getProperty("/draftExists")===false){return;}if(o._bLocalBinding){this._setBindingContext(o);if(!this.bFormEnabled){if(typeof this.getView().getModel()._submitRequest==='function'){this.getView().getModel()._submitRequest=function(){};}}this._refreshLineItems();}else{B.prototype.bindView.apply(this,arguments);}this._updateFieldControl(o);},hasLineItemAnnotation:function(){var i=this._getFormatterInterface();var m=a.getMetaModelContextForFacetType(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"LineItem");return m!==null;},_onLineItemsFound:function(e){if(!this.hasLineItemAnnotation()){return;}var n=e.getParameter("numberOfLineItems");if(n<=0){return;}this.setBusy(true);var m=this.getView().getBindingContext();var p=[];for(var i=0;i<n;i++){p.push(this._createLineItem(m));}Promise.all(p).then(jQuery.proxy(function(r){this._refreshLineItems();this.setBusy(false);},this));},_createLineItem:function(m){var t=this;var i=this._getFormatterInterface(m);var o=this.getView().getModel().getMetaModel();var d=a.getMetaModelContextForFacetType(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"LineItem");var s=b.getNavigationPath(d);s=s.replace(/[{}]/g,'');var l=o.getODataAssociationEnd(this.oEntityTypeMeta,s);var L=o.getODataEntityType(l.type);if(this.bDraftEnabled){return this.oDraftController.createNewDraftEntity(L.name,m.sPath+"/"+s);}else{return new Promise(function(r,e){var f=t.getView().getModel().createEntry(m.sPath+"/"+s,{groupId:t._sDeferredGroupId});t._initializeObject(f,"LineItem");r(f);});}},_deleteLineItem:function(o){this.oTransactionController.deleteEntity(o).then(jQuery.proxy(function(r){this._refreshLineItems();this.setBusy(false);if(this.oQuickCreateAPI){this.oQuickCreateAPI.calculateViewHeight(this.getView(),false);}},this),jQuery.proxy(function(e){this.setBusy(false);this.onError(e);},this));},_onSmartFieldAfterRendering:function(e){if(typeof e.srcControl.setEnabled=='function'){e.srcControl.setEnabled(this.bFormEnabled);}if(this.oQuickCreateAPI){this.oQuickCreateAPI.calculateViewHeight(this.getView(),true);}jQuery(".copilotQuickCreateContainerBox .sapQuickCreateFieldGroup label").css("text-align","");jQuery(".sapQuickActionCreateButtonContainer > div").addClass("sapUiSmallMarginEnd");jQuery(".sapQuickActionCreateButtonContainer .sapMBtnInner").css("padding","0");},_refreshLineItems:function(){if(this._lineItemsTable){var d=this.getView().getBindingContext();if(d&&d._bLocalBinding){O.restoreLineItemReferences(this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,d);this._lineItemsTable.getModel().updateBindings();}else{this._lineItemsTable.getModel().refresh();}}},onTableUpdateStarted:function(e){this._getLineItemsTableFromEvent(e);},_getLineItemsTableFromEvent:function(e){if(!this._lineItemsTable&&e&&e.getSource){var d=e.getSource();while(d){if(d instanceof sap.m.Table){this._lineItemsTable=d;return;}if(typeof d.getParent==='function'){d=d.getParent();}else{return;}}}},onTableUpdateFinished:function(e){this._updateFieldControl();},_initializeObject:function(o,f){var m=this.getView().getBindingContext()?this.getView().getBindingContext():o;var p=a.getAllPropertyPathsFromFacet(m,f);if(p&&p.length>0){O.initializeObjectProperties(o,p,{groupId:this._sDeferredGroupId});}},_updateFieldControl:function(o){var d=o?o:this.getView().getBindingContext();if(d&&this.getView().getModel().getProperty(d.getPath()+"/Update_mc")!==undefined){this.getView().getModel().setProperty(d.getPath()+"/Update_mc",true);}}});return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickView.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickView.Component');jQuery.sap.require('sap.ca.ui.utils.Lessifier');sap.ui.define("sap/suite/ui/generic/template/QuickView/Component",["../js/QuickTemplates/QuickTemplateComponentFactory","../js/AnnotationHelper","../js/QuickTemplates/AnnotationHelper","sap/ca/ui/utils/Lessifier"],function(Q,A,a,L){"use strict";return Q.createQuickTemplateComponent("sap.suite.ui.generic.template.QuickView.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"viewName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.QuickView.view.QuickView"}},"manifest":"json","includes":["css/custom.css"]},init:function(){L.lessifyCSS("sap.suite.ui.generic.template.QuickView","css/custom.css",true);}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickView.view.QuickView.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickView.view.QuickView.controller');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/QuickView/view/QuickView.controller",["sap/ui/model/Context","../../js/QuickTemplates/QuickActionBaseController","../../js/QuickTemplates/AnnotationHelper","../../js/QuickTemplates/ODataModelHelper","sap/ui/model/json/JSONModel"],function(C,B,A,O,J){"use strict";return B.extend("sap.suite.ui.generic.template.QuickView.view.QuickView",{onInit:function(){if(!this._bIsInitialized){B.prototype.onInit.apply(this);this.sEntityPath=decodeURIComponent(this.oComponent.getComponentData().startupParameters["entityPath"]);this.sEntityPath="/"+O.createKeyFromPath(this.sEntityPath,this.getView().getModel().getMetaModel(),this.sEntitySet);var b=new J({});b.setProperty("/badgeVisible",false);b.setProperty("/fallbackBadgeVisible",false);this._sBadgeModelName="badge";this.getView().setModel(b,this._sBadgeModelName);}},_onMetaModelLoaded:function(){var c=new C(this.getView().getModel(),this.sEntityPath);this.bindView(c);c.getModel().attachRequestCompleted(this._resolveBadgeModel,this);},bindView:function(c){var i=this._getFormatterInterface(c);var f=A.getNavigationPathsFromFacet(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"FieldGroup");var h=A.getNavigationPathsUsingAnnotationHeuristics(c,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name);var o={};jQuery.each(f,function(a,p){o[p]="";});jQuery.each(h,function(a,p){o[p]="";});var e=A.formatExpandPaths(Object.keys(o));this.oContext=c;this.getView().bindElement({path:c.getPath(),parameters:{expand:e}});},_resolveBadgeModel:function(){if(this._badgeResolved){this.oContext.getModel().detachRequestCompleted(this._resolveBadgeModel,this);return;}var c=this.oContext;var a=this.oComponent.ContextualManagedObject;var b=this.getView().getModel(this._sBadgeModelName);if(a){var o=new a({serviceUrl:(c.getModel().sServiceUrl)?c.getModel().sServiceUrl:null,path:c.getPath(),entitytype:this.oEntitySetMeta.entityType,uiGroup:"Main Object",priority:"1"});o.setModel(c.getModel());o.setBindingContext(c);o.resolveAnnotations();b.setProperty("/imgUrlDefined",(o.getProperty("imgUrl")!=undefined&&o.getProperty("imgUrl").indexOf("sap-icon")<0));b.setProperty("/imgUrl",o.getProperty("imgUrl"));b.setProperty("/typeImgUrlDefined",(o.getProperty("typeImgUrl")!=undefined&&!b.getProperty("/imgUrlDefined")));b.setProperty("/typeImgUrl",o.getProperty("typeImgUrl"));if(!b.getProperty("/imgUrlDefined")&&!b.getProperty("/typeImgUrlDefined")){b.setProperty("/typeImgUrl","sap-icon://form");b.setProperty("/typeImgUrlDefined",true);}b.setProperty("/title",o.getProperty("title"));if(o.getProperty("typeName")){b.setProperty("/typeName",o.getProperty("typeName"));}else if(o.getProperty("titleMetadata")&&o.getProperty("titleMetadata")["sap:label"]){b.setProperty("/typeName",o.getProperty("titleMetadata")["sap:label"]);}else{b.setProperty("/typeName","");}b.setProperty("/subtitle",o.getProperty("headline"));b.setProperty("/badgeVisible",true);}else{b.setProperty("/fallbackBadgeVisible",true);}this._badgeResolved=true;}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.BusyHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.BusyHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/BusyHelper",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/lib/MessageUtils","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,M,t){"use strict";function g(T){var b={};var i=false;var a=false;var c=0;var d=T.oNavigationHost.getBusyIndicatorDelay();var u=Promise.resolve();var U=q.noop;function e(){return c!==0||!q.isEmptyObject(b);}var A;function f(I){var k=e();if(k||I){a=false;T.oNavigationHost.setBusy(k);q.sap.log.info("Physical busy state has been changed to "+k);if(k!==i){i=k;if(!i){T.oNavigationHost.setBusyIndicatorDelay(d);M.handleTransientMessages(T.oApplicationProxy.getDialogFragment);U();}}}else{var n=T.oNavigationObserver.getProcessFinished(true);n.then(A,A);}}A=f.bind(null,true);function E(I){if(I){T.oNavigationHost.setBusyIndicatorDelay(0);f();}else if(!a){a=true;setTimeout(f,0);}}function h(){c--;if(!c){E(false);}}function m(){if(i){return;}i=true;u=new Promise(function(r){U=r;});M.removeTransientMessages();}function s(r,I,k){if(I){m();b[r]=true;}else{delete b[r];}E(k);}function j(o,I){c++;m();o.then(h,h);E(I);}return{setBusyReason:s,setBusy:j,isBusy:e,getUnbusy:function(){return u;}};}return B.extend("sap.suite.ui.generic.template.lib.BusyHelper",{constructor:function(T){q.extend(this,(t.testableStatic(g,"BusyHelper"))(T));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CRUDHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CRUDHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/suite/ui/generic/template/lib/CRUDHelper",["jquery.sap.global","sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(q,B,C,M,F,a){"use strict";function c(d,E,b,m,s){b=b||"/"+E;return new Promise(function(g,h){if(d.getDraftContext().isDraftEnabled(E)){d.createNewDraftEntity(E,b).then(function(o){g(o.context);},function(o){h(o);});}else{s(true);return g(m.createEntry(b,{batchGroupId:"Changes",changeSetId:"Changes"}));}});}function r(m,b,t){var P=new Promise(function(d,g){m.read(b,{urlParameters:{"$expand":"DraftAdministrativeData"},success:function(o){d(o);},error:function(o){g(o);}});});t.oBusyHelper.setBusy(P,true);return P;}function R(t,E,k,s,m,T){var P=new Promise(function(b,d){var i,l,g,v,h=[];if(k&&s&&m){l=k.length;for(i=0;i<l;i++){g=k[i].PropertyPath;v=s[g][0];h.push(new F(g,a.EQ,v));}if(t.getDraftController().getDraftContext().isDraftEnabled(E)){var D=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});h.push(D);}var o=new F(h,true);m.read("/"+E,{urlParameters:{"$expand":"DraftAdministrativeData"},filters:[o],success:function(j){var n=f(j,m,s);if(n){b(n);}else{d(j);}},error:function(j){d(j);}});}});T.oBusyHelper.setBusy(P,true);return P;}function f(o,m,s){var b,i,l,d;if(o&&o.results){l=o.results.length;if(l==0){d=null;}else if(l==1){d=o.results[0];}else if(l>=1){var D=[];var A=[];for(i=0;i<l;i++){b=o.results[i];if(b&&b.IsActiveEntity){A.push(b);}else if(b&&b.IsActiveEntity==false){D.push(b);}}if(A.length==0&&D.length>=2){var g;for(var j=0;j<D.length;j++){g=D[j];if(g.DraftUUID==s.DraftUUID){d=g;break;}}if(!d){d=D[0];}}else if(A.length==1&&D.length==1){d=A[0];}else if(A.length==1&&D.length>=2){d=A[0];}}}return d;}function p(P,o,t,A){if(!A.getModel().getMetaModel().getODataEntitySet(o.getPath().split("(")[0].substring(1))){return Promise.resolve();}var b=A.getApplicationController();if(!b.getTransactionController().getDraftController().getDraftContext().hasDraft(o)){return Promise.resolve();}return b.propertyChanged(P,o).catch(function(E){t.oApplicationProxy.getResourceBundleForEditPromise().then(function(d){var n=A.getNavigationController();var m=A.getModel();M.handleError(M.operations.modifyEntity,null,null,E,{resourceBundle:d,navigationController:n,model:m});M.handleTransientMessages(t.oApplicationProxy.getDialogFragment);});});}function u(t,d,b){return new Promise(function(g,h){var U=t.oApplicationProxy.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){U.close();g();},onCancel:function(){U.close();h();}},"Dialog");var s=t.getText("DRAFT_LOCK_EXPIRED",[d.LastChangedByUserDescription||d.LastChangedByUser]);U.getModel("Dialog").setProperty("/unsavedChangesQuestion",s);(b||q.noop)();t.oBusyHelper.getUnbusy().then(function(){U.open();});});}function e(t,E,b,m,T,d,k,s){if(b===""&&k&&s){return new Promise(function(g,h){R(t,E,k,s,m,T).then(function(i){var j="/"+m.createKey(E,i);var o=new C(m,j);if(!i.DraftAdministrativeData||i.DraftAdministrativeData.DraftIsCreatedByMe){g(t.editEntity(o,false));}else if(i.DraftAdministrativeData.InProcessByUser){h({lockedByUser:i.DraftAdministrativeData.InProcessByUserDescription||i.DraftAdministrativeData.InProcessByUser});}else{u(T,i.DraftAdministrativeData,d).then(function(){g(t.editEntity(o,false));},function(){h({lockedByUser:i.DraftAdministrativeData.LastChangedByUserDescription||i.DraftAdministrativeData.LastChangedByUser});});}},function(i){h({draftAdminReadResponse:i});});});}var D=t.getDraftController().getDraftContext();var o=new C(m,b);if(D.isDraftEnabled(E)){if(true||!D.hasPreserveChanges(o)){return new Promise(function(g,h){r(m,b,T).then(function(i){if(!i.DraftAdministrativeData||i.DraftAdministrativeData.DraftIsCreatedByMe){g(t.editEntity(o,false));}else if(i.DraftAdministrativeData.InProcessByUser){h({lockedByUser:i.DraftAdministrativeData.InProcessByUserDescription||i.DraftAdministrativeData.InProcessByUser});}else{u(T,i.DraftAdministrativeData,d).then(function(){g(t.editEntity(o,false));},function(){h({lockedByUser:i.DraftAdministrativeData.LastChangedByUserDescription||i.DraftAdministrativeData.LastChangedByUser});});}},function(i){h({draftAdminReadResponse:i});});});}}else{T.oApplicationProxy.setEditableNDC(true);return Promise.resolve({context:o});}}return{create:c,edit:e,propertyChange:p};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CRUDManager')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CRUDManager');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.ui.generic.app.util.ActionUtil');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.ui.table.AnalyticalTable');sap.ui.define("sap/suite/ui/generic/template/lib/CRUDManager",["jquery.sap.global","sap/ui/base/Object","sap/m/MessageToast","sap/ui/generic/app/util/ModelUtil","sap/ui/generic/app/util/ActionUtil","sap/suite/ui/generic/template/lib/MessageUtils","sap/m/MessageBox","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/testableHelper","sap/m/Table","sap/ui/table/AnalyticalTable"],function(q,B,M,a,A,b,c,C,t,T,d){"use strict";var r=Promise.reject();r.catch(q.noop);function g(o,e,s,f,h){function k(O,i,j,P){b.handleError(O,o,s,j,P);return(i||q.noop)(j);}function l(){b.handleTransientMessages(s.oApplication.getDialogFragmentForView.bind(null,null));}var E;function m(i){return new Promise(function(j,J){var K=o.getOwnerComponent();var L=K.getBindingContext();var N=K.getModel();N.read(L.getPath(),{urlParameters:{"$expand":"DraftAdministrativeData"},success:function(R){if(!R.DraftAdministrativeData){if(i){return k(b.operations.editEntity,J,i);}return j({});}if(R.DraftAdministrativeData.InProcessByUser){var U=R.DraftAdministrativeData.InProcessByUserDescription||R.DraftAdministrativeData.InProcessByUser;i=i||new Error(f.getText("ST_GENERIC_DRAFT_LOCKED_BY_USER",[" ",U]));return k(b.operations.editEntity,J,i,i);}return j({draftAdministrativeData:R.DraftAdministrativeData});},error:k.bind(null,b.operations.editEntity,J)});});}function n(i,U,P){if(P.draftAdministrativeData){return Promise.resolve(P);}return new Promise(function(j,J){s.oTransactionController.editEntity(o.getView().getBindingContext(),!U).then(function(R){l(R);return j({context:R.context});},function(R){if(R&&R.response&&R.response.statusCode==="409"&&i&&!U){b.removeTransientMessages();return m(R).then(j,J);}else{k(b.operations.editEntity,J,R,R);}});});}E=function(U){var i=f.isDraftEnabled();var R;var j=o.getOwnerComponent();var J=j.getBindingContext();if(i&&!U){var K=s.oDraftController.getDraftContext();var P=K.hasPreserveChanges(J);if(!P){R=m().then(n.bind(null,true,true));}}R=R||n(i,U,{});if(i){s.oApplication.editingStarted(J,R);}return R;};function p(U){if(h.isBusy()){return r;}var R=E(U);h.setBusy(R);return R;}function u(i,j,J,K,N){var R=new Promise(function(L,O){var P=function(Q){o.getOwnerComponent().getComponentContainer().bindElement(J.getPath());return k(b.operations.deleteEntity,O,Q);};if(i&&K){s.oDraftController.getDraftForActiveEntity(J).then(function(Q){s.oTransactionController.deleteEntity(Q.context).then(function(){if(!N){s.oApplication.showMessageToast(f.getText("ST_GENERIC_DRAFT_WITH_ACTIVE_DOCUMENT_DELETED"));}return L();});},P);}else{s.oTransactionController.deleteEntity(J).then(function(){var Q=a.getEntitySetFromContext(J);var S=s.oDraftController.getDraftContext();var U=S.isDraftRoot(Q);var V=f.getText("ST_GENERIC_OBJECT_DELETED");if(!i&&U){V=f.getText(j?"ST_GENERIC_DRAFT_WITH_ACTIVE_DOCUMENT_DELETED":"ST_GENERIC_DRAFT_WITHOUT_ACTIVE_DOCUMENT_DELETED");}if(!N){s.oApplication.showMessageToast(V);}return L();},P);}});return R;}function v(i,N,R,j){if(h.isBusy()){j();return;}var J=o.getView().getBindingContext();var K=s.oDraftController.isActiveEntity(J);var L=s.oDraftController.hasActiveEntity(J);var S;if(i){S=Promise.resolve(J);}else if(L&&!K){S=s.oApplication.getDraftSiblingPromise(J);}else{S=Promise.resolve();}S.then(function(O){var P=u(K,L,J,i,N);P.then(R,j);if(L&&!K){var Q=function(){return{context:O};};var U=P.then(Q);s.oApplication.cancellationStarted(J,U);}},j);}function w(i,N){var R=new Promise(function(j,J){s.oApplication.performAfterSideEffectExecution(v.bind(null,i,N,j,J));});h.setBusy(R);return R;}function x(P){var R=new Promise(function(J,K){s.oTransactionController.deleteEntities(P).then(function(L){var N=[];var O=sap.ui.getCore().getMessageManager().getMessageModel().getData();for(var i=0;i<O.length;i++){var Q=O[i].getTarget();for(var j=0;j<P.length;j++){if(Q.indexOf(P[j])>-1){N.push(Q);break;}}}return J(N);},function(i){return K(i);});});R.then(function(j){var J=[];for(var i=0;i<P.length;i++){if(j.indexOf(P[i])===-1){J.push(P[i]);}}s.oApplication.adaptAfterDeletion(J,e.getViewLevel());});return R;}function y(i,j){if(h.isBusy()){j();return;}s.oTransactionController.triggerSubmitChanges().then(function(R){l();i(R.context);},k.bind(null,b.operations.saveEntity,j));}function z(){var R=new Promise(function(i,j){s.oApplication.performAfterSideEffectExecution(y.bind(null,i,j));});h.setBusy(R);return R;}function D(){if(h.isBusy()){return r;}var R=new Promise(function(i,j){var J=o.getView().getBindingContext();var K=s.oDraftController.activateDraftEntity(J);s.oApplication.activationStarted(J,K);K.then(function(L){var P=L.context.getPath();function N(){l();i(L);}var O=e.getPreprocessorsData().rootContextExpand;if(O){var Q=O.join(",");o.getView().getModel().read(P,{urlParameters:{"$select":Q,"$expand":Q},success:N,error:N});}else{N();}},k.bind(null,b.operations.activateDraftEntity,j));});h.setBusy(R);return R;}function F(P){return new A(P);}function G(P,S,R,j){if(h.isBusy()){j();return;}var J=P.functionImportPath;var K=P.contexts;var L=P.sourceControl;var N=P.label;var O=P.navigationProperty;var Q=P.operationGrouping;var U=F({controller:o,contexts:K,applicationController:s.oApplicationController,operationGrouping:Q});var V=function(Z,$){if(Z.pages){for(var i in Z.pages){var _=Z.pages[i];if(_.component.list!=true&&_.entitySet===$){return true;}else{var a1=V(_,$);if(a1){return true;}}}}return false;};var W=function(i,Z){var $=i.getAppComponent().getConfig();if(Z&&Z.sPath){var _=Z.sPath.split("(")[0].replace("/","");return V($.pages[0],_);}return false;};var X=function(i){var Z,$,_,a1;if(q.isArray(i)&&i.length===1){Z=i[0];}else{Z={response:{context:i.context}};}$=Z.response&&Z.response.context;_=o.getOwnerComponent();a1=W(_,$);if(a1&&$&&$!==Z.actionContext&&$.getPath()!=="/undefined"){if(L){f.navigateFromListItem($,L);}else{s.oNavigationController.navigateToContext($,O,false);}}if(i.length>0){var b1=f.getTableBindingInfo(L);var c1=b1&&b1.binding;if(c1&&c1.oEntityType){f.setEnabledToolbarButtons(L);var d1=_.getComponentContainer();var e1=d1&&d1.getSettings();var f1=e1&&e1.routeConfig;if(f1){if(sap.suite.ui.generic.template.js.AnnotationHelper.isListReportTemplate(f1)){f.setEnabledFooterButtons(L,o);}}}}R(i);};var Y=function(i){if(q.isArray(i)){if(i.length===1){i=i[0].error;}else{i=null;}}var Z={context:K};if(K&&K[0]){var $=K[0].oModel;if($&&$.hasPendingChanges()){$.resetChanges();}}k(b.operations.callAction,null,i,Z);j(i);};U.call(J,N).then(function(i){if(i&&i.executionPromise){h.setBusy(i.executionPromise);i.executionPromise.then(X,Y);}else{if(!i){j();}else{X(i);}}},function(i){if(!i){j();}else{Y(i);}});}function H(P,S){var R=new Promise(function(i,j){s.oApplication.performAfterSideEffectExecution(G.bind(null,P,S,i,j));});return R;}function I(i){if(!i){throw new Error("Unknown Table");}var j="";var J="";var K=o.getOwnerComponent().getEntitySet();var L,N,O,P;var V=o.getView();var Q=V.getModel();var R=V.getBindingContext();if(R){J=f.getTableBindingInfo(i).path;P=Q.getMetaModel();N=P.getODataEntitySet(K);L=P.getODataEntityType(N.entityType);O=P.getODataAssociationSetEnd(L,J);if(O){K=O.entitySet;}J="/"+J;j=R.getPath()+J;}else{j="/"+K;}var S=C.create(s.oDraftController,K,j,Q,s.oApplication.setEditableNDC);s.oApplication.getBusyHelper().setBusy(S);return S.then(function(U){return{newContext:U,tableBindingPath:J};},k.bind(null,b.operations.addEntry,function(U){throw U;}));}var k=t.testable(k,"handleError");var F=t.testable(F,"getActionUtil");return{editEntity:p,deleteEntity:w,deleteEntities:x,saveEntity:z,activateDraftEntity:D,callAction:H,addEntry:I};}return B.extend("sap.suite.ui.generic.template.lib.CRUDManager.js",{constructor:function(o,e,s,f,h){q.extend(this,g(o,e,s,f,h));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CommonEventHandlers')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CommonEventHandlers');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.ComboBox');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.comp.smartfilterbar.SmartFilterBar');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.ui.model.odata.type.Time');sap.ui.define("sap/suite/ui/generic/template/lib/CommonEventHandlers",["jquery.sap.global","sap/ui/base/Object","sap/ui/core/format/DateFormat","sap/m/ComboBox","sap/m/MessageBox","sap/m/MessageToast","sap/m/Table","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/table/AnalyticalTable","sap/ui/table/Table","sap/ui/model/odata/type/Time","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,C,M,a,T,F,S,b,A,U,c,t){"use strict";function g(p){var s="";var m=[];return function(o){var l="";var e=p;var f;for(var h in m){if(m[h].path===p){f=m[h];break;}}if(!f){var i=o.getModel("entitySet").getMetaModel();var P=i.getObject(i.getMetaContext(o.sPath+"/"+p).sPath);if(P){var j=" ";for(var k=0;P.extensions&&k<P.extensions.length;k++){if(P.extensions[k].namespace==="http://www.sap.com/Protocols/SAPData"){switch(P.extensions[k].name){case"display-format":j=P.extensions[k].value;break;case"label":l=P.extensions[k].value;break;case"text":var n=P.extensions[k].value;var r=p.split("/");r[r.length-1]=n;e=r.join("/");break;default:break;}}}if(l===""){l=p;}f={path:p,data:{type:P.type,displayFormat:j,label:l,textPath:e}};m.push(f);}}l=f.data.label;var u=o.getProperty(p);var v;if(f.data.textPath&&f.data.textPath!==""){v=o.getProperty(f.data.textPath);}if(!v||f.data.textPath===p){s=u?u:"";}else{s=v+(u?" ("+u+")":"");}switch(f.data.type){case"Edm.DateTime":if(f.data.displayFormat==="Date"){var w=D.getDateInstance({style:"medium"});var x=new Date(0).getTimezoneOffset()*60*1000;if(s&&s!==""&&s.getTime){s=w.format(new Date(s.getTime()+x));}}break;case"Edm.Time":if(s&&s!==""){var y=new c();s=y.formatValue(s,"string");}break;case"Edm.Boolean":if(s===true){s="{i18n>YES}";}else if(s===false){s="{i18n>NO}";}break;default:break;}return{key:s?s:p,text:l?l+": "+s:s};};}function d(o,e,s,f){function E(i){var j={};for(var k in i){var i1=i[k];if(typeof i1==="string"){j[k]=i1;}else if(typeof i1==="object"){if(i1.value){j[k]=E(i1).value;}else{j[k]=i1;}}}return j;}function h(i){if(i instanceof sap.ui.generic.app.navigation.service.NavError){sap.m.MessageBox.show(i.getErrorCode(),{title:f.getText("ST_GENERIC_ERROR_TITLE")});}}function l(){var i=o.getView().getBindingContext();return s.oApplication.getDraftSiblingPromise(i);}var I;var m;function n(i){I=true;m=i;var j=f.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){q.sap.log.info("Draft cancellation confirmed");if(!I){q.sap.log.info("Draft popover no longer active -> Ignore.");return;}var k=s.oApplication.getBusyHelper();if(k.isBusy()){q.sap.log.info("Ignore discarding confirmation as app is already busy");return;}q.sap.log.info("Discarding was confirmed, draft will be discarded");k.setBusy(m);m.then(function(i1){q.sap.log.info("Active information for current draft has been read. Start discarding the draft");var j1=i1&&i1.getObject();var k1=j1&&j1.IsActiveEntity;var l1=k1?s.oApplication.getTargetAfterCancelPromise(i1):Promise.resolve();l1.then(function(m1){var n1=s.oCRUDManager.deleteEntity();n1.then(function(){q.sap.log.info("Draft was discarded successfully");I=false;j.close();q.sap.log.info("Draft popover closed");s.oViewDependencyHelper.setRootPageToDirty();s.oViewDependencyHelper.unbindChildren(o.getOwnerComponent());if(m1){q.sap.log.info("Navigate to active entityy");s.oNavigationController.navigateToContext(m1,null,true,1);}else{q.sap.log.info("Deleted draft was create draft. Navigate back");var p1=o.getOwnerComponent().getModel("_templPrivGlobal");var q1=p1.getProperty("/generic/forceFullscreenCreate");if(q1){s.oNavigationController.navigateBack();}else{s.oNavigationController.navigateToRoot(true);}}});var o1={discardPromise:n1};e.fire(o,"AfterCancel",o1);});},function(i1){j.close();});}},"discard");return j;}var p;function r(){p=true;var i=f.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardSubItemPopover",{onDiscardConfirm:function(){q.sap.log.info("Sub item cancellation confirmed");if(!p){q.sap.log.info("Sub item popover no longer active -> Ignore.");return;}var j=s.oCRUDManager.deleteEntity(false,true);j.then(function(){var i1=o.getOwnerComponent();s.oViewDependencyHelper.setParentToDirty(i1,i1.getNavigationProperty());s.oViewDependencyHelper.unbindChildren(i1,true);i.close();p=false;s.oNavigationController.navigateBack();});var k={deleteEntityPromise:j};e.fire(o,"AfterDelete",k);}},"discard");return i;}function u(j){var k=j;var i1=-1,j1=-1;var k1=f.getOwnerControl(j);if(k1.getTable){k1=k1.getTable();}var l1=k1 instanceof A;if(!l1){var m1=f.getTableBindingInfo(k1);var n1=m1&&m1.binding;var o1=null;if(n1){if(k1 instanceof U){o1=n1.getContexts();}else if(k1 instanceof T){o1=n1.getCurrentContexts();}}var p1=null;var q1=f.getSelectedContexts(k1);var r1=null;if(q1&&q1.length>0){r1=q1[0].getPath();}else if(k){if(k1 instanceof T){r1=k.getBindingContext()?k.getBindingContext().sPath:null;}}if(n1&&n1.getContexts&&r1){for(var i=0;i<o1.length;i++){p1=o1[i];if(p1.getPath()===r1){i1=i;break;}}}if(k1&&i1!==-1){j1=n1.getLength();var s1=Math.floor(j1/5);if(k1 instanceof T){s1=k1.getGrowingThreshold();}else if(k1 instanceof U){s1=k1.getThreshold();}var t1=null;if(n1&&k1 instanceof U){t1=n1.getContexts();}else if(n1&&k1 instanceof T){t1=n1.getCurrentContexts();}var u1=t1&&{listBinding:n1,tableMaxItems:j1,growingThreshold:s1,selectedRelativeIndex:i1,objectPageNavigationContexts:t1,tableNavFrom:k1,endIndex:t1.length-1};var v1=e.getTemplatePrivateModel();var w1=v1.getProperty("/generic/viewLevel");var x1=o.getOwnerComponent().getModel("_templPrivGlobal");x1.setProperty("/generic/paginatorInfo/"+w1,u1);}}}function v(j,k){var i1=o.getView().getModel().getMetaModel();var j1=k;var k1=i1.getODataEntitySet(j,false);var l1=i1.getODataEntityType(k1.entityType,false);var m1=l1.key.propertyRef;var i;var n1=s.oDraftController.getDraftContext();if(n1.isDraftEnabled(j)){m1=m1.concat(n1.getSemanticKey(j));m1.push({name:"IsActiveEntity"},{name:"HasDraftEntity"},{name:"HasActiveEntity"});}if(j1.parameters.select&&j1.parameters.select.length>0){var o1=j1.parameters.select.split(",");for(i=0;i<m1.length;i++){if(q.inArray(m1[i].name,o1)===-1){j1.parameters.select+=","+m1[i].name;}}}return j1;}function w(i,j){var k=i.getSource().getUrl();i.preventDefault();f.processDataLossConfirmationIfNonDraft(function(){sap.m.URLHelper.redirect(k,false);},q.noop,j);}function x(i,j){i.preventDefault();var k=i.getSource().getHref();f.processDataLossConfirmationIfNonDraft(function(){window.location.hash=k;},q.noop,j);}function y(j){return f.getDialogFragment("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(i){var k=i.getSource().getParent();k.close();},onDelete:function(k){var i1=k.getSource().getParent();var j1=i1.getModel("delete");var k1=j1.getProperty("/items");var l1=[];for(var i=0;i<k1.length;i++){if(!k1[i].draftStatus.locked&&k1[i].deletable){if(k1.length===j1.getProperty("/unsavedChangesItemsCount")||!k1[i].draftStatus.unsavedChanges||j1.getProperty("/checkboxSelected")){l1.push(k1[i].context.getPath());}}}s.oCRUDManager.deleteEntities(l1).then(function(m1){var n1=j.getTable();n1.getModel("_templPriv").setProperty("/listReport/deleteEnabled",false);var o1=l1.length-m1.length;if(m1.length>0){var p1="";if(o1>0){p1+=(o1>1)?f.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL_WITH_COUNT",[o1]):f.getText("ST_GENERIC_DELETE_SUCCESS_WITH_COUNT",[o1]);p1+="\n";p1+=(m1.length>1)?f.getText("ST_GENERIC_DELETE_ERROR_PLURAL_WITH_COUNT",[m1.length]):f.getText("ST_GENERIC_DELETE_ERROR_WITH_COUNT",[m1.length]);}else{p1=(m1.length>1)?f.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):f.getText("ST_GENERIC_DELETE_ERROR");}M.error(p1);}else{var q1="";q1=(o1>1)?f.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):f.getText("ST_GENERIC_OBJECT_DELETED");a.show(q1);}f.refreshSmartTable(j);},function(m1){M.error(f.getText("ST_GENERIC_DELETE_ERROR_PLURAL",[l1.length]),{styleClass:f.getContentDensityClass()});});i1.close();}},"delete");}function z(j){var k=o.getView().getModel();var i1=k.getMetaModel();var j1=i1.getODataEntitySet(o.getOwnerComponent().getEntitySet());var k1=j1["Org.OData.Capabilities.V1.DeleteRestrictions"];var l1=(k1&&k1.Deletable&&k1.Deletable.Path)?k1.Deletable.Path:"";var m1={items:undefined,itemsCount:j.length,text:{title:undefined,shortText:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,checkboxSelected:true};var n1=[];for(var i=0;i<j.length;i++){var o1=k.getObject(j[i].getPath());var p1={};var q1=true;if(!o1.IsActiveEntity){p1.draft=true;}else if(o1.HasDraftEntity){var r1=k.getProperty("DraftAdministrativeData/InProcessByUser",j[i]);if(r1){p1.locked=true;p1.user=r1;m1.lockedItemsCount++;}else{p1.unsavedChanges=true;p1.user=k.getProperty("DraftAdministrativeData/LastChangedByUser",j[i]);m1.unsavedChangesItemsCount++;}}if(l1&&l1!==""){if(k.getProperty(l1,j[i])===false){q1=false;m1.undeletableCount++;}}n1.push({context:j[i],draftStatus:p1,deletable:q1});}m1.items=n1;if(m1.lockedItemsCount===m1.itemsCount){m1.text.title=f.getText("ST_GENERIC_ERROR_TITLE");}else{m1.text.title=(m1.itemsCount>1)?f.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[m1.itemsCount]):f.getText("ST_GENERIC_DELETE_TITLE");}m1.text.unsavedChanges=f.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(m1.itemsCount>1){if(m1.lockedItemsCount===m1.itemsCount){m1.text.shortText=f.getText("ST_GENERIC_DELETE_LOCKED_PLURAL");}else if(m1.unsavedChangesItemsCount===m1.itemsCount){m1.text.shortText=f.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL");}else if(m1.lockedItemsCount>0){var s1=m1.itemsCount-m1.lockedItemsCount;m1.text.shortText=(m1.lockedItemsCount>1)?f.getText("ST_GENERIC_CURRENTLY_LOCKED_PLURAL",[m1.lockedItemsCount,m1.itemsCount]):f.getText("ST_GENERIC_CURRENTLY_LOCKED",[m1.itemsCount]);m1.text.shortText+="\n";if(s1===m1.unsavedChangesItemsCount){m1.text.shortText+=(s1>1)?f.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL"):f.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");}else{m1.text.shortText+=(s1>1)?f.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[s1]):f.getText("ST_GENERIC_DELETE_REMAINING");}}else{m1.text.shortText=f.getText("ST_GENERIC_DELETE_SELECTED_PLURAL");}if(m1.undeletableCount>0){m1.text.undeletableText=f.getText("ST_GENERIC_DELETE_UNDELETABLE",[m1.undeletableCount,m1.itemsCount]);}}else{if(m1.lockedItemsCount>0){m1.text.shortText=f.getText("ST_GENERIC_DELETE_LOCKED",[" ",m1.items[0].draftStatus.user]);}else if(m1.unsavedChangesItemsCount>0){m1.text.shortText=f.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",m1.items[0].draftStatus.user]);}else{m1.text.shortText=f.getText("ST_GENERIC_DELETE_SELECTED");}}return m1;}function G(i){M.error(f.getText(i),{styleClass:f.getContentDensityClass()});}function H(i,j,k,i1){var j1=f.getNavigationHandler();var k1={};var l1={};for(var m1 in i.parameters){if(q.isEmptyObject(i.parameters[m1])){k1[m1]=i.parameters[m1];}else{l1[m1]=i.parameters[m1];}}l1=E(l1);j1.mixAttributesAndSelectionVariant({},i1).getParameterNames().forEach(function(m1){delete k1[m1];});var n1=k&&k.getObject();var o1=j&&j.getObject();var p1=q.extend({},k1,n1,o1,l1);return j1.mixAttributesAndSelectionVariant(p1,i1);}function N(i,j,k,i1){var j1=f.getNavigationHandler();var k1;if(k){k1=k.getDataSuiteFormat();}var l1=H(i,j,o.getView().getBindingContext(),k1);var m1={semanticObject:i.semanticObject,action:i.action};o.adaptNavigationParameterExtension(l1,m1);j1.navigate(i.semanticObject,i.action,l1.toJSONString(),null,h);}function J(i,j,k){var i1=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var j1=i1.crossNavigation.outbounds[i.data("CrossNavigation")];var k1;if(k){k1=f.getOwnerControl(i).getParent();}N(j1,j,k,k1);}function K(j,k){for(var i=0;i<j.length;i++){if(j[i].indexOf("/")!==-1){var i1=j[i].split("/");i1.pop();var j1=i1.join("/");if(k.indexOf(j1)===-1){k.push(j1);}}}}function L(i,j){}function O(k){var i1=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui.generic.app");var j1={};if(i1&&i1.pages[0]&&i1.pages[0].component&&i1.pages[0].component.settings){j1=i1.pages[0].component.settings.tableTabs;}var k1=[];for(var l1 in j1){var m1=j1[l1].qualifier;if(m1){k1[l1]=[];var n1=k[m1];for(var i in n1.SelectOptions){if(n1.SelectOptions[i].PropertyName){var o1=n1.SelectOptions[i].PropertyName.PropertyPath;for(var j in n1.SelectOptions[i].Ranges){var p1=n1.SelectOptions[i].Ranges[j].Option;p1.EnumMember=p1.EnumMember.replace("com.sap.vocabularies.UI.v1.SelectionRangeOptionType/","");var q1=n1.SelectOptions[i].Ranges[j].Low;var r1=n1.SelectOptions[i].Ranges[j].High;if(r1){k1[l1].push(new F(o1,p1.EnumMember,q1.String,r1.String));}else{k1[l1].push(new F(o1,p1.EnumMember,q1.String));}}}}}}return k1;}function V(o,j,k,i1){var j1=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui.generic.app");if(o.getMetadata().getName()==='sap.suite.ui.generic.template.ListReport.view.ListReport'&&j1&&j1.pages[0]&&j1.pages[0].component&&j1.pages[0].component.settings&&j1.pages[0].component.settings.tableTabs){var k1=j.getFilters();if(k1[0]&&k1[0]._bMultiFilter){k1=k1[0].aFilters;}if(k1){for(var i in k1){i1.filters.push(k1[i]);}}}}function P(i){f.setEnabledToolbarButtons(i.getSource());}function Q(i){var i1=i.getSource();var j1=i1.getTable();if(j1 instanceof T){var k1=j1.getColumns();for(var l1=0;l1<k1.length;l1++){if(k1[l1].getCustomData()[0].getValue()&&k1[l1].getCustomData()[0].getValue()["actionButton"]==="true"){k1[l1].setPopinDisplay("WithoutHeader");}}}var m1=i.getParameter("bindingParams");m1.parameters=m1.parameters||{};var n1=o.byId(i1.getSmartFilterId());if(!n1){n1=o.byId("listReportFilter");V(o,n1,i1,m1);}if(n1 instanceof b){var o1=n1.getControlByKey("EditState");if(o1 instanceof C){var p1=o1.getSelectedKey();switch(p1){case"1":m1.filters.push(new F("IsActiveEntity","EQ",true));m1.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":m1.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":m1.filters.push(new F("IsActiveEntity","EQ",true));m1.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));m1.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":m1.filters.push(new F("IsActiveEntity","EQ",true));m1.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));m1.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var q1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(m1.filters[0]&&m1.filters[0].aFilters){var r1=m1.filters[0];m1.filters[0]=new F([r1,q1],true);}else{m1.filters.push(q1);}break;}}}v(i1.getEntitySet(),m1);var s1=m1.parameters.select&&m1.parameters.select.split(",")||[];var t1=m1.parameters&&m1.parameters.expand&&m1.parameters.expand.split(",")||[];var u1=i1.getEntitySet();if(s1&&s1.length>0){var v1=i1.getModel().getMetaModel();var w1=v1.getODataEntitySet(u1);var x1={};var y1=v1.getODataEntityType(w1.entityType);for(var z1=0;z1<s1.length;z1++){var A1=s1[z1];if(A1){var x1=v1.getODataProperty(y1,A1);if(x1&&x1["com.sap.vocabularies.Common.v1.FieldControl"]&&x1["com.sap.vocabularies.Common.v1.FieldControl"].Path){var B1=x1["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(B1!==" "&&m1.parameters.select.search(B1)===-1){m1.parameters.select+=","+B1;s1.push(B1);}}}}if(j1 instanceof T){var C1=m1.sorter[0];if(C1&&C1.vGroup){var D1=v1.getODataProperty(y1,C1.sPath);var E1=D1["sap:text"]||(D1["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";if(E1){if(q.inArray(E1,s1)===-1){m1.parameters.select+=","+E1;s1.push(E1);}}}}var F1=w1["Org.OData.Capabilities.V1.DeleteRestrictions"];if(F1&&F1.Deletable&&F1.Deletable.Path&&m1.parameters.select.search(F1.Deletable.Path)===-1){m1.parameters.select+=","+F1.Deletable.Path;s1.push(F1.Deletable.Path);}var G1,H1;var y1=v1.getODataEntityType(w1.entityType);var I1=y1["com.sap.vocabularies.UI.v1.LineItem"]||[];for(var z1=0;z1<I1.length;z1++){if(I1[z1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){G1=v1.getODataFunctionImport(I1[z1].Action.String,true);if(G1){H1=v1.getObject(G1);if(H1["sap:action-for"]!==" "&&H1["sap:applicable-path"]!==" "&&m1.parameters.select.search(H1["sap:applicable-path"])===-1){m1.parameters.select+=","+H1["sap:applicable-path"];s1.push(H1["sap:applicable-path"]);}}}if(I1[z1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){var J1,K1;if(I1[z1].Value&&I1[z1].Value.Path){J1=v1.getODataProperty(y1,I1[z1].Value.Path);if(J1){K1=J1["sap:text"]||(J1["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";}if(!K1){K1=I1[z1].Value.Path;}if(s1.indexOf(K1)===-1){s1.push(K1);m1.parameters.select=m1.parameters.select+","+K1;}}}if(I1[z1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(I1[z1].Target&&I1[z1].Target.AnnotationPath){var L1=I1[z1].Target.AnnotationPath;var M1=L1.split("@")[1];var N1=y1[M1];if(N1&&N1.MeasureAttributes){if(N1.MeasureAttributes[0]&&N1.MeasureAttributes[0].DataPoint&&N1.MeasureAttributes[0].DataPoint.AnnotationPath){var O1=N1.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var P1=y1[O1];if(P1){for(var Q1 in P1){if(P1[Q1]&&P1[Q1].Path&&s1.indexOf(P1[Q1].Path)===-1){m1.parameters.select=m1.parameters.select+","+P1[Q1].Path;s1.push(P1[Q1].Path);}if(Q1==="CriticalityCalculation"&&P1.CriticalityCalculation){for(var R1 in P1.CriticalityCalculation){if(P1.CriticalityCalculation[R1].Path&&s1.indexOf(P1.CriticalityCalculation[R1].Path)===-1){m1.parameters.select=m1.parameters.select+","+P1.CriticalityCalculation[R1].Path;s1.push(P1.CriticalityCalculation[R1].Path);}}}}}}}if(N1&&N1.Measures){if(N1.Measures[0]&&N1.Measures[0].PropertyPath&&s1.indexOf(N1.Measures[0].PropertyPath)===-1){m1.parameters.select=m1.parameters.select+","+N1.Measures[0].PropertyPath;s1.push(N1.Measures[0].PropertyPath);}}}}}var S1=f.getBreakoutActionsForTable(i1,o);var T1=f.getBreakoutActionsFromManifest(j1.getModel());for(var U1 in T1){if(q.inArray(T1[U1].id,S1)!==-1){if(T1[U1].requiresSelection&&T1[U1].applicablePath){if(m1.parameters.select.search(T1[U1].applicablePath)===-1){m1.parameters.select+=","+T1[U1].applicablePath;s1.push(T1[U1].applicablePath);}}}}}K(s1,t1);var V1=s.oDraftController.getDraftContext();if(V1.isDraftEnabled(u1)&&V1.isDraftRoot(u1)){if(V1.hasDraftAdministrativeData(u1)){if(s1&&s1.length>0){if(s1.indexOf("DraftAdministrativeData")===-1){s1.push("DraftAdministrativeData");m1.parameters.select=m1.parameters.select+",DraftAdministrativeData";}}if(t1.indexOf("DraftAdministrativeData")===-1){t1.push("DraftAdministrativeData");}}}if(t1.length>0){m1.parameters.expand=t1.join(",");}var W1=i1.getCustomData();var X1={};for(var k=0;k<W1.length;k++){X1[W1[k].getKey()]=W1[k].getValue();}var Y1=i1.fetchVariant();if((!Y1||!Y1.sort)&&j1 instanceof T&&X1.TemplateSortOrder){var Z1=X1.TemplateSortOrder.split(", ");for(var j=0;j<Z1.length;j++){var $1=Z1[j].split(" ");if($1.length>1){m1.sorter.push(new S($1[0],$1[1]==="true"));}else{m1.sorter.push(new S($1[0]));}}}if(j1 instanceof T){var C1=m1.sorter[0];if(C1&&C1.vGroup){C1.fnGroup=g(C1.sPath);}}}function R(i,j,k){i[j].setCount(k);}function W(j){var k=o.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui.generic.app");if(k&&k.pages[0]&&k.pages[0].component&&k.pages[0].component.settings&&k.pages[0].component.settings.tableTabs){var i1=j.getParameter("bindingParams");i1.parameters=i1.parameters||{};var j1=j.getSource();var k1=j1.getModel();var l1=k1.getMetaModel();var m1=j1.getEntitySet();var n1=l1.getODataEntitySet(m1);var o1=l1.getODataEntityType(n1.entityType);var p1=O(o1);var q1=o.byId("iconTabBar");var r1=q1.getSelectedKey();var s1=q1.getItems();for(var t1 in s1){var u1=[];for(var i in i1.filters){u1.push(i1.filters[i]);}for(var i in p1[t1]){u1.push(p1[t1][i]);}var v1=o.byId("listReport-"+t1);var m1=v1.getEntitySet();k1.read("/"+m1+"/$count",{urlParameters:i1.parameters,filters:u1,groupId:"updateTabs",success:R.bind(null,s1,t1),error:function(w1,x1){}});}for(var i in p1[r1]){i1.filters.push(p1[r1][i]);}}}function X(i,j){f.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){J(i,i.getBindingContext(),j.oSmartFilterbar);return;}var k=f.getOwnerControl(i);u(i);f.navigateFromListItem(i.getBindingContext(),k);},q.noop,j);}function Y(i,j){var k=i.getParent().getParent().getTable();var i1=f.getSelectedContexts(k);switch(i1.length){case 0:G("ST_GENERIC_NO_ITEM_SELECTED");return;case 1:f.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){J(i,i1[0],j.oSmartFilterbar);return;}u(i);f.navigateFromListItem(i1[0],k);},q.noop,j);return;default:G("ST_GENERIC_MULTIPLE_ITEMS_SELECTED");return;}}function Z(i,j){var k=i.getSource();var i1=f.getOwnerControl(k);var j1=f.getSelectedContexts(i1);switch(j1.length){case 0:case 1:f.processDataLossConfirmationIfNonDraft(function(){var k1={action:k.data('Action'),semanticObject:k.data('SemanticObject')};N(k1,j1[0],j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);return;default:G("ST_GENERIC_MULTIPLE_ITEMS_SELECTED");return;}}function $(i,j){var k=i.getSource();var i1=k.getParent().getBindingContext();var j1=k.data('SemanticObject');var k1=k.data('Action');f.processDataLossConfirmationIfNonDraft(function(){var l1={action:k1,semanticObject:j1};N(l1,i1,j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}function _(i,j,k){f.processDataLossConfirmationIfNonDraft(function(){var i1={action:j.Action,semanticObject:j.SemanticObject};N(i1,i,k.oSmartFilterbar,k.oSmartTable);},q.noop,k);}function a1(i,j){f.processDataLossConfirmationIfNonDraft(function(){var k={semanticObject:i.data("SemanticObject"),action:i.data("Action")};var i1=i.getParent().getBindingContext();N(k,i1,j.oSmartFilterbar,j.oSmartTable);},q.noop,j);}function b1(i,j){var k,i1="";var j1=f.getOwnerControl(i.getSource());var k1=i.getSource().data();var l1=f.getSelectedContexts(j1);var m1=j1.getMetadata().getName();if(m1==="sap.ui.comp.smarttable.SmartTable"){k=j1.getTable();i1=j1.getTableBindingPath();}else if(m1==="sap.ui.comp.smartchart.SmartChart"){k=j1.getChart();i1=j1.getChartBindingPath();}c1({functionImportPath:k1.Action,contexts:l1,sourceControl:k,label:k1.Label,operationGrouping:k1.InvocationGrouping,navigationProperty:""},j,i1);}function c1(i,j,k){var i1;f.processDataLossConfirmationIfNonDraft(function(){s.oCRUDManager.callAction({functionImportPath:i.functionImportPath,contexts:i.contexts,sourceControl:i.sourceControl,label:i.label,operationGrouping:i.operationGrouping,navigationProperty:i.navigationProperty},j).then(function(j1){if(j1&&j1.length&&j1.length===1){i1=j1[0];if(i1.response&&i1.response.context&&(!i1.actionContext||i1.actionContext&&i1.response.context.getPath()!==i1.actionContext.getPath())){s.oViewDependencyHelper.setMeToDirty(o.getOwnerComponent(),k);}}});},q.noop,j,"Proceed");}function d1(i){var j=i.getSource();var k=l();var i1=n(k);var j1=i1.getModel("discard");j1.setProperty("/placement",sap.m.PlacementType.Top);var k1=o.getView().getBindingContext();var l1=k1.getObject();var m1=l1.hasOwnProperty("HasActiveEntity")&&!k1.getProperty("IsActiveEntity")&&!k1.getProperty("HasActiveEntity");j1.setProperty("/isCreateDraft",m1);i1.openBy(j);}function e1(i){var j=i.getSource();var k=j.getCustomData();var i1=r();var j1=i1.getModel("discard");var k1=k&&k[0]?k[0].getValue():sap.m.PlacementType.Top;j1.setProperty("/placement",k1);i1.openBy(j);}function f1(i,j,k){if(i.data("CrossNavigation")){J(i,i.getBindingContext(),k);return new Promise(function(m1){m1();});}var i1=f.getOwnerControl(i);var j1=i1.getTableBindingPath();var k1=o.getOwnerComponent();var l1=s.oCRUDManager.addEntry(i1).then(function(m1){if(!j){s.oNavigationController.navigateToContext(m1.newContext,m1.tableBindingPath,false,4);s.oViewDependencyHelper.setMeToDirty(k1,j1);}else{f.refreshSmartTable(i1);}});l1.catch(q.noop);return l1;}function g1(i){var j=f.getOwnerControl(i.getSource());var k=f.getSelectedContexts(j);if(k&&k.length>0){var i1=z(k);var j1=y(j);var k1=j1.getModel("delete");k1.setData(i1);j1.open();}else{M.error(f.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:f.getContentDensityClass()});}}function h1(i){var j;if(i.getSource().data("Location")==="Header"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="Section"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="SmartTable"){j=i.getSource().getParent().getAggregation("items")[0];}else{j=i.getSource().getParent().getParent().getParent().getParent().getParent().getAggregation("items")[1];}j.bindElement(i.getSource().getBindingContext().getPath());j.openBy(i.getSource());}var H=t.testable(H,"fnBuildSelectionVariantForNavigation");var E=t.testable(E,"fnEvaluateParameters");return{onDataReceived:P,onBeforeRebindTable:Q,onBeforeRebindTableFinally:W,onListNavigate:X,onShowDetails:Y,onEditNavigateIntent:J,onSemanticObjectLinkPopoverLinkPressed:L,onDataFieldForIntentBasedNavigation:Z,onDataFieldForIntentBasedNavigationSelectedContext:_,onInlineDataFieldForIntentBasedNavigation:a1,onDataFieldWithIntentBasedNavigation:$,onSmartFieldUrlPressed:w,onBreadCrumbUrlPressed:x,onCallActionFromToolBar:b1,onDiscardDraft:d1,onDiscardSubItem:e1,addEntry:f1,deleteEntries:g1,onContactDetails:h1};}return B.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(o,e,s,f){q.extend(this,d(o,e,s,f));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CommonUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CommonUtils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.ListBase');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.generic.app.navigation.service.NavigationHandler');jQuery.sap.require('sap.ui.generic.app.navigation.service.NavError');sap.ui.define("sap/suite/ui/generic/template/lib/CommonUtils",["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/comp/smarttable/SmartTable","sap/ui/table/Table","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavigationHandler","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,S,U,R,L,M,N,a,t){"use strict";function g(p,e){for(var i in p){var E=p[i];if(E.entitySet===e&&E.component.list&&E.navigationProperty){return E.navigationProperty;}else if(E.pages){var r=g(E.pages,e);if(r){return r;}}}}function b(c,s,C){var n;function A(i){s.oApplication.attachControlToParent(i,c.getView());}function d(i,j,e1,f1){return s.oApplication.getDialogFragmentForView(c.getView(),i,j,e1,f1);}var r;function e(){r=r||c.getOwnerComponent().getModel("i18n").getResourceBundle();return r.getText.apply(r,arguments);}function f(){var i=s.oDraftController.getDraftContext();return i.isDraftEnabled(c.getOwnerComponent().getEntitySet());}function h(j){var e1=[];if(j instanceof S){j=j.getTable();}else if(j instanceof sap.ui.comp.smartchart.SmartChart){j=j.getChart();if(j&&j.getMetadata().getName()==="sap.chart.Chart"){var f1=j.getSelectedDataPoints();if(f1.count>0){var g1=f1.dataPoints;for(var i=0;i<g1.length;i++){e1.push(g1[i].context);}}}}if(j instanceof L){e1=j.getSelectedContexts();}else if(j instanceof U){var h1=j.getSelectedIndices();for(var i=0;i<h1.length;i++){e1.push(j.getContextByIndex(h1[i]));}}return e1;}function k(j){var e1,f1,g1,h1,i1,j1;var k1=this.getOwnerControl(j);var l1=k1.getMetadata().getName();if(l1!=="sap.ui.comp.smarttable.SmartTable"&&l1!=="sap.ui.comp.smartchart.SmartChart"){k1=k1.getParent();l1=k1.getMetadata().getName();}var m1=this.getSelectedContexts(k1);var n1=k1.getModel();var o1=n1.getMetaModel();var p1=c.getView();if(l1==="sap.ui.comp.smarttable.SmartTable"){e1=k1.getCustomToolbar()&&k1.getCustomToolbar().getContent();f1=this.getBreakoutActionsForTable(k1);this.fillEnabledMapForBreakoutActions(f1,m1,n1);}else if(l1==="sap.ui.comp.smartchart.SmartChart"){e1=k1.getToolbar()&&k1.getToolbar().getContent();}if(e1&&e1.length>0){for(var i=0;i<e1.length;i++){i1=undefined;g1=e1[i];if(g1.getMetadata().getName()==="sap.m.Button"&&g1.getVisible()){j1=this.getElementCustomData(g1);if(j1&&j1.Type){h1=p1.getLocalId(g1.getId());if(j1.Type==="CRUDActionDelete"){i1=p(n1,o1,m1,k1);}else if(j1.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||j1.Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){i1=o(n1,o1,m1,j1.Type,j1.Action);}}if(/generic\/controlProperties/.test(g1.getBindingPath("enabled"))&&i1!==undefined){m(h1,"enabled",i1);}}}}}function l(i,c){var j=this.getBreakoutActionsForFooter(c);var e1=this.getSelectedContexts(i);var f1=i.getModel();this.fillEnabledMapForBreakoutActions(j,e1,f1);}function m(i,j,e1){var f1=c.getView().getModel("_templPriv");var g1=f1.getProperty("/generic/controlProperties/"+i);if(!g1){g1={};g1[j]=e1;f1.setProperty("/generic/controlProperties/"+i,g1);}else{f1.setProperty("/generic/controlProperties/"+i+"/"+j,e1);}}function o(i,e1,f1,g1,h1){var i1,j1,k1,l1;var m1=false;if(g1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){i1=e1.getODataFunctionImport(h1);k1=i1&&i1["sap:action-for"];if(k1&&k1!==""&&k1!==" "){if(f1.length>0){l1=i1["sap:applicable-path"];if(l1&&l1!==""&&l1!==" "){for(var j=0;j<f1.length;j++){j1=i.getObject(f1[j].getPath());if(j1&&j1[l1]===true){m1=true;break;}}}else{m1=true;}}}else{m1=true;}}else if(g1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&f1.length>0){m1=true;}return m1;}function p(j,e1,f1,g1){var h1=G(g1);var i1=false;var j1=e1.getODataEntitySet(g1.getEntitySet());if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(e1,j1.entityType,h1)){if(f1.length>0){var k1=h1&&h1.Deletable&&h1.Deletable.Path;if(k1){for(var i=0;i<f1.length;i++){if(j.getProperty(k1,f1[i])){i1=true;break;}}}else{i1=true;}}}return i1;}function G(i){var j=i.getModel()&&i.getModel().getMetaModel();var e1=j&&j.getODataEntitySet(i.getEntitySet());var f1=e1&&e1["Org.OData.Capabilities.V1.DeleteRestrictions"];return f1;}function u(i,j,e1){var f1=y(e1);var g1=c.getView().getModel("_templPriv");var h1=g1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(f1){v(h1,f1,i,j,e1);}g1.setProperty("/generic/listCommons/breakoutActionsEnabled",h1);}function v(i,j,e1,f1,g1){var h1;for(var i1 in j){if(q.inArray(j[i1].id,e1)!==-1){h1=true;if(j[i1].requiresSelection){if(f1.length>0){if(j[i1].applicablePath!==undefined&&j[i1].applicablePath!==""){h1=false;for(var j1=0;j1<f1.length;j1++){var k1="";var l1=j[i1].applicablePath.split("/");if(l1.length>1){for(var m1=0;m1<l1.length-1;m1++){k1+="/"+l1[m1];}}var n1=g1.getObject(f1[j1].getPath()+k1);var o1=l1[l1.length-1];if(n1[o1]===true){h1=true;break;}}}}else{h1=false;}}i[j[i1].id]={enabled:h1};}}}function w(i){var j=[];var e1=q.grep(i.getCustomToolbar().getContent(),function(h1){return h1.getMetadata().getName()==="sap.m.Button";});for(var f1=0;f1<e1.length;f1++){var g1=e1[f1].getId().split("--");j.push(g1[g1.length-1]);}return j;}function x(c){var i=[];var j=[];var e1=c.getView().byId("page");if(e1&&e1.getFooter()){j=q.grep(e1.getFooter().getContent(),function(h1){return h1.getMetadata().getName()==="sap.m.Button";});}for(var f1=0;f1<j.length;f1++){var g1=j[f1].getId().split("--");i.push(g1[g1.length-1]);}return i;}function y(i){var j=c.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui5");var e1=j.extends&&j.extends.extensions&&j.extends.extensions["sap.ui.controllerExtensions"];if(e1){var f1=(e1[c.getOwnerComponent().getTemplateName()]||{})["sap.ui.generic.app"]||{};var g1=i.getMetaModel();var h1=(f1[g1.getODataEntitySet(c.getOwnerComponent().getEntitySet()).name]||{})["Actions"];if(!h1){h1={};var i1=(f1[g1.getODataEntitySet(c.getOwnerComponent().getEntitySet()).name]||{})["Sections"];if(i1){for(var j1 in i1){h1=q.extend(h1,i1[j1]["Actions"]);}}}return h1;}}function z(i){var j=i;while(j){if(j instanceof R||j instanceof U||j instanceof S||j instanceof sap.ui.comp.smartchart.SmartChart){return j;}if(j.getParent){j=j.getParent();}else{return null;}}return null;}function E(i){if(i instanceof S){i=i.getTable();}if(i instanceof U){return i.getBindingInfo("rows");}else if(i instanceof R){return i.getBindingInfo("items");}return null;}function F(i){var j=E(i);if(j&&j.binding){j.binding.refresh();}else{i.rebindTable();}}function H(i,j){var e1=i.getPath();var f1=c.getOwnerComponent();var g1="";if(f1.getComponentContainer().getElementBinding()){g1=f1.getComponentContainer().getElementBinding().getPath();}var h1=null;if(e1.indexOf(g1)!==0){h1=E(j).path;}var i1=!s.oApplication.isNewHistoryEntryRequired(i,h1);var j1;if(f()){j1=s.oDraftController.isActiveEntity(i)?1:6;}else{j1=c.getOwnerComponent().getModel("ui").getProperty("/editable")?6:1;}s.oNavigationController.navigateToContext(i,h1,i1,j1);}function I(i,j){var e1;if(j&&j.navigationProperty){e1=j.navigationProperty;}s.oNavigationController.navigateToContext(i,e1,false);}function K(i){if(i instanceof a){M.show(i.getErrorCode(),{title:e("ST_GENERIC_ERROR_TITLE")});}}function O(i,j){X(function(){n=c1();var e1={semanticObject:i.semanticObject,action:i.action};var f1=n.mixAttributesAndSelectionVariant(i.parameters);c.adaptNavigationParameterExtension(f1,e1);n.navigate(i.semanticObject,i.action,f1.toJSONString(),j.getCurrentAppState&&j.getCurrentAppState()||{},K);},q.noop,j,"LeavePage");}function P(i,j,c){var e1={semanticObject:i.semanticObject,action:""};n=c1();var f1=n.mixAttributesAndSelectionVariant(i.semanticAttributes,j);c.adaptNavigationParameterExtension(f1,e1);var g1=f1.toJSONString();delete i.semanticAttributes;n.processBeforeSmartLinkPopoverOpens(i,g1);}function Q(i,j,e1){if(!i){return e("DRAFT_OBJECT");}else if(j){return e(e1?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function T(){var i=d("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var j=Array.prototype.slice.call(arguments,1);var e1=arguments[0];if(!e1){return"";}if(j.length>0&&(j[0]===null||j[0]===undefined||j[0]==="")){if(j.length>3&&(j[3]===null||j[3]===undefined||j[3]==="")){return(j.length>2&&(j[1]===null||j[1]===undefined||j[1]===""))?"":j[2];}else{return e(e1,j[3]);}}else{return e(e1,j[0]);}},closeDraftAdminPopover:function(){i.close();},formatDraftLockText:Q},"admin");return i;}function V(i,j,e1,f1,g1){var h1=s.oApplication.getBusyHelper();if(!g1&&h1.isBusy()){return;}if(!f()){var i1=false;if(e1&&e1.aUnsavedDataCheckFunctions){i1=e1.aUnsavedDataCheckFunctions.some(function(k1){return k1();});}if(i1||c.getView().getModel().hasPendingChanges()){var j1;Z(function(){c.getView().getModel().resetChanges();C.fire(c,"AfterCancel",{});j1=i();},function(){j1=j();},f1);return j1;}}return i();}function W(i,j,e1,f1){var g1=false;if(e1&&e1.aUnsavedDataCheckFunctions){g1=e1.aUnsavedDataCheckFunctions.some(function(i1){return i1();});}if(g1||c.getView().getModel().hasPendingChanges()){var h1;_(function(){c.getView().getModel().resetChanges();C.fire(c,"AfterCancel",{});h1=i();},function(){h1=j();},f1);return h1;}return i();}function X(i,j,e1,f1,g1){if(g1){return V(i,j,e1,f1,true);}s.oApplication.performAfterSideEffectExecution(V.bind(null,i,j,e1,f1,false));}var Y;function Z(i,j,e1){Y=i;if(!e1){e1="LeavePage";}var f1=d("sap.suite.ui.generic.template.fragments.DataLoss",{onDataLossOK:function(){f1.close();Y();},onDataLossCancel:function(){f1.close();j();}},"dataLoss");var g1=f1.getModel("dataLoss");g1.setProperty("/mode",e1);f1.open();}var $;function _(i,j,e1){$=i;if(!e1){e1="LeavePage";}var f1=d("sap.suite.ui.generic.template.fragments.DataLossTechnicalError",{onDataLossOK:function(){f1.close();$();},onDataLossCancel:function(){f1.close();j();}},"dataLoss");var g1=f1.getModel("dataLoss");g1.setProperty("/mode",e1);f1.open();}function a1(i,j,e1,f1,g1,h1){if(j.busy.check&&f1.isBusy()){h1();return;}var i1=(j.dataloss.popup?X(i,h1,e1,(j.dataloss.navigation?"LeavePage":"Proceed"),true):i());if(i1 instanceof Promise){i1.then(g1,h1);}else{g1();}}function b1(i,j,e1){j=q.extend(true,{busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},j);var f1=s.oApplication.getBusyHelper();var g1=new Promise(function(h1,i1){s.oApplication.performAfterSideEffectExecution(a1.bind(null,i,j,e1,f1,h1,i1));});if(j.busy.set){f1.setBusy(g1);}return g1;}function c1(){n=n||new N(c);return n;}function d1(j,e1){var f1,g1,h1,i1,j1,k1=[],l1=[],i,m1,n1,o1,p1,q1,r1;var s1,t1;f1=c.getOwnerComponent().getAppComponent();g1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");h1=e1.getProperty("/generic/supportedIntents/");i1=j.getCustomToolbar().getContent();j1=i1.length;for(i=0;i<j1;i++){m1=this.getElementCustomData(i1[i]);if(m1.hasOwnProperty("SemanticObject")&&m1.hasOwnProperty("Action")){n1=m1.SemanticObject;o1=m1.Action;p1={semanticObject:n1,action:o1,ui5Component:f1};k1.push([p1]);q1=q.extend({},p1);q1.bLinkIsSupported=false;l1.push(q1);}}if(k1.length>0&&!!g1){r1=g1.getLinks(k1);r1.done(function(u1){h1=e1.getProperty("/generic/supportedIntents/");s1=u1.length;for(i=0;i<s1;i++){if(u1[i][0].length>0){l1[i].bLinkIsSupported=true;}n1=l1[i].semanticObject;o1=l1[i].action;t1=e1.getProperty("/generic/supportedIntents/"+n1);if(!t1){h1[n1]={};h1[n1][o1]={"visible":l1[i].bLinkIsSupported};}else if(!t1[o1]){t1[o1]={"visible":l1[i].bLinkIsSupported};}else{t1[o1]["visible"]=l1[i].bLinkIsSupported;}}});}}var c1=t.testable(c1,"getNavigationHandler");var f=t.testable(f,"isDraftEnabled");return{getNavigationProperty:g,getText:e,isDraftEnabled:f,getNavigationHandler:c1,executeGlobalSideEffect:function(){if(f()){var i=c.getView();i.attachBrowserEvent("keyup",function(j){if(j.keyCode===13&&i.getModel("ui").getProperty("/editable")){var e1=c.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui.generic.app");var f1=e1.settings&&e1.settings.forceGlobalRefresh;s.oApplicationController.executeSideEffects(i.getBindingContext(),null,null,f1);}});}},setEnabledToolbarButtons:k,setEnabledFooterButtons:l,fillEnabledMapForBreakoutActions:u,getBreakoutActionsForTable:w,getBreakoutActionsForFooter:x,getBreakoutActionsFromManifest:y,getSelectedContexts:h,getDeleteRestrictions:G,setPrivateModelControlProperty:m,navigateFromListItem:H,navigateToContext:I,navigateExternal:O,semanticObjectLinkNavigation:P,getCustomData:function(j){var e1=j.getSource().getCustomData();var f1={};for(var i=0;i<e1.length;i++){f1[e1[i].getKey()]=e1[i].getValue();}return f1;},formatDraftLockText:Q,showDraftPopover:function(i,j){var e1=T();var f1=e1.getModel("admin");f1.setProperty("/IsActiveEntity",i.getProperty("IsActiveEntity"));f1.setProperty("/HasDraftEntity",i.getProperty("HasDraftEntity"));e1.bindElement({path:i.getPath()+"/DraftAdministrativeData"});if(e1.getBindingContext()){e1.openBy(j);}else{e1.getObjectBinding().attachDataReceived(function(){e1.openBy(j);});}},getContentDensityClass:function(){return s.oApplication.getContentDensityClass();},attachControlToView:A,getDialogFragment:d,processDataLossConfirmationIfNonDraft:X,processDataLossTechnicalErrorConfirmation:W,securedExecution:b1,getOwnerControl:z,getTableBindingInfo:E,refreshSmartTable:F,getElementCustomData:function(i){var j={};if(i instanceof sap.ui.core.Element){i.getCustomData().forEach(function(e1){j[e1.getKey()]=e1.getValue();});}return j;},triggerAction:function(i,j,e1,f1,g1){X(function(){s.oCRUDManager.callAction({functionImportPath:e1.Action,contexts:i,sourceControl:f1,label:e1.Label,operationGrouping:"",navigationProperty:""}).then(function(h1){if(h1&&h1.length>0){var i1=h1[0];if(i1.response&&i1.response.context&&(!i1.actionContext||i1.actionContext&&i1.response.context.getPath()!==i1.actionContext.getPath())){s.oViewDependencyHelper.setMeToDirty(c.getOwnerComponent(),j);}}});},q.noop,g1,"Proceed");},checkToolbarIntentsSupported:d1};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(c,s,C){q.extend(this,b(c,s,C));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.MessageButtonHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.MessageButtonHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.m.MessagePopover');jQuery.sap.require('sap.m.MessagePopoverItem');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/suite/ui/generic/template/lib/MessageButtonHelper",["jquery.sap.global","sap/ui/base/Object","sap/m/MessagePopover","sap/m/MessagePopoverItem","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,M,a,F,b,t){"use strict";F=t.observableConstructor(F,true);var p=new F({path:"persistent",operator:b.EQ,value1:false});var v=new F({path:"validation",operator:b.EQ,value1:true});var I=new F({path:"validation",operator:b.EQ,value1:"bla"});function g(c,C){var m;var s;var o=C.byId("showMessages");var d=c.getDialogFragment("sap.suite.ui.generic.template.fragments.MessagePopover");d.setModel(sap.ui.getCore().getMessageManager().getMessageModel(),"msg");var e;var E;(function(){var i=C.getOwnerComponent();E=new F({path:"target",operator:b.EQ,value1:"/"+i.getEntitySet()});e=d.getBinding("items");var T=i.getModel("_templPriv");T.setProperty("/generic/messageCount",0);var K=c.getText("MESSAGE_BUTTON_TOOLTIP_P",0);T.setProperty("/generic/messageButtonTooltip",K);e.attachChange(function(){var L=e.getLength();T.setProperty("/generic/messageCount",L);K=c.getText(L===1?"MESSAGE_BUTTON_TOOLTIP_S":"MESSAGE_BUTTON_TOOLTIP_P",L);T.setProperty("/generic/messageButtonTooltip",K);});})();var f=[];var h;var j=0;var n;var k;function l(K){if(q.isArray(K)){var L=false;for(var i=0;i<K.length;i++){L=l(K[i])||L;}return L;}if(K instanceof Promise){K.then(n);return false;}k.push(K);return true;}function r(){var K=k;if(s){for(var i=0;i<s.length;i++){K=K.concat(s[i].filters);}}return K;}function A(){var i=r();if(m){m.propagateFilters(i);}else if(s){var K=new F(i.concat(v),false);var L=[K,p];e.filter(L);}}function R(i,K){if(i===j&&l(K)){A();}}function u(i){var K=i();return l(K);}function w(){f.forEach(u);}function x(i){h=i;j++;n=R.bind(null,j);k=[new F({path:"target",operator:b.StartsWith,value1:h}),E];w();A();}function y(i){f.push(i);if(h!==undefined&&u(i)){A();}}var S;function z(){if(m){m.showMessagePopover();return;}if(s){S=S||d.openBy.bind(d,o);setTimeout(S,0);}}function D(){m=null;if(s){for(var i=0;i<s.length;i++){s[i].free();}s=null;k=null;e.filter(I);}}function P(i,K){if(s){s[i].filters=K;if(k){A();}}}function G(K){s=[];for(var i=0;i<K.length;i++){var L={showMessagePopover:z,propagateFilters:P.bind(null,i)};var N=K[i].serve(L);s.push(N);}if(k){A();}}function H(){m=null;}function J(i){m=i;e.filter(I);return{filters:k?r():[],free:H};}return{adaptToContext:x,toggleMessagePopover:d.toggle.bind(d,o),showMessagePopover:z,registerMessageFilterProvider:y,suspend:D,resume:G,serve:J};}return B.extend("sap.suite.ui.generic.template.lib.MessageButtonHelper",{constructor:function(c,C){q.extend(this,(t.testableStatic(g,"MessageButtonHelper"))(c,C));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ViewDependencyHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ViewDependencyHelper');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ViewDependencyHelper",["sap/ui/base/Object","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/lib/testableHelper"],function(B,A,t){"use strict";function g(T){function s(E){E=E||[];for(var i in T.componentRegistry){if(E.indexOf(i)===-1){var C=T.componentRegistry[i];C.oComponent.setIsRefreshRequired(true);}}}function a(C,n,N){var S,p,P,r,m=T.componentRegistry;var M=C.getId();S=C.getComponentContainer().getSettings();var R=S&&S.routeConfig;if(R){if(R.viewLevel===0){return false;}else{for(var f in m){if(f!==M){p=m[f].oComponent.getComponentContainer().getSettings();if(p&&p.routeConfig&&p.routeConfig.viewLevel===(R.viewLevel-1)&&(R.viewLevel===1||p.routeConfig.entitySet===R.parentEntitySet)){P=m[f].oComponent;if(n){r=m[f].oGenericData.mRefreshInfos;r[n]=true;}else{if(typeof P.setIsRefreshRequired==="function"){P.setIsRefreshRequired(true);}}break;}}}}}}function b(C,n){if(n){var r=T.componentRegistry[C.getId()].oGenericData.mRefreshInfos;r[n]=true;}else{if(typeof C.setIsRefreshRequired==="function"){C.setIsRefreshRequired(true);}}}function c(C){var f=[];var S=C.getComponentContainer().getSettings();for(var o in T.componentRegistry){var O=T.componentRegistry[o];var h=O.oComponent.getComponentContainer().getSettings();if(S.routeConfig.viewLevel+1===h.routeConfig.viewLevel&&S.routeConfig.entitySet===h.routeConfig.parentEntitySet){f.push(O.oComponent);}}return f;}function d(C){var S=[];var f=c(C);for(var i=0;i<f.length;i++){S=S.concat(d(f[i]));}return S.concat(f);}function u(C,f){var S=d(C);for(var i=0;i<S.length;i++){T.componentRegistry[S[i].getId()].oComponent.getComponentContainer().unbindElement();}if(f){C.getComponentContainer().unbindElement();}}function e(){if(T.rootContainer){var i=T.rootContainer.getComponentInstance();if(i&&typeof i.setIsRefreshRequired==="function"){i.setIsRefreshRequired(true);}}}var a=t.testable(a,"setParentToDirty");return{setAllPagesDirty:s,setParentToDirty:a,setMeToDirty:b,unbindChildren:u,setRootPageToDirty:e};}return B.extend("sap.suite.ui.generic.template.lib.ViewDependencyHelper",{constructor:function(T){jQuery.extend(this,g(T));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.routingHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.routingHelper');jQuery.sap.require('sap.f.FlexibleColumnLayout');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.m.routing.Targets');sap.ui.define("sap/suite/ui/generic/template/lib/routingHelper",["sap/f/FlexibleColumnLayout","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/generic/app/util/ModelUtil","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/FlexibleColumnLayoutHandler","sap/suite/ui/generic/template/lib/testableHelper","sap/m/routing/Targets"],function(F,a,b,M,C,c,t,T){"use strict";function d(i,j,V,w,x){var y={};y={viewName:V,controlId:j,controlAggregation:x};var z=i.getTargets();z.addTarget(w,y);}function e(N,i){if(N.oTemplateContract.oFlexibleColumnLayoutHandler){N.oTemplateContract.oFlexibleColumnLayoutHandler.createMessagePageTargets(d.bind(null,N.oRouter,i,"sap.suite.ui.generic.template.fragments.MessagePage"));}else{d(N.oRouter,i,"sap.suite.ui.generic.template.fragments.MessagePage","messagePage","pages");}}function g(N){var i=N.oTemplateContract.oNavigationHost.getId();var j=N.oAppComponent.getConfig(),w,x;if(!j.pages||!j.pages.length){throw new Error("Route Configuration missing");}if(j.pages.length>1){throw new Error("Currently only one Top route supported");}w=j.pages[0];N.oTemplateContract.mEntityTree={};x=l([],w,"root",0,null,N,i);N.oRouter.addRoute(x);k(x,N);f(x.target,w,0,null,N,i);e(N,i);return w.entitySet;}function f(j,w,L,x,N,y,z){var i,A;if(w.pages){A=w.pages.length;for(i=0;i<A;i++){h(j,w.pages[i],(L+1),x,N,y,z);}}}function h(i,j,L,w,N,x,y){if(j.component){var z={parent:w&&w.entitySet,navigationProperty:j.navigationProperty,level:L,children:[]};var A=l(i,j,j.component.list?"aggregation":"detail",L,w,N,x);z.sRouteName=A.name;z.entitySet=A.entitySet;if(y){y.push(A.entitySet);}var E=N.oTemplateContract.mEntityTree[A.entitySet];if(!E||E.level>z.level){N.oTemplateContract.mEntityTree[A.entitySet]=z;}N.oRouter.addRoute(A);k(A,N);f(A.target,j,L,A,N,x,z.children);}}function k(i,N){var Q=jQuery.extend({},i);Q.name=i.name+"query";Q.pattern=i.pattern+"{?query}";N.oRouter.addRoute(Q);}function l(i,j,O,L,w,N,x){var y=jQuery.isArray(i)?i:[i];var z,A;z=j.navigationProperty||j.entitySet;A=jQuery.extend({},j);A.path="/"+j.entitySet;A.operation=O;A.viewLevel=L;A.template=j.component?(j.component.name||j.component):j.template;switch(O){case"root":A.name="root";A.pattern="";break;case"aggregation":A.name=z+"~aggregation";A.pattern=z;break;default:A.name=z;A.pattern=z+"({keys"+L+"})";break;}if(w){A.name=w.name+"/"+A.name;A.pattern=w.pattern+"/"+A.pattern;A.parentEntitySet=w.entitySet;}if(A.viewLevel===1){N.oTemplateContract.routeViewLevel1={pattern:A.pattern,name:A.name};}var B;var E=A.name;if(N.oTemplateContract.oFlexibleColumnLayoutHandler){B=N.oTemplateContract.oFlexibleColumnLayoutHandler.adaptRoutingInfo(A,E,y);}else{B="pages";A.target=E;}d(N.oRouter,x,A.name,E,B);var G=new Promise(function(H){N.mRouteToComponentResolve[A.name]=H;});N.oTemplateContract.mRouteToTemplateComponentPromise[A.name]=G;return A;}function I(N,S){var H;if(!N.oHashChanger.getHash()){H="";if(S&&S.route&&S.route.length===1){H=S.route[0];N.navigate(H,true);}}N.oRouter.initialize();N.fnInitializationResolve();}function r(N,E,K,S,j){var i,L,w,V,x=[];if(K&&S&&j){L=K.length;for(i=0;i<L;i++){w=K[i].PropertyPath;V=S[w][0];x.push(new a(w,b.EQ,V));}if(N.oAppComponent.getTransactionController().getDraftController().getDraftContext().isDraftEnabled(E)){var y=new a({filters:[new a("IsActiveEntity","EQ",false),new a("SiblingEntity/IsActiveEntity","EQ",null)],and:false});x.push(y);}var z=new a(x,true);j.read("/"+E,{filters:[z],success:function(A){var B=R(A,j,S);if(B){var G=j.getKey(B);if(G){N.navigate(G,true);}}I(N,S);},error:function(A){I(N,S);}});}}function R(w,x,S){var y,i,L,z;if(w&&w.results){L=w.results.length;if(L==0){z=null;}else if(L==1){z=w.results[0];}else if(L>=1){var A=[];var B=[];for(i=0;i<L;i++){y=w.results[i];if(y&&y.IsActiveEntity){B.push(y);}else if(y&&y.IsActiveEntity==false){A.push(y);}}if(B.length==0&&A.length>=2){var E;for(var j=0;j<A.length;j++){E=A[j];if(E.DraftUUID==S.DraftUUID){z=E;break;}}if(!z){z=A[0];}}else if(B.length==1&&A.length==1){z=B[0];}else if(B.length==1&&A.length>=2){z=B[0];}}}return z;}function m(i,j){if((i&&j)||(j==="display")){return{mode:"unsupported"};}var w={mode:"display",force:"false"};w.mode=j||i||w.mode;w.force=!!j;return w;}function D(j,N,E,S,w){var x=o(j,N,E,S,w);var H;if(x.bNavigationWithSemanticKeyPossible){r(N,E,x.aSemanticKey,S,j);return;}else if(x.bNavigationWithTechnicalKeyPossible){if(S.IsActiveEntity&&S.IsActiveEntity[0]==="false"&&S.DraftUUID&&S.DraftUUID[0]!==""){var K=[];for(var i=0;i<x.aTechnicalKey.length;i++){var y=x.aTechnicalKey[i]&&x.aTechnicalKey[i].name;if(y==="DraftUUID"||y==="IsActiveEntity"){continue;}if(S.hasOwnProperty(y)){K.push({PropertyPath:y});}}r(N,E,K,S,j);return;}H=j.createKey(E,S);if(H){N.navigate(H,true);}}I(N,S);}function n(K,j){var i,L,S=false,w,x;if(j&&K){L=K.length;for(i=0;i<L;i++){S=true;w=K[i];x=w.name||w.PropertyPath;if(!j[x]||j[x].length>1){S=false;break;}}}return S;}function o(i,N,E,S,j){var w={};if(!N.oRouter.getRoute(E)){return{};}if(N.oAppComponent.getManifestEntry("sap.ui.generic.app").pages[0].pages[0].navigation&&N.oAppComponent.getManifestEntry("sap.ui.generic.app").pages[0].pages[0].navigation[j.mode]){return{};}var x=i.getMetaModel().getODataEntitySet(E);if(!x){return{};}var y=i.getMetaModel().getODataEntityType(x.entityType);var z=y["com.sap.vocabularies.Common.v1.SemanticKey"];if(z){w={bNavigationWithSemanticKeyPossible:n(z,S),aSemanticKey:z};}if(y.key.propertyRef){w.bNavigationWithTechnicalKeyPossible=n(y.key.propertyRef,S);w.aTechnicalKey=y.key.propertyRef;}return w;}function p(N){var G=N.oAppComponent.getModel("_templPrivGlobal");G.setProperty("/generic/forceFullscreenCreate",true);}function P(N,E,S){var j;j=N.oAppComponent.getModel();j.attachMetadataFailed(N.fnInitializationResolve);j.getMetaModel().loaded().then(function(){var w;var x=S.preferredMode&&S.preferredMode[0];var y=S.mode&&S.mode[0];var z=m(x,y);if(S.DraftUUID){var A=S.DraftUUID[0];if(A&&A.indexOf("guid")!==-1){A=A.replace("guid","");A=A.replace("'","");A=A.replace("'","");S.DraftUUID[0]=A;}}switch(z.mode){case"create":p(N);var B=C.create(N.oAppComponent.getTransactionController().getDraftController(),E,"/"+E,j,N.oTemplateContract.oApplicationProxy.setEditableNDC);B.then(function(O){N.navigateToContext(O,"",true,4).then(I.bind(null,N,S));},function(O){I(N,S);N.navigateToMessagePage({title:N.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),text:O.messageText,description:"",icon:"sap-icon://message-error",replaceURL:true});});N.oTemplateContract.oBusyHelper.setBusy(B,true);break;case"createWithContext":p(N);w=j.getMetaModel().getODataEntitySet(E);var G=w["com.sap.vocabularies.Common.v1.DraftRoot"];if(G&&G.NewAction){var H=j.getMetaModel().getODataFunctionImport(G.NewAction.String.split("/")[1]);var U={};if(H&&H.parameter){for(var i=0;i<H.parameter.length;i++){if(H.parameter[i].mode==="In"&&S[H.parameter[i].name][0]){U[H.parameter[i].name]=S[H.parameter[i].name][0];}}sap.ui.core.BusyIndicator.show();j.callFunction("/"+H.name,{success:function(O,Q){I(N,S);sap.ui.core.BusyIndicator.hide();var V=new M(j);var W=V.getContextFromResponse(O);if(W){N.navigateToContext(W,null,true,4).then(I.bind(null,N,S));}else{I(N,S);N.navigateToMessagePage({title:N.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),replaceURL:true});}},error:function(O){sap.ui.core.BusyIndicator.hide();N.navigateToMessagePage({title:N.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),replaceURL:true});},method:"POST",urlParameters:U});}else{N.navigateToMessagePage({title:N.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),replaceURL:true});}}break;case"edit":var J=o(j,N,E,S,z);if(J.bNavigationWithTechnicalKeyPossible||J.bNavigationWithSemanticKeyPossible){var K="";var L;if(J.bNavigationWithTechnicalKeyPossible){K=j.createKey(E,S);L=C.edit(N.oAppComponent.getTransactionController(),E,"/"+K,j,N.oTemplateContract,N.fnInitializationResolve);}else if(J.bNavigationWithSemanticKeyPossible){K="";L=C.edit(N.oAppComponent.getTransactionController(),E,K,j,N.oTemplateContract,N.fnInitializationResolve,J.aSemanticKey,S);}L.then(function(O){N.navigate(O.context.getPath(),true);I(N);},function(O){if(O.lockedByUser){if(!z.force){D(j,N,E,S,z);}else{N.fnInitializationResolve();N.navigateToMessagePage({title:N.oTemplateContract.getText("LOCKED_OBJECT_POPOVER_TITLE"),text:N.oTemplateContract.getText("LOCKED_OBJECT_POPOVER_TITLE"),description:N.oTemplateContract.getText("ST_GENERIC_LOCKED_OBJECT_POPOVER_TEXT",[O.lockedByUser]),icon:"sap-icon://message-error",replaceURL:true});}}else if(O.draftAdminReadResponse){I(N,S);}});}else{I(N,S);}break;case"display":D(j,N,E,S,z);break;default:N.fnInitializationResolve();N.navigateToMessagePage({title:N.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),text:N.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),description:N.oTemplateContract.getText("PARAMETER_COMBINATION_NOT_SUPPORTED",[y,x]),icon:"sap-icon://message-error",replaceURL:true});}});}function s(N){var i=N.oAppComponent.getManifestEntry("sap.ui.generic.app");if(i.settings&&i.settings.flexibleColumnLayout){N.oTemplateContract.oFlexibleColumnLayoutHandler=new c(N.oTemplateContract.oNavigationHost,N);}var E=g(N);var j=N.oAppComponent.getComponentData();var S=j&&j.startupParameters;if(E&&S&&!N.oHashChanger.getHash()){P(N,E,S);}else{I(N);}}function q(i){var j,w,x;if(i){j=i.pattern;w=i.navigationProperty||i.entitySet;if(j&&w){x=j.indexOf("{?query}");if(x>0){j=j.substring(0,x);}x=-1;w+="({keys";x=j.indexOf(w);if(x>0){j=j.substring(x);}if(i.navigationProperty){j=j.replace(i.navigationProperty,i.entitySet);}j="/"+j;}}return j;}function u(i,E,j){var w,K,x;if(i.operation==="root"){return null;}if(i.operation==="aggregation"){w=i.pattern;}else{if(j){w=j;}else{w=q(i);}}if(w.indexOf("/")!==0){w="/"+w;}K=E.getParameter("arguments");if(K){for(x in K){if(x!=="?query"){w=w.replace("{"+x+"}",K[x]);}}return w;}}function v(i,N){var j,w,E;j=i.getPath().substring(1);w=j.split("(");if(w[0]){E=w[0];}if(N){j=j.replace(E,N);if(j.indexOf("/")===0){j=j.substring(1);}}return{entitySet:E,path:j};}var g=t.testableStatic(g,"routingHelpergenerateRoutingMetadataAndGetRootEntitySet");var I=t.testableStatic(I,"routingHelper_initialiseRouting");var r=t.testableStatic(r,"routingHelper_readObject");var P=t.testableStatic(P,"routingHelper_processStartupParameters");return{startupRouter:s,determinePath:u,determineNavigationPath:v,readObjectProcessResults:R};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.KpiTag')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.KpiTag');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.NumericContent');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/KpiTag",["sap/ui/core/Control","sap/m/Label","sap/m/NumericContent","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiTagController","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationHelper"],function(C,L,N,J,K,a,b){"use strict";var c={toleranceLow:null,toleranceHigh:null,deviationLow:null,deviationHigh:null,_value:null,state:sap.m.ValueColor.Neutral,setVals:function(t,T,d,D,v){this.toleranceLow=t;this.toleranceHigh=T;this.deviationLow=d;this.deviationHigh=D;this._value=v;this.state=sap.m.ValueColor.Neutral;},Maximize:function(){if(this.toleranceLow||this.deviationLow){if(this._value>=this.toleranceLow){this.state=sap.m.ValueColor.Good;}else if(this._value<this.deviationLow){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;},Maximizing:function(){this.Maximize();},Minimize:function(){if(this.toleranceHigh||this.deviationHigh){if(this._value<=this.toleranceHigh){this.state=sap.m.ValueColor.Good;}else if(this._value>this.deviationHigh){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;},Minimizing:function(){this.Minimize();},Target:function(){if(this.toleranceLow&&this.toleranceHigh){if(this._value>=this.toleranceLow&&this._value<=this.toleranceHigh){this.state=sap.m.ValueColor.Good;}else if(this._value<this.deviationLow||this._value>this.deviationHigh){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;}};var o={Critical:sap.m.ValueColor.Critical,Negative:sap.m.ValueColor.Error,Positive:sap.m.ValueColor.Good};return C.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.KpiTag",{metadata:{properties:{value:{type:"string",defaultValue:"",bindable:true},name:{type:"string",defaultValue:"",bindable:true},scale:{type:"string",defaultValue:undefined,bindable:true},indicator:{type:"sap.m.ValueColor",defaultValue:"Neutral"},entitySet:{type:"string",defaultValue:"",bindable:false},qualifier:{type:"string",defaultValue:"",bindable:false},modelName:{type:"string",defaultValue:undefined,bindable:false},deviationRangeLowValue:{type:"string",defaultValue:undefined,bindable:true},deviationRangeHighValue:{type:"string",defaultValue:undefined,bindable:true},toleranceRangeHighValue:{type:"string",defaultValue:undefined,bindable:true},toleranceRangeLowValue:{type:"string",defaultValue:undefined,bindable:true}},aggregations:{_name:{type:"sap.m.Label",multiple:false,visibility:"visible"},_value:{type:"sap.m.Label",multiple:false,visibility:"visible"},_content:{type:"sap.m.NumericContent",multiple:false,visibility:"visible"}},events:{press:{}}},_firstTime:true,_dataModel:undefined,_controller:undefined,_isRelative:false,_isPercent:false,_sUnitofMeasure:"",_relativeToProperties:[],_getDataModel:function(){if(!this._dataModel){this._dataModel=new J();}return this._dataModel;},_getController:function(){if(!this._controller){this._controller=new K();}return this._controller;},onBeforeRendering:function(){if(this._firstTime){this.setBusy(true);this._firstTime=false;var m=this.getModel(this.getModelName());m.getMetaModel().loaded().then(function(){var M=m.getMetaModel();var e=M.getODataEntitySet(this.getEntitySet());var E=M.getODataEntityType(e.entityType);var s="com.sap.vocabularies.UI.v1.SelectionPresentationVariant#"+this.getQualifier();var S=E[s];if(!S){return;}var d=S.SelectionVariant&&(S.SelectionVariant.AnnotationPath||S.SelectionVariant.Path);if(!d){return;}if(/^@/.test(d)){d=d.slice(1);}var f=E[d];var F=[];var g=f&&f.SelectOptions;var h,p,r;if(g){for(var i=0;i<g.length;i++){h=g[i];p=h.PropertyName.PropertyPath;for(var j=0;j<h[p].length;j++){r=h[p][j];if(r.Sign.EnumMember==="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"){var k={path:p,operator:r.Option.EnumMember.split("/")[1],value1:r.Low.String,value2:r.High?r.High.String:""};F.push(new sap.ui.model.Filter(k));}}}}var P=S.PresentationVariant&&(S.PresentationVariant.AnnotationPath||S.PresentationVariant.Path);if(!P){return;}if(/^@/.test(P)){P=P.slice(1);}var l="com.sap.vocabularies.UI.v1.DataPoint#"+this.getQualifier();var D=E[l];this.dataPointAnnotation=D;var n=M.getODataProperty(E,D.Value.Path);this._checkForPercent(m,n);this._getCriticalityRefProperties(D);this.setModel(this._getDataModel());var q=b.resolveParameterizedEntitySet(m,e,f);if(D.Value){if(D.Value.Path){this.bindValue("/0/"+D.Value.Path);}else{this.setProperty("value",D.Value.String);}}if(D.CriticalityCalculation.ToleranceRangeLowValue){if(D.CriticalityCalculation.ToleranceRangeLowValue.Path){this.bindProperty("toleranceRangeLowValue","/0/"+String(D.CriticalityCalculation.ToleranceRangeLowValue.Path));}else{this.setProperty("toleranceRangeLowValue",String(D.CriticalityCalculation.ToleranceRangeLowValue.Int));}}if(D.CriticalityCalculation.ToleranceRangeHighValue){if(D.CriticalityCalculation.ToleranceRangeHighValue.Path){this.bindProperty("toleranceRangeHighValue","/0/"+String(D.CriticalityCalculation.ToleranceRangeHighValue.Path));}else{this.setProperty("toleranceRangeHighValue",String(D.CriticalityCalculation.ToleranceRangeHighValue.Int));}}if(D.CriticalityCalculation.DeviationRangeLowValue){if(D.CriticalityCalculation.DeviationRangeLowValue.Path){this.bindProperty("deviationRangeLowValue","/0/"+String(D.CriticalityCalculation.DeviationRangeLowValue.Path));}else{this.setProperty("deviationRangeLowValue",String(D.CriticalityCalculation.DeviationRangeLowValue.Int));}}if(D.CriticalityCalculation.DeviationRangeHighValue){if(D.CriticalityCalculation.DeviationRangeHighValue.Path){this.bindProperty("deviationRangeHighValue","/0/"+String(D.CriticalityCalculation.DeviationRangeHighValue.Path));}else{this.setProperty("deviationRangeHighValue",String(D.CriticalityCalculation.DeviationRangeHighValue.Int));}}m.read(q,{async:true,filters:F,urlParameters:{"$select":[D.Value.Path].concat(this._relativeToProperties).join(","),"$top":1},success:function(t,u){this._getDataModel().setData(t.results);this._calculateKPICriticality(this.dataPointAnnotation);this._setNameInformation(this.dataPointAnnotation);this._setScaleInformation(this.dataPointAnnotation);this.setBusy(false);}.bind(this),error:function(t){jQuery.sap.log.error("Error reading URL:"+t);}});}.bind(this));}},init:function(){if(C.prototype.init){C.prototype.init.call(this);}},_onMouseClick:function(e){K.openKpiCard(e);},_checkForPercent:function(m,e){this._sUnitofMeasure=a.getUnitofMeasure(m,e);if(this._sUnitofMeasure=="%")this._isPercent=true;},_checkIfRelative:function(d){var t=d.TrendCalculation;this._isRelative=a.isRelative(d);if(this._isRelative){if(t.ReferenceValue.Path){this._relativeToProperties.push(t.ReferenceValue.Path);}}},_setNameInformation:function(d){var t=d.Title;var n=a.getPathOrPrimitiveValue(t);if(n===undefined){n="";}this.setProperty("name",this._getNameFromHeuristic(n),false);this.setTooltip(n);},_setScaleInformation:function(d){if(d.ValueFormat){if(d.ValueFormat.ScaleFactor){this.setProperty("scale",a.getPathOrPrimitiveValue(d.ValueFormat.ScaleFactor));}}},_getCriticalityRefProperties:function(d){var e=d.CriticalityCalculation;var f=d.Criticality;if(e.DeviationRangeLowValue&&e.DeviationRangeLowValue.Path){this._relativeToProperties.push(e.DeviationRangeLowValue.Path);}if(e.DeviationRangeHighValue&&e.DeviationRangeHighValue.Path){this._relativeToProperties.push(e.DeviationRangeHighValue.Path);}if(e.ToleranceRangeLowValue&&e.ToleranceRangeLowValue.Path){this._relativeToProperties.push(e.ToleranceRangeLowValue.Path);}if(e.ToleranceRangeHighValue&&e.ToleranceRangeHighValue.Path){this._relativeToProperties.push(e.ToleranceRangeHighValue.Path);}if(f&&f.Path){this._relativeToProperties.push(f.Path);}},_getTitleRefProperty:function(d){var t=d.Title;if(t&&t.Path){this._relativeToProperties.push(t.Path);}},_getNameFromHeuristic:function(s){var p=s.split(/\s/);return p.length===1?this._getNameFromSingleWordHeuristic(s):this._getNameFromMultiWordHeuristic(p);},_getNameFromSingleWordHeuristic:function(w){return w.substr(0,3).toUpperCase();},_getNameFromMultiWordHeuristic:function(w){var p=[];p.push(w[0].charAt(0));p.push(w[1].charAt(0));if(w.length>=3){p.push(w[2].charAt(0));}return p.join("").toUpperCase();},_calculateKPICriticality:function(d){var i=d.CriticalityCalculation&&d.CriticalityCalculation.ImprovementDirection?a.getPathOrPrimitiveValue(d.CriticalityCalculation.ImprovementDirection):undefined;var e=d.Criticality?a.getPathOrPrimitiveValue(d.Criticality):undefined;var s=sap.m.ValueColor.Neutral;if(e){s=o[e];if(!s){s=sap.m.ValueColor.Neutral;}this.setIndicator(s);return;}var f=Number(this.getDeviationRangeLowValue());var t=Number(this.getToleranceRangeLowValue());var g=Number(this.getDeviationRangeHighValue());var h=Number(this.getDeviationRangeHighValue());if(isNaN(f)){f=d.CriticalityCalculation.DeviationRangeLowValue?a.getPrimitiveValue(d.CriticalityCalculation.DeviationRangeLowValue):undefined;}if(isNaN(h)){h=d.CriticalityCalculation.DeviationRangeHighValue?a.getPrimitiveValue(d.CriticalityCalculation.DeviationRangeHighValue):undefined;}if(isNaN(t)){t=d.CriticalityCalculation.ToleranceRangeLowValue?a.getPrimitiveValue(d.CriticalityCalculation.ToleranceRangeLowValue):undefined;}if(isNaN(g)){g=d.CriticalityCalculation.ToleranceRangeHighValue?a.getPrimitiveValue(d.CriticalityCalculation.ToleranceRangeHighValue):undefined;}var v=Number(this.getValue());c.setVals(t,g,f,h,v);this.setIndicator(c[i]());},renderer:function(r,d){r.write("<div");r.writeControlData(d);r.addClass("alrKpiTag sapUiSmallMarginEnd");d._addColorClasses(r);r.writeClasses();r.writeAttributeEscaped("title",d.getTooltip());r.write(">");r.write("<div");r.addClass("alrKpiTagName");r.writeClasses();r.write(">");r.writeEscaped(d.getName());r.write("</div>");r.write("<div");r.addClass("alrKpiTagValue");r.writeClasses();r.write(">");r.writeEscaped(d._isPercent?a.formatNumberForPresentation(d.getValue(),true,1,d.getProperty("scale"))+d._sUnitofMeasure:a.formatNumberForPresentation(d.getValue(),true,0,d.getProperty("scale")));r.write("</div>");r.write("</div>");},_addColorClasses:function(r){switch(this.getIndicator()){case sap.m.ValueColor.Neutral:r.addClass("alrKPINeutral");break;case sap.m.ValueColor.Error:r.addClass("alrKPINegative");break;case sap.m.ValueColor.Good:r.addClass("alrKPIPositive");break;case sap.m.ValueColor.Critical:r.addClass("alrKPICritical");break;default:break;}},onAfterRendering:function(){setTimeout(function(){this.detachBrowserEvent("click",this._onMouseClick).attachBrowserEvent("click",this._onMouseClick);}.bind(this),1);},handleClick:function(e){this.fireEvent("press",{});},exit:function(){this._relativeToProperties=[];}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.VisualFilterProvider')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.VisualFilterProvider');jQuery.sap.require('sap.ui.comp.odata.MetadataAnalyser');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/VisualFilterProvider",["sap/ui/comp/odata/MetadataAnalyser","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(M,F,V){"use strict";var c=function(f){this._filter=f;this._oMetadataAnalyser=new M(f.getModel());this._groupList=[];this._groupListByName={};this._groupMap={};this._measureList=[];this._measureMap={};this._dimensionMap={};this._selectionFieldsLength=0;this._selectionFieldsParsed=0;this._annotationData={Filters:[]};this._allSelectionFields;this._initMetadata();};c.prototype._initMetadata=function(){var e=this._filter.getEntitySet();var a=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e);this._getFieldAnnotations(e,a);this._getVisualFilterAnnotation(a);};c.prototype.getVisualFilterConfig=function(){return this._filterConfig;};c.prototype._getFieldAnnotations=function(e,a){if(!e)return;var b=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e);if(!b)return;var m=this._filter.getModel();var d=m.getMetaModel();if(!a||!d)return;var g={};var f={};var h=this._oMetadataAnalyser.getFieldGroupAnnotation(b);for(var i=0;i<h.length;i++){var k=h[i];var l={name:k.groupName,label:k.groupLabel,fieldList:k.fields};f[l.name]=l;for(var j=0;j<k.fields.length;j++)g[k.fields[j]]=l;}var n=d.getODataEntityType(a);var s=n[V.SelectionFields];var o={};if(s){for(var i=0;i<s.length;i++){var p=s[i];o[p.PropertyPath]=p;}}var u={};var q=this._oMetadataAnalyser.getFieldsByEntityTypeName(b);for(var i=0;i<q.length;i++){var r=q[i];var t=r.name;var v=d.getODataProperty(n,t);var w=v["sap:aggregation-role"];if(w=="dimension"){var x={name:t,fieldInfo:r,propInfo:v};var l=g[t];if(l){for(var j=0;j<l.fieldList.length;j++){if(l.fieldList[j]==t){l.fieldList[j]=x;break;}}}else{var L=n[V.Label]?n[V.Label].String:undefined;var y=o[t]?"_BASIC":(n[L]||n.name);var l=f[y];if(!l){l={name:y,label:y=="_BASIC"?this._filter.getModel("i18n").getResourceBundle().getText("VIS_FILTER_GRP_BASIC_TITLE"):y,fieldList:[]};f[y]=l;}l.fieldList.push(x);g[t]=l;}u[l.name]=true;}}var z=[];if(u["_BASIC"]){z.push(f["_BASIC"]);delete f["_BASIC"];}for(var i=0;i<h.length;i++){var y=h[i].groupName;if(y=="_BASIC")continue;if(u[y])z.push(f[y]);delete f[y];}for(var y in f){if(u[y])z.push(f[y]);delete f[y];}f={};for(var i=0;i<z.length;i++){var l=z[i];f[l.name]=l;}};c.prototype.getGroupList=function(){return this._groupList?this._groupList:[];};c.prototype.getGroupMap=function(){return this._groupMap?this._groupMap:{};};c.prototype.getMeasureMap=function(){return this._measureMap;};c.prototype.getDimensionMap=function(){return this._dimensionMap;};c.prototype.getEntityType=function(e){return this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e);};c.prototype._updateGroupList=function(e,a,p,d){var i=function(g){return g.PropertyPath===p;};var b=this._allSelectionFields.filter(i);b=(b.length>0)?true:false;var m=this._filter.getModel().getMetaModel();var f=m.getODataEntityType(e);f=f[V.Label]?f[V.Label].String:f.name;var u=function(g,h){for(var k in h._groupList){var j=h._groupList[k],l=false;if(j.name===g){var n=j.fieldList;for(var o in n){if(n[o].name===d){l=true;}else{continue;}}if(!l){var q=m.getODataEntityType(a);var r=h._oMetadataAnalyser.getFieldsByEntityTypeName(a);for(var k in r){if(r[k].name===d){var s=m.getODataProperty(q,r[k].name);n.push({name:r[k].name,fieldInfo:r[k],propInfo:s});}}}}else{continue;}}};if(b){u('_BASIC',this);}else{u(f,this);}};c.prototype._createDimensionMap=function(e,a){var b,m=this._filter.getModel(),d=m.getMetaModel(),f,g={},p,h,i,j={};if(!d)return false;f=d.getODataEntityType(a);b=this._oMetadataAnalyser.getFieldsByEntityTypeName(a);for(var k in b){p=d.getODataProperty(f,b[k].name);if(b[k]['aggregationRole']==='dimension'){h={name:b[k].name,fieldInfo:b[k],propInfo:p};g[b[k].name]=h;}else if(b[k]['aggregationRole']==='measure'){i={name:b[k].name,label:b[k].fieldLabel,fieldInfo:b[k],propInfo:p};j[b[k].name]=i;}}if(Object.keys(g).length>0){this._dimensionMap[e]=g;}if(Object.keys(j).length>0){this._measureMap[e]=j;}};c.prototype._createGroupList=function(f,p,i,g){var a;if(i){a=this._filter.getModel("i18n").getResourceBundle().getText("VIS_FILTER_GRP_BASIC_TITLE");this._addToGroupListByName('_BASIC',a,f,p);}else{a=f.groupTitle;this._addToGroupListByName(g,a,f,p);}};c.prototype._addToGroupListByName=function(g,a,f,p){if(this._groupListByName[g]===undefined){this._groupListByName[g]=[];this._groupListByName[g].push({name:g,label:a,fieldList:[]});this._groupListByName[g][0].fieldList.push({name:f.name,fieldInfo:f,propInfo:p});}else{this._groupListByName[g][0].fieldList.push({name:f.name,fieldInfo:f,propInfo:p});}};c.prototype._setGroupListForDialog=function(){if(Object.keys(this._groupListByName).length>0){for(var k in this._groupListByName){this._groupList.push(this._groupListByName[k][0]);}}var g={};for(var i=0;i<this._groupList.length;i++){var a=this._groupList[i];g[a.name]=a;}this._groupMap=g;};c.prototype._sortVisualFilter=function(d,e){if(e.filterList){e.filterList.sort(function(a,b){var I,f;if(d){for(var i=0;i<d.length;i++){if(d[i].PropertyPath===a.parentProperty){I=i;}if(d[i].PropertyPath===b.parentProperty){f=i;}if(I&&f){break;}}}if((I<f)||(!I&&a.isMandatory)){return-1;}if((I>f)||(!f&&b.isMandatory)){return 1;}return 0;});}return e;};c.prototype._getScaleFactor=function(e,a){if(a.indexOf("com.sap.vocabularies.UI.v1.DataPoint")>-1){a=a.toString();if(a.charAt(0)==="@"){a=a.slice(1);}var E=e[a];if(E&&E.ValueFormat&&E.ValueFormat.ScaleFactor){return F.getPathOrPrimitiveValue(E.ValueFormat.ScaleFactor);}else{return"";}}};c.prototype._getVisualFilterAnnotation=function(e){var m=this._filter.getModel();var a=m.getMetaModel();if(!e||!a)return null;var b=a.getODataEntityType(e);if(!b)return null;this._allSelectionFields=b[V.SelectionFields];var d=this._filter._smartFilterContext.getFilterBarViewMetadata(),i,f,g,G,h,v,j,k,l=[],n,p;for(var o in d){l=d[o].fields;G=d[o].groupName;for(var P in l){i=l[P].filterable;f=l[P].filterRestriction;if(f==="auto"){f="multiple";}if(f!=="interval"&&i!=="false"){n=l[P];j=l[P].fieldName;g=l[P].isMandatory;h=l[P].requiredFilterField;for(var q in l[P]){if(q.indexOf(V.ValueList)>-1&&l[P][q].PresentationVariantQualifier){k=(G==="_BASIC")||g||h;p=a.getODataProperty(b,j);v=l[P][q];this._createGroupList(n,p,k,G);this._getAnnotationFromValueList(e,k,v,j,f,g,b);}}}}}this._setGroupListForDialog();this._filterConfig=this._getConfig(this._annotationData);};c.prototype._getAnnotationFromValueList=function(e,i,v,p,f,I,a){var P=e;if(v!==undefined){var b={Filters:[]},d=F.readProperty(v,"PresentationVariantQualifier.String"),g=F.readProperty(v,"CollectionPath"),h=F.readProperty(v,"Parameters"),j=F.readProperty(g,"String"),P=this.getEntityType(j),m=this._filter.getModel(),k=m.getMetaModel(),l=k.getODataEntityType(P);if(d){var q=d,n=this._oMetadataAnalyser.getPresentationVariantAnnotation(P,q),o={},r=F.readProperty(n,"chartAnnotation.annotation.Dimensions.0.PropertyPath");if(r){this._createDimensionMap(g.String,P);this._updateGroupList(e,P,p,r);o=this._createConsumeableObjectFromAnnotation(n,g,i,h,p,f,I,l);b.Filters.push(o);this._annotationData.Filters.push(o);}}}};c.prototype._getDescendingFromSortOrder=function(s,S){var b;s.filter(function(e,i,a){if(e.Property.PropertyPath==S){b=!(e.Descending.Bool==="false");}});return b;};c.prototype._fieldExist=function(e,f){var a=this._oMetadataAnalyser.getFieldsByEntityTypeName(e);for(var i=0;i<a.length;i++){if(a[i].name===f){return true;}}return false;};c.prototype._createSortObject=function(p){var s,S={};if(p.chartAnnotation.chartType==="com.sap.vocabularies.UI.v1.ChartType/Line"){s=p.chartAnnotation.annotation.Dimensions[0].PropertyPath;}else{s=p.chartAnnotation.annotation.Measures[0].PropertyPath;}S.Field={"String":s};S.Descending={"Boolean":true};return S;};c.prototype._createSortOrderFromAnnotation=function(p,e){var a={};a.SortOrder=[];var s=p.annotation.SortOrder;if(s!==undefined&&s.length>0){for(var i=0;i<s.length;i++){var S=s[i].Property.PropertyPath;if(S){var o={};if(this._fieldExist(e,S)){o.Field={"String":S};o.Descending={"Boolean":this._getDescendingFromSortOrder(s,S)};}else{o=this._createSortObject(p);}a.SortOrder.push(o);}}}else{a.SortOrder.push(this._createSortObject(p));}return a;};c.prototype._createConsumeableObjectFromAnnotation=function(p,a,i,b,d,f,I,e){var g={};var s=p.sortOrderFields;g=this._createSortOrderFromAnnotation(p,this.getEntityType(a.String));var h=p.chartAnnotation.annotation.ChartType.EnumMember.split("/");var j=h[h.length-1];if(j){g.Type={"String":j};}var D=p.chartAnnotation.annotation.DataPoint;if(D){var k=D[0].AnnotationPath;var l=this._getScaleFactor(e,k);g.scaleFactor={"String":l};}else{g.scaleFactor={"String":undefined};}if(f){g.filterRestriction={"String":f};}else{g.filterRestriction={"String":undefined};}var m=p.chartAnnotation.annotation.Dimensions[0].PropertyPath;if(m){g.Dimensions=[];var n={};n.Field={"String":m};s.filter(function(C,E,G){if(C.name==m){n.Descending={"Boolean":C.descending};}});g.Dimensions.push(n);}var o=p.chartAnnotation.annotation.Measures[0].PropertyPath;if(o){g.Measures=[];var q={};q.Field={"String":o};var r=(p.annotation.SortOrder&&p.annotation.SortOrder.length>0)?p.annotation.SortOrder[0]:undefined;if(r){r=((r.Descending)&&(r.Descending.Boolean))?r.Descending.Boolean:undefined;}if(r){q.Descending={"Boolean":r};}else{q.Descending={"Boolean":"true"};}g.Measures.push(q);}if(i){g.Selected={"Boolean":"true"};}else{g.Selected={"Boolean":"false"};}if(a){g.CollectionPath=a;}if(b&&b.length>0){g.InParameters=[];for(var t in b){var u=b[t]?b[t]:undefined,v=(u&&u.RecordType)?u.RecordType:undefined,w=(u.ValueListProperty&&u.ValueListProperty.String)?u.ValueListProperty.String:undefined,x=(u.LocalDataProperty&&u.LocalDataProperty.PropertyPath)?u.LocalDataProperty.PropertyPath:undefined;if(u&&v&&w&&x){if(g.OutParameter===undefined&&(v===V.ValueListParameterOut||v===V.ValueListParameterInOut)&&w===m&&x===d){g.OutParameter=x;}if(v===V.ValueListParameterIn||v===V.ValueListParameterInOut){var y=this._filter.getModel().getMetaModel(),z=this.getEntityType(a.String),A=y.getODataEntityType(z),B=y.getODataProperty(A,w);if(B['sap:filterable']===undefined||B['sap:filterable']=="true"){g.InParameters.push({localDataProperty:x,valueListProperty:w});}else{jQuery.sap.log.error('IN Parameter valueListProperty: '+w+' is not sap:filterable');}}}}if(g.InParameters.length===0){g.InParameters=undefined;}}if(d){g.ParentProperty=d;}g.isMandatoryProperty=I;return g;};c.prototype._getConfig=function(a){var b={filterList:[]};if(!a)return b;var f={};var d={};var e=a.Filters;for(var i=0;i<e.length;i++){var g=e[i];var p=g.ParentProperty;var h=g.Dimensions[0].Field.String;var l=g.CollectionPath.String;var m=this._dimensionMap[l][h];if(!m){jQuery.sap.log.error("Unknown Dimension :"+h);continue;}var n=g.Measures[0].Field.String;var o=this._measureMap[l][n];if(!o){jQuery.sap.log.error("Unknown Measure :"+n);continue;}var q=m.fieldInfo.description;if(!q)q=h;if(!f[h])f[h]=[];if(!d[p])d[p]=[];var r={type:g.Type.String,selected:g.Selected.Boolean=="true",dimension:{field:h,fieldDisplay:q},measure:{field:g.Measures[0].Field.String,descending:g.Measures[0].Descending.Boolean=="true"},sortOrder:g.SortOrder,scaleFactor:g.scaleFactor.String};r.collectionPath=g.CollectionPath.String;r.outParameter=g.OutParameter;r.inParameters=g.InParameters;r.parentProperty=g.ParentProperty;r.filterRestriction=g.filterRestriction.String;r.isMandatory=g.isMandatoryProperty;d[p].push(r);f[h].push(r);}var u={};for(var i=0;i<this._groupList.length;i++){var s=this._groupList[i];for(var j=0;j<s.fieldList.length;j++){var t=s.fieldList[j];var e=d[t.name];if(!e)continue;u[s.name]=true;for(var k=0;k<e.length;k++)b.filterList.push(e[k]);}}for(var i=this._groupList.length-1;i>=0;i--){var s=this._groupList[i];if(u[s.name])continue;this._groupList.splice(i,1);delete this._groupMap[s.name];}b=this._sortVisualFilter(this._allSelectionFields,b);return b;};return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Bar');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.Title');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.TextArea');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.StandardListItem');jQuery.sap.require('sap.m.ListSeparators');jQuery.sap.require('sap.m.Popover');jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.ui.layout.GridData');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.m.SegmentedButtonItem');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController",["sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Dialog","sap/m/Bar","sap/m/SearchField","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Title","sap/m/VBox","sap/m/HBox","sap/m/CheckBox","sap/m/Link","sap/m/List","sap/m/TextArea","sap/m/Text","sap/m/StandardListItem","sap/m/ListSeparators","sap/m/Popover","sap/ui/layout/form/SimpleForm","sap/ui/layout/GridData","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/m/SegmentedButton","sap/m/SegmentedButtonItem"],function(B,a,L,D,b,S,T,c,d,V,H,C,e,f,g,h,j,k,P,l,G,m,F,n,o){"use strict";var p="_BASIC";var q,r,s,t;var u="100%";var v=0.33;var w=0.5;var x=m.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController",{init:function(i){this.oState=i;this.oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");},launchDialog:function(){var i=this;this.oConfig=this.oState.alr_visualFilterBar.getConfig();this._filterModified=false;this.filterCompList=[];this.filterChartList=[];this._buildFiltersFromConfig();this.oVFDialog=new sap.m.Dialog({title:this.oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"),afterClose:function(){i.oVFDialog.destroy();}});this.oVFDialog.setModel(this.oState.oController.getView().getModel("_templPriv"),"_templPriv");this.oVFDialog.setModel(this.oState.oController.getView().getModel());this.oVFDialog.setModel(this.oState.oController.getView().getModel("i18n"),"i18n");this.oVFDialog.setVerticalScrolling(true);this._addDialogButtons();this.oVFDialog.addStyleClass("sapUiPopupWithPadding");this.oVFDialog.addStyleClass("sapUiSizeCompact");this.oVFDialog.addStyleClass("sapUiCompFilterBarDialog");var y=new b();var z=new S({placeholder:this.oRb.getText("FILTER_BAR_SEARCH")});z.attachLiveChange(function(E){if(i.oVFDialog){i._triggerSearchInFilterDialog(E);}});y.addContentRight(z);this.oVFDialog.setSubHeader(y);this.oVerticalBox=new V();this.oVerticalBox.addStyleClass("sapUiNoContentPadding");this.oVFDialog.addContent(this.oVerticalBox);this._addFilterSwitch();this._addGroupsAndFilters();this.oVFDialog.open();},_addFilterSwitch:function(){var i=[new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-fields",width:"inherit",key:"compact",tooltip:"{i18n>FILTER_COMPACT}"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-analytics",width:"inherit",key:"visual",tooltip:"{i18n>FILTER_VISUAL}"})];var y=new n({width:"inherit",selectedKey:"visual",items:i});y.attachSelect(function(){this.oState.alr_visualFilterBar._setVariantModified();this.oState.alr_visualFilterBar.setConfig(this._rebuildConfig(),true);this.oState.filterBarController.onGoFilter();this.oVFDialog.close();this.oState.oSmartFilterbar.showFilterDialog();}.bind(this));var z=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,content:[new sap.m.ToolbarSpacer(),y]}).addStyleClass("alpFilterDialogToolbar");this.oVerticalBox.addItem(z);},_addDialogButtons:function(){var i=this;s=new B({text:this.oRb.getText("FILTER_BAR_GO"),type:a.Emphasized,press:function(E){i.oState.alr_visualFilterBar._setVariantModified();i.oState.alr_visualFilterBar.setConfig(i._rebuildConfig(),true);i.oState.filterBarController.onGoFilter();i.oVFDialog.close();}});q=new B({text:this.oRb.getText("FILTER_BAR_CLEAR"),press:function(E){i._clearFilters();}});r=new B({text:this.oRb.getText("FILTER_BAR_RESTORE"),press:function(E){i.oState.alr_visualFilterBar.fireFilterChange({bRestoreCompactFilter:true});i._buildFiltersFromConfig();i.oVerticalBox.removeAllItems();i._addFilterSwitch();i._addGroupsAndFilters();}});t=new B({text:this.oRb.getText("FILTER_BAR_CANCEL"),press:function(E){i.oState.alr_visualFilterBar.fireFilterChange({bRestoreCompactFilter:true});i.oVFDialog.close();}});this.oVFDialog.addButton(s);this.oVFDialog.addButton(q);this.oVFDialog.addButton(r);this.oVFDialog.addButton(t);this.oVFDialog.attachAfterClose(function(){i.oVFDialog.destroy();i.oVFDialog=null;});},_buildFiltersFromConfig:function(){var i;this.filterCompList=[];this.filterChartList=[];for(i=0;i<this.oConfig.filterCompList.length;i++){this.filterCompList.push({obj:{shownInFilterBar:this.oConfig.filterCompList[i].shownInFilterBar,shownInFilterDialog:this.oConfig.filterCompList[i].shownInFilterDialog,cellHeight:this.oConfig.filterCompList[i].cellHeight,component:{type:this.oConfig.filterCompList[i].component.type,cellHeight:this.oConfig.filterCompList[i].component.cellHeight},group:{label:this.oConfig.filterCompList[i].group.label,name:this.oConfig.filterCompList[i].group.name}},searchVisible:true,toolbar:this._addChartCustomToolbar(this.oConfig.filterCompList[i],i)});this.filterChartList.push(this._addChart(this.oConfig.filterCompList[i].component.type,this.oConfig.filterCompList[i].component.properties,i));}this._applyFilterSelections();},_rebuildConfig:function(){var i;var y={filterCompList:[]};for(i=0;i<this.filterCompList.length;i++){y.filterCompList.push({shownInFilterBar:this.filterCompList[i].obj.shownInFilterBar&&this.filterCompList[i].obj.shownInFilterDialog,shownInFilterDialog:this.filterCompList[i].obj.shownInFilterDialog,cellHeight:this.filterCompList[i].obj.cellHeight,group:{label:this.filterCompList[i].obj.group.label,name:this.filterCompList[i].obj.group.name},component:{type:this.filterCompList[i].obj.component.type,cellHeight:this.filterCompList[i].obj.component.cellHeight,properties:{scaleFactor:this.filterChartList[i].getScaleFactor(),sortOrder:this.filterChartList[i].getSortOrder(),filterRestriction:this.oConfig.filterCompList[i].component.properties.filterRestriction,entitySet:this.filterChartList[i].getEntitySet(),width:this.oConfig.filterCompList[i].component.properties.width,height:this.oConfig.filterCompList[i].component.properties.height,dimensionField:this.filterChartList[i].getDimensionField(),dimensionFieldDisplay:this.filterChartList[i].getDimensionFieldDisplay(),dimensionFieldIsDateTime:this.filterChartList[i].getDimensionFieldIsDateTime(),dimensionFilter:this.filterChartList[i].getDimensionFilter(),unitField:this.filterChartList[i].getUnitField(),isCurrency:this.filterChartList[i].getIsCurrency(),isMandatory:this.oConfig.filterCompList[i].component.properties.isMandatory,measureField:this.filterChartList[i].getMeasureField(),measureSortDescending:this.filterChartList[i].getMeasureSortDescending(),outParameter:this.oConfig.filterCompList[i].component.properties.outParameter,inParameters:this.oConfig.filterCompList[i].component.properties.inParameters,parentProperty:this.oConfig.filterCompList[i].component.properties.parentProperty}}});}return y;},_addGroupsAndFilters:function(){var i;var y;var z;var A=0;for(i=0;i<this.filterCompList.length;i++){if(!Array.isArray(this.filterCompList[i])){if(this.filterCompList[i].searchVisible===false){continue;}if(!y||(y!=this.filterCompList[i].obj.group.name)){if(z){this.oVerticalBox.addItem(z);}y=this.filterCompList[i].obj.group.name;z=new V();z.setWidth("100%");z.setLayoutData(new G({span:"L12 M12 S12"}));A++;this._addGroupToolbar(z,this.filterCompList[i].obj.group.label,this.filterCompList[i].obj.group.name);}if(this.filterCompList[i].obj.shownInFilterDialog){var E=new V();E.addStyleClass("alp_graphicalFilterDialogChartViewContainer");E.addStyleClass("sapSuiteVisualFilterBar");E.addItem(this.filterCompList[i].toolbar);E.addItem(this.filterChartList[i]);this._updateFilterCount(i);z.addItem(E);}}if(z){this.oVerticalBox.addItem(z);}}if(A<=1){F.executeFunction(z,"mAggregations.items.0.setVisible",[false]);}},_addGroupToolbar:function(i,y,z){var A=new T({content:[new d({text:y}),new c()]});if(z!=p){A.addContent(this._createMoreFiltersLink(z));}i.addItem(A);},_addChartCustomToolbar:function(i,y){var z=this;var A=i.component.properties.sortOrder[0].Descending.Boolean;var E=this._getChartTypeIconLink(i.component.type);var I=new H({items:[new C({text:"",selected:i.shownInFilterBar,select:function(K){var y=K.getSource().data("idx");z.filterCompList[y].obj.shownInFilterBar=this.getSelected();}}).data("idx",y)]});var J=new H({items:[new B({type:"Transparent",text:"",enabled:"{= !${_templPriv>/alp/visualFilter/"+i.component.properties.parentProperty+"/hasMultiUnit} }",press:function(K){sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController.launchAllFiltersPopup(K.getSource(),z.filterChartList[K.getSource().data("idx")],K.getSource().getModel('i18n'));}}).data("idx",y),new B({type:"Transparent",icon:"sap-icon://line-chart-time-axis",visible:false,press:function(K){z._showLineChartTimeAxisPopup(K);}}).data("idx",y),new B({type:"Transparent",icon:(A?"sap-icon://sort-descending":"sap-icon://sort-ascending"),visible:true,tooltip:"{i18n>VISUAL_FILTER_SORT_ORDER}",press:function(K){z._showChartSortPopup(K);}}).data("idx",y),new B({type:"Transparent",icon:E,tooltip:"{i18n>VISUAL_FILTER_CHART_TYPE}",press:function(K){z._showChartTypesPopup(K);}}).data("idx",y),new B({type:"Transparent",icon:"sap-icon://measure",tooltip:"{i18n>VISUAL_FILTER_MEASURE}",press:function(K){z._showChartMeasuresPopup(K);}}).data("idx",y)]});J.setWidth("100%");J.setJustifyContent(sap.m.FlexJustifyContent.End);I.setWidth("100%");I.addItem(J);return I;},_addChart:function(i,y,z){var A;var E=this;var I={scaleFactor:y.scaleFactor,sortOrder:y.sortOrder,filterRestriction:y.filterRestriction,width:u,height:y.height,labelWidthPercent:v,entitySet:y.entitySet,dimensionField:y.dimensionField,dimensionFieldDisplay:y.dimensionFieldDisplay,dimensionFieldIsDateTime:y.dimensionFieldIsDateTime,unitField:y.unitField,isCurrency:y.isCurrency,isMandatory:y.isMandatory,measureField:y.measureField,dimensionFilter:y.dimensionFilter,measureSortDescending:y.measureSortDescending,outParameter:y.outParameter,inParameters:y.inParameters,parentProperty:y.parentProperty};if(i==="Donut"){I.labelWidthPercent=w;}var A=this.oState.alr_visualFilterBar._createFilterItemOfType(i,I);A.data("idx",z);A.attachFilterChange(function(J){var z=J.getSource().data("idx");E._filterModified=true;E._updateFilterCount(z);E.oState.alr_visualFilterBar.fireFilterChange({filterList:J.getParameter('filterList'),property:J.getParameter('property'),filterRestriction:J.getParameter('filterRestriction')});E._applyFilterSelections();});A.attachTitleChange(function(J){var z=J.getSource().data("idx");if(I.isMandatory){E.filterCompList[z].toolbar.getItems()[0]._oLabel.addStyleClass("sapMLabelRequired");}E.filterCompList[z].toolbar.getItems()[0].setText(E._getChartTitle(E.filterCompList[z].obj,z));});return A;},_createMoreFiltersLink:function(y){var z=this;var A=0;var i;var E=new e();for(i=0;i<this.filterCompList.length;i++){if(this.filterCompList[i].searchVisible&&this.filterCompList[i].obj.group.name===y&&!this.filterCompList[i].obj.shownInFilterDialog){A++;}}if(A>0){E.setText(this.oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[A]));}else{E.setText(this.oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS"));}E.attachPress(function(I){z._createAddRemoveFiltersDialog(y,E);});return E;},_showChartMeasuresPopup:function(E){var i=this;var y=E.getSource().data("idx");var z=this.filterChartList[y].getProperty("entitySet");var A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(E.getSource().getModel('i18n'),"VISUAL_FILTER_MEASURES");var I=new f({mode:sap.m.ListMode.SingleSelectLeft});I.data("idx",y);A.addContent(I);var J=this.oState.alr_visualFilterBar._getMeasureMap()[z];I.addStyleClass("sapUiSizeCompact");if(J){for(var K in J){var M=new j({title:J[K].label}).data("measureName",J[K].name);I.addItem(M);if(this.filterChartList[y].getMeasureField()===J[K].name){I.setSelectedItem(M);}}}I.attachSelectionChange(function(E){var y=E.getSource().data("idx");i.filterChartList[y].setMeasureField(E.getSource().getSelectedItem().data("measureName"));i.filterCompList[y].toolbar.getItems()[0].setText(i._getChartTitle(i.filterCompList[y].obj,y));A.close();});A.attachAfterClose(function(){A.destroy();A=null;});A.openBy(E.getSource());},_showChartTypesPopup:function(E){var y=this;var z=E.getSource();var A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(E.getSource().getModel('i18n'),"VISUAL_FILTER_CHART_TYPES");var I=this.oState.alr_visualFilterBar._getSupportedFilterItemList();var J=[];for(var i=0;i<I.length;i++){var K=I[i];var M=new j({title:"{i18n>"+K.textKey+"}",icon:K.iconLink,selected:z.getIcon()===K.iconLink}).data("type",K.type);J.push(M);}var N=new f({mode:sap.m.ListMode.SingleSelectMaster,items:J});N.data("button",z);N.addStyleClass("sapUiSizeCompact");A.addContent(N);N.attachSelectionChange(function(E){var O=E.getSource().data("button").data("idx");var Q=E.getSource().getSelectedItem().data("type");var R=y.filterChartList[O].getP13NConfig();y.filterCompList[O].obj.component.type=Q;E.getSource().data("button").setIcon(y._getChartTypeIconLink(Q));y.filterChartList[O]=y._addChart(Q,R,O);y._applyFilterSelections();A.close();});A.attachBeforeClose(function(){y.oVerticalBox.removeAllItems();y._addFilterSwitch();y._addGroupsAndFilters();});A.attachAfterClose(function(){A.destroy();A=null;});A.openBy(E.getSource());},_showLineChartTimeAxisPopup:function(E){var i=E.getSource().data("idx");var y=E.getSource();var z=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(E.getSource().getModel('i18n'),"VISUAL_FILTER_LINE_CHART_TIME_LINE");var A=new f({mode:sap.m.ListMode.SingleSelectLeft,items:[new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_DAYS}"}).data("idx",i),new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_MONTH}"}).data("idx",i),new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_QUARTERS}"}).data("idx",i),new j({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_YEARS}"}).data("idx",i)]});A.data("button",y);A.addStyleClass("sapUiSizeCompact");z.addContent(A);A.attachSelectionChange(function(E){z.close();});z.attachAfterClose(function(){z.destroy();z=null;});z.openBy(E.getSource());},_showChartSortPopup:function(E){var i=this;var y=E.getSource().data("idx");var z=E.getSource();var A=E.getSource().getModel('i18n');var I=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(A,"VISUAL_FILTER_SORTING");var J=new f({mode:sap.m.ListMode.SingleSelectLeft,items:[new j({title:A.getResourceBundle().getText("VISUAL_FILTER_SORTING_ASCENDING")}).data("idx",y),new j({title:A.getResourceBundle().getText("VISUAL_FILTER_SORTING_DESCENDING")}).data("idx",y)]});J.data("button",z);J.addStyleClass("sapUiSizeCompact");if(this.filterChartList[y].getSortOrder()[0].Descending.Boolean){J.setSelectedItem(J.getItems()[1],true);}else{J.setSelectedItem(J.getItems()[0],true);}I.addContent(J);J.attachSelectionChange(function(E){var z=E.getSource().data("button");var y=z.data("idx");var K=jQuery.extend(true,[],i.filterChartList[y].getSortOrder());K[0].Descending.Boolean=E.getSource().getItems()[1].isSelected();i.filterChartList[y].setSortOrder(K);if(i.filterChartList[y].getSortOrder()[0].Descending.Boolean){z.setIcon("sap-icon://sort-descending");}else{z.setIcon("sap-icon://sort-ascending");}I.close();});I.attachAfterClose(function(){I.destroy();I=null;});I.openBy(E.getSource());},_createAddRemoveFiltersDialog:function(y,z){var i;var A=this;var E=new sap.m.Dialog();E.setTitle(this.oRb.getText("SELECT_FILTER_FIELDS"));E.addStyleClass("sapUiPopupWithPadding");E.addStyleClass("sapUiCompAddRemoveFilterDialog");E.addStyleClass("sapUiSizeCompact");E.setVerticalScrolling(true);var I=new b();var J=new S({placeholder:this.oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=J;J.attachLiveChange(function(M){A._onAddRemoveFiltersSearch(M);});I.addContentRight(J);E.setSubHeader(I);this.addRemoveList=new f({mode:sap.m.ListMode.MultiSelect});this.addRemoveList.setShowSeparators(k.None);E.addContent(this.addRemoveList);for(i=0;i<this.filterCompList.length;i++){if(this.filterCompList[i].obj.group.name===y&&this.filterCompList[i].searchVisible){var K=new j({title:this._getChartTitle(this.filterCompList[i].obj,i,true)}).data("idx",i);this.addRemoveList.addItem(K);if(this.filterCompList[i].obj.shownInFilterDialog){this.addRemoveList.setSelectedItem(K,true);}}}var O=new B({text:this.oRb.getText("FORM_PERS_DIALOG_OK")});O.attachPress(function(){var i;var M=A.addRemoveList.getItems();for(i=0;i<M.length;i++){var N=M[i].data("idx");A.filterCompList[N].obj.shownInFilterDialog=M[i].isSelected();}A.oVerticalBox.removeAllItems();A._addFilterSwitch();A._addGroupsAndFilters();E.close();});E.addAggregation("buttons",O);E.setInitialFocus(this._oSearchField);E.setContentHeight("23.25rem");var t=new B({text:this.oRb.getText("FORM_PERS_DIALOG_CANCEL"),press:function(){E.close();}});E.addAggregation("buttons",t);E.attachAfterClose(function(){E.destroy();E=null;});E.open();},_onAddRemoveFiltersSearch:function(E){var i;if(!E){return;}var y=E.getParameters();if(!y){return;}var z=(y.newValue?y.newValue:"").toLowerCase();var A=this.addRemoveList.getItems();for(i=0;i<A.length;i++){var I=(A[i].getTitle()).toLowerCase();A[i].setVisible(I.indexOf(z)>=0);}},_getChartTypeIconLink:function(i){var y=this.oState.alr_visualFilterBar._getSupportedFilterItemMap();var z=y[i];return!z?"":z.iconLink;},_getChartTitle:function(i,y,z){var A="";if(this.filterChartList[y]){if(z){i.component.properties=this.filterChartList[y].getP13NConfig();A=this.oState.alr_visualFilterBar.getTitleByFilterItemConfig(i);}else{A=this.filterChartList[y].getTitle();}}else{A=this.oState.alr_visualFilterBar.getTitleByFilterItemConfig(i);}return A;},_adjustToolbarIcons:function(i){if(this.filterCompList[i].obj.component.type==="Line"){this.filterCompList[i].toolbar.getItems()[1].getItems()[1].setVisible(true);this.filterCompList[i].toolbar.getItems()[1].getItems()[2].setVisible(false);}else{this.filterCompList[i].toolbar.getItems()[1].getItems()[1].setVisible(false);this.filterCompList[i].toolbar.getItems()[1].getItems()[2].setVisible(true);}},_applyFilterSelections:function(){this.oState.alr_visualFilterBar._updateFilterItemList(this.filterChartList);},_clearFilters:function(){for(var i=0;i<this.filterCompList.length;i++){this.filterChartList[i].setDimensionFilter([]);this.filterChartList[i].setDimensionFilterExternal([]);this._updateFilterCount(i);}this.oState.alr_visualFilterBar.fireFilterChange({filterItemList:this.filterChartList});this._applyFilterSelections();},_updateFilterCount:function(i){if(this.filterChartList[i].getDimensionFilter()&&this.filterChartList[i].getDimensionFilter().length>0){var y=this.oRb.getText("VALUEHELPDLG_SELECTEDITEMS_SHORT",[this.filterChartList[i].getDimensionFilter().length]);this.filterCompList[i].toolbar.getItems()[1].getItems()[0].setVisible(true);this.filterCompList[i].toolbar.getItems()[1].getItems()[0].setText(y);}else{this.filterCompList[i].toolbar.getItems()[1].getItems()[0].setVisible(false);}},_triggerSearchInFilterDialog:function(E){var i;if(!E){return;}var y=E.getParameters();if(!y){return;}var z=(y.newValue?y.newValue:"").toLowerCase();for(i=0;i<this.filterCompList.length;i++){var A=(this.filterCompList[i].toolbar.getItems()[0].getText()).toLowerCase();this.filterCompList[i].searchVisible=A.indexOf(z)>=0;}this.oVerticalBox.removeAllItems();this._addFilterSwitch();this._addGroupsAndFilters();}});sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog=function(i,y){var z=new sap.m.Popover();z.setTitle(i.getResourceBundle().getText(y));z.setPlacement(sap.m.PlacementType.PreferredBottomOrFlip);z.addStyleClass("sapUiPopupWithPadding");return z;};sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController.launchAllFiltersPopup=function(y,z,A){var i;var E=z.getDimensionFilter();var I=z.getFilterRestriction();var J=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(A,"VISUAL_FILTER_ALL_SELECTED_FILTERS");var K=new f({mode:sap.m.ListMode.Delete});K.data("chart",z);J.addContent(K);J.addStyleClass("sapUiSizeCompact");J.addStyleClass("alpSelectedLinkDialog");var M=new sap.m.Bar();var q=new B({text:A.getResourceBundle().getText("CLEAR_FILTERS_ALL"),press:function(O){var Q=K.data("chart");E.length=0;J.removeContent(K);Q.setDimensionFilter(E);Q.fireFilterChange({filterList:E,property:Q.getParentProperty(),filterRestriction:Q.getFilterRestriction()});J.close();}});M.addContentRight(q);J.setFooter(M);if(I!=="single"){for(i=0;i<E.length;i++){var N=new j({title:F.createTitle(E[i].dimValueDisplay,E[i].dimValue)});K.addItem(N);}}else{K.addItem(new j({title:E[0].dimValue}));}K.attachDelete(function(O){var Q=O.getParameter("listItem");var R=K.data("chart");var U=K.indexOfItem(Q);E.splice(U,1);K.removeItem(Q);R.setDimensionFilter(E);R.fireFilterChange({filterList:E,property:R.getParentProperty(),filterRestriction:R.getFilterRestriction()});J.focus();});J.attachAfterClose(function(){J.destroy();J=null;});J.openBy(y);};return x;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.ObjectIdentifier');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.model.Filter');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/ControllerImplementation",["jquery.sap.global","sap/ui/base/Object","sap/ui/model/json/JSONModel","sap/m/ObjectIdentifier","sap/m/Table","sap/m/Text","sap/ui/comp/smartfield/SmartField","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/ListReport/extensionAPI/ExtensionAPI","sap/m/MessageBox","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/lib/MessageUtils","sap/suite/ui/generic/template/ListReport/controller/IappStateHandler","sap/ui/table/Table","sap/ui/table/AnalyticalTable","sap/ui/model/Filter"],function(q,B,J,O,T,a,S,b,E,M,A,c,I,U,d,F){"use strict";return{getMethods:function(v,t,C){var s={};var o;var e=true;function f(){var i=C.getOwnerComponent();var m=i.getModel("_templPriv");m.setProperty("/listReport/isLeaf",i.getIsLeaf());}function g(){var G=q.sap.getObject("sap.ushell.Container.getUser");var m=C.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui");var i=(m&&m.icons&&m.icons.icon)||"";var n={bookmarkIcon:i,bookmarkCustomUrl:function(){var H=hasher.getHash();return H?("#"+H):window.location.href;},bookmarkServiceUrl:function(){var u=s.oSmartTable.getTable();var w=u.getBinding("rows")||u.getBinding("items");return w?w.getDownloadUrl()+"&$top=0&$inlinecount=allpages":"";},isShareInJamActive:!!G&&G().isJamActive()};var r=C.getOwnerComponent().getModel("_templPriv");r.setProperty("/listReport/share",n);}function h(i){C.onInitSmartFilterBarExtension(i);o.onSmartFilterBarInitialise();}function j(){var i=o.parseUrlAndApplyAppState();i.then(function(){e=false;},function(m){if(m instanceof Error){m.showMessageBox();e=false;}});}function k(){if(!e){o.changeIappState(true,false);}}function p(){var m=C.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui.generic.app");if(m&&m.pages[0]&&m.pages[0].component&&m.pages[0].component.settings&&m.pages[0].component.settings.tableTabs){var n;s.aSmartTables=[];for(var i in m.pages[0].component.settings.tableTabs){var K=m.pages[0].component.settings.tableTabs[i].key;n=C.byId("listReport-"+K);s.aSmartTables.push(n);}s.oSmartTable=s.aSmartTables[0];for(i=1;i<s.aSmartTables.length;i++){s.aSmartTables[i].setVisible(false);}s.oSmartFilterbar.attachSearch(function(r){s.oSmartTable._reBindTable(r);});}}function l(i){var m,n,r,D,u;m=i.getParameters().mainNavigation;u=i.getSource();n=u.getText&&u.getText();r=t.oCommonUtils.getCustomData(i);D=r["LinkDescr"];m.setDescription(D);i.getParameters().show(n,m,undefined,undefined);}return{onInit:function(){s.oSmartFilterbar=C.byId("listReportFilter");s.oSmartTable=C.byId("listReport");p();o=new I(s,C,t.oCommonUtils.getNavigationHandler());t.oServices.oApplication.registerStateChanger({isStateChange:o.isStateChange});v.getUrlParameterInfo=o.getUrlParameterInfo;v.onComponentActivate=function(){if(!e){o.parseUrlAndApplyAppState();}};v.refreshBinding=function(){if(o.areDataShownInTable()){t.oCommonUtils.refreshSmartTable(s.oSmartTable);}};f();g();var i=C.getOwnerComponent();C.byId("template::FilterText").attachBrowserEvent("click",function(){C.byId("page").setHeaderExpanded(true);});var m=i.getModel("_templPriv");m.setProperty("/listReport/isHeaderExpanded",true);m.setProperty("/listReport/deleteEnabled",false);var n=s.oSmartTable.getTable();var r="sapUiSizeCozy",u="sapUiSizeCompact",w="sapUiSizeCondensed";if(n instanceof U||n instanceof d){var V=C.getView();var x=q(document.body);if(x.hasClass(r)||V.hasStyleClass(r)){s.oSmartTable.addStyleClass(r);}else if(x.hasClass(u)||V.hasStyleClass(u)){var y=i.getComponentContainer().getSettings().condensedTableLayout;if(y===true){s.oSmartTable.addStyleClass(w);}else{s.oSmartTable.addStyleClass(u);}}}},handlers:{onBack:function(){t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){t.oServices.oNavigationController.navigateBack();},q.noop,s);},addEntry:function(i){var m=i.getSource();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){t.oCommonEventHandlers.addEntry(m,false,s.oSmartFilterbar);},q.noop,s);},deleteEntries:function(i){t.oCommonEventHandlers.deleteEntries(i);},onSelectionChange:function(m){var n=m.getSource(),r=n.getModel(),P=n.getModel("_templPriv");var u=r.getMetaModel(),w=u.getODataEntitySet(this.getOwnerComponent().getEntitySet()),D=w["Org.OData.Capabilities.V1.DeleteRestrictions"];var x=false;if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(u,w.entityType,D)){var y=(D&&D.Deletable&&D.Deletable.Path)?D.Deletable.Path:"";var z=true;var G=(y&&y!=="");var H=t.oCommonUtils.getSelectedContexts(n);if(H.length>0){for(var i=0;i<H.length;i++){var K=r.getObject(H[i].getPath());if(!(K.IsActiveEntity&&K.HasDraftEntity&&K.DraftAdministrativeData&&K.DraftAdministrativeData.InProcessByUser)){z=false;}if(G){if(r.getProperty(y,H[i])){G=false;}}if(!z&&!G){x=true;break;}}}}P.setProperty("/listReport/deleteEnabled",x);t.oCommonUtils.setEnabledToolbarButtons(n);t.oCommonUtils.setEnabledFooterButtons(n,this);},onChange:function(i){t.oCommonEventHandlers.onChange(i);},onSmartFieldUrlPressed:function(i){t.oCommonEventHandlers.onSmartFieldUrlPressed(i,s);},onBreadCrumbUrlPressed:function(i){t.oCommonEventHandlers.onBreadCrumbUrlPressed(i,s);},onContactDetails:function(i){t.oCommonEventHandlers.onContactDetails(i);},onSmartFilterBarInitialise:h,onSmartFilterBarInitialized:j,onBeforeSFBVariantSave:function(){o.onBeforeSFBVariantSave();},onAfterSFBVariantSave:function(){o.onAfterSFBVariantSave();},onDataReceived:function(i){t.oCommonEventHandlers.onDataReceived(i);},onAfterSFBVariantLoad:function(i){o.onAfterSFBVariantLoad(i);},onBeforeRebindTable:function(i){t.oCommonEventHandlers.onBeforeRebindTable(i);C.onBeforeRebindTableExtension(i);t.oCommonEventHandlers.onBeforeRebindTableFinally(i);},onShowDetails:function(i){t.oCommonEventHandlers.onShowDetails(i.getSource(),s);},onListNavigate:function(i){if(!C.onListNavigationExtension(i)){t.oCommonEventHandlers.onListNavigate(i.getSource(),s);}},onCallActionFromToolBar:function(i){t.oCommonEventHandlers.onCallActionFromToolBar(i,s);},onDataFieldForIntentBasedNavigation:function(i){t.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(i,s);},onDataFieldWithIntentBasedNavigation:function(i){t.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(i,s);},onBeforeSemanticObjectLinkPopoverOpens:function(i){var m=i.getParameters();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var n=s.oSmartFilterbar.getDataSuiteFormat();t.oCommonUtils.semanticObjectLinkNavigation(m,n,C);},q.noop,s,q.noop);},onSemanticObjectLinkNavigationTargetObtained:l,onDraftLinkPressed:function(i){var m=i.getSource();var n=m.getBindingContext();t.oCommonUtils.showDraftPopover(n,m);},onAssignedFiltersChanged:function(i){if(i.getSource()){C.byId("template::FilterText").setText(i.getSource().retrieveFiltersWithValuesAsText());}},onFilterChange:k,onToggleFiltersPressed:function(){var i=C.getOwnerComponent();var m=i.getModel("_templPriv");m.setProperty("/listReport/isHeaderExpanded",!m.getProperty("/listReport/isHeaderExpanded"));},onSearchButtonPressed:function(){var m=C.getOwnerComponent().getModel();var r=function(i){c.handleError("getCollection",C,t.oServices,i.getParameters());s.oSmartTable.getTable().setBusy(false);c.handleTransientMessages(t.oServices.oApplication.getDialogFragmentForView.bind(null,C.getView()));};o.changeIappState(false,true);m.attachEvent('requestFailed',r);m.attachEventOnce('requestCompleted',function(){m.detachEvent('requestFailed',r);});},onSemanticObjectLinkPopoverLinkPressed:function(i){t.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(i,s);},onAfterTableVariantSave:function(){o.onAfterTableVariantSave();},onAfterApplyTableVariant:function(){o.onAfterApplyTableVariant();},onShareListReportActionButtonPress:function(i){var m=t.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ListReport.view.fragments.ShareSheet",{shareEmailPressed:function(){sap.m.URLHelper.triggerEmail(null,t.oCommonUtils.getText("EMAIL_HEADER",[t.oCommonUtils.getText("PAGEHEADER")]),document.URL);},shareJamPressed:function(){var u=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:t.oCommonUtils.getText("PAGEHEADER")}}});u.open();}},"share",function(u,w){var R=sap.ui.getCore().getLibraryResourceBundle("sap.m");w.setProperty("/emailButtonText",R.getText("SEMANTIC_CONTROL_SEND_EMAIL"));w.setProperty("/jamButtonText",R.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));w.setProperty("/bookmarkButtonText",R.getText("SEMANTIC_CONTROL_SAVE_AS_TILE"));var G=q.sap.getObject("sap.ushell.Container.getUser");w.setProperty("/jamVisible",!!G&&G().isJamActive());});m.openBy(i.getSource());var n=this.getView().byId("template::Share");var r=this.getView().byId("bookmarkButton");r.setBeforePressHandler(function(){n.focus();});},onInlineDataFieldForAction:function(i){var m=i.getSource();var n=t.oCommonUtils.getElementCustomData(m);var r=t.oCommonUtils.getOwnerControl(m);var u=r.getParent().getTableBindingPath();var w=[m.getBindingContext()];t.oCommonUtils.triggerAction(w,u,n,r,s);},onInlineDataFieldForIntentBasedNavigation:function(i){t.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(i.getSource(),s);},onDeterminingDataFieldForAction:function(i){var m=s.oSmartTable.getTable();var n=t.oCommonUtils.getSelectedContexts(m);if(n.length===0){M.error(t.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:t.oCommonUtils.getContentDensityClass()});}else{var r=i.getSource();var u=t.oCommonUtils.getElementCustomData(r);var w=s.oSmartTable.getTableBindingPath();t.oCommonUtils.triggerAction(n,w,u,m);}},onDeterminingDataFieldForIntentBasedNavigation:function(i){var m=i.getSource();var n=t.oCommonUtils.getElementCustomData(m);var r=s.oSmartTable.getTable();var u=t.oCommonUtils.getSelectedContexts(r);var R=!(n.RequiresContext&&n.RequiresContext==="false");if(R&&u.length===0){M.error(t.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:t.oCommonUtils.getContentDensityClass()});}else if(R&&u.length>1){M.error(t.oCommonUtils.getText("ST_GENERIC_MULTIPLE_ITEMS_SELECTED"),{styleClass:t.oCommonUtils.getContentDensityClass()});}else{var w=R?u[0]:null;t.oCommonEventHandlers.onDataFieldForIntentBasedNavigationSelectedContext(w,n,s);}},onIconTabBarSelect:function(i){var K=i.getSource().getSelectedKey();var m,n;m=s.oSmartTable;n=C.byId("listReport-"+K);if(n){s.oSmartTable=n;m.setVisible(false);s.oSmartTable.setVisible(true);s.oSmartTable.rebindTable();t.oCommonUtils.refreshSmartTable(s.oSmartTable);}},onTableInit:function(i){var m=i.getSource();var n=C.getOwnerComponent().getModel("_templPriv");t.oCommonUtils.checkToolbarIntentsSupported(m,n);}},formatters:{formatDraftType:function(D,i,H){if(D&&D.DraftUUID){if(!i){return sap.m.ObjectMarkerType.Draft;}else if(H){return D.InProcessByUser?sap.m.ObjectMarkerType.Locked:sap.m.ObjectMarkerType.Unsaved;}}return sap.m.ObjectMarkerType.Flagged;},formatDraftVisibility:function(D,i){if(D&&D.DraftUUID){if(!i){return sap.m.ObjectMarkerVisibility.TextOnly;}}return sap.m.ObjectMarkerVisibility.IconAndText;},formatDraftLineItemVisible:function(D){if(D&&D.DraftUUID){return true;}return false;},formatDraftOwner:function(D,H){var i="";if(D&&D.DraftUUID&&H){var u=D.InProcessByUserDescription||D.InProcessByUser||D.LastChangedByUserDescription||D.LastChangedByUser;if(u){i=t.oCommonUtils.getText("ST_DRAFT_OWNER",[u]);}else{i=t.oCommonUtils.getText("ST_DRAFT_ANOTHER_USER");}}return i;}},extensionAPI:new E(t,C,s)};}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.core.routing.HashChanger');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/controller/ControllerImplementation",["jquery.sap.global","sap/ui/base/Object","sap/ui/core/format/DateFormat","sap/ui/core/routing/HashChanger","sap/m/MessageBox","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/table/AnalyticalTable","sap/ui/comp/smarttable/SmartTable","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/lib/MessageButtonHelper","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/js/AnnotationHelper","sap/ui/core/mvc/ViewType"],function(q,B,D,H,M,a,F,S,A,b,c,d,t,E,J,f,V){"use strict";function I(s){return s.data("inlineCreate")==="true";}return{getMethods:function(v,T,C){var s={aUnsavedDataCheckFunctions:[]};var g;var h;var l;var m;var L;function o(){if(T.oServices.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Activation of object suppressed, since App is currently busy");return;}q.sap.log.info("Activate object");var e=T.oServices.oCRUDManager.activateDraftEntity();e.then(function(j){T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("OBJECT_SAVED"));if(j&&j.context){T.oServices.oViewDependencyHelper.setAllPagesDirty([C.getOwnerComponent().getId()]);T.oServices.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());T.oServices.oNavigationController.navigateToContext(j.context,undefined,true);}});var i={activationPromise:e};T.oComponentUtils.fire(C,"AfterActivate",i);}function n(){T.oServices.oApplication.performAfterSideEffectExecution(o);}function p(i){var e=C.getView().getModel("ui");e.setProperty("/editable",i);if(g&&!T.oCommonUtils.isDraftEnabled()){T.oComponentUtils.setEditableNDC(i);}}function r(e){if(I(e.getSource())){var i=e.getParameter("bindingParams");if(i.filters&&i.filters.length){var j=new F(i.filters);i.filters=new F({filters:[new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:true}),j],and:true}),new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:false}),new F({filters:[j,new F({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false});}var k=i.sorter[0]&&i.sorter[0].getGroupFunction();var x=k&&function(q1){var r1=q1.getObject();if(r1.IsActiveEntity||r1.HasActiveEntity){var s1=q.extend({},k(q1));s1.key=s1.key.charAt(0)===""?""+s1.key:s1.key;return s1;}return{key:"",text:T.oCommonUtils.getText("NEW_ENTRY_GROUP")};};i.sorter.unshift(new S("HasActiveEntity",false,x));}}function O(e,i){var j=e;if(i){j=j+" - "+i;}sap.m.URLHelper.triggerEmail(null,j,document.URL);}function u(e,i){var j=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:e+" "+i}}});j.open();}function w(){var e=C.byId("objectPage");return e.getHeaderTitle();}function y(e){var i=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.fragments.ShareSheet",{shareEmailPressed:function(){var j=i.getModel("share");O(j.getProperty("/objectTitle"),j.getProperty("/objectSubtitle"));},shareJamPressed:function(){var j=i.getModel("share");u(j.getProperty("/objectTitle"),j.getProperty("/objectSubtitle"));}},"share",function(x,j){var q1=sap.ui.getCore().getLibraryResourceBundle("sap.m");j.setProperty("/emailButtonText",q1.getText("SEMANTIC_CONTROL_SEND_EMAIL"));j.setProperty("/jamButtonText",q1.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));j.setProperty("/bookmarkButtonText",q1.getText("SEMANTIC_CONTROL_SAVE_AS_TILE"));var r1=q.sap.getObject("sap.ushell.Container.getUser");j.setProperty("/jamVisible",!!r1&&r1().isJamActive());});var j=i.getModel("share");var k=w();j.setProperty("/objectTitle",k.getProperty("objectTitle"));j.setProperty("/objectSubtitle",k.getProperty("objectSubtitle"));j.setProperty("/bookmarkCustomUrl",document.URL);i.openBy(e.getSource());}function z(){var e=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(i){var j=i.getSource();var k=j.getBindingContext("buttons");var x=k.getProperty("link");var q1=k.getProperty("param");var r1=x.intent;var s1=r1.split('#')[1].split('-')[0];var t1=r1.split('-')[1].split('?')[0].split('~')[0];var u1={target:{semanticObject:s1,action:t1},params:q1};sap.ushell.Container.getService("CrossApplicationNavigation").toExternal(u1);}},"buttons");return e;}function N(){if(L){T.oServices.oNavigationController.navigateToContext(L,"",true);}else{T.oServices.oNavigationController.navigateToRoot(true);}}function G(){var e=C.getOwnerComponent();var i=e.getNavigationProperty();var j=T.oCommonUtils;var k=C.byId("objectPageHeader");if(k.getProperty("objectTitle")!==""){if(k.getProperty("objectSubtitle")!==""){var x=[" ",k.getProperty("objectTitle").trim(),k.getProperty("objectSubtitle")];var q1=j.getText("DELETE_WITH_OBJECTINFO",x);}else{var x=[k.getProperty("objectTitle").trim()];var q1=j.getText("DELETE_WITH_OBJECTTITLE",x);}}else{var q1=j.getText("ST_GENERIC_DELETE_SELECTED");}M.show(q1,{icon:M.Icon.WARNING,styleClass:T.oCommonUtils.getContentDensityClass(),title:j.getText("DELETE"),actions:[M.Action.DELETE,M.Action.CANCEL],onClose:function(r1){if(r1===M.Action.DELETE){var s1=T.oServices.oCRUDManager.deleteEntity();s1.then(function(){T.oServices.oViewDependencyHelper.setParentToDirty(e,i);T.oServices.oViewDependencyHelper.unbindChildren(e,true);N();});var t1={deleteEntityPromise:s1};T.oComponentUtils.fire(C,"AfterDelete",t1);}}});}function K(e){var i,j;if(e){j=e.context||e;if(T.oServices.oDraftController.getDraftContext().hasDraft(j)){T.oServices.oViewDependencyHelper.setRootPageToDirty();i=e.context&&e.context.context||e.context||e;}}if(i){if(h){h(i);}else{T.oServices.oNavigationController.navigateToContext(i,undefined,true,2);}}else{var n1=T.oComponentUtils.getTemplatePrivateModel();n1.setProperty("/objectPage/displayMode",2);}p(true);}var P;function Q(e){T.oServices.oCRUDManager.editEntity(e).then(function(i){if(i.draftAdministrativeData){P(i.draftAdministrativeData.CreatedByUserDescription||i.draftAdministrativeData.CreatedByUser);}else{K(i.context);}});}function R(e){var k=function(e,i){var j=i.dependent.propertyRef[0].name;var y1=e.getParameters().originalId;var z1=C.getView().byId(y1);if(z1&&z1.mProperties.fieldName===j){return true;}if(!z1){var A1=q("#"+y1.replace(/(:|\.|\[|\]|,|=)/g,"\\$1"));if(A1){z1=A1.control(0);if(z1&&z1.mProperties.fieldName===j){return true;}}}return false;};var x=function(e){var q1,u1,v1,y1,z1,A1,B1;u1=e.getSource().getModel().getMetaModel();v1=u1.getODataEntitySet(e.getSource().getEntitySet());y1=u1.getODataEntityType(v1.entityType);if(!y1||!y1.navigationProperty){return;}for(var i=0;i<y1.navigationProperty.length;i++){z1=y1.navigationProperty[i];if(z1.name==="SiblingEntity"||z1.name==="DraftAdministrativeData"){continue;}var C1=z1.relationship;var D1=C1.lastIndexOf(".");var E1=C1.slice(0,D1);var F1=C1.slice(D1+1);var G1=u1.getObject("/dataServices/schema");var H1;for(var j in G1){if(G1[j].namespace===E1){H1=G1[j];break;}}var I1=H1.association;var J1;for(var j in I1){if(I1[j].name===F1){J1=I1[j];break;}}var K1=J1.referentialConstraint;if(K1&&K1.dependent&&K1.dependent.propertyRef){var L1=k(e,K1);if(L1){A1=u1.getODataAssociationEnd(y1,z1.name);B1=u1.getODataEntityType(A1.type);if(B1["com.sap.vocabularies.UI.v1.QuickViewFacets"]){var M1=u1.getODataEntityContainer();var N1="";var O1="";for(var j=0;j<M1.entitySet.length;j++){if(M1.entitySet[j].entityType===B1.entityType){N1=M1.entitySet[j].name;O1=M1.entitySet[j].entityType;break;}}var P1=u1.getODataEntityType(O1,true)+"/com.sap.vocabularies.UI.v1.QuickViewFacets";q1={navigation:z1.name,entitySet:N1,quickViewFacetODataPath:P1};return q1;}}}}return q1;};var q1=x(e);var r1=e.getParameters();if(q1){var s1=C.getOwnerComponent();var t1=s1.getModel();var u1=t1.getMetaModel();var v1=u1.getODataEntitySet(s1.getEntitySet());var w1=new J({fieldsEnabled:false,navigationPath:q1.navigation});w1.setDefaultBindingMode("OneWay");var x1=sap.ui.view({async:true,preprocessors:{xml:{bindingContexts:{meta:u1.createBindingContext(u1.getODataEntityType(v1.entityType,true)),entitySet:u1.createBindingContext(u1.getODataEntitySet(q1.entitySet,true)),facetCollection:u1.createBindingContext(q1.quickViewFacetODataPath,true)},models:{quickView:w1,meta:u1,entitySet:u1,facetCollection:u1},preprocessorsData:T.oComponentUtils.getPreprocessorsData()}},type:V.XML,viewName:"sap.suite.ui.generic.template.ObjectPage.view.QuickViewSmartForm",height:"100%"});r1.show(undefined,undefined,undefined,x1);}else{r1.show();}}P=function(e){var i=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){i.close();Q(true);},onCancel:function(){i.close();}},"Dialog");var j=i.getModel("Dialog");var k=T.oCommonUtils.getText("DRAFT_LOCK_EXPIRED",[e]);j.setProperty("/unsavedChangesQuestion",k);i.open();};var U;function W(){U=U||T.oCommonUtils.getText("NEW_OBJECT");return U;}var X;function Y(){return X||H.getInstance();}function Z(e,i,j){if(!e.getContent){return;}e.getContent().forEach(function(k){if(k instanceof b){if(j||i[k.getTableBindingPath()]){if(k.isInitialised()){T.oCommonUtils.refreshSmartTable(k);}else{k.attachInitialise(function(){T.oCommonUtils.refreshSmartTable(k);});}if(!j){T.oServices.oApplicationController.executeSideEffects(C.getOwnerComponent().getBindingContext(),[],[k.getTableBindingPath()]);}}}});}function $(e){var i=sap.ui.getCore().byId(w().getId()+"-lock");i.setVisible(e);}function _(){var j="{\"SelectionVariantID\":\"\"}";var k=C.getOwnerComponent();var q1=k.getEntitySet();var r1=k.getModel();var s1=r1.getMetaModel();var t1=s1.getODataEntitySet(q1);var u1=s1.getODataEntityType(t1.entityType);var v1=u1.property;var w1=[];for(var x in v1){var x1=v1[x]["sap:field-control"];if(x1&&w1.indexOf(x1)<0){w1.push(v1[x]["sap:field-control"]);}}var y1=C.getView().getBindingContext();var z1=y1.getObject();var A1=new c();for(var i in v1){var B1=v1[i].type;var C1=v1[i].name;var D1=z1[v1[i].name];if(w1.indexOf(C1)>-1){continue;}if(C1&&(D1||B1==="Edm.Boolean")){if(B1==="Edm.Time"&&D1.ms!==undefined){D1=D1.ms;}if(typeof D1!=="string"){try{D1=D1.toString();}catch(e){D1=D1+"";}}A1.addParameter(C1,D1);}}j=A1.toJSONString();return j;}function a1(e,i){var j=true;var k=i.getModel();var x=T.oCommonUtils.getDeleteRestrictions(i);var q1=x&&x.Deletable&&x.Deletable.Path;if(q1){j=k.getProperty(q1,e);}return j;}function b1(e){var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=e.getSource();var x=T.oCommonUtils.getOwnerControl(k);var q1=T.oCommonUtils.getSelectedContexts(x);if(q1.length===0){M.error(T.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:T.oCommonUtils.getContentDensityClass()});return;}var r1=[];var s1=[];for(var i=0;i<q1.length;i++){if(a1(q1[i],x)){r1.push(q1[i].getPath());}else{s1.push(q1[i]);}}if(s1.length>0){M.error(T.oCommonUtils.getText("ST_GENERIC_DELETE_UNDELETABLE_SUBITEMS",[s1.length,q1.length]),{styleClass:T.oCommonUtils.getContentDensityClass()});}var t1=T.oServices.oCRUDManager.deleteEntities(r1);j.setBusy(t1);t1.then(function(){T.oServices.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());T.oCommonUtils.refreshSmartTable(x);});}function c1(){var i=C.byId("imageDialog")||T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.ImageDialog",{onImageDialogClose:function(){i.close();}},"headerImage");return i;}function d1(){var e=C.getOwnerComponent();var n1=e.getModel("_templPriv");var o1=n1.getProperty("/generic/viewLevel")-1;return"/generic/paginatorInfo/"+o1;}function e1(){var e=C.getOwnerComponent();var i=e.getModel("_templPrivGlobal");var j=i.getProperty(d1());return j;}function f1(){var e=C.getOwnerComponent();var n1=e.getModel("_templPriv");var i=e.getModel("_templPrivGlobal");var j=e1();var k=!!j&&(!l||i.getProperty("/generic/FCL/isLogicallyFullScreen"));var x=k&&(j.selectedRelativeIndex!==(j.listBinding.getLength()-1));var q1=k&&j.selectedRelativeIndex>0;n1.setProperty("/objectPage/navButtons/navUpEnabled",q1);n1.setProperty("/objectPage/navButtons/navDownEnabled",x);n1.setProperty("/objectPage/navButtons/navBtnsVisible",x||q1);}function g1(){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var i=T.oCommonUtils.isDraftEnabled();if(g&&!i){p(false);}T.oServices.oNavigationController.navigateBack();},q.noop,s);}function h1(e){C.oComponent=C.getOwnerComponent()||C.getView().getViewData().component;var i=C.getView();i.setModel(C.oComponent.getModel());C.sEntitySet=C.oComponent.getEntitySet();C.oDraftController=C.oComponent.getAppComponent().getTransactionController().getDraftController();C.bDraftEnabled=C.oDraftController.getDraftContext().isDraftEnabled(C.sEntitySet);if(C.bDraftEnabled){var j=e.getBindingContext();var k=C.oComponent.getAppComponent().getApplicationController();if(!k.getTransactionController().getDraftController().getDraftContext().hasDraft(j)){return Promise.resolve();}var x=C.getOwnerComponent().getRouter();var q1=x.oHashChanger.getHash();return k.propertyChanged(q1,j);}}function i1(e){var i=e.getSource();T.oServices.oApplication.performAfterSideEffectExecution(function(){var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=C.getView().getModel("ui");var x=C.getOwnerComponent().getModel("_templPrivGlobal");var q1=h1(i).then(function(r1){if(!l||x.getProperty("/generic/FCL/isLogicallyFullScreen")){N();k.setProperty("/enabled",false);}T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("ST_CHANGES_APPLIED"));},function(){j.getUnbusy().then(function(r1){if(!l||x.getProperty("/generic/FCL/isLogicallyFullScreen")){T.oCommonUtils.processDataLossTechnicalErrorConfirmation(function(){N();k.setProperty("/enabled",false);},q.noop,s);}else{T.oCommonUtils.processDataLossTechnicalErrorConfirmation(q.noop,q.noop,s,'StayOnPage');}});});j.setBusy(q1);});}function j1(e,i){var n1=T.oComponentUtils.getTemplatePrivateModel();var o1=n1.getProperty("/generic/viewLevel");var j=o1>1?T.oCommonUtils.getTableBinding(i).path:null;T.oServices.oNavigationController.navigateToContext(e,j,true);}function k1(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.m");var n1=T.oComponentUtils.getTemplatePrivateModel();n1.setProperty("/objectPage/navButtons",{navDownTooltip:e.getText("FACETFILTER_NEXT"),navUpTooltip:e.getText("FACETFILTER_PREVIOUS"),navDownEnabled:false,navUpEnabled:false,navBtnsVisible:false});}v.refreshFacets=function(e,i){C.byId("objectPage").getSections().forEach(function(j){j.getSubSections().forEach(function(k){k.getBlocks().forEach(function(x){Z(x,e,i);});k.getMoreBlocks().forEach(function(x){Z(x,e,i);});});});};function l1(){var n1=T.oComponentUtils.getTemplatePrivateModel();var e=n1.getProperty("/generic/viewLevel")-1;var j=e?T.oServices.oApplication.getHierarchySectionsFromCurrentHash():[];var k=w();var x=k&&k.getBreadCrumbsLinks();X=Y();L="";var q1="";for(var i=0;i<e;i++){var r1=j[i];L=L+q1+r1;q1="/";var s1=m[i];var t1=r1.split("(");if(t1&&t1[1]){var u1=x&&x[i];if(u1){var v1=X.hrefForAppSpecificHash?X.hrefForAppSpecificHash(L):"#/"+L;v1=T.oServices.oApplication.adaptBreadCrumbUrl(v1,i+1);var w1="/"+s1+"("+t1[1];u1.setHref(v1);u1.bindElement(w1);}}}}v.onComponentActivate=function(e){s.messageButtonHelper.adaptToContext(e);f1();T.oComponentUtils.setBackNavigation(g1);l1();};v.draftResume=function(e,j,k){var x=e.getObject();if(!x||!x.hasOwnProperty("IsActiveEntity")||x.IsActiveEntity!==false){return;}var q1=C.getView().getModel();var r1=q1.getMetaModel();var s1=r1.getODataEntitySet(C.getOwnerComponent().getEntitySet());var t1=r1.getODataEntityType(s1.entityType);var u1="";var v1="";var w1=t1["com.sap.vocabularies.Common.v1.SemanticKey"];for(var i in w1){var x1=w1[i];if(v1===""){v1=j[x1.PropertyPath];}else{v1=v1+"-"+j[x1.PropertyPath];}}var y1="-";if(k&&k.LastChangeDateTime!==null){var z1=D.getDateTimeInstance({pattern:"MMMM d, yyyy HH:mm",style:"long"});y1=z1.format(k.LastChangeDateTime);}var A1=[u1,v1,y1];var B1=T.oCommonUtils.getText("DRAFT_FOUND_RESUME",A1);var C1;var D1=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.DraftResumeDialog",{onDraftResume:function(){D1.close();T.oServices.oNavigationController.navigateToContext(C1.getProperty("/siblingContext"),null,true);},onDraftDiscard:function(){D1.close();C.getView().getModel("ui").setProperty("/enabled",true);T.oServices.oCRUDManager.deleteEntity(true);$(false);C1.getProperty("/activeEntity").HasDraftEntity=false;T.oServices.oViewDependencyHelper.setAllPagesDirty();},onResumeDialogClosed:function(){C1.setProperty("/siblingContext",null);C1.setProperty("/activeEntity",null);}},"Dialog");C1=D1.getModel("Dialog");C1.setProperty("/draftResumeText",B1);C1.setProperty("/siblingContext",e);C1.setProperty("/activeEntity",j);D1.open();};var Q=t.testable(Q,"editEntity");var Y=t.testable(Y,"getHashChangerInstance");var a1=t.testable(a1,"isEntryDeletable");var l1=t.testable(l1,"adaptLinksToUpperLevels");var m1={onInit:function(){k1();T.oCommonUtils.executeGlobalSideEffect();s.messageButtonHelper=new d(T.oCommonUtils,C);T.oServices.oTemplateCapabilities.oMessageButtonHelper=s.messageButtonHelper;v.isDraftEnabled=T.oCommonUtils.isDraftEnabled;m=T.oServices.oApplication.getSections(C.getOwnerComponent().getEntitySet(),true);},handlers:{addEntry:function(e){var i=e.getSource();var j=T.oCommonUtils.getOwnerControl(i);var k=I(j);if(!i.data("CrossNavigation")&&k){T.oCommonEventHandlers.addEntry(i,true);return;}T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){T.oCommonEventHandlers.addEntry(i,false);},q.noop,s);},deleteEntries:b1,onSelectionChange:function(e){T.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onBack:g1,applyAndUp:i1,onCancel:function(){var e="Proceed";if(T.oComponentUtils.isNonDraftCreate()||!g){e="LeavePage";}T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var n1=T.oComponentUtils.getTemplatePrivateModel();n1.setProperty("/objectPage/displayMode",1);if(g){p(false);}if(T.oComponentUtils.isNonDraftCreate()||!g){T.oServices.oNavigationController.navigateBack();}},q.noop,s,e);},onContactDetails:function(e){T.oCommonEventHandlers.onContactDetails(e);},onPressDraftInfo:function(e){var i=C.getView().getBindingContext();var j=sap.ui.getCore().byId(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));T.oCommonUtils.showDraftPopover(i,j);},onShareObjectPageActionButtonPress:y,onRelatedApps:function(e){var x,q1,r1,s1,t1,u1,v1;var w1,x1,y1,z1,A1;x=e.getSource();y1=sap.ushell&&sap.ushell.Container;q1=y1&&y1.getService("URLParsing");r1=q1.parseShellHash(document.location.hash);z1=r1.semanticObject;A1=r1.action;s1=C.getView&&C.getView().getBindingContext();var B1=C.getOwnerComponent().getModel().getMetaModel();var C1=s1.getObject();var D1=C1.__metadata.type;var E1=B1.getODataEntityType(D1);var F1=E1["com.sap.vocabularies.Common.v1.SemanticKey"];var G1={};if(F1&&F1.length>0){for(var j=0;j<F1.length;j++){var H1=F1[j].PropertyPath;if(!G1[H1]){G1[H1]=[];G1[H1].push(C1[H1]);}}}else{for(var k in E1.key.propertyRef){var I1=E1.key.propertyRef[k].name;if(!G1[I1]){G1[I1]=[];G1[I1].push(C1[I1]);}}}t1=C.getOwnerComponent().getAppComponent();u1=y1&&y1.getService("CrossApplicationNavigation");v1=u1.getLinks({semanticObject:z1,params:G1,ui5Component:t1});w1=z();x1=w1.getModel("buttons");x1.setProperty("/buttons",[]);w1.openBy(x);v1.done(function(J1){var K1=[];for(var i=0;i<J1.length;i++){var L1=J1[i];var M1=L1.intent;var N1=M1.split("-")[1].split("?")[0];if(N1!=A1){K1.push({enabled:true,text:L1.text,link:L1,param:G1});}}if(K1.length===0){K1.push({enabled:false,text:T.oCommonUtils.getText("NO_RELATED_APPS")});}x1.setProperty("/buttons",K1);});},onSemanticObjectLinkPopoverLinkPressed:function(e){T.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(e,s);},handleShowNextObject:function(e){var i=T.oServices.oApplication.getBusyHelper();if(i.isBusy()){return;}var j=e1();var k=j.listBinding;var x=j.endIndex;var q1=j.selectedRelativeIndex+1;var r1=j.objectPageNavigationContexts;var s1=j.growingThreshold;var t1=C.getOwnerComponent().getModel("_templPrivGlobal");var u1=d1();if(q1&&r1){var v1=r1[q1];if(v1){t1.setProperty(u1+"/selectedRelativeIndex",q1);j1(v1,j.tableNavFrom);}else{var w1=new Promise(function(x1,y1){var z1=x+1+s1;var A1=function(B1){var C1=B1.getSource().getContexts(0,z1);t1.setProperty(u1+"/objectPageNavigationContexts",C1);t1.setProperty(u1+"/endIndex",z1);v1=C1[q1];k.detachDataReceived(A1);t1.setProperty(u1+"/selectedRelativeIndex",q1);j1(v1,j.tableNavFrom);x1();};k.attachDataReceived(A1);k.loadData(0,z1);});i.setBusy(w1);}}},handleShowPrevObject:function(e){if(T.oServices.oApplication.getBusyHelper().isBusy()){return;}var i=e1();var j=i.selectedRelativeIndex-1;var k=i.objectPageNavigationContexts;var x=C.getOwnerComponent();var q1=x.getModel("_templPrivGlobal");if(k){var r1=k[j];if(r1&&r1.getPath){q1.setProperty(d1()+"/selectedRelativeIndex",j);j1(r1,i.tableNavFrom);}}},onShowMessages:function(){s.messageButtonHelper.toggleMessagePopover();},onEdit:function(e){var i=e.getSource();if(i.data("CrossNavigation")){T.oCommonEventHandlers.onEditNavigateIntent(i);return;}g=true;Q();},onSave:function(){if(T.oServices.oApplication.getBusyHelper().isBusy()){return;}var e=C.getView().getBindingContext();var i=C.getView().getModel().getPendingChanges();i=i&&i[e.getPath().replace("/","")]||{};var j=Object.keys(i)||[];var k=T.oComponentUtils.isNonDraftCreate();var x=j.indexOf("__metadata");if(x>-1){j.splice(x,1);}var q1=T.oServices.oCRUDManager.saveEntity();q1.then(function(s1){var n1=T.oComponentUtils.getTemplatePrivateModel();n1.setProperty("/objectPage/displayMode",1);if(!T.oCommonUtils.isDraftEnabled()&&g){p(false);}else if(T.oCommonUtils.isDraftEnabled()){p(false);}if(k){if(s1&&s1.getPath()!=="/undefined"){T.oServices.oNavigationController.navigateToContext(s1,undefined,true);}else{p(false);T.oServices.oNavigationController.navigateBack();}T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("OBJECT_CREATED"));}else{T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("OBJECT_SAVED"));if(!T.oCommonUtils.isDraftEnabled()&&!g){T.oServices.oNavigationController.navigateBack();}}if(j.length>0){T.oServices.oApplicationController.executeSideEffects(e,j);}});var r1={saveEntityPromise:q1};T.oComponentUtils.fire(C,"AfterSave",r1);},onActivate:n,onSmartFieldUrlPressed:function(e){T.oCommonEventHandlers.onSmartFieldUrlPressed(e,s);},onBreadCrumbUrlPressed:function(e){T.oCommonEventHandlers.onBreadCrumbUrlPressed(e,s);},onDiscardDraft:function(e){T.oCommonEventHandlers.onDiscardDraft(e);},onDiscardSubItem:function(e){T.oCommonEventHandlers.onDiscardSubItem(e);},onDelete:function(e){if(T.oServices.oApplication.getBusyHelper().isBusy()){return;}G();},onCallActionFromToolBar:function(e){T.oCommonEventHandlers.onCallActionFromToolBar(e,s);},onCallAction:function(e){var i=C.getOwnerComponent();var j=i.getNavigationProperty();var k=T.oCommonUtils.getCustomData(e);var x=[];x.push(C.getView().getBindingContext());if(x[0]&&k.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var q1={functionImportPath:k.Action,contexts:x,sourceControl:"",label:k.Label,operationGrouping:k.InvocationGrouping,navigationProperty:C.getOwnerComponent().getNavigationProperty()};T.oServices.oCRUDManager.callAction(q1).then(function(r1){var s1=r1&&r1[0];if(s1&&s1.response&&s1.response.context&&(!s1.actionContext||s1.actionContext&&s1.response.context.getPath()!==s1.actionContext.getPath())){T.oServices.oViewDependencyHelper.setParentToDirty(i,j);}});},q.noop,s,"Proceed");}},onDataFieldForIntentBasedNavigation:function(e){T.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,s);},onDataFieldWithIntentBasedNavigation:function(e){T.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,s);},onChartInit:function(e){var i=e.getSource().getChart();var j=C._templateEventHandlers.onSelectionChange;i.attachSelectData(j).attachDeselectData(j);},onDataReceived:function(e){T.oCommonEventHandlers.onDataReceived(e);},onBeforeRebindDetailTable:function(e){T.oCommonEventHandlers.onBeforeRebindTable(e);C.onBeforeRebindTableExtension(e);r(e);if(e.getSource().getTable()instanceof A){var i=e.getParameter("bindingParams");i.parameters.entitySet=e.getSource().getEntitySet();}},onShowDetails:function(e){T.oCommonEventHandlers.onShowDetails(e.getSource(),s);},onListNavigate:function(e){T.oCommonEventHandlers.onListNavigate(e.getSource(),s);},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var j=_();T.oCommonUtils.semanticObjectLinkNavigation(i,j,C);},q.noop,s,q.noop);},onSemanticObjectLinkNavigationTargetObtained:function(e){R(e);},onHeaderImagePress:function(e){var i=c1();var j=e.getSource().getId();i.addAriaLabelledBy(j);var k=i.getModel("headerImage");k.setProperty("/src",e.getSource().getSrc());if(sap.ui.Device.system.phone){i.setProperty("stretch",true);}i.open();},onInlineDataFieldForAction:function(e){var i=e.getSource();var j=T.oCommonUtils.getElementCustomData(i);var k=T.oCommonUtils.getOwnerControl(i);var x=k.getParent().getTableBindingPath();var q1=[i.getBindingContext()];T.oCommonUtils.triggerAction(q1,x,j,i,s);},onInlineDataFieldForIntentBasedNavigation:function(e){T.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),s);},onDeterminingDataFieldForAction:function(e){var i=[this.getView().getBindingContext()];var j=e.getSource();var k=T.oCommonUtils.getElementCustomData(j);var x=this.getView().getBindingPath();T.oCommonUtils.triggerAction(i,x,k);},onBeforeRebindChart:function(e){var i=e.getSource();i.oModels=i.getChart().oPropagatedProperties.oModels;},onTableInit:function(e){var i=e.getSource();var n1=C.getOwnerComponent().getModel("_templPriv");T.oCommonUtils.checkToolbarIntentsSupported(i,n1);}},formatters:{formatDefaultObjectTitle:function(e,i){if(i||!e){return;}var j=C.getView().getBindingContext();var k=j&&j.getObject();if(e&&k&&(k.IsActiveEntity===undefined||k.IsActiveEntity===false||k.HasActiveEntity===false)){return W();}}},extensionAPI:new E(T,C,s)};var n1=T.oComponentUtils.getTemplatePrivateModel();var o1=n1.getProperty("/generic/viewLevel");var p1=T.oServices.oApplication.getFclProxy(o1);if(p1.oActionButtonHandlers){m1.handlers.fclActionButtonHandlers=p1.oActionButtonHandlers;l=true;}h=p1.navigateToDraft;return m1;}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.Application')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.Application');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.routing.History');jQuery.sap.require('sap.ui.core.routing.HistoryDirection');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.ActionSheet');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Popover');sap.ui.define("sap/suite/ui/generic/template/lib/Application",["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,r,C,t){"use strict";var c=(t.testableStatic(function(T,o){var s="sapUiSizeCozy",e="sapUiSizeCompact";if(o.hasClass(s)||o.hasClass(e)){return"";}else{return T?s:e;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return c;}function f(o,p){q.sap.syncStyleClass(c,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function d(T){var o=new C(T.oAppComponent);var e={api:{}};var h={};var R={};function j(i){var X=i.getParameters();if(X.name!==R.name){R=X;return true;}var Y=q.extend({},R.arguments,X.arguments);for(var Z in Y){if(Z.indexOf("?")!==0&&Y[Z]!==R.arguments[Z]){R=X;return true;}}return false;}function k(){return e.api||{};}var I=false;function p(X){if(I){return;}var i=0;for(;i<T.aRunningSideEffectExecutions.length&&!T.aRunningSideEffectExecutions[i];i++){i++;}if(T.aRunningSideEffectExecutions[i]){I=true;var Y=T.aRunningSideEffectExecutions[i];Y.then(function(){if(T.aRunningSideEffectExecutions[i]===Y){T.aRunningSideEffectExecutions[i]=null;}I=false;p(X);});}else{X();}}function m(i){var X;if(i instanceof b){X="open";}else if(i instanceof P||i instanceof A){X="openBy";}if(X){var Y=i[X];i[X]=function(){var Z=arguments;p(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){Y.apply(i,Z);});}});};}}var F={};function l(i,X,Y,Z,$){i=i||T.oNavigationHost;var _=i.getId();var a1=F[_]||(F[_]={});var b1=a1[X];if(!b1){b1=sap.ui.xmlfragment(_,X,Y);f(b1,i);var c1;if(Z){c1=new J();b1.setModel(c1,Z);}($||q.noop)(b1,c1);a1[X]=b1;m(b1);}return b1;}function n(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function s(i){if(T.oShellService){T.oShellService.setBackNavigation(i);}}function u(i){if(T.oShellService){T.oShellService.setTitle(i);}}function v(i){if(!T.oFlexibleColumnLayoutHandler){return{};}return{oActionButtonHandlers:T.oFlexibleColumnLayoutHandler.getActionButtonHandlers(i),navigateToDraft:T.oFlexibleColumnLayoutHandler.navigateToDraft};}var w=false;function x(i){w=i;}function y(i,X){if(!T.oFlexibleColumnLayoutHandler){return true;}var Y=r.determineNavigationPath(i,X);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(Y);}function z(i){T.aStateChangers.push(i);}function E(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function G(i,X){o.adaptAfterDeletion(i);if(i.length===0||!T.oFlexibleColumnLayoutHandler){return;}T.oFlexibleColumnLayoutHandler.adaptAfterDeletion(i,X);}function K(i,X,Y){var Z=T.mEntityTree[i];var $;if(Z.navigationProperty){$=X?Z.entitySet:Z.navigationProperty;}else{$=i;}if(Y.indexOf($)<0){Y.unshift($);if(Z.navigationProperty){K(Z.parent,X,Y);}}}function L(i,X){var Y=[];K(i,X,Y);return Y;}function N(X){var Y=L(X);Y.pop();var Z="";var $="";var _=[];for(var i=0;i<Y.length;i++){Z=Z+$+Y[i];_.push(Z);$="/";}return _;}function O(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var X=i.split("?")[0];var Y=X.split("/");if(Y[0]===""||Y[0]==="#"){Y.splice(0,1);}return Y;}function Q(i,X,Y){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,X,Y);}return i;}function S(){var X=T.oNavigationControllerProxy.getActiveComponents();var Y=0;var Z;for(var i=0;i<X.length;i++){var $=T.componentRegistry[X[i]];if($.viewLevel>0&&(Y===0||$.viewLevel<Y)){Y=$.viewLevel;Z=$.oComponent;}}var _=Z?Promise.resolve(Z):T.oNavigationControllerProxy.getRootComponentPromise();return _.then(function(a1){return a1.getModel("i18n").getResourceBundle();});}var U=H.getInstance();var V;var W;T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getResourceBundleForEditPromise:S,onAfterNavigate:function(i){V=i.getParameter("toId");var X=i.getParameter("to");var Y=X&&X.getComponent&&X.getComponent();var Z=Y&&T.componentRegistry[Y];if(Z){var $=function(){e.currentView=Z.oController.getView();};if(Z.oController){$();}else{Z.viewRegisterd.then($);}}else{e.currentView=null;}},onBypassed:function(){R={};e.api.outdated=true;e.api={};},onRouteMatched:function(i){if(!j(i)){return;}e.api.outdated=true;e.api={isBack:U.getDirection()===a.Backwards,dataFromLastPage:h};h={};var X=i.getParameter("config").target;var Y=T.mRouteToTemplateComponentPromise[X];Y.then(function(Z){W=Z.getComponentContainer().getId();if(!V||W===V){V=W;}});},getHierarchySectionsFromCurrentHash:O,getCurrentDisplayObject:k,getContentDensityClass:g,setEditableNDC:x,getDialogFragment:l.bind(null,null),destroyView:function(i){delete F[i];}};return{setEditableNDC:x,getEditableNDC:function(){return w;},getCurrentDisplayObject:k,getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:l,getBusyHelper:function(){return T.oBusyHelper;},performAfterSideEffectExecution:p,isTemplateComponentActive:function(i){return i.getComponentContainer().getId()===W;},showMessageToast:function(){var i=arguments;var X=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([n(true),T.oBusyHelper.getUnbusy()]).then(X);},setBackNavigation:s,setTitle:u,getFclProxy:v,isNewHistoryEntryRequired:y,registerStateChanger:z,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:E,adaptAfterDeletion:G,getBreadCrumbInfo:N,adaptBreadCrumbUrl:Q,getSections:L,getHierarchySectionsFromCurrentHash:O};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,d(T));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.NavigationController')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.lib.NavigationController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.ComponentContainer');jQuery.sap.require('sap.ui.core.routing.HashChanger');jQuery.sap.require('sap.ui.core.routing.History');jQuery.sap.require('sap.ui.core.routing.HistoryDirection');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessagePage');jQuery.sap.require('sap.m.Link');sap.ui.define("sap/suite/ui/generic/template/lib/NavigationController",["jquery.sap.global","sap/ui/base/Object","sap/ui/core/ComponentContainer","sap/ui/core/routing/HashChanger","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessagePage","sap/m/Link","sap/suite/ui/generic/template/lib/ProcessObserver","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,C,H,a,b,F,c,M,d,L,P,r,T,t){"use strict";var h=a.getInstance();function n(s){if(s.indexOf("/")===0){return s;}return"/"+s;}function f(o,R,i){var s=R.template;var E=R.entitySet;var v=R.viewLevel;var O=-1;if(o.oFlexibleColumnLayoutHandler){O=v<3?v:0;}var k=O<0?o.oNavigationObserver:o.aNavigationObservers[O];var l=new P();var m=O<0?o.oHeaderLoadingObserver:o.aHeaderLoadingObservers[O];m.addObserver(l);var p={};var S={appComponent:o.oAppComponent,isLeaf:!R.pages||!R.pages.length,subPages:R.pages,entitySet:E,navigationProperty:R.navigationProperty,routeConfig:R,componentData:{registryEntry:{componentCreateResolve:i,route:R.name,viewLevel:v,oNavigationObserver:k,oHeaderLoadingObserver:l,preprocessorsData:p}}};if(R.component.settings){q.extend(S,R.component.settings);}var u;o.oAppComponent.runAsOwner(function(){try{var w=sap.ui.component({name:s,settings:S,handleValidation:true,async:true});var x;u=new C({propagateModel:true,width:"100%",height:"100%",settings:S});x=w.then(function(y){u.setComponent(y);return u;});u.loaded=function(){return x;};}catch(e){throw new Error("Component "+s+" could not be loaded");}});return u;}function g(o,e){var m={};var k={iHashChangeCount:0,backTarget:0};var A=Promise.resolve();var p=[];function l(){var i=e.oRouter.getViews();i.getView({viewName:"root"});return o.mRouteToTemplateComponentPromise.root;}var s;function u(){if(!s){var i=l();return i.then(function(g1){return g1.getModel("i18n").getResourceBundle().getText("PAGEHEADER");});}return s;}function v(){return k.iHashChangeCount;}function S(i){var g1;if(i instanceof T){var h1=i&&o.componentRegistry[i.getId()];var i1=h1&&h1.methods.getTitle;g1=i1&&Promise.resolve(i1());}else if(i&&i.title){g1=Promise.resolve(i.title);}g1=g1||u();g1.then(function(j1){if(o.oShellService){o.oShellService.setTitle(j1);}});}function w(g1,h1){var i1;var j1=[];for(var i=0;i<=h1;i++){var k1=g1[i];if(k1){if(i1){j1.push(k1);}else{i1=k1;}}}if(i1){i1.resume(j1);}}function x(i){var g1=[o.oPagesDataLoadedObserver.getProcessFinished(true)];var h1=null;var i1=k.iHashChangeCount;var j1=-1;var k1={};for(var l1 in o.componentRegistry){var m1=o.componentRegistry[l1];var n1=m1.oControllerRegistryEntry.oTemplateUtils.oServices.oTemplateCapabilities.oMessageButtonHelper;if(m1.activationTakt<i1){m1.utils.suspendBinding();if(n1){n1.suspend();}}else{g1.push(m1.oViewRenderdPromise);if(m1.viewLevel>j1){j1=m1.viewLevel;h1=m1.oComponent;}k1[m1.viewLevel]=n1;}}w(k1,j1);var o1=h1&&h1.getComponentContainer().getElementBinding();k.bindingPath=o1&&n(o1.getPath());i=i||h1;if(o.oFlexibleColumnLayoutHandler){o.oFlexibleColumnLayoutHandler.setTitleForActiveComponent(i,S);}else{S(i);}Promise.all(g1).then(function(){if(i1===k.iHashChangeCount&&q.isEmptyObject(m)){o.oAppComponent.firePageDataLoaded();}});}var y=x.bind(null,null);function z(i,g1,h1){var i1=function(m1){q.extend(g1,m1);};for(var j1 in o.componentRegistry){var k1=o.componentRegistry[j1];if(k1.route===i){var l1=k1.methods.getUrlParameterInfo;return l1?l1(h1).then(i1):Promise.resolve();}}return Promise.resolve();}function G(g1,h1){var i1=h1?z("root",g1):Promise.resolve();return i1.then(function(){var j1="";var k1="";for(var l1 in g1){var m1=g1[l1];for(var i=0;i<m1.length;i++){var n1=m1[i];k1=k1+j1+l1+"="+n1;j1="&";}}return k1;});}function D(){q.sap.log.info("Navigate back");if(k.backTarget&&n(h.getPreviousHash()||"")!==n(k.hash)){o.oBusyHelper.setBusyReason("HashChange",true);}k.LeaveByBack=true;window.history.back();}function E(i,g1){i=i||"";q.sap.log.info("Navigate to hash: "+i);if(i===k.hash){q.sap.log.info("Navigation suppressed since hash is the current hash");return;}o.oBusyHelper.setBusyReason("HashChange",true);k.targetHash=i;if(k.backTarget&&n(h.getPreviousHash()||"")===n(i)){D();return;}k.LeaveByReplace=g1;if(g1){e.oHashChanger.replaceHash(i);}else{e.oHashChanger.setHash(i);}}function I(i,g1,h1,i1){var j1=g1.then(function(k1){if(k1){i=i+"?"+k1;}if(i1){k.backwardingInfo={backCount:i1.backCount,targetViewLevel:i1.targetViewLevel,path:i};D();}else{E(i,h1);}return i;});o.oBusyHelper.setBusy(j1);return j1;}function J(i){var g1=0;for(var h1=k;h1.oEvent;){var i1=h1.oEvent.getParameter("config").viewLevel;if(i1===0){return g1;}if(i&&g1>0){return-1;}g1++;h1=p[h1.backTarget];}return-1;}function K(i){var g1=J(!i);var h1=G({},true);var i1=(g1>0)&&{backCount:g1,targetViewLevel:0};I("",h1,i,i1);}function O(i){var g1=o.mEntityTree[i.entitySet].sRouteName;var h1=o.mRouteToTemplateComponentPromise[g1];return[h1];}function Q(g1,h1){var i1=k.iHashChangeCount;var j1=function(l1){var m1=o.componentRegistry[l1.getId()];(m1.methods.presetDisplayMode||q.noop)(h1,i1===m1.activationTakt);};for(var i=0;i<g1.length;i++){var k1=g1[i];k1.then(j1);}}function R(i){var g1=i&&o.mEntityTree[i.entitySet];var h1=g1?g1.level:1;return h1;}function U(g1,h1,i1,j1,k1){var l1;var m1,n1;var o1=[];if(typeof g1==="string"){l1=g1;n1=n(l1).split("/").length-1;}else{m1=r.determineNavigationPath(g1,h1);n1=R(m1);l1=m1.path;o1=O(m1);}if(l1){if(h1){var p1=o.oApplicationProxy.getHierarchySectionsFromCurrentHash();for(var i=n1-2;i>=0;i--){l1=p1[i]+"/"+l1;}l1="/"+l1;}Q(o1,j1||0);if(k1){var q1="";var r1="&";for(var s1 in k1){q1=q1+r1+s1+"="+k1[s1];r1="&";}if(q1){l1=l1+"?"+q1;}E(l1,i1);return Promise.resolve(l1);}else{var t1={};var u1=m1&&o.mEntityTree[m1.entitySet].sRouteName;var v1=new Promise(function(w1){z(u1,t1,l1).then(function(){var x1=o.oFlexibleColumnLayoutHandler?o.oFlexibleColumnLayoutHandler.getAppStateParStringForNavigation(n1,t1):G(t1,false);var y1=p[k.backTarget];var z1=y1&&y1.hash&&n(y1.hash.split("?")[0])===n(l1)&&{backCount:1};I(l1,x1,i1,z1).then(w1);});});o.oBusyHelper.setBusy(v1);return v1;}}}function V(i,g1,h1,i1){return U(i,g1,h1,i1);}function W(i){var g1=k.iHashChangeCount;k.iHashChangeCount++;p.push(null);if(i){for(var h1 in o.componentRegistry){var i1=o.componentRegistry[h1];if(i1.activationTakt===g1&&i[i1.viewLevel]){i1.activationTakt=k.iHashChangeCount;}}}return{iHashChangeCount:k.iHashChangeCount};}function X(i){var g1,h1,i1,j1,k1,l1=null,m1,n1;if(i){g1=i.entitySet;h1=i.text;l1=i.icon;n1=i.description;}if(g1){m1=o.oAppComponent.getModel().getMetaModel();if(m1){i1=m1.getODataEntitySet(g1);j1=m1.getODataEntityType(i1.entityType);k1=j1["com.sap.vocabularies.UI.v1.HeaderInfo"];}if(k1&&k1.TypeImageUrl&&k1.TypeImageUrl.String){l1=k1.TypeImageUrl.String;}}o.oNoOwnTitlePromise.then(function(q1){if(o.oShellService){o.oShellService.setBackNavigation(undefined);}});o.oTemplatePrivateGlobalModel.setProperty("/generic/messagePage",{text:h1,icon:l1,description:n1});var o1;if(e.oTemplateContract.oFlexibleColumnLayoutHandler){o1=e.oTemplateContract.oFlexibleColumnLayoutHandler.displayMessagePage(i);}else{var p1=e.oRouter.getTargets();p1.display("messagePage");}W(o1);x(i);}function Y(){if(!q.isEmptyObject(m)){var g1=null;for(var i=0;!g1;i++){g1=m[i];}m={};X(g1);}}function Z(i){if(e.oTemplateContract.oFlexibleColumnLayoutHandler){i.viewLevel=i.viewLevel||0;m[i.viewLevel]=i;var g1=Promise.all([A,e.oTemplateContract.oPagesDataLoadedObserver.getProcessFinished(true)]);g1.then(Y);return;}X(i);}function $(){var i=[];var g1=k.iHashChangeCount;for(var h1 in o.componentRegistry){var i1=o.componentRegistry[h1];if(i1.activationTakt===g1){i.push(h1);}}return i;}function _(i,g1,h1){var i1=o.componentRegistry[h1.getId()]||{};var j1=(i1.activationTakt===g1.iHashChangeCount-1);i1.activationTakt=g1.iHashChangeCount;var k1;if(h1&&h1.onActivate){k1=h1.onActivate(i,j1);}return k1||i1.viewRegisterd;}function a1(i,g1,h1){return _(i,g1,h1).then(y);}function b1(i,g1,h1){var i1={};if(g1||h1){var j1=i.getParameter("config").viewLevel;var k1=o.oTemplatePrivateGlobalModel.getProperty("/generic/paginatorInfo");for(var l1=0;l1<j1;l1++){i1[l1]=k1[l1];}}o.oTemplatePrivateGlobalModel.setProperty("/generic/paginatorInfo",i1);}function c1(i){return o.oApplicationProxy.getAlternativeContextPromise(i);}function d1(i){if(o.oFlexibleColumnLayoutHandler){o.oFlexibleColumnLayoutHandler.handleBeforeRouteMatched(i);}}function e1(g1){o.oBusyHelper.setBusyReason("HashChange",false);g1=q.extend({},g1);var h1=g1.getParameter("config").viewLevel;var i1=e.oHashChanger.getHash()||"";q.sap.log.info("Route matched with hash "+i1);var j1;if(k.backwardingInfo){j1=k;p.push(j1);var k1=j1.iHashChangeCount+1;k={iHashChangeCount:k1,forwardingInfo:{bIsProgrammatic:true,bIsBack:true,iHashChangeCount:k1,backCount:j1.backwardingInfo.backCount,targetHash:j1.backwardingInfo.path,targetViewLevel:j1.backwardingInfo.targetViewLevel},backTarget:j1.backTarget};}if(k.forwardingInfo){if(k.forwardingInfo.backCount){k.backTarget=p[k.backTarget].backTarget;k.forwardingInfo.backCount--;if(k.forwardingInfo.backCount&&h1!==k.forwardingInfo.targetViewLevel){k.hash=i1;D();return;}delete k.forwardingInfo.backCount;}if((k.forwardingInfo.targetHash||k.forwardingInfo.targetHash==="")&&k.forwardingInfo.targetHash!==i1){k.hash=i1;var l1=k.forwardingInfo.targetHash;delete k.forwardingInfo.targetHash;E(l1,true);return;}}else{for(var i=0;i<o.aStateChangers.length;i++){var m1=o.aStateChangers[i];if(m1.isStateChange(g1)){k.hash=i1;return;}}}o.oTemplatePrivateGlobalModel.setProperty("/generic/routeLevel",h1);var n1=k.forwardingInfo;delete k.forwardingInfo;if(!n1){n1={};var o1=k.iHashChangeCount;n1.iHashChangeCount=o1+1;n1.bIsProgrammatic=(i1===k.targetHash);n1.bIsBack=!!(k.LeaveByBack||(!n1.bIsProgrammatic&&(h.getDirection()===b.Backwards)));k.LeaveByBack=n1.bIsBack;k.LeaveByReplace=n1.bIsProgrammatic&&k.LeaveByReplace;j1=k;p.push(j1);k={iHashChangeCount:n1.iHashChangeCount};if(j1.LeaveByReplace){k.backTarget=j1.backTarget;}else if(n1.bIsBack){k.backTarget=p[j1.backTarget].backTarget;}else{k.backTarget=o1;}b1(g1,n1.bIsProgrammatic,n1.bIsBack);}k.oEvent=g1;k.hash=i1;var p1=g1.getParameter("config");var q1=r.determinePath(p1,g1);var r1=h1<2?q1:r.determinePath(p1,g1,o.routeViewLevel1.pattern);c1(r1).then(function(s1){if(s1){var t1=g1.getParameter("arguments");var u1=t1["?query"];k.forwardingInfo=n1;U(s1.context,null,true,s1.iDisplayMode,u1||{});return;}if(o.oFlexibleColumnLayoutHandler){A=o.oFlexibleColumnLayoutHandler.handleRouteMatched(g1,p1,q1,n1);return;}o.oApplicationProxy.onRouteMatched(g1);if(p1.viewLevel===0||!(n1.bIsProgrammatic||n1.bIsBack)){o.oApplicationProxy.setEditableNDC(false);}var v1=p1.target;var w1=o.mRouteToTemplateComponentPromise[v1];A=new Promise(function(x1){w1.then(function(y1){a1(q1,n1,y1).then(x1);});});});}function f1(){o.oApplicationProxy.onBypassed();Z({title:o.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),replaceURL:true});}if(o.sRoutingType==="f"){e.oRouter.attachBeforeRouteMatched(d1);}e.oRouter.attachRouteMatched(e1);e.oRouter.attachBypassed(f1);e.navigate=E;e.navigateToParStringPromise=I;e.activateOneComponent=_;e.afterActivation=y;e.addUrlParameterInfoForRoute=z;e.getParStringPromise=G;e.performPseudoHashChange=W;e.getActiveComponents=$;e.getRootComponentPromise=l;e.getCurrenActivationTakt=v;e.getTargetLevel=R;return{navigateToRoot:K,navigateToContext:V,navigateToMessagePage:Z,navigateBack:D};}function j(o,e){var i={oAppComponent:e.oAppComponent,oRouter:e.oAppComponent.getRouter(),oTemplateContract:e,oHashChanger:H.getInstance(),mRouteToComponentResolve:{}};e.oNavigationControllerProxy=i;var k=new Promise(function(R){i.fnInitializationResolve=R;});e.oBusyHelper.setBusy(k);q.extend(o,g(e,i));q.extend(i,o);var v={};i.oRouter._oViews._getViewWithGlobalId=function(V){if(!v[V.viewName]){var R=i.oRouter.getRoute(V.viewName);var l;if(R&&R._oConfig){l=f(e,R._oConfig,i.mRouteToComponentResolve[V.viewName]);}else{l=sap.ui.view({viewName:V.viewName,type:V.type,height:"100%"});}v[V.viewName]=l;if(V.viewName==="root"){e.rootContainer=l;}}return v[V.viewName];};r.startupRouter(i);}var N=B.extend("sap.suite.ui.generic.template.lib.NavigationController",{metadata:{library:"sap.suite.ui.generic.template"},constructor:function(o){B.apply(this,arguments);t.testableStatic(j,"NavigationController")(this,o);}});N._sChanges="Changes";return N;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateAssembler')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateAssembler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.mvc.View');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateAssembler",["jquery.sap.global","sap/ui/core/mvc/View","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/suite/ui/generic/template/lib/TemplateViewController","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/lib/Application","sap/suite/ui/generic/template/lib/CRUDManager","sap/suite/ui/generic/template/lib/CommonUtils","sap/suite/ui/generic/template/lib/ComponentUtils","sap/suite/ui/generic/template/lib/CommonEventHandlers","sap/suite/ui/generic/template/lib/ViewDependencyHelper","sap/suite/ui/generic/template/lib/testableHelper"],function(q,V,J,R,T,a,A,C,b,c,d,e,t){"use strict";var m={};var f={};var r=function(o){var s=o.appComponent.getId();m[s]=o;return function(){delete m[s];};};function g(o){var s=o.getId();var k=m[s];return k;}function h(o){return g(o.getAppComponent()).oTemplateContract.componentRegistry[o.getId()];}function F(o){while(o&&!(o instanceof V)){o=o.getParent();}return o;}function G(o){while(o){var v=F(o);var k=v&&v.getController();var l=k&&k.getOwnerComponent();if(l instanceof a){var n=h(l);return n;}else{o=l&&l.oContainer;}}}function i(k,s,o,l,n){o=o||{};o.constructor=function(){T.prototype.constructor.apply(this,arguments);var M=k(l,this);this._templateEventHandlers=Object.freeze(M.handlers||{});this._templateFormatters=Object.freeze(M.formatters||{});this.extensionAPI=Object.freeze(M.extensionAPI||{});this.fnGenericOnInit=function(p){var v=p.getView();var u=v.getId();q.sap.log.info("Init view "+u+" of template "+s);var w=p.getOwnerComponent();var x=h(w);x.oControllerRegistryEntry={onExit:M.onExit||q.noop,oTemplateUtils:l,oAppRegistryEntry:n};f[u]=x.oControllerRegistryEntry;l.oServices.oApplicationController.registerView(v);l.oCommonUtils=new b(p,l.oServices,l.oComponentUtils);l.oServices.oCRUDManager=new C(p,l.oComponentUtils,l.oServices,l.oCommonUtils,n.oTemplateContract.oBusyHelper);l.oCommonEventHandlers=new d(p,l.oComponentUtils,l.oServices,l.oCommonUtils);(M.onInit||q.noop)();x.oController=this;x.fnViewRegisteredResolve();delete x.fnViewRegisteredResolve;};};o.onInit=function(){this.fnGenericOnInit(this);delete this.fnGenericOnInit;};o.onExit=function(){var v=this.getView().getId();var p=f[v];p.oAppRegistryEntry.oTemplateContract.oApplicationProxy.destroyView(v);p.onExit();delete f[v];q.sap.log.info("View "+v+" of template "+s+" exited");};return T.extend(s,o);}function j(o){var k=o.methods.oControllerSpecification;return k&&function(){var l=o.oComponent.getAppComponent();var n=g(l);var p=l.getTransactionController();var s={oComponentUtils:o.utils,oServices:{oTemplateCapabilities:{},oApplicationController:l.getApplicationController(),oTransactionController:p,oNavigationController:l.getNavigationController(),oDraftController:p.getDraftController(),oApplication:n.application,oViewDependencyHelper:n.oViewDependencyHelper}};return i(k.getMethods,o.oComponent.getTemplateName(),k.oControllerDefinition,s,n);};}r=t.testableStatic(r,"TemplateComponent_RegisterAppComponent");return{getTemplateComponent:function(k,s,o){var l=s+".Component";o=o||{};o.init=function(){var n=this.getComponentData().registryEntry;n.viewRegisterd=new Promise(function(p){n.fnViewRegisteredResolve=p;});n.oViewRenderdPromise=new Promise(function(p){n.fnViewRenderdResolve=p;});(a.prototype.init||q.noop).apply(this,arguments);n.componentName=l;n.oComponent=this;n.activationTakt=0;n.utils=new c(this,n);n.methods=k(this,n.utils)||{};n.oGenericData={mRefreshInfos:{}};(n.methods.init||q.noop)();};o.exit=function(){var I=this.getId();var n=h(this);var p=g(this.getAppComponent());var M=n.methods;(M.exit||q.noop)();delete p.oTemplateContract.componentRegistry[I];(a.prototype.exit||q.noop).apply(this,arguments);};o.onBeforeRendering=function(){var n=h(this);(a.prototype.onBeforeRendering||q.noop).bind(this,n).apply(this,arguments);var M=n.methods;(M.onBeforeRendering||q.noop)();};o.onAfterRendering=function(){var n=h(this);if(n.fnViewRenderdResolve&&!n.fnViewRegisteredResolve){n.fnViewRenderdResolve();delete n.fnViewRenderdResolve;}(a.prototype.onAfterRendering||q.noop).bind(this,n).apply(this,arguments);var M=n.methods;(M.onAftereRendering||q.noop)();};o.onActivate=function(B,I){var n=h(this);n.sCurrentBindingPath=B;var p=function(){n.utils.bindComponent(n.sCurrentBindingPath,I);var u=this.getIsRefreshRequired();if(u||!q.isEmptyObject(n.oGenericData.mRefreshInfos)){(n.methods.refreshBinding||q.noop)(u,u?{}:n.oGenericData.mRefreshInfos);this.setIsRefreshRequired(false);n.oGenericData.mRefreshInfos={};}return(n.methods.onActivate||q.noop)(B);}.bind(this);return n.fnViewRegisteredResolve?n.viewRegisterd.then(p):(p()||Promise.resolve());};o.setContainer=function(){a.prototype.setContainer.apply(this,arguments);var I=this.getId();var n=this.getAppComponent();var p=g(n);if(!p.oTemplateContract.componentRegistry[I]){var u=this.getComponentData();var v=u.registryEntry;delete u.registryEntry;v.componentCreateResolve(this);delete v.componentCreateResolve;p.oTemplateContract.componentRegistry[I]=v;p.oTemplateContract.oBusyHelper.setBusy(v.viewRegisterd,true);v.oApplication=p.application;v.createViewController=j(v);(v.methods.setContainer||q.noop)();}};o.onDeactivate=q.noop;return a.extend(l,o);},getRegisterAppComponent:function(){var k=r;r=null;return k;},getExtensionAPIPromise:function(o){var k=G(o);if(!k){return Promise.reject();}return k.viewRegisterd.then(function(){return k.oController.extensionAPI;});},getExtensionAPI:function(o){var k=G(o);return k&&k.oController&&k.oController.extensionAPI;}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar');jQuery.sap.require('sap.suite.ui.commons.HeaderContainer');jQuery.sap.require('sap.suite.ui.commons.HeaderCell');jQuery.sap.require('sap.suite.ui.commons.HeaderCellItem');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.ui.comp.odata.ODataModelUtil');jQuery.sap.require('sap.ui.comp.smartfilterbar.FilterProvider');jQuery.sap.require('sap.ui.comp.smartvariants.PersonalizableInfo');jQuery.sap.require('sap.ui.comp.smartvariants.SmartVariantManagement');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.ui.comp.odata.MetadataAnalyser');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/SmartVisualFilterBar",["sap/suite/ui/commons/HeaderContainer","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/suite/ui/commons/HeaderCell","sap/suite/ui/commons/HeaderCellItem","sap/m/Label","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/smartfilterbar/FilterProvider","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/VisualFilterProvider","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/model/Filter","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/Link","sap/ui/comp/odata/MetadataAnalyser","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(H,V,a,b,L,O,F,c,P,S,d,e,T,f,M,g,h){"use strict";var k=H.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar",{metadata:{properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},config:{type:"object",group:"Misc",defaultValue:null},persistencyKey:{type:"string",group:"Misc",defaultValue:null}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},events:{filterChange:{}}},renderer:{}});k.prototype.init=function(){if(H.prototype.init)H.prototype.init.apply(this,arguments);this.labelHeight=2.0;this.compHeight=7.9;this.cellHeightPadding=1;this.cellHeight=(this.labelHeight+this.compHeight+this.cellHeightPadding)+"rem";this.cellWidth=320;this._dialogFilters={};this._compactFilters={};this._oVariantConfig={};this._smartFilterContext;this.addStyleClass("sapSuiteVisualFilterBar");};k.prototype.propagateProperties=function(){H.prototype.propagateProperties.apply(this,arguments);this._initMetadata();};k.prototype._initMetadata=function(){if(!this.bIsInitialised)O.handleModelInit(this,this._onMetadataInit);};k.prototype._onMetadataInit=function(){if(this.bIsInitialised)return;this._annoProvider=this._createVisualFilterProvider();if(!this._annoProvider)return;this.bIsInitialised=true;this._updateFilterBar();};k.prototype._createVisualFilterProvider=function(){var m=this.getModel();var i=this.getEntitySet();if(!m||!i)return null;return new c(this);};k.prototype._getBasicGroupTitle=function(){return this.getModel("i18n").getResourceBundle().getText("VIS_FILTER_GRP_BASIC_TITLE");};k.prototype._getFieldGroupForProperty=function(E,C){return this._annoProvider?this._annoProvider._getFieldGroupForProperty(E,C):undefined;};k.prototype._getGroupList=function(){return this._annoProvider?this._annoProvider.getGroupList():[];};k.prototype._getGroupMap=function(){return this._annoProvider?this._annoProvider.getGroupMap():{};};k.prototype._getMeasureMap=function(){return this._annoProvider?this._annoProvider.getMeasureMap():{};};k.prototype._getDimensionMap=function(){return this._annoProvider?this._annoProvider.getDimensionMap():{};};k.prototype.setSmartFilterContext=function(C){this._smartFilterContext=C;};k.prototype._updateFilterBar=function(){var i=this._getAnnotationSettings();if(i&&i.filterList){var j=this._convertSettingsToConfig(i);}else{this.setConfig({filterCompList:[]});return;}var v=this._getVariantConfig();if(v&&v.config){j.filterCompList.forEach(function(l){if(v.config[l.component.properties.parentProperty]){jQuery.extend(true,l,v.config[l.component.properties.parentProperty]);}});this._oVariantConfig=j;return;}this.setConfig(j);return;};k.prototype._getAnnotationSettings=function(){return this._annoProvider?this._annoProvider.getVisualFilterConfig():null;};k.prototype._convertSettingsToConfig=function(s,I){var l={filterCompList:[]};var m=this._getGroupList();var n={};for(var i=0;i<m.length;i++){var o=m[i];for(var j=0;j<o.fieldList.length;j++){var p=o.fieldList[j];n[p.name]={name:o.name,label:o.label};}}var q=this._getGroupMap();var r=q["_BASIC"];var t=[];if(r&&r.fieldList){for(var i=0;i<r.fieldList.length;i++)t.push(r.fieldList[i].name);}var u=this._getMeasureMap(),v=s.filterList,w={};for(var i=0;i<v.length;i++){var x=v[i];var y=x.dimension.field;var z=u[x.collectionPath][x.measure.field];var A=false;if(z.fieldInfo[h.ISOCurrency]){A=true;}var C={shownInFilterBar:x.selected,component:{type:x.type,properties:{sortOrder:x.sortOrder,measureField:x.measure.field,parentProperty:x.parentProperty?x.parentProperty:undefined}}};if(!I){var B={shownInFilterDialog:x.selected||t.indexOf(y)!=-1,cellHeight:this.cellHeight,group:n[x.parentProperty],component:{cellHeight:this.compHeight+"rem",properties:{scaleFactor:x.scaleFactor,filterRestriction:x.filterRestriction,width:this.cellWidth+"px",height:this.compHeight+"rem",entitySet:x.collectionPath?x.collectionPath:this.getEntitySet(),dimensionField:y,dimensionFieldDisplay:x.dimension.fieldDisplay,dimensionFilter:x.dimensionFilter,measureSortDescending:x.measure.descending===true||x.measure.descending=="true",unitField:z?z.fieldInfo.unit:"",isCurrency:A,isMandatory:x.isMandatory,outParameter:x.outParameter?x.outParameter:undefined,inParameters:x.inParameters?x.inParameters:undefined}}};jQuery.extend(true,C,B);l.filterCompList.push(C);}else{w[x.parentProperty]=C;}}return I?w:l;};k.prototype._setVariantModified=function(){if(this._oVariantManagement)this._oVariantManagement.currentVariantSetModified(true);};k.prototype._onFilterChange=function(j){this._setVariantModified();var l=this.getItems();var m=[];for(var i=0;i<l.length;i++)m.push(l[i].getSouth().getContent());this.fireFilterChange({filterList:j.getParameter('filterList'),property:j.getParameter('property'),filterRestriction:j.getParameter('filterRestriction')});this._updateFilterItemList(m);};k.prototype._updateFilterItemList=function(j){var l=[];for(var i=0;i<j.length;i++){var m=j[i];var n=m.getDimensionFilter();if(!n)n=[];l.push({dimensionField:m.getDimensionField(),inParameters:m.getInParameters(),parentProperty:m.getParentProperty(),filterList:n,filterItem:m});}for(var i=0;i<l.length;i++){var m=l[i].filterItem;var o=this._combineFilterLists(l,i);m.setDimensionFilterExternal(o);}};k.prototype._combineFilterLists=function(i,j){var p={},l=(i.length>0&&i[j]&&i[j].inParameters)?i[j].inParameters:undefined,m=(i.length>0&&i[j]&&i[j].parentProperty)?i[j].parentProperty:undefined,n=[];var o=new sap.ui.model.Filter({aFilters:[],and:true});if(l){var r=function(t){t.sPath=v;};for(var q=(l.length-1);q>-1;q--){var s=l[q].localDataProperty,v=l[q].valueListProperty;if(s!==m&&n.indexOf(s)===-1){p=this._smartFilterContext.getFilters([s]);if(p&&p.length>0){if(p[0].aFilters){p[0].aFilters.forEach(r.bind(this));}else{r(p[0]);}n.push(s);o.aFilters.push(p[0]);}}}}return o;};k.prototype._createTitleToolbar=function(p,i){var t=new L({text:{path:"i18n>VIS_FILTER_TITLE_MD",formatter:function(){return i.getTitle();}}});var s=new f({text:{path:"_filter>/"+i.getParentProperty(),formatter:function(C){if(C){var l=0;if(typeof C==="object"){if(C.value){l++;}if(C.items){l+=C.items.length;}if(C.ranges){l+=C.ranges.length;}}else{l++;}var m=this.getModel("i18n");var r=m.getResourceBundle();return r.getText("VISUAL_FILTER_SELECTED_FILTERS",[l]);}return"";}},visible:{path:"_filter>/"+i.getParentProperty(),formatter:function(C){if(!C){return false;}if(typeof C==="object"){return(C.value||(C.items&&C.items.length)||(C.ranges&&C.ranges.length))?true:false;}else if(C){return true;}return false;}},enabled:"{= !${_templPriv>/alp/visualFilter/"+i.getParentProperty()+"/hasMultiUnit} }",press:function(l){V.launchAllFiltersPopup(s,i,l.getSource().getModel('i18n'));},layoutData:new sap.m.ToolbarLayoutData({shrinkable:false})});var j=new e({design:sap.m.ToolbarDesign.Transparent,width:this.cellWidth+"px",content:[t,new T(),s]});j.addStyleClass("alr_visualFilterTitleToolbar");return j;};k.prototype.getTitleByFilterItemConfig=function(i,u,s){var p=i.component.properties;var j=p.entitySet;var m=this.getModel();if(!m)return"";var l="/"+j+"/";var n=m.getData(l+p.measureField+"/#@sap:label");var o=m.getData(l+p.dimensionField+"/#@sap:label");if(!u)u="";if(!s)s="";var t="";var r=this.getModel("i18n").getResourceBundle();if(s&&u)t=r.getText("VIS_FILTER_TITLE_MD_UNIT_CURR",[n,o,s,u]);else if(u)t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[n,o,u]);else if(s)t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[n,o,s]);else t=r.getText("VIS_FILTER_TITLE_MD",[n,o]);return t;};k.prototype._onTitleChange=function(j){var s=j.getSource();var l=this.getItems();for(var i=0;i<l.length;i++){var m=l[i];var n=m.getSouth().getContent();if(n==s){var o=m.getNorth().getContent().getContent()[0];if(s.getProperty("isMandatory")){o.addStyleClass("sapMLabelRequired");}o.setText(n.getTitle());o.setTooltip(n.getTitle());break;}}};k.prototype._getSupportedFilterItemList=function(){if(!this._supportedFilterItemList){this._supportedFilterItemList=[{type:"Bar",className:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartBar",iconLink:"sap-icon://horizontal-bar-chart",textKey:"VISUAL_FILTER_CHART_TYPE_BAR"},{type:"Donut",className:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartDonut",iconLink:"sap-icon://donut-chart",textKey:"VISUAL_FILTER_CHART_TYPE_Donut"},{type:"Line",className:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemChartLine",iconLink:"sap-icon://line-charts",textKey:"VISUAL_FILTER_CHART_TYPE_Line"}];}return this._supportedFilterItemList;};k.prototype._getSupportedFilterItemMap=function(){if(!this._supportedFilterItemMap){this._supportedFilterItemMap={};var j=this._getSupportedFilterItemList();for(var i=0;i<j.length;i++){var l=j[i];this._supportedFilterItemMap[l.type]=l;}}return this._supportedFilterItemMap;};k.prototype.setConfig=function(j,s,l){var m=this.getProperty("config");this.setProperty("config",j);this.removeAllItems();if(!j.filterCompList){jQuery.sap.log.warning("Expecting a filterCompList as part of the configuration");return;}var n=this._getDimensionMap();var o=[];for(var i=0;i<j.filterCompList.length;i++){var p=j.filterCompList[i];if(!p.shownInFilterBar)continue;var q=p.component;q.type=this._resolveChartType(q.type);var r=jQuery.extend({},q.properties);var t=n[r.entitySet][r.dimensionField];r.dimensionFieldIsDateTime=t?t.fieldInfo.type=="Edm.DateTime":false;var u=this._createFilterItemOfType(q.type,r);u.setModel(this.getModel());u.setModel(this.getModel("_templPriv"),"_templPriv");if(u.attachFilterChange)u.attachFilterChange(this._onFilterChange,this);if(u.attachTitleChange)u.attachTitleChange(this._onTitleChange,this);var v=this._createTitleToolbar(r,u);var w=new a({height:p.cellHeight,north:new b({height:this.labelHeight+"rem",content:v}),south:new b({height:q.cellHeight,content:u})});o.push(u);this.addItem(w);}if(m&&!s){this.fireFilterChange({filterItemList:o});}if(!l){this._updateFilterItemList(o);}};k.prototype._resolveChartType=function(t){var i=this._getSupportedFilterItemMap();var j=i[t];if(!j){var l;for(l in i){j=i[l];break;}jQuery.sap.log.error("Could not resolve the filter component type: \""+t+"\", falling back to "+l);t=l;}return t;};k.prototype._createFilterItemOfType=function(t,p){var i=this._getSupportedFilterItemMap();var j=i[t];var l=j.className;jQuery.sap.require(l);var m=jQuery.sap.getObject(l);var n=new m(p);return n;};k.prototype.getConfig=function(I){var j=this.getProperty("config"),v={};if(!j)return{filterCompList:[]};var l=0;var m=this.getItems();for(var i=0;i<j.filterCompList.length;i++){var n=j.filterCompList[i];if(I){v[n.component.properties.parentProperty]={shownInFilterBar:n.shownInFilterBar,component:{type:n.component.type,properties:{measureField:n.component.properties.measureField,sortOrder:n.component.properties.sortOrder,parentProperty:n.component.properties.parentProperty}}};}else{if(!n.shownInFilterBar)continue;var o=m[l];if(!o){jQuery.sap.log.error("The configured selected filter bar items do not correspond to the actual filter bar items.  Could be an error during initialization, e.g. a chart class not found");return{filterCompList:[]};}l++;var p=o.getSouth().getContent();n.component.properties=p.getP13NConfig();}}return I?v:j;};k.prototype.setSmartVariant=function(s){this.setAssociation("smartVariant",s);if(s){var p=new P({type:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar",keyName:"persistencyKey"});p.setControl(this);}this._oVariantManagement=this._getVariantManagementControl(s);if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(p);this._oVariantManagement.initialise(this._variantInitialised,this);this._oVariantManagement.attachSave(this._onVariantSave,this);}else if(s){if(typeof s==="string")jQuery.sap.log.error("Variant with id="+s+" cannot be found");else if(s instanceof sap.ui.core.Control)jQuery.sap.log.error("Variant with id="+s.getId()+" cannot be found");}else{jQuery.sap.log.error("Missing SmartVariant");}};k.prototype._getVariantManagementControl=function(s){var o=null;if(s){o=typeof s=="string"?sap.ui.getCore().byId(s):s;if(o&&!(o instanceof S)){jQuery.sap.log.error("Control with the id="+s.getId?s.getId():s+" not of expected type");return null;}}return o;};k.prototype._variantInitialised=function(){if(!this._oCurrentVariant)this._oCurrentVariant="STANDARD";};k.prototype._onVariantSave=function(){if(this._oCurrentVariant=="STANDARD")this._oCurrentVariant={config:this.getConfig(true)};};k.prototype.applyVariant=function(v,C){this._oCurrentVariant=v;if(this._oCurrentVariant=="STANDARD")this._oCurrentVariant=null;if(this._oCurrentVariant&&this._oCurrentVariant.config&&this._oCurrentVariant.config.filterCompList){this._oCurrentVariant.config=null;}if(this._oCurrentVariant&&this._oCurrentVariant.config==null){var i=this._getAnnotationSettings();if(i&&i.filterList){this._oCurrentVariant.config=this._convertSettingsToConfig(i,true);}}this._updateFilterBar();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};k.prototype._getVariantConfig=function(){return this._oCurrentVariant;};k.prototype.fetchVariant=function(){if(!this._oCurrentVariant||this._oCurrentVariant=="STANDARD"){var i=this._getAnnotationSettings();if(i&&i.filterList){this._oCurrentVariant={config:this._convertSettingsToConfig(i,true)};return this._oCurrentVariant;}else{return{config:null};}}return{config:this.getConfig(true)};};k.prototype.clearFilters=function(){var j=this.getProperty('config');for(var i=0;i<j.filterCompList.length;i++){var l=j.filterCompList[i];l.component.properties.dimensionFilter=[];}this.setConfig(j);};k.prototype.mergeCompactFilters=function(j,I){this._compactFilters={};if(!j){return;}this._compactFilters=j;var A,D={},p=[];var C=(I&&g.readProperty(this,"_oVariantConfig.filterCompList.length"))?this._oVariantConfig:this.getConfig();if(Object.keys(C).length<0){jQuery.sap.log.error('Config not ready for visual filter');return;}if(C&&C.filterCompList.length>0){A=C.filterCompList;for(var i=0;i<A.length;i++){var o=A[i].component.properties,s=o.outParameter,l=o.parentProperty,m=[];o.dimensionFilter=[];if(s){var m=[];if(this._compactFilters[s]){p.push(s);m=this._addToFiltersFromCompact(s);}}o.dimensionFilter=m;D[l]=m;}}this.setConfig(C,true);};k.prototype._addToFiltersFromCompact=function(p){var i=[],I=this._compactFilters[p]&&(typeof this._compactFilters[p]!=='object'),l=this._compactFilters[p].items,m=this._compactFilters[p].ranges,n=this._compactFilters[p].value;if(this._compactFilters[p].low){var s=this._compactFilters[p].low;if(this._compactFilters[p].high){s+="-"+this._compactFilters[p].high;}i.push({dimValue:s,dimValueDisplay:s});}if(I){i.push({dimValue:this._compactFilters[p],dimValueDisplay:this._compactFilters[p]});}if(l){for(var j=0;j<l.length;j++){i.push({dimValue:l[j].key,dimValueDisplay:l[j].text});}}if(m){for(var j=0;j<m.length;j++){i.push({dimValue:m[j].tokenText?m[j].tokenText:g.createTitleFromCode(m[j]),dimValueDisplay:m[j].tokenText,keyField:m[j].keyField,operation:m[j].operation,tokenText:m[j].tokenText,value1:m[j].value1,value2:m[j].value2});}}if(n){i.push({dimValue:n,dimValueDisplay:n,bIsUserTypedIn:true});}return i;};return k;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController');jQuery.sap.require('sap.m.SegmentedButtonItem');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/FilterBarController",["sap/m/SegmentedButtonItem","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/m/Dialog","sap/m/SegmentedButton","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(S,B,a,T,D,b,V,C,F){"use strict";var c="visual",d="compact";var f=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController",{init:function(s){this.compactFilterData={};var m=this;var e=s.oController.getOwnerComponent().getDefaultFilterMode();m.oState=s;m.oState.oSmartFilterbar.attachSwitchToVisualFilter(function(){var o=m.oState.oSmartFilterbar.getFilterData();m.compactFilterData=jQuery.extend(true,{},o);m.oState.alr_visualFilterBar.mergeCompactFilters(o);m.oState.visualFilterDialogContainer.launchDialog();});if(e===c&&m.oState.hideVisualFilter){jQuery.sap.log.error("Visual filter is hidden defaulting to compact");e=d;}var g=m.oState.oController.getOwnerComponent().getShowGoButtonOnFilterBar()?true:false;s.oSmartFilterbar.setShowGoOnFB(g);s.oSmartFilterbar.setLiveMode(!g);s.oSmartFilterbar.setShowMessages(g);s.oSmartTable.setEnableAutoBinding(!g);s.oSmartFilterbar.attachFilterChange(function(E){var i=E.getSource();var j=this.oState.oController.getOwnerComponent().getModel("_filter");j.setData(i.getFilterData());if(this.oState.alr_visualFilterBar){var o=this.oState.oSmartFilterbar.getFilterData();this.oState.alr_visualFilterBar.mergeCompactFilters(o);}}.bind(this));s.oSmartFilterbar.attachSearch(function(E){this.oState.oSmartChart.getToolbar().setEnabled(true);this.oState.oSmartTable.getCustomToolbar().setEnabled(true);},this);m.oState.oSmartFilterbar._oFiltersButton.setVisible(false);s.oHeader=s.oPage.getHeader();s.oTitle=s.oPage.getTitle();var h=function(){if(!this.oState.oPage.getHeaderExpanded())this.oState.alr_visualFilterToolbar.addContent(this.filterSwitch);else this.oState.alr_visualFilterToolbar.removeContent(this.filterSwitch);s.oTitle.detachEvent("_titlePress",h);};s.oTitle.attachEvent("_titlePress",h,this);if(s.oSmartFilterbar){s.oSmartFilterbar.addStyleClass("alrFilterbar");}if(s.oKpiTagContainer){s.alr_filterContainer.removeContent(s.oKpiTagContainer);s.oKpiTagContainer.addStyleClass("alrKpiTagContainer");}if(s.alr_visualFilterBar){s.alr_visualFilterBar.setSmartFilterContext(this.oState.oSmartFilterbar);s.alr_visualFilterBar.attachFilterChange(this._onVisualFilterChange.bind(this));}s.oSmartFilterbar.attachAfterVariantLoad(this._afterVariantLoad.bind(this));},_afterVariantLoad:function(e){if(this.oState.alr_visualFilterBar){var o=this.oState.oSmartFilterbar.getFilterData();this.oState.alr_visualFilterBar.mergeCompactFilters(o,true);}if(this.oState.oSmartFilterbar.isLiveMode()&&e.mParameters.context!="INIT"){this.oState.oSmartFilterbar.search();}},_onVisualFilterChange:function(e){var g,p,s,h,P,o=this,i=o.oState.oSmartFilterbar.getFilterData(true),r=e.getParameter('bRestoreCompactFilter');if(e.getParameter('filterItemList')){h=e.getParameter('filterItemList');h.forEach(function(k){g=k.getDimensionFilter();p=k.getParentProperty();s=k.getFilterRestriction();if(i){P=i[p]?i[p]:(i[p]!==undefined);}if(P){P=o._modifyCompactFilterData(g,s,p,P);i[p]=P;}});}else{g=e.getParameter('filterList');p=e.getParameter('property');s=e.getParameter('filterRestriction');if(i){P=i[p]?i[p]:(i[p]!==undefined);}if(P){P=this._modifyCompactFilterData(g,s,p,P);i[p]=P;}}if(r){this.oState.oSmartFilterbar.setFilterData(this.compactFilterData,true);if(this.compactFilterData['_CUSTOM']&&Object.keys(this.compactFilterData).length===1){var i=this.oState.oSmartFilterbar.getFilterData(),j=this.oState.oController.getOwnerComponent().getModel("_filter");this.oState.alr_visualFilterBar.mergeCompactFilters(i);j.setData(i);}}else{this.oState.oSmartFilterbar.setFilterData(i);}if(this.oState.oSmartFilterbar.isLiveMode())this.oState.oSmartFilterbar.search();},_modifyCompactFilterData:function(e,s,p,P){if(s==="multiple"){if(P){P.items=[];P.ranges=[];P.value=null;if(e&&e.length>0){e.forEach(function(g,i,h){if(g.tokenText){P.ranges.push({keyField:g.keyField,operation:g.operation,tokenText:g.tokenText,value1:g.value1,value2:g.value2});}else if(g.bIsUserTypedIn){P.value=g.dimValue;}else{P.items.push({key:g.dimValue,text:F.createTitle(g.dimValueDisplay,g.dimValue)});}});}}}else{P=null;if(e.length>0){P=e[0].dimValue;}}return P;},onGoFilter:function(){this.oState.oSmartFilterbar.search();},setDefaultFilter:function(m){var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");t.setProperty('/alp/filterMode',m);this.handleFilterSwitch(m);},createFilterSwitch:function(){var m=this,e=[new S({icon:"sap-icon://filter-fields",width:"inherit",key:d,tooltip:"{i18n>FILTER_COMPACT}"}),new S({icon:"sap-icon://filter-analytics",width:"inherit",key:c,tooltip:"{i18n>FILTER_VISUAL}"})];var g=new b({width:"inherit",selectedKey:"{_templPriv>/alp/filterMode}",items:e,layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow})});g.attachSelect(function(h){m.handleFilterSwitch(h.getParameter("key"),h.oSource._bApplyingVariant);m.oState.oController._templateEventHandlers.onSegmentButtonPressed();});return g;},handleFilterSwitch:function(m,A){var e=this,t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(!e.oState.filterSwitch&&!e.oState.hideVisualFilter){e.oState.filterSwitch=e.createFilterSwitch();e.oState.alr_visualFilterToolbar.addContent(e.oState.filterSwitch);}if(!e.oState.alr_visualFilterBar){t.setProperty('/alp/filterMode',d);}if(t.getProperty('/alp/filterMode')==c){e.oState.alr_compactFilterContainer.addStyleClass("sapUiHidden");e.oState.alr_visualFilterContainer.removeStyleClass("sapUiHidden");}else if(t.getProperty('/alp/filterMode')==d){if(e.oState.oSmartFilterbar._oToolbar)e.oState.oSmartFilterbar._oToolbar.addStyleClass("sapUiHidden");if(!e.oState.hideVisualFilter){e.oState.alr_visualFilterContainer.addStyleClass("sapUiHidden");}e.oState.alr_compactFilterContainer.removeStyleClass("sapUiHidden");}e.oState.oSmartFilterbar.setMode(m);},showDialog:function(){var m=this,t=m.oState.oController.getOwnerComponent().getModel("_templPriv");if(t.getProperty('/alp/filterMode')===d){m.oState.oSmartFilterbar.showFilterDialog();}else if(t.getProperty('/alp/filterMode')===c){this.compactFilterData=jQuery.extend(true,{},this.oState.oSmartFilterbar.getFilterData());m.oState.visualFilterDialogContainer.launchDialog.call(m.oState.visualFilterDialogContainer);}},clearFilters:function(){var m=this,t=m.oState.oController.getOwnerComponent().getModel("_templPriv");if(t.getProperty('/alp/filterMode')===d){var o=m.oState.oSmartFilterbar.getFilterData();for(var p in o){if(o.hasOwnProperty(p)){delete o[p];}}m.oState.oSmartFilterbar.setFilterData(o,true);}else if(t.getProperty('/alp/filterMode')===c){m.oState.alr_visualFilterBar.clearFilters();}this.oState.chartController.updateTable();}});return f;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.Component');sap.ui.define("sap/suite/ui/generic/template/ListReport/Component",["sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/ListReport/controller/ControllerImplementation"],function(T,C){"use strict";function g(c,o){var v={};return{oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{getVisibleSelectionsWithDefaults:function(){var V=[];return V;},onInitSmartFilterBarExtension:function(e){},getCustomAppStateDataExtension:function(a){},restoreCustomAppStateDataExtension:function(a){},onBeforeRebindTableExtension:function(e){},adaptNavigationParameterExtension:function(s,O){},onListNavigationExtension:function(e){}}},init:function(){var t=c.getModel("_templPriv");t.setProperty("/listReport",{});},onActivate:function(){o.setBackNavigation(undefined);v.onComponentActivate();},refreshBinding:function(u){v.refreshBinding();},getUrlParameterInfo:function(){return v.getUrlParameterInfo();}};}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.ListReport",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ListReport.view.ListReport"},"treeTable":"boolean","gridTable":"boolean","condensedTableLayout":"boolean","multiSelect":"boolean","smartVariantManagement":"boolean","hideTableVariantManagement":"boolean"},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.Component');jQuery.sap.require('sap.m.DraftIndicatorState');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/Component",["sap/m/DraftIndicatorState","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/ObjectPage/controller/ControllerImplementation"],function(D,T,a,C){"use strict";function g(c,o){var v={};var h;return{oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{adaptNavigationParameterExtension:function(s,O){},onBeforeRebindTableExtension:function(e){}}},init:function(){var t=o.getTemplatePrivateModel();t.setProperty("/objectPage",{displayMode:0});},getTemplateSpecificParameters:function(){return{breadCrumb:o.getBreadCrumbInfo()};},getTitle:function(){if(!h){var m=c.getModel().getMetaModel();var M=m.getODataEntitySet(c.getEntitySet());var d=m.getODataEntityType(M.entityType);var H=d["com.sap.vocabularies.UI.v1.HeaderInfo"];h=(H&&H.TypeName&&H.TypeName.String)||"";if(h.substr(0,7)==="{@i18n>"){var s=h.substring(1,h.length-1);var S=s.split(">");h=c.getModel(S[0]).getResourceBundle().getText(S[1]);}}return h;},onActivate:function(b){var u=c.getModel("ui");var t=o.getTemplatePrivateModel();if(o.getEditableNDC()){u.setProperty("/editable",true);var d=o.isNonDraftCreate();u.setProperty("/createMode",d);t.setProperty("/objectPage/displayMode",d?4:2);}else if(!v.isDraftEnabled()){u.setProperty("/editable",false);u.setProperty("/createMode",false);t.setProperty("/objectPage/displayMode",1);}v.onComponentActivate(b);},refreshBinding:function(u,r){if(u){var e=c.getComponentContainer().getElementBinding();if(e){e.refresh(true);}}else{v.refreshFacets(r);}},presetDisplayMode:function(d,i){if(i){return;}var t=o.getTemplatePrivateModel();t.setProperty("/objectPage/displayMode",d);},updateBindingContext:function(){var b=c.getBindingContext();var t=o.getTemplatePrivateModel();var d=o.registerContext(b);t.setProperty("/generic/draftIndicatorState",D.Clear);v.refreshFacets(null,true);var A=b.getObject();var u=c.getModel("ui");var i;if(d.bIsDraft){i=true;u.setProperty("/enabled",true);t.setProperty("/objectPage/displayMode",d.bIsCreate?4:2);}else{i=o.getEditableNDC();t.setProperty("/objectPage/displayMode",i?2:1);var e=c.getAppComponent().getTransactionController().getDraftController();var f=e.getDraftContext();if(A.hasOwnProperty("HasDraftEntity")&&A.HasDraftEntity&&f.hasSiblingEntity(c.getEntitySet())){u.setProperty("/enabled",false);var m=c.getModel();var r=new Promise(function(R,j){m.read(b.getPath(),{urlParameters:{"$expand":"SiblingEntity,DraftAdministrativeData"},success:R,error:j});});var B=o.getBusyHelper();B.setBusy(r);r.then(function(R){var s=m.getContext("/"+m.getKey(R.SiblingEntity));if(s){v.draftResume(s,A,R.DraftAdministrativeData);}u.setProperty("/enabled",true);},function(E){});}else{u.setProperty("/enabled",true);}}u.setProperty("/createMode",d.bIsCreate);u.setProperty("/editable",i);}};}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.ObjectPage",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ObjectPage.view.Details"},"showRelatedApps":{"type":"boolean","defaultValue":"false"},"editableHeaderContent":{"type":"boolean","defaultValue":"false"},"gridTable":"boolean","sections":"object"},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.extensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.extensionAPI');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/extensionAPI",["sap/suite/ui/generic/template/lib/TemplateAssembler"],function(T){"use strict";return{getExtensionAPI:function(c){return T.getExtensionAPI(c);},getExtensionAPIPromise:function(c){return T.getExtensionAPIPromise(c);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.AppComponent')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.AppComponent');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.NavContainer');jQuery.sap.require('sap.f.FlexibleColumnLayout');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.generic.app.ApplicationController');sap.ui.define("sap/suite/ui/generic/template/lib/AppComponent",["jquery.sap.global","sap/ui/core/UIComponent","sap/m/NavContainer","sap/f/FlexibleColumnLayout","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/generic/app/ApplicationController","sap/suite/ui/generic/template/lib/Application","sap/suite/ui/generic/template/lib/BusyHelper","sap/suite/ui/generic/template/lib/NavigationController","sap/suite/ui/generic/template/lib/ProcessObserver","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/ViewDependencyHelper","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/library"],function(q,U,N,F,J,R,A,a,B,b,P,T,C,V,t){"use strict";A=t.observableConstructor(A);var D=sap.m.DraftIndicatorState;var r=T.getRegisterAppComponent();var o;function g(){o=o||new R({bundleName:"sap/suite/ui/generic/template/lib/i18n/i18n"}).getResourceBundle();return o.getText.apply(o,arguments);}function c(){return new P({processObservers:[]});}function d(e,f){var h={oAppComponent:e,componentRegistry:{},aRunningSideEffectExecutions:[],getText:g,mRouteToTemplateComponentPromise:{},oTemplatePrivateGlobalModel:(new J()).setDefaultBindingMode("TwoWay"),aStateChangers:[]};var j;var n;var k;function l(){h.oTemplatePrivateGlobalModel.setProperty("/generic",{draftIndicatorState:D.Clear,hasOwnTitle:false,paginatorInfo:{},forceFullscreenCreate:false});e.setModel(h.oTemplatePrivateGlobalModel,"_templPrivGlobal");h.oNoOwnTitlePromise.then(function(i){h.oTemplatePrivateGlobalModel.setProperty("/generic/hasOwnTitle",!i);});}function m(){j.attachEvent("beforeSideEffectExecution",function(K){if(K.getParameter("valueChange")||K.getParameter("fieldControl")){var L=K.getParameter("promise");h.oBusyHelper.setBusy(L);var i=0;for(;h.aRunningSideEffectExecutions[i];){i++;}h.aRunningSideEffectExecutions[i]=L;var M=function(){h.aRunningSideEffectExecutions[i]=null;};L.then(M,M);}});var G=e.getModel("_templPrivGlobal");var H="/generic/draftIndicatorState";j.attachBeforeQueueItemProcess(function(i){if(i.draftSave){G.setProperty(H,D.Saving);}});j.attachOnQueueCompleted(function(){if(G.getProperty(H)===D.Saving){G.setProperty(H,D.Saved);}});j.attachOnQueueFailed(function(){if(G.getProperty(H)===D.Saving){G.setProperty(H,D.Clear);}});G.setProperty("/generic/appComponentName",e.getMetadata().getComponentName());}function p(M){M.attachPropertyChange(function(i){C.propertyChange(i.getParameter("path"),i.getParameter("context"),h,e);});}function s(){var i={appComponent:e,oTemplateContract:h,application:new a(h),oViewDependencyHelper:new V(h)};var S=sap.ui.core.service.ServiceFactoryRegistry.get("sap.ushell.ui5service.ShellUIService");var G=S&&S.createInstance();h.oNoOwnTitlePromise=G?G.then(function(H){h.oShellService=H;return H.getUxdVersion()===2;}):Promise.resolve(false);(U.prototype.init||q.noop).apply(e,arguments);h.oBusyHelper.setBusy(h.oNoOwnTitlePromise);k=r(i);var M=e.getModel();j=new A(M);l();n=new b(h);m();p(M);if((!M.oMetadata||!M.oMetadata.isLoaded())||M.oMetadata.isFailed()){M.attachMetadataFailed(function(){n.navigateToMessagePage({title:g("ST_GENERIC_ERROR_TITLE"),text:g("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE"),icon:"sap-icon://message-error",description:g("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC")});for(var H in h.componentRegistry){h.componentRegistry[H].fnViewRegisteredResolve();}});}h.oBusyHelper.setBusyReason("initAppComponent",false);}function u(){if(h.oNavigationHost){return"";}if(h.sRoutingType==="f"){var i=new F();h.oNavigationHost=i;h.aNavigationObservers=[new P({processName:"BeginColumnNavigation",eventHandlers:{attachProcessStart:i.attachBeginColumnNavigate.bind(i),attachProcessStop:i.attachAfterBeginColumnNavigate.bind(i)}}),new P({processName:"MidColumnNavigation",eventHandlers:{attachProcessStart:i.attachMidColumnNavigate.bind(i),attachProcessStop:i.attachAfterMidColumnNavigate.bind(i)}}),new P({processName:"EndColumnNavigation",eventHandlers:{attachProcessStart:i.attachEndColumnNavigate.bind(i),attachProcessStop:i.attachAfterEndColumnNavigate.bind(i)}})];h.oNavigationObserver=new P({processObservers:h.aNavigationObservers});h.aHeaderLoadingObservers=[c(),c(),c()];}else{var G=new N({id:e.getId()+"-appContent"});h.oNavigationHost=G;h.oNavigationObserver=new P({processName:"Navigation",eventHandlers:{attachProcessStart:G.attachNavigate.bind(G),attachProcessStop:G.attachAfterNavigate.bind(G)}});h.oNavigationHost.attachAfterNavigate(h.oApplicationProxy.onAfterNavigate);}h.oHeaderLoadingObserver=new P({processObservers:h.aHeaderLoadingObservers||[]});h.oPagesDataLoadedObserver=new P({processObservers:[h.oHeaderLoadingObserver,h.oNavigationObserver]});h.oNavigationHost.addStyleClass(h.oApplicationProxy.getContentDensityClass());h.oBusyHelper=new B(h);h.oBusyHelper.setBusyReason("initAppComponent",true,true);return h.oNavigationHost;}function v(){if(h.oNavigationHost){h.oNavigationHost.destroy();}if(j){j.destroy();}if(n){n.destroy();}(U.prototype.exit||q.noop).apply(e,arguments);k();t.endApp(f);}function w(i){var G=Object.keys(i).map(function(H){var K=i[H];if(K.pages){K.pages=w(K.pages);}return i[H];});return G;}var x;function y(){if(!x){var M=e.getMetadata();x=M.getManifestEntry("sap.ui.generic.app");if(x._version==="1.3.0"&&x.pages&&q.isPlainObject(x.pages)){x.pages=w(x.pages);}}return x;}var I;function z(){if(!I){I=q.extend({},e.getMetadata().getManifest());I["sap.ui.generic.app"]=y();}return I;}function E(){var M=e.getManifestObject();var S=M.getEntry("sap.ui.generic.app").settings;h.sRoutingType=(S&&S.flexibleColumnLayout)?"f":"m";return"sap."+h.sRoutingType+".routing.Router";}return{init:s,createContent:u,exit:v,_getRouterClassName:E,getConfig:y,getInternalManifest:z,getTransactionController:function(){return j.getTransactionController();},getApplicationController:function(){return j;},getNavigationController:function(){return n;}};}return U.extend("sap.suite.ui.generic.template.lib.AppComponent",{metadata:{config:{title:"SAP UI Application Component",fullWidth:true},properties:{forceGlobalRefresh:{type:"boolean",defaultValue:true}},events:{pageDataLoaded:{}},routing:{config:{async:true,viewType:"XML",viewPath:"",clearTarget:false},routes:[],targets:[]},library:"sap.suite.ui.generic.template"},constructor:function(){var e=t.startApp();q.extend(this,d(this,e));(U.prototype.constructor||q.noop).apply(this,arguments);}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.ObjectIdentifier');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.table.Table');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.analytics.odata4analytics');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/ControllerImplementation",["jquery.sap.global","sap/ui/base/Object","sap/ui/model/json/JSONModel","sap/m/ObjectIdentifier","sap/m/Table","sap/m/Text","sap/ui/comp/smartfield/SmartField","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ui/base/EventProvider","sap/suite/ui/generic/template/AnalyticalListPage/extensionAPI/ExtensionAPI","sap/ui/core/ResizeHandler","sap/suite/ui/generic/template/AnalyticalListPage/controller/SmartChartController","sap/suite/ui/generic/template/AnalyticalListPage/controller/DetailController","sap/suite/ui/generic/template/AnalyticalListPage/controller/FilterBarController","sap/suite/ui/generic/template/AnalyticalListPage/controller/ToolbarController","sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiTagController","sap/suite/ui/generic/template/AnalyticalListPage/control/KpiTag","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterBarController","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/suite/ui/generic/template/lib/MessageUtils","sap/m/MessageBox","sap/ui/table/Table","sap/ui/table/AnalyticalTable","sap/ui/model/odata/AnnotationHelper","sap/ui/model/analytics/odata4analytics","sap/suite/ui/generic/template/AnalyticalListPage/util/ModelUtil"],function(q,B,J,O,T,a,S,b,E,c,R,d,D,F,f,K,g,V,h,M,j,U,A,k,l,m){"use strict";var n="sap.suite.ui.generic.template.customData",o="sap.suite.ui.generic.template.genericData",C="chart",p="visual",r="Filter";function N(e){if(e){for(var P in e){e[P]=null;}}}return{getMethods:function(t,s){var u=new E();var v;var w={attachSearchButtonPressed:function(e,i,$){return u.attachEvent("SearchButtonPressed",e,i,$);},detachSearchButtonPressed:function(e,i){return u.detachEvent("SearchButtonPressed",e,i);},fireSearchButtonPressed:function(e){return u.fireEvent("SearchButtonPressed",e);}};function x(){var e={};e[n]={};var i=w.oController.getOwnerComponent().getModel("_templPriv");e[o]={chartVariantId:w.oSmartChart&&w.oSmartChart.getCurrentVariantId(),filterMode:i.getProperty('/alp/filterMode'),contentView:i.getProperty('/alp/contentView'),autoHide:i.getProperty('/alp/autoHide')};var $=s.byId("editStateFilter");if($){e[o].editStateFilter=$.getSelectedKey();}s.getCustomAppStateDataExtension(e[n]);return e;}function y(){var e=new b(w.oSmartFilterbar.getDataSuiteFormat());var $=s.getVisibleSelectionsWithDefaults();for(var i=0;i<$.length;i++){if(!e.getValue($[i])){e.addSelectOption($[i],"I","EQ","");}}return{selectionVariant:e.toJSONString(),tableVariantId:w.oSmartTable.getCurrentVariantId(),customData:x()};}function z(e){e=e||y();try{t.oCommonUtils.getNavigationHandler().storeInnerAppState(e);}catch(i){q.sap.log.error("AnalyticalListPage.fnStoreCurrentAppStateAndAdjustURL: "+i);}}function G(){var e=s.getOwnerComponent();var i=e.getModel("_templPriv");i.setProperty("/listReport/isLeaf",e.getIsLeaf());}function H(){var e=q.sap.getObject("sap.ushell.Container.getUser");var i=s.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui");var $=(i&&i.icons&&i.icons.icon)||"";var _={bookmarkIcon:$,bookmarkCustomUrl:function(){z();return hasher.getHash()?("#"+hasher.getHash()):window.location.href;},bookmarkServiceUrl:function(){var b1=w.oSmartTable.getTable();var c1=b1.getBinding("rows")||b1.getBinding("items");return c1?c1.getDownloadUrl()+"&$top=0&$inlinecount=allpages":"";},isShareInJamActive:!!e&&e().isJamActive()};var a1=s.getOwnerComponent().getModel("_templPriv");a1.setProperty("/listReport/share",_);}function I(e){if(e&&e.editStateFilter!==undefined){var i=s.byId("editStateFilter");if(i){i.setSelectedKey((e.editStateFilter===null)?0:e.editStateFilter);}}var $=w.oController.getOwnerComponent().getModel("_templPriv");if(e.chartVariantId){w.oSmartChart.setCurrentVariantId(e.chartVariantId);}if(e.filterMode){$.setProperty('/alp/filterMode',e.filterMode);w.filterBarController.handleFilterSwitch(e.filterMode);}if(e.contentView){$.setProperty('/alp/contentView',e.contentView);}if(e.autoHide){$.setProperty('/alp/autoHide',e.autoHide);}}function L(e){s.restoreCustomAppStateDataExtension(e||{});}function P(e){e=e||{};if(e.hasOwnProperty(n)&&e.hasOwnProperty(o)){I(e[o]);L(e[n]);}else{if(e._editStateFilter!==undefined){I({editStateFilter:e._editStateFilter});delete e._editStateFilter;}L(e);}}var Q;function W(e,i){var $=e&&e.property;return $.filter(function(_){return typeof _[i]!=="undefined";});}function X(i){var $=i.getModel(),_=$&&$.getMetaModel(),a1=_&&_.getODataEntityType(i.getEntityType()),b1=_&&_.getODataEntityType(i.getEntityType(),true),c1=a1&&W(a1,"com.sap.vocabularies.Common.v1.FilterDefaultValue"),d1,e1,f1,g1,h1,i1,j1=[];try{e1=new l.Model(new l.Model.ReferenceByModel($));i1=e1&&e1.findQueryResultByName(i.getEntitySet());f1=i1&&i1.getParameterization();g1=f1&&_.getODataEntitySet(f1.getEntitySet().getQName());h1=g1&&_.getODataEntityType(g1.entityType);j1=h1?W(h1,"defaultValue"):[];}catch(e){q.sap.log.Error(e);}if(c1.length>0||j1.length>0){d1={"SelectOptions":[],"Parameters":[]};c1.forEach(function(k1){var l1=_.createBindingContext(b1+"/property/[${path:'name'}===\'"+k1.name+"']/com.sap.vocabularies.Common.v1.FilterDefaultValue"),m1={"PropertyName":k1.name,"Ranges":[{"Sign":"I","Option":"EQ","Low":k.format(l1),"High":null}]};d1.SelectOptions.push(m1);});j1.forEach(function(k1){var l1={"PropertyName":"$Parameter."+k1.name,"PropertyValue":k1.defaultValue};d1.Parameters.push(l1);});}return d1;}function Y(e){var i=e.getSource(),$=X(i);if($){i.setDataSuiteFormat(JSON.stringify($),true);}Q=t.oCommonUtils.getNavigationHandler().parseNavigation();s.onInitSmartFilterBarExtension(e);}function Z(){var e=w.oSmartFilterbar.isCurrentVariantStandard()?w.oController.getOwnerComponent().getDefaultFilterMode():w.oSmartFilterbar.getMode();w.filterBarController.setDefaultFilter(e);Q.done(function(_,a1,b1){if(b1!==sap.ui.generic.app.navigation.service.NavType.initial){var c1=_&&_.bNavSelVarHasDefaultsOnly;var d1=new b(_.selectionVariant);var e1=d1.getParameterNames().concat(d1.getSelectOptionsPropertyNames());for(var i=0;i<e1.length;i++){w.oSmartFilterbar.addFieldToAdvancedArea(e1[i]);}if(!c1||w.oSmartFilterbar.getCurrentVariantId()===""){w.oSmartFilterbar.clearVariantSelection();w.oSmartFilterbar.clear();w.oSmartFilterbar.setDataSuiteFormat(_.selectionVariant,true);}if(_.tableVariantId){w.oSmartTable.setCurrentVariantId(_.tableVariantId);}var f1=w.oController.getOwnerComponent().getModel("_templPriv");if(b1===sap.ui.generic.app.navigation.service.NavType.xAppState&&f1.getProperty('/alp/filterMode')===p){var g1=w.oSmartFilterbar.getFilterData();w.alr_visualFilterBar.mergeCompactFilters(g1);}P(_.customData);if(!c1){w.oSmartFilterbar.search();}}});Q.fail(function(i){if(i instanceof Error){i.showMessageBox();}});var $=w.oController.getOwnerComponent().getModel("_filter");$.setData(w.oSmartFilterbar.getFilterData());}return{onInit:function(){var e=s.getOwnerComponent();w.hideVisualFilter=e.getHideVisualFilter();w.hideVisualFilter=(w.hideVisualFilter===undefined||w.hideVisualFilter!==true)?false:true;w.oSmartFilterbar=s.byId("template::SmartFilterBar");w.oSmartTable=s.byId("table");w.oPage=s.byId("template::Page");w.oSmartChart=s.byId("chart");w.alr_compactFilterContainer=s.byId("template::CompactFilterContainer");w.alr_visualFilterContainer=s.byId("template::VisualFilterContainer");w.alr_visualFilterToolbar=s.byId("template::VisualFilterToolbar");w.alr_visualFilterBar=s.byId("template::VisualFilterBar");w.alp_clearButton=s.byId("template::ClearButton");w.alp_goFiltersBtn=s.byId("template::GoFilters");w.alr_filterContainer=s.byId("template::FilterContainer");w.alr_pageVariant=e.getProperty('smartVariantManagement')||e.getProperty('smartVariantManagement')===undefined?s.byId("template::PageVariant"):null;w.oKpiTagContainer=s.byId("template::KpiTagContainer");w.chartController=new d();w.detailController=new D();w.toolbarController=new f();w.oController=s;w.filterBarController=new F();w.filterBarController.init(w);w.toolbarController.setState(w);w.chartController.setState(w);w.detailController.setState(w);K.init(w);if(!w.hideVisualFilter){w.visualFilterBarContainer=new V();w.visualFilterBarContainer.init(w);w.visualFilterDialogContainer=new h();w.visualFilterDialogContainer.init(w);}G();H();if(w.alp_goFiltersBtn){var i=e.getShowGoButtonOnFilterBar()?true:false;w.alp_goFiltersBtn.setVisible(i);}var $=e.getShowClearButtonOnFilterBar()?true:false;w.alp_clearButton.setVisible($);w.oTitle.attachEvent("_titlePress",function(){if(!w.oPage.getHeaderExpanded()){w.alr_visualFilterToolbar.addContent(w.filterSwitch);}else{w.alr_visualFilterToolbar.removeContent(w.filterSwitch);}});s.byId("template::FilterText").attachBrowserEvent("click",function(){s.byId("template::Page").setHeaderExpanded(true);w.alr_visualFilterToolbar.addContent(w.filterSwitch);});var _=e.getModel("_templPriv");_.setProperty("/listReport/isHeaderExpanded",true);v=t.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.fragments.ShareSheet",{shareEmailPressed:function(){z();sap.m.URLHelper.triggerEmail(null,t.oCommonUtils.getText("EMAIL_HEADER",[t.oCommonUtils.getText("PAGEHEADER")]),document.URL);},shareJamPressed:function(){z();var g1=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:t.oCommonUtils.getText("PAGEHEADER")}}});g1.open();}},"share",function(g1,h1){var i1=sap.ui.getCore().getLibraryResourceBundle("sap.m");h1.setProperty("/emailButtonText",i1.getText("SEMANTIC_CONTROL_SEND_EMAIL"));h1.setProperty("/jamButtonText",i1.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));h1.setProperty("/bookmarkButtonText",i1.getText("SEMANTIC_CONTROL_SAVE_AS_TILE"));var j1=q.sap.getObject("sap.ushell.Container.getUser");h1.setProperty("/jamVisible",!!j1&&j1().isJamActive());});var a1=w.oSmartTable.getTable();var b1="sapUiSizeCompact",c1="sapUiSizeCondensed";if(a1 instanceof U||a1 instanceof A){var d1=s.getView();var e1=q(document.body);if(e1.hasClass(b1)||d1.hasStyleClass(b1)){var f1=e.getComponentContainer().getSettings().condensedTableLayout;if(f1===false){w.oSmartTable.addStyleClass(b1);}else{w.oSmartTable.addStyleClass(c1);}}}},handlers:{onBack:function(){t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){window.history.back();},q.noop,w);},addEntry:function(e){var i=e.getSource();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){t.oCommonEventHandlers.addEntry(i,false,w.oSmartFilterbar);},q.noop,w);},deleteEntries:function(e){t.oCommonEventHandlers.deleteEntries(e);},onSelectionChange:function(e){var $=e.getSource(),_=$.getModel(),a1=$.getModel("_templPriv");var b1=_.getMetaModel(),c1=b1.getODataEntitySet(this.getOwnerComponent().getEntitySet()),d1=c1["Org.OData.Capabilities.V1.DeleteRestrictions"];var e1=(d1&&d1.Deletable&&d1.Deletable.Path)?d1.Deletable.Path:"";var f1=false;var g1=true;var h1=(e1&&e1!=="");var i1=t.oCommonUtils.getSelectedContexts($);if(i1.length>0){for(var i=0;i<i1.length;i++){var j1=_.getObject(i1[i].getPath());if(!(j1.IsActiveEntity&&j1.HasDraftEntity&&j1.DraftAdministrativeData&&j1.DraftAdministrativeData.InProcessByUser)){g1=false;}if(h1){if(_.getProperty(e1,i1[i])){h1=false;}}if(!g1&&!h1){f1=true;break;}}}a1.setProperty("/listReport/deleteEnabled",f1);},onChange:function(e){t.oCommonEventHandlers.onChange(e);},onSmartFieldUrlPressed:function(e){t.oCommonEventHandlers.onSmartFieldUrlPressed(e,w);},onContactDetails:function(e){t.oCommonEventHandlers.onContactDetails(e);},onSmartFilterBarInitialise:Y,onSmartFilterBarInitialized:Z,onEditStateFilterChanged:function(e){e.getSource().fireChange();},onFilterPress:function(e){w.filterBarController.showDialog();},onClearPress:function(e){w.filterBarController.clearFilters();s.onClearFilterExtension(e);},onGoPress:function(e){w.filterBarController.onGoFilter();},onSetHeaderState:function(e){w.oPage.setHeaderExpanded(!w.oPage.getHeaderExpanded());if(w.oPage.getHeaderExpanded()){e.getSource().setText(t.oCommonUtils.getText("VISUAL_FILTER_HIDE"));}else{e.getSource().setText(t.oCommonUtils.getText("VISUAL_FILTER_SHOW"));}},onVisualFilterToggle:function(e){w.alr_visualFilterBar.setVisible(!w.alr_visualFilterBar.getVisible());if(w.alr_visualFilterBar.getVisible()){e.getSource().setText(t.oCommonUtils.getText("VISUAL_FILTER_HIDE"));}else{e.getSource().setText(t.oCommonUtils.getText("VISUAL_FILTER_SHOW"));}setTimeout(function(){w.alr_visualFilterToolbar.toggleStyleClass("closed");},0);},onBeforeSFBVariantSave:function(){var e=y();if(!this.getOwnerComponent().getProperty('smartVariantManagement')){delete e.customData["sap.suite.ui.generic.template.genericData"].contentView;}w.oSmartFilterbar.setFilterData({_CUSTOM:e.customData});},onAfterSFBVariantLoad:function(){var e=w.oSmartFilterbar.getFilterData();if(e._CUSTOM!==undefined){P(e._CUSTOM);}else{var i=x();N(i[n]);N(i[o]);P(i);}z();},onBeforeRebindTable:function(e){t.oCommonEventHandlers.onBeforeRebindTable(e);s.onBeforeRebindTableExtension(e);},onBeforeRebindChart:function(e){},onShowDetails:function(e){t.oCommonEventHandlers.onShowDetails(e.getSource(),w);},onListNavigate:function(e){t.oCommonEventHandlers.onListNavigate(e.getSource(),w);},onCallActionFromToolBar:function(e){var i=t.oCommonUtils.getParentTable;t.oCommonUtils.getParentTable=function(){return w.oSmartTable;};t.oCommonEventHandlers.onCallActionFromToolBar(e,w);t.oCommonUtils.getParentTable=i;i=null;},onShowDetailsIntent:function(e){t.oCommonEventHandlers.onShowDetailsIntent(e,w.oSmartFilterbar);},onCallActionFromList:function(e){},onDataFieldForIntentBasedNavigation:function(e){t.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,w);},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var $=w.oSmartFilterbar.getDataSuiteFormat();t.oCommonUtils.semanticObjectLinkNavigation(i,$,s);},q.noop,w,q.noop);},onAssignedFiltersChanged:function(e){if(e&&e.getSource()){if(w&&w.oSmartFilterbar&&w.filterBarController){s.byId("template::FilterText").setText(w.oSmartFilterbar.retrieveFiltersWithValuesAsText());}}},onToggleFiltersPressed:function(){var e=s.getOwnerComponent();var i=e.getModel("_templPriv");i.setProperty("/listReport/isHeaderExpanded",(i.getProperty("/listReport/isHeaderExpanded")===true)?false:true);},onSearchButtonPressed:function(){var e=s.getOwnerComponent().getModel();e.attachEventOnce("requestSent",function(){z();});var i=function($){M.handleError("getCollection",this,t.oServices,$.getParameters());var _=this.getView().byId("table");_.getTable().setBusy(false);M.handleTransientMessages(t.oServices.oApplication.getDialogFragmentForView.bind(null,null));}.bind(this);e.attachEvent("requestFailed",i);e.attachEventOnce("requestCompleted",function($){if($.getParameter("success")){e.detachEvent("requestFailed",i);}});w.fireSearchButtonPressed();},onSemanticObjectLinkPopoverLinkPressed:function(e){z();t.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(e,w);},onAfterTableVariantSave:function(){z();},onAfterApplyTableVariant:function(){z();},onAfterChartVariantSave:function(){z();},onAfterApplyChartVariant:function(){z();},onSegmentButtonPressed:function(i){if(!i){w.oController.byId('template::PageVariant').currentVariantSetModified(true);w.oSmartFilterbar.setFilterData({_CUSTOM:x()});}z();},onShareListReportActionButtonPress:function(e){v.openBy(e.getSource());},onChartDeterminingDataFieldForAction:function(e){var i=t.oCommonUtils.getSelectedContexts(w.oSmartChart);var $=e.getSource();var _=t.oCommonUtils.getElementCustomData($);var a1=this.getView().getBindingPath();t.oCommonUtils.triggerAction(i,a1,_);},onDeterminingDataFieldForAction:function(e){var i=w.oSmartTable.getTable();var $=t.oCommonUtils.getSelectedContexts(i);if($.length===0){j.error(t.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:t.oCommonUtils.getContentDensityClass()});}else{var _=e.getSource();var a1=t.oCommonUtils.getElementCustomData(_);var b1=w.oSmartTable.getTableBindingPath();t.oCommonUtils.triggerAction($,b1,a1,i);}},onDeterminingDataFieldForIntentBasedNavigation:function(e){var i=e.getSource();var $=t.oCommonUtils.getElementCustomData(i);var _=i.getParent().data(r);var a1=w.oSmartTable.getTable();var b1=t.oCommonUtils.getSelectedContexts(a1);if(_===C){b1=t.oCommonUtils.getSelectedContexts(w.oSmartChart);}var c1=!($.RequiresContext&&$.RequiresContext==="false");if(c1&&b1.length===0){j.error(t.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:t.oCommonUtils.getContentDensityClass()});}else if(c1&&b1.length>1){j.error(t.oCommonUtils.getText("ST_GENERIC_MULTIPLE_ITEMS_SELECTED"),{styleClass:t.oCommonUtils.getContentDensityClass()});}else{var d1=c1?b1[0]:null;t.oCommonEventHandlers.onDataFieldForIntentBasedNavigationSelectedContext(d1,$,w);}},onAutoHideToggle:function(){w.chartController.updateTable();z();},onFullScreenToggled:function(e){var i=e.getParameter("fullScreen");var $=e.getSource().getModel("_templPriv");$.setProperty("/alp/fullScreen",i);}},extensionAPI:new c(t,s,w)};}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/ReuseComponentSupport",["jquery.sap.global","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/extensionAPI/extensionAPI"],function(q,U,J,e){"use strict";var R={},j="sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport";function a(c){c.attachEvent("modelContextChange",function(){var d=c.getBindingContext(),M=c.getModel(),b=d&&d.getPath();q.sap.log.debug(c.getId()+":"+c.getMetadata().getName()+": modelAvailable="+!!M+" : context="+b,j);if(M&&b&&c._stContext.lastBindingContextPath!==b){c._stContext.lastBindingContextPath=b;var C=(c._stContext.firstTime&&c.stStart)||c.stRefresh;if(C){c._stContext.extensionAPIPromise=c._stContext.extensionAPIPromise||e.getExtensionAPIPromise(c.oContainer);c._stContext.extensionAPIPromise.then(C.bind(c,M,d));}c._stContext.firstTime=false;}});}function m(c,C){c._stContext={lastBindingContextPath:"",firstTime:true};if(c.stRefresh||c.stStart){a(c);}if(C){var p=c.getMetadata().getProperties();var M={};for(var P in p){M[P]=c.getProperty(P);}var o=new J(M);c.setModel(o,C);var s=c.setProperty||q.noop;c.setProperty=function(n,v){s.apply(this,arguments);o.setProperty("/"+n,v);q.sap.log.debug(this.getId()+":"+this.getMetadata().getName()+": setProperty "+n+"="+v,j);};c.getComponentModel=c.getComponentModel||function(){return o;};}}R.mixInto=function(c,C){if(!(c instanceof U)){throw new Error("Reuse component must be an instance of sap.ui.core.UIComponent");}m(c,C);};return R;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.Component');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/Component",["sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/AnalyticalListPage/controller/ControllerImplementation"],function(T,C){"use strict";function g(c,o){return{oControllerSpecification:{getMethods:C.getMethods,oControllerDefinition:{getVisibleSelectionsWithDefaults:function(){var v=[];return v;},onInitSmartFilterBarExtension:function(e){},getCustomAppStateDataExtension:function(a){},restoreCustomAppStateDataExtension:function(a){},onBeforeRebindTableExtension:function(e){},onBeforeRebindChartExtension:function(e){},adaptNavigationParameterExtension:function(s,O){},onClearFilterExtension:function(e){}}},init:function(){var t=c.getModel("_templPriv");t.setProperty("/listReport",{});t.setProperty("/alp",{filterMode:"visual",contentView:"charttable",autoHide:true,visualFilter:{}});var f=new sap.ui.model.json.JSONModel();c.setModel(f,"_filter");},forView:{hasDraft:function(){return c.getAppComponent().getTransactionController().getDraftController().getDraftContext().isDraftEnabled(c.getEntitySet());}},onActivate:function(){o.setBackNavigation(undefined);},refreshBinding:function(){var v=c.getAggregation("rootControl");if(v instanceof sap.ui.core.mvc.XMLView){var s=v.byId("table");if(s&&s.rebindTable){s.rebindTable();}var S=v.byId("chart");if(S&&S.rebindChart){S.rebindChart();}}},overwrite:{updateBindingContext:function(){sap.suite.ui.generic.template.lib.TemplateComponent.prototype.updateBindingContext.apply(c,arguments);var b=c.getBindingContext();if(b){c.getModel().getMetaModel().loaded().then(function(){var u=c.getModel("ui");var a=b.getObject();if(a){var d=c.getAppComponent().getTransactionController().getDraftController();var D=d.getDraftContext();var i=D.hasDraft(b)&&!a.IsActiveEntity;if(i){u.setProperty("/editable",true);u.setProperty("/enabled",true);}}});}}}};}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.AnalyticalListPage",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"},"qualifier":{"type":"string","defaultValue":""},"gridTable":"boolean","multiSelect":"boolean","smartVariantManagement":{"type":"boolean","defaultValue":true},"defaultContentView":{"type":"string","defaultValue":"charttable"},"defaultFilterMode":{"type":"string","defaultValue":"visual"},"keyPerformanceIndicators":"array","autoHide":{"type":"boolean","defaultValue":true},"showAutoHide":{"type":"boolean","defaultValue":true},"hideVisualFilter":{"type":"boolean","defaultValue":false},"showGoButtonOnFilterBar":"boolean","condensedTableLayout":"boolean","showClearButtonOnFilterBar":{"type":"boolean","defaultValue":false}},"manifest":"json"}});});};
