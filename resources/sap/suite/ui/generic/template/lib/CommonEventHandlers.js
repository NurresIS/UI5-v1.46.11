sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/format/DateFormat","sap/m/ComboBox","sap/m/MessageBox","sap/m/MessageToast","sap/m/Table","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/table/AnalyticalTable","sap/ui/table/Table","sap/ui/model/odata/type/Time","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,C,M,a,T,F,S,b,A,U,c,t){"use strict";function g(p){var s="";var m=[];return function(o){var l="";var e=p;var f;for(var h in m){if(m[h].path===p){f=m[h];break;}}if(!f){var i=o.getModel("entitySet").getMetaModel();var P=i.getObject(i.getMetaContext(o.sPath+"/"+p).sPath);if(P){var j=" ";for(var k=0;P.extensions&&k<P.extensions.length;k++){if(P.extensions[k].namespace==="http://www.sap.com/Protocols/SAPData"){switch(P.extensions[k].name){case"display-format":j=P.extensions[k].value;break;case"label":l=P.extensions[k].value;break;case"text":var n=P.extensions[k].value;var r=p.split("/");r[r.length-1]=n;e=r.join("/");break;default:break;}}}if(l===""){l=p;}f={path:p,data:{type:P.type,displayFormat:j,label:l,textPath:e}};m.push(f);}}l=f.data.label;var u=o.getProperty(p);var v;if(f.data.textPath&&f.data.textPath!==""){v=o.getProperty(f.data.textPath);}if(!v||f.data.textPath===p){s=u?u:"";}else{s=v+(u?" ("+u+")":"");}switch(f.data.type){case"Edm.DateTime":if(f.data.displayFormat==="Date"){var w=D.getDateInstance({style:"medium"});var x=new Date(0).getTimezoneOffset()*60*1000;if(s&&s!==""&&s.getTime){s=w.format(new Date(s.getTime()+x));}}break;case"Edm.Time":if(s&&s!==""){var y=new c();s=y.formatValue(s,"string");}break;case"Edm.Boolean":if(s===true){s="{i18n>YES}";}else if(s===false){s="{i18n>NO}";}break;default:break;}return{key:s?s:p,text:l?l+": "+s:s};};}function d(o,e,s,f){function E(i){var j={};for(var k in i){var i1=i[k];if(typeof i1==="string"){j[k]=i1;}else if(typeof i1==="object"){if(i1.value){j[k]=E(i1).value;}else{j[k]=i1;}}}return j;}function h(i){if(i instanceof sap.ui.generic.app.navigation.service.NavError){sap.m.MessageBox.show(i.getErrorCode(),{title:f.getText("ST_GENERIC_ERROR_TITLE")});}}function l(){var i=o.getView().getBindingContext();return s.oApplication.getDraftSiblingPromise(i);}var I;var m;function n(i){I=true;m=i;var j=f.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){q.sap.log.info("Draft cancellation confirmed");if(!I){q.sap.log.info("Draft popover no longer active -> Ignore.");return;}var k=s.oApplication.getBusyHelper();if(k.isBusy()){q.sap.log.info("Ignore discarding confirmation as app is already busy");return;}q.sap.log.info("Discarding was confirmed, draft will be discarded");k.setBusy(m);m.then(function(i1){q.sap.log.info("Active information for current draft has been read. Start discarding the draft");var j1=i1&&i1.getObject();var k1=j1&&j1.IsActiveEntity;var l1=k1?s.oApplication.getTargetAfterCancelPromise(i1):Promise.resolve();l1.then(function(m1){var n1=s.oCRUDManager.deleteEntity();n1.then(function(){q.sap.log.info("Draft was discarded successfully");I=false;j.close();q.sap.log.info("Draft popover closed");s.oViewDependencyHelper.setRootPageToDirty();s.oViewDependencyHelper.unbindChildren(o.getOwnerComponent());if(m1){q.sap.log.info("Navigate to active entityy");s.oNavigationController.navigateToContext(m1,null,true,1);}else{q.sap.log.info("Deleted draft was create draft. Navigate back");var p1=o.getOwnerComponent().getModel("_templPrivGlobal");var q1=p1.getProperty("/generic/forceFullscreenCreate");if(q1){s.oNavigationController.navigateBack();}else{s.oNavigationController.navigateToRoot(true);}}});var o1={discardPromise:n1};e.fire(o,"AfterCancel",o1);});},function(i1){j.close();});}},"discard");return j;}var p;function r(){p=true;var i=f.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardSubItemPopover",{onDiscardConfirm:function(){q.sap.log.info("Sub item cancellation confirmed");if(!p){q.sap.log.info("Sub item popover no longer active -> Ignore.");return;}var j=s.oCRUDManager.deleteEntity(false,true);j.then(function(){var i1=o.getOwnerComponent();s.oViewDependencyHelper.setParentToDirty(i1,i1.getNavigationProperty());s.oViewDependencyHelper.unbindChildren(i1,true);i.close();p=false;s.oNavigationController.navigateBack();});var k={deleteEntityPromise:j};e.fire(o,"AfterDelete",k);}},"discard");return i;}function u(j){var k=j;var i1=-1,j1=-1;var k1=f.getOwnerControl(j);if(k1.getTable){k1=k1.getTable();}var l1=k1 instanceof A;if(!l1){var m1=f.getTableBindingInfo(k1);var n1=m1&&m1.binding;var o1=null;if(n1){if(k1 instanceof U){o1=n1.getContexts();}else if(k1 instanceof T){o1=n1.getCurrentContexts();}}var p1=null;var q1=f.getSelectedContexts(k1);var r1=null;if(q1&&q1.length>0){r1=q1[0].getPath();}else if(k){if(k1 instanceof T){r1=k.getBindingContext()?k.getBindingContext().sPath:null;}}if(n1&&n1.getContexts&&r1){for(var i=0;i<o1.length;i++){p1=o1[i];if(p1.getPath()===r1){i1=i;break;}}}if(k1&&i1!==-1){j1=n1.getLength();var s1=Math.floor(j1/5);if(k1 instanceof T){s1=k1.getGrowingThreshold();}else if(k1 instanceof U){s1=k1.getThreshold();}var t1=null;if(n1&&k1 instanceof U){t1=n1.getContexts();}else if(n1&&k1 instanceof T){t1=n1.getCurrentContexts();}var u1=t1&&{listBinding:n1,tableMaxItems:j1,growingThreshold:s1,selectedRelativeIndex:i1,objectPageNavigationContexts:t1,tableNavFrom:k1,endIndex:t1.length-1};var v1=e.getTemplatePrivateModel();var w1=v1.getProperty("/generic/viewLevel");var x1=o.getOwnerComponent().getModel("_templPrivGlobal");x1.setProperty("/generic/paginatorInfo/"+w1,u1);}}}function v(j,k){var i1=o.getView().getModel().getMetaModel();var j1=k;var k1=i1.getODataEntitySet(j,false);var l1=i1.getODataEntityType(k1.entityType,false);var m1=l1.key.propertyRef;var i;var n1=s.oDraftController.getDraftContext();if(n1.isDraftEnabled(j)){m1=m1.concat(n1.getSemanticKey(j));m1.push({name:"IsActiveEntity"},{name:"HasDraftEntity"},{name:"HasActiveEntity"});}if(j1.parameters.select&&j1.parameters.select.length>0){var o1=j1.parameters.select.split(",");for(i=0;i<m1.length;i++){if(q.inArray(m1[i].name,o1)===-1){j1.parameters.select+=","+m1[i].name;}}}return j1;}function w(i,j){var k=i.getSource().getUrl();i.preventDefault();f.processDataLossConfirmationIfNonDraft(function(){sap.m.URLHelper.redirect(k,false);},q.noop,j);}function x(i,j){i.preventDefault();var k=i.getSource().getHref();f.processDataLossConfirmationIfNonDraft(function(){window.location.hash=k;},q.noop,j);}function y(j){return f.getDialogFragment("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(i){var k=i.getSource().getParent();k.close();},onDelete:function(k){var i1=k.getSource().getParent();var j1=i1.getModel("delete");var k1=j1.getProperty("/items");var l1=[];for(var i=0;i<k1.length;i++){if(!k1[i].draftStatus.locked&&k1[i].deletable){if(k1.length===j1.getProperty("/unsavedChangesItemsCount")||!k1[i].draftStatus.unsavedChanges||j1.getProperty("/checkboxSelected")){l1.push(k1[i].context.getPath());}}}s.oCRUDManager.deleteEntities(l1).then(function(m1){var n1=j.getTable();n1.getModel("_templPriv").setProperty("/listReport/deleteEnabled",false);var o1=l1.length-m1.length;if(m1.length>0){var p1="";if(o1>0){p1+=(o1>1)?f.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL_WITH_COUNT",[o1]):f.getText("ST_GENERIC_DELETE_SUCCESS_WITH_COUNT",[o1]);p1+="\n";p1+=(m1.length>1)?f.getText("ST_GENERIC_DELETE_ERROR_PLURAL_WITH_COUNT",[m1.length]):f.getText("ST_GENERIC_DELETE_ERROR_WITH_COUNT",[m1.length]);}else{p1=(m1.length>1)?f.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):f.getText("ST_GENERIC_DELETE_ERROR");}M.error(p1);}else{var q1="";q1=(o1>1)?f.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):f.getText("ST_GENERIC_OBJECT_DELETED");a.show(q1);}f.refreshSmartTable(j);},function(m1){M.error(f.getText("ST_GENERIC_DELETE_ERROR_PLURAL",[l1.length]),{styleClass:f.getContentDensityClass()});});i1.close();}},"delete");}function z(j){var k=o.getView().getModel();var i1=k.getMetaModel();var j1=i1.getODataEntitySet(o.getOwnerComponent().getEntitySet());var k1=j1["Org.OData.Capabilities.V1.DeleteRestrictions"];var l1=(k1&&k1.Deletable&&k1.Deletable.Path)?k1.Deletable.Path:"";var m1={items:undefined,itemsCount:j.length,text:{title:undefined,shortText:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,checkboxSelected:true};var n1=[];for(var i=0;i<j.length;i++){var o1=k.getObject(j[i].getPath());var p1={};var q1=true;if(!o1.IsActiveEntity){p1.draft=true;}else if(o1.HasDraftEntity){var r1=k.getProperty("DraftAdministrativeData/InProcessByUser",j[i]);if(r1){p1.locked=true;p1.user=r1;m1.lockedItemsCount++;}else{p1.unsavedChanges=true;p1.user=k.getProperty("DraftAdministrativeData/LastChangedByUser",j[i]);m1.unsavedChangesItemsCount++;}}if(l1&&l1!==""){if(k.getProperty(l1,j[i])===false){q1=false;m1.undeletableCount++;}}n1.push({context:j[i],draftStatus:p1,deletable:q1});}m1.items=n1;if(m1.lockedItemsCount===m1.itemsCount){m1.text.title=f.getText("ST_GENERIC_ERROR_TITLE");}else{m1.text.title=(m1.itemsCount>1)?f.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[m1.itemsCount]):f.getText("ST_GENERIC_DELETE_TITLE");}m1.text.unsavedChanges=f.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(m1.itemsCount>1){if(m1.lockedItemsCount===m1.itemsCount){m1.text.shortText=f.getText("ST_GENERIC_DELETE_LOCKED_PLURAL");}else if(m1.unsavedChangesItemsCount===m1.itemsCount){m1.text.shortText=f.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL");}else if(m1.lockedItemsCount>0){var s1=m1.itemsCount-m1.lockedItemsCount;m1.text.shortText=(m1.lockedItemsCount>1)?f.getText("ST_GENERIC_CURRENTLY_LOCKED_PLURAL",[m1.lockedItemsCount,m1.itemsCount]):f.getText("ST_GENERIC_CURRENTLY_LOCKED",[m1.itemsCount]);m1.text.shortText+="\n";if(s1===m1.unsavedChangesItemsCount){m1.text.shortText+=(s1>1)?f.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL"):f.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");}else{m1.text.shortText+=(s1>1)?f.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[s1]):f.getText("ST_GENERIC_DELETE_REMAINING");}}else{m1.text.shortText=f.getText("ST_GENERIC_DELETE_SELECTED_PLURAL");}if(m1.undeletableCount>0){m1.text.undeletableText=f.getText("ST_GENERIC_DELETE_UNDELETABLE",[m1.undeletableCount,m1.itemsCount]);}}else{if(m1.lockedItemsCount>0){m1.text.shortText=f.getText("ST_GENERIC_DELETE_LOCKED",[" ",m1.items[0].draftStatus.user]);}else if(m1.unsavedChangesItemsCount>0){m1.text.shortText=f.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",m1.items[0].draftStatus.user]);}else{m1.text.shortText=f.getText("ST_GENERIC_DELETE_SELECTED");}}return m1;}function G(i){M.error(f.getText(i),{styleClass:f.getContentDensityClass()});}function H(i,j,k,i1){var j1=f.getNavigationHandler();var k1={};var l1={};for(var m1 in i.parameters){if(q.isEmptyObject(i.parameters[m1])){k1[m1]=i.parameters[m1];}else{l1[m1]=i.parameters[m1];}}l1=E(l1);j1.mixAttributesAndSelectionVariant({},i1).getParameterNames().forEach(function(m1){delete k1[m1];});var n1=k&&k.getObject();var o1=j&&j.getObject();var p1=q.extend({},k1,n1,o1,l1);return j1.mixAttributesAndSelectionVariant(p1,i1);}function N(i,j,k,i1){var j1=f.getNavigationHandler();var k1;if(k){k1=k.getDataSuiteFormat();}var l1=H(i,j,o.getView().getBindingContext(),k1);var m1={semanticObject:i.semanticObject,action:i.action};o.adaptNavigationParameterExtension(l1,m1);j1.navigate(i.semanticObject,i.action,l1.toJSONString(),null,h);}function J(i,j,k){var i1=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var j1=i1.crossNavigation.outbounds[i.data("CrossNavigation")];var k1;if(k){k1=f.getOwnerControl(i).getParent();}N(j1,j,k,k1);}function K(j,k){for(var i=0;i<j.length;i++){if(j[i].indexOf("/")!==-1){var i1=j[i].split("/");i1.pop();var j1=i1.join("/");if(k.indexOf(j1)===-1){k.push(j1);}}}}function L(i,j){}function O(k){var i1=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui.generic.app");var j1={};if(i1&&i1.pages[0]&&i1.pages[0].component&&i1.pages[0].component.settings){j1=i1.pages[0].component.settings.tableTabs;}var k1=[];for(var l1 in j1){var m1=j1[l1].qualifier;if(m1){k1[l1]=[];var n1=k[m1];for(var i in n1.SelectOptions){if(n1.SelectOptions[i].PropertyName){var o1=n1.SelectOptions[i].PropertyName.PropertyPath;for(var j in n1.SelectOptions[i].Ranges){var p1=n1.SelectOptions[i].Ranges[j].Option;p1.EnumMember=p1.EnumMember.replace("com.sap.vocabularies.UI.v1.SelectionRangeOptionType/","");var q1=n1.SelectOptions[i].Ranges[j].Low;var r1=n1.SelectOptions[i].Ranges[j].High;if(r1){k1[l1].push(new F(o1,p1.EnumMember,q1.String,r1.String));}else{k1[l1].push(new F(o1,p1.EnumMember,q1.String));}}}}}}return k1;}function V(o,j,k,i1){var j1=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui.generic.app");if(o.getMetadata().getName()==='sap.suite.ui.generic.template.ListReport.view.ListReport'&&j1&&j1.pages[0]&&j1.pages[0].component&&j1.pages[0].component.settings&&j1.pages[0].component.settings.tableTabs){var k1=j.getFilters();if(k1[0]&&k1[0]._bMultiFilter){k1=k1[0].aFilters;}if(k1){for(var i in k1){i1.filters.push(k1[i]);}}}}function P(i){f.setEnabledToolbarButtons(i.getSource());}function Q(i){var i1=i.getSource();var j1=i1.getTable();if(j1 instanceof T){var k1=j1.getColumns();for(var l1=0;l1<k1.length;l1++){if(k1[l1].getCustomData()[0].getValue()&&k1[l1].getCustomData()[0].getValue()["actionButton"]==="true"){k1[l1].setPopinDisplay("WithoutHeader");}}}var m1=i.getParameter("bindingParams");m1.parameters=m1.parameters||{};var n1=o.byId(i1.getSmartFilterId());if(!n1){n1=o.byId("listReportFilter");V(o,n1,i1,m1);}if(n1 instanceof b){var o1=n1.getControlByKey("EditState");if(o1 instanceof C){var p1=o1.getSelectedKey();switch(p1){case"1":m1.filters.push(new F("IsActiveEntity","EQ",true));m1.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":m1.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":m1.filters.push(new F("IsActiveEntity","EQ",true));m1.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));m1.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":m1.filters.push(new F("IsActiveEntity","EQ",true));m1.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));m1.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var q1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(m1.filters[0]&&m1.filters[0].aFilters){var r1=m1.filters[0];m1.filters[0]=new F([r1,q1],true);}else{m1.filters.push(q1);}break;}}}v(i1.getEntitySet(),m1);var s1=m1.parameters.select&&m1.parameters.select.split(",")||[];var t1=m1.parameters&&m1.parameters.expand&&m1.parameters.expand.split(",")||[];var u1=i1.getEntitySet();if(s1&&s1.length>0){var v1=i1.getModel().getMetaModel();var w1=v1.getODataEntitySet(u1);var x1={};var y1=v1.getODataEntityType(w1.entityType);for(var z1=0;z1<s1.length;z1++){var A1=s1[z1];if(A1){var x1=v1.getODataProperty(y1,A1);if(x1&&x1["com.sap.vocabularies.Common.v1.FieldControl"]&&x1["com.sap.vocabularies.Common.v1.FieldControl"].Path){var B1=x1["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(B1!==" "&&m1.parameters.select.search(B1)===-1){m1.parameters.select+=","+B1;s1.push(B1);}}}}if(j1 instanceof T){var C1=m1.sorter[0];if(C1&&C1.vGroup){var D1=v1.getODataProperty(y1,C1.sPath);var E1=D1["sap:text"]||(D1["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";if(E1){if(q.inArray(E1,s1)===-1){m1.parameters.select+=","+E1;s1.push(E1);}}}}var F1=w1["Org.OData.Capabilities.V1.DeleteRestrictions"];if(F1&&F1.Deletable&&F1.Deletable.Path&&m1.parameters.select.search(F1.Deletable.Path)===-1){m1.parameters.select+=","+F1.Deletable.Path;s1.push(F1.Deletable.Path);}var G1,H1;var y1=v1.getODataEntityType(w1.entityType);var I1=y1["com.sap.vocabularies.UI.v1.LineItem"]||[];for(var z1=0;z1<I1.length;z1++){if(I1[z1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){G1=v1.getODataFunctionImport(I1[z1].Action.String,true);if(G1){H1=v1.getObject(G1);if(H1["sap:action-for"]!==" "&&H1["sap:applicable-path"]!==" "&&m1.parameters.select.search(H1["sap:applicable-path"])===-1){m1.parameters.select+=","+H1["sap:applicable-path"];s1.push(H1["sap:applicable-path"]);}}}if(I1[z1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){var J1,K1;if(I1[z1].Value&&I1[z1].Value.Path){J1=v1.getODataProperty(y1,I1[z1].Value.Path);if(J1){K1=J1["sap:text"]||(J1["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";}if(!K1){K1=I1[z1].Value.Path;}if(s1.indexOf(K1)===-1){s1.push(K1);m1.parameters.select=m1.parameters.select+","+K1;}}}if(I1[z1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(I1[z1].Target&&I1[z1].Target.AnnotationPath){var L1=I1[z1].Target.AnnotationPath;var M1=L1.split("@")[1];var N1=y1[M1];if(N1&&N1.MeasureAttributes){if(N1.MeasureAttributes[0]&&N1.MeasureAttributes[0].DataPoint&&N1.MeasureAttributes[0].DataPoint.AnnotationPath){var O1=N1.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var P1=y1[O1];if(P1){for(var Q1 in P1){if(P1[Q1]&&P1[Q1].Path&&s1.indexOf(P1[Q1].Path)===-1){m1.parameters.select=m1.parameters.select+","+P1[Q1].Path;s1.push(P1[Q1].Path);}if(Q1==="CriticalityCalculation"&&P1.CriticalityCalculation){for(var R1 in P1.CriticalityCalculation){if(P1.CriticalityCalculation[R1].Path&&s1.indexOf(P1.CriticalityCalculation[R1].Path)===-1){m1.parameters.select=m1.parameters.select+","+P1.CriticalityCalculation[R1].Path;s1.push(P1.CriticalityCalculation[R1].Path);}}}}}}}if(N1&&N1.Measures){if(N1.Measures[0]&&N1.Measures[0].PropertyPath&&s1.indexOf(N1.Measures[0].PropertyPath)===-1){m1.parameters.select=m1.parameters.select+","+N1.Measures[0].PropertyPath;s1.push(N1.Measures[0].PropertyPath);}}}}}var S1=f.getBreakoutActionsForTable(i1,o);var T1=f.getBreakoutActionsFromManifest(j1.getModel());for(var U1 in T1){if(q.inArray(T1[U1].id,S1)!==-1){if(T1[U1].requiresSelection&&T1[U1].applicablePath){if(m1.parameters.select.search(T1[U1].applicablePath)===-1){m1.parameters.select+=","+T1[U1].applicablePath;s1.push(T1[U1].applicablePath);}}}}}K(s1,t1);var V1=s.oDraftController.getDraftContext();if(V1.isDraftEnabled(u1)&&V1.isDraftRoot(u1)){if(V1.hasDraftAdministrativeData(u1)){if(s1&&s1.length>0){if(s1.indexOf("DraftAdministrativeData")===-1){s1.push("DraftAdministrativeData");m1.parameters.select=m1.parameters.select+",DraftAdministrativeData";}}if(t1.indexOf("DraftAdministrativeData")===-1){t1.push("DraftAdministrativeData");}}}if(t1.length>0){m1.parameters.expand=t1.join(",");}var W1=i1.getCustomData();var X1={};for(var k=0;k<W1.length;k++){X1[W1[k].getKey()]=W1[k].getValue();}var Y1=i1.fetchVariant();if((!Y1||!Y1.sort)&&j1 instanceof T&&X1.TemplateSortOrder){var Z1=X1.TemplateSortOrder.split(", ");for(var j=0;j<Z1.length;j++){var $1=Z1[j].split(" ");if($1.length>1){m1.sorter.push(new S($1[0],$1[1]==="true"));}else{m1.sorter.push(new S($1[0]));}}}if(j1 instanceof T){var C1=m1.sorter[0];if(C1&&C1.vGroup){C1.fnGroup=g(C1.sPath);}}}function R(i,j,k){i[j].setCount(k);}function W(j){var k=o.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui.generic.app");if(k&&k.pages[0]&&k.pages[0].component&&k.pages[0].component.settings&&k.pages[0].component.settings.tableTabs){var i1=j.getParameter("bindingParams");i1.parameters=i1.parameters||{};var j1=j.getSource();var k1=j1.getModel();var l1=k1.getMetaModel();var m1=j1.getEntitySet();var n1=l1.getODataEntitySet(m1);var o1=l1.getODataEntityType(n1.entityType);var p1=O(o1);var q1=o.byId("iconTabBar");var r1=q1.getSelectedKey();var s1=q1.getItems();for(var t1 in s1){var u1=[];for(var i in i1.filters){u1.push(i1.filters[i]);}for(var i in p1[t1]){u1.push(p1[t1][i]);}var v1=o.byId("listReport-"+t1);var m1=v1.getEntitySet();k1.read("/"+m1+"/$count",{urlParameters:i1.parameters,filters:u1,groupId:"updateTabs",success:R.bind(null,s1,t1),error:function(w1,x1){}});}for(var i in p1[r1]){i1.filters.push(p1[r1][i]);}}}function X(i,j){f.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){J(i,i.getBindingContext(),j.oSmartFilterbar);return;}var k=f.getOwnerControl(i);u(i);f.navigateFromListItem(i.getBindingContext(),k);},q.noop,j);}function Y(i,j){var k=i.getParent().getParent().getTable();var i1=f.getSelectedContexts(k);switch(i1.length){case 0:G("ST_GENERIC_NO_ITEM_SELECTED");return;case 1:f.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){J(i,i1[0],j.oSmartFilterbar);return;}u(i);f.navigateFromListItem(i1[0],k);},q.noop,j);return;default:G("ST_GENERIC_MULTIPLE_ITEMS_SELECTED");return;}}function Z(i,j){var k=i.getSource();var i1=f.getOwnerControl(k);var j1=f.getSelectedContexts(i1);switch(j1.length){case 0:case 1:f.processDataLossConfirmationIfNonDraft(function(){var k1={action:k.data('Action'),semanticObject:k.data('SemanticObject')};N(k1,j1[0],j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);return;default:G("ST_GENERIC_MULTIPLE_ITEMS_SELECTED");return;}}function $(i,j){var k=i.getSource();var i1=k.getParent().getBindingContext();var j1=k.data('SemanticObject');var k1=k.data('Action');f.processDataLossConfirmationIfNonDraft(function(){var l1={action:k1,semanticObject:j1};N(l1,i1,j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}function _(i,j,k){f.processDataLossConfirmationIfNonDraft(function(){var i1={action:j.Action,semanticObject:j.SemanticObject};N(i1,i,k.oSmartFilterbar,k.oSmartTable);},q.noop,k);}function a1(i,j){f.processDataLossConfirmationIfNonDraft(function(){var k={semanticObject:i.data("SemanticObject"),action:i.data("Action")};var i1=i.getParent().getBindingContext();N(k,i1,j.oSmartFilterbar,j.oSmartTable);},q.noop,j);}function b1(i,j){var k,i1="";var j1=f.getOwnerControl(i.getSource());var k1=i.getSource().data();var l1=f.getSelectedContexts(j1);var m1=j1.getMetadata().getName();if(m1==="sap.ui.comp.smarttable.SmartTable"){k=j1.getTable();i1=j1.getTableBindingPath();}else if(m1==="sap.ui.comp.smartchart.SmartChart"){k=j1.getChart();i1=j1.getChartBindingPath();}c1({functionImportPath:k1.Action,contexts:l1,sourceControl:k,label:k1.Label,operationGrouping:k1.InvocationGrouping,navigationProperty:""},j,i1);}function c1(i,j,k){var i1;f.processDataLossConfirmationIfNonDraft(function(){s.oCRUDManager.callAction({functionImportPath:i.functionImportPath,contexts:i.contexts,sourceControl:i.sourceControl,label:i.label,operationGrouping:i.operationGrouping,navigationProperty:i.navigationProperty},j).then(function(j1){if(j1&&j1.length&&j1.length===1){i1=j1[0];if(i1.response&&i1.response.context&&(!i1.actionContext||i1.actionContext&&i1.response.context.getPath()!==i1.actionContext.getPath())){s.oViewDependencyHelper.setMeToDirty(o.getOwnerComponent(),k);}}});},q.noop,j,"Proceed");}function d1(i){var j=i.getSource();var k=l();var i1=n(k);var j1=i1.getModel("discard");j1.setProperty("/placement",sap.m.PlacementType.Top);var k1=o.getView().getBindingContext();var l1=k1.getObject();var m1=l1.hasOwnProperty("HasActiveEntity")&&!k1.getProperty("IsActiveEntity")&&!k1.getProperty("HasActiveEntity");j1.setProperty("/isCreateDraft",m1);i1.openBy(j);}function e1(i){var j=i.getSource();var k=j.getCustomData();var i1=r();var j1=i1.getModel("discard");var k1=k&&k[0]?k[0].getValue():sap.m.PlacementType.Top;j1.setProperty("/placement",k1);i1.openBy(j);}function f1(i,j,k){if(i.data("CrossNavigation")){J(i,i.getBindingContext(),k);return new Promise(function(m1){m1();});}var i1=f.getOwnerControl(i);var j1=i1.getTableBindingPath();var k1=o.getOwnerComponent();var l1=s.oCRUDManager.addEntry(i1).then(function(m1){if(!j){s.oNavigationController.navigateToContext(m1.newContext,m1.tableBindingPath,false,4);s.oViewDependencyHelper.setMeToDirty(k1,j1);}else{f.refreshSmartTable(i1);}});l1.catch(q.noop);return l1;}function g1(i){var j=f.getOwnerControl(i.getSource());var k=f.getSelectedContexts(j);if(k&&k.length>0){var i1=z(k);var j1=y(j);var k1=j1.getModel("delete");k1.setData(i1);j1.open();}else{M.error(f.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:f.getContentDensityClass()});}}function h1(i){var j;if(i.getSource().data("Location")==="Header"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="Section"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="SmartTable"){j=i.getSource().getParent().getAggregation("items")[0];}else{j=i.getSource().getParent().getParent().getParent().getParent().getParent().getAggregation("items")[1];}j.bindElement(i.getSource().getBindingContext().getPath());j.openBy(i.getSource());}var H=t.testable(H,"fnBuildSelectionVariantForNavigation");var E=t.testable(E,"fnEvaluateParameters");return{onDataReceived:P,onBeforeRebindTable:Q,onBeforeRebindTableFinally:W,onListNavigate:X,onShowDetails:Y,onEditNavigateIntent:J,onSemanticObjectLinkPopoverLinkPressed:L,onDataFieldForIntentBasedNavigation:Z,onDataFieldForIntentBasedNavigationSelectedContext:_,onInlineDataFieldForIntentBasedNavigation:a1,onDataFieldWithIntentBasedNavigation:$,onSmartFieldUrlPressed:w,onBreadCrumbUrlPressed:x,onCallActionFromToolBar:b1,onDiscardDraft:d1,onDiscardSubItem:e1,addEntry:f1,deleteEntries:g1,onContactDetails:h1};}return B.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(o,e,s,f){q.extend(this,d(o,e,s,f));}});});
